var Q8=Object.defineProperty;var J8=(e,t,n)=>t in e?Q8(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var v=(e,t,n)=>(J8(e,typeof t!="symbol"?t+"":t,n),n);function eD(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in e)){const o=Object.getOwnPropertyDescriptor(r,i);o&&Object.defineProperty(e,i,o.get?o:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();var Ln=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function rl(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var n$={exports:{}},qm={},r$={exports:{}},Ve={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bh=Symbol.for("react.element"),tD=Symbol.for("react.portal"),nD=Symbol.for("react.fragment"),rD=Symbol.for("react.strict_mode"),iD=Symbol.for("react.profiler"),oD=Symbol.for("react.provider"),sD=Symbol.for("react.context"),aD=Symbol.for("react.forward_ref"),lD=Symbol.for("react.suspense"),cD=Symbol.for("react.memo"),uD=Symbol.for("react.lazy"),nE=Symbol.iterator;function dD(e){return e===null||typeof e!="object"?null:(e=nE&&e[nE]||e["@@iterator"],typeof e=="function"?e:null)}var i$={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},o$=Object.assign,s$={};function jc(e,t,n){this.props=e,this.context=t,this.refs=s$,this.updater=n||i$}jc.prototype.isReactComponent={};jc.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};jc.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function a$(){}a$.prototype=jc.prototype;function vw(e,t,n){this.props=e,this.context=t,this.refs=s$,this.updater=n||i$}var xw=vw.prototype=new a$;xw.constructor=vw;o$(xw,jc.prototype);xw.isPureReactComponent=!0;var rE=Array.isArray,l$=Object.prototype.hasOwnProperty,bw={current:null},c$={key:!0,ref:!0,__self:!0,__source:!0};function u$(e,t,n){var r,i={},o=null,s=null;if(t!=null)for(r in t.ref!==void 0&&(s=t.ref),t.key!==void 0&&(o=""+t.key),t)l$.call(t,r)&&!c$.hasOwnProperty(r)&&(i[r]=t[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];i.children=l}if(e&&e.defaultProps)for(r in a=e.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:bh,type:e,key:o,ref:s,props:i,_owner:bw.current}}function hD(e,t){return{$$typeof:bh,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function ww(e){return typeof e=="object"&&e!==null&&e.$$typeof===bh}function fD(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var iE=/\/+/g;function b0(e,t){return typeof e=="object"&&e!==null&&e.key!=null?fD(""+e.key):t.toString(36)}function _p(e,t,n,r,i){var o=typeof e;(o==="undefined"||o==="boolean")&&(e=null);var s=!1;if(e===null)s=!0;else switch(o){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case bh:case tD:s=!0}}if(s)return s=e,i=i(s),e=r===""?"."+b0(s,0):r,rE(i)?(n="",e!=null&&(n=e.replace(iE,"$&/")+"/"),_p(i,t,n,"",function(c){return c})):i!=null&&(ww(i)&&(i=hD(i,n+(!i.key||s&&s.key===i.key?"":(""+i.key).replace(iE,"$&/")+"/")+e)),t.push(i)),1;if(s=0,r=r===""?".":r+":",rE(e))for(var a=0;a<e.length;a++){o=e[a];var l=r+b0(o,a);s+=_p(o,t,n,l,i)}else if(l=dD(e),typeof l=="function")for(e=l.call(e),a=0;!(o=e.next()).done;)o=o.value,l=r+b0(o,a++),s+=_p(o,t,n,l,i);else if(o==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return s}function mf(e,t,n){if(e==null)return e;var r=[],i=0;return _p(e,r,"","",function(o){return t.call(n,o,i++)}),r}function pD(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Zn={current:null},Cp={transition:null},gD={ReactCurrentDispatcher:Zn,ReactCurrentBatchConfig:Cp,ReactCurrentOwner:bw};Ve.Children={map:mf,forEach:function(e,t,n){mf(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return mf(e,function(){t++}),t},toArray:function(e){return mf(e,function(t){return t})||[]},only:function(e){if(!ww(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ve.Component=jc;Ve.Fragment=nD;Ve.Profiler=iD;Ve.PureComponent=vw;Ve.StrictMode=rD;Ve.Suspense=lD;Ve.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=gD;Ve.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=o$({},e.props),i=e.key,o=e.ref,s=e._owner;if(t!=null){if(t.ref!==void 0&&(o=t.ref,s=bw.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(l in t)l$.call(t,l)&&!c$.hasOwnProperty(l)&&(r[l]=t[l]===void 0&&a!==void 0?a[l]:t[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];r.children=a}return{$$typeof:bh,type:e.type,key:i,ref:o,props:r,_owner:s}};Ve.createContext=function(e){return e={$$typeof:sD,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:oD,_context:e},e.Consumer=e};Ve.createElement=u$;Ve.createFactory=function(e){var t=u$.bind(null,e);return t.type=e,t};Ve.createRef=function(){return{current:null}};Ve.forwardRef=function(e){return{$$typeof:aD,render:e}};Ve.isValidElement=ww;Ve.lazy=function(e){return{$$typeof:uD,_payload:{_status:-1,_result:e},_init:pD}};Ve.memo=function(e,t){return{$$typeof:cD,type:e,compare:t===void 0?null:t}};Ve.startTransition=function(e){var t=Cp.transition;Cp.transition={};try{e()}finally{Cp.transition=t}};Ve.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Ve.useCallback=function(e,t){return Zn.current.useCallback(e,t)};Ve.useContext=function(e){return Zn.current.useContext(e)};Ve.useDebugValue=function(){};Ve.useDeferredValue=function(e){return Zn.current.useDeferredValue(e)};Ve.useEffect=function(e,t){return Zn.current.useEffect(e,t)};Ve.useId=function(){return Zn.current.useId()};Ve.useImperativeHandle=function(e,t,n){return Zn.current.useImperativeHandle(e,t,n)};Ve.useInsertionEffect=function(e,t){return Zn.current.useInsertionEffect(e,t)};Ve.useLayoutEffect=function(e,t){return Zn.current.useLayoutEffect(e,t)};Ve.useMemo=function(e,t){return Zn.current.useMemo(e,t)};Ve.useReducer=function(e,t,n){return Zn.current.useReducer(e,t,n)};Ve.useRef=function(e){return Zn.current.useRef(e)};Ve.useState=function(e){return Zn.current.useState(e)};Ve.useSyncExternalStore=function(e,t,n){return Zn.current.useSyncExternalStore(e,t,n)};Ve.useTransition=function(){return Zn.current.useTransition()};Ve.version="18.2.0";r$.exports=Ve;var b=r$.exports;const ke=rl(b),d$=eD({__proto__:null,default:ke},[b]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mD=b,yD=Symbol.for("react.element"),vD=Symbol.for("react.fragment"),xD=Object.prototype.hasOwnProperty,bD=mD.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,wD={key:!0,ref:!0,__self:!0,__source:!0};function h$(e,t,n){var r,i={},o=null,s=null;n!==void 0&&(o=""+n),t.key!==void 0&&(o=""+t.key),t.ref!==void 0&&(s=t.ref);for(r in t)xD.call(t,r)&&!wD.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)i[r]===void 0&&(i[r]=t[r]);return{$$typeof:yD,type:e,key:o,ref:s,props:i,_owner:bD.current}}qm.Fragment=vD;qm.jsx=h$;qm.jsxs=h$;n$.exports=qm;var m=n$.exports,ex={},f$={exports:{}},Rr={},p$={exports:{}},g$={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(D,F){var J=D.length;D.push(F);e:for(;0<J;){var Z=J-1>>>1,ne=D[Z];if(0<i(ne,F))D[Z]=F,D[J]=ne,J=Z;else break e}}function n(D){return D.length===0?null:D[0]}function r(D){if(D.length===0)return null;var F=D[0],J=D.pop();if(J!==F){D[0]=J;e:for(var Z=0,ne=D.length,de=ne>>>1;Z<de;){var Ce=2*(Z+1)-1,he=D[Ce],je=Ce+1,$e=D[je];if(0>i(he,J))je<ne&&0>i($e,he)?(D[Z]=$e,D[je]=J,Z=je):(D[Z]=he,D[Ce]=J,Z=Ce);else if(je<ne&&0>i($e,J))D[Z]=$e,D[je]=J,Z=je;else break e}}return F}function i(D,F){var J=D.sortIndex-F.sortIndex;return J!==0?J:D.id-F.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var s=Date,a=s.now();e.unstable_now=function(){return s.now()-a}}var l=[],c=[],u=1,d=null,h=3,f=!1,p=!1,g=!1,y=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _(D){for(var F=n(c);F!==null;){if(F.callback===null)r(c);else if(F.startTime<=D)r(c),F.sortIndex=F.expirationTime,t(l,F);else break;F=n(c)}}function S(D){if(g=!1,_(D),!p)if(n(l)!==null)p=!0,q(T);else{var F=n(c);F!==null&&U(S,F.startTime-D)}}function T(D,F){p=!1,g&&(g=!1,x($),$=-1),f=!0;var J=h;try{for(_(F),d=n(l);d!==null&&(!(d.expirationTime>F)||D&&!K());){var Z=d.callback;if(typeof Z=="function"){d.callback=null,h=d.priorityLevel;var ne=Z(d.expirationTime<=F);F=e.unstable_now(),typeof ne=="function"?d.callback=ne:d===n(l)&&r(l),_(F)}else r(l);d=n(l)}if(d!==null)var de=!0;else{var Ce=n(c);Ce!==null&&U(S,Ce.startTime-F),de=!1}return de}finally{d=null,h=J,f=!1}}var P=!1,I=null,$=-1,L=5,R=-1;function K(){return!(e.unstable_now()-R<L)}function Q(){if(I!==null){var D=e.unstable_now();R=D;var F=!0;try{F=I(!0,D)}finally{F?j():(P=!1,I=null)}}else P=!1}var j;if(typeof w=="function")j=function(){w(Q)};else if(typeof MessageChannel<"u"){var B=new MessageChannel,z=B.port2;B.port1.onmessage=Q,j=function(){z.postMessage(null)}}else j=function(){y(Q,0)};function q(D){I=D,P||(P=!0,j())}function U(D,F){$=y(function(){D(e.unstable_now())},F)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(D){D.callback=null},e.unstable_continueExecution=function(){p||f||(p=!0,q(T))},e.unstable_forceFrameRate=function(D){0>D||125<D?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<D?Math.floor(1e3/D):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return n(l)},e.unstable_next=function(D){switch(h){case 1:case 2:case 3:var F=3;break;default:F=h}var J=h;h=F;try{return D()}finally{h=J}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(D,F){switch(D){case 1:case 2:case 3:case 4:case 5:break;default:D=3}var J=h;h=D;try{return F()}finally{h=J}},e.unstable_scheduleCallback=function(D,F,J){var Z=e.unstable_now();switch(typeof J=="object"&&J!==null?(J=J.delay,J=typeof J=="number"&&0<J?Z+J:Z):J=Z,D){case 1:var ne=-1;break;case 2:ne=250;break;case 5:ne=1073741823;break;case 4:ne=1e4;break;default:ne=5e3}return ne=J+ne,D={id:u++,callback:F,priorityLevel:D,startTime:J,expirationTime:ne,sortIndex:-1},J>Z?(D.sortIndex=J,t(c,D),n(l)===null&&D===n(c)&&(g?(x($),$=-1):g=!0,U(S,J-Z))):(D.sortIndex=ne,t(l,D),p||f||(p=!0,q(T))),D},e.unstable_shouldYield=K,e.unstable_wrapCallback=function(D){var F=h;return function(){var J=h;h=F;try{return D.apply(this,arguments)}finally{h=J}}}})(g$);p$.exports=g$;var SD=p$.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var m$=b,Lr=SD;function ae(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var y$=new Set,xd={};function il(e,t){bc(e,t),bc(e+"Capture",t)}function bc(e,t){for(xd[e]=t,e=0;e<t.length;e++)y$.add(t[e])}var Fo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),tx=Object.prototype.hasOwnProperty,_D=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,oE={},sE={};function CD(e){return tx.call(sE,e)?!0:tx.call(oE,e)?!1:_D.test(e)?sE[e]=!0:(oE[e]=!0,!1)}function ED(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function kD(e,t,n,r){if(t===null||typeof t>"u"||ED(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Qn(e,t,n,r,i,o,s){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=s}var bn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){bn[e]=new Qn(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];bn[t]=new Qn(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){bn[e]=new Qn(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){bn[e]=new Qn(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){bn[e]=new Qn(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){bn[e]=new Qn(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){bn[e]=new Qn(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){bn[e]=new Qn(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){bn[e]=new Qn(e,5,!1,e.toLowerCase(),null,!1,!1)});var Sw=/[\-:]([a-z])/g;function _w(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Sw,_w);bn[t]=new Qn(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Sw,_w);bn[t]=new Qn(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Sw,_w);bn[t]=new Qn(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){bn[e]=new Qn(e,1,!1,e.toLowerCase(),null,!1,!1)});bn.xlinkHref=new Qn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){bn[e]=new Qn(e,1,!1,e.toLowerCase(),null,!0,!0)});function Cw(e,t,n,r){var i=bn.hasOwnProperty(t)?bn[t]:null;(i!==null?i.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(kD(t,n,i,r)&&(n=null),r||i===null?CD(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=n===null?i.type===3?!1:"":n:(t=i.attributeName,r=i.attributeNamespace,n===null?e.removeAttribute(t):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var Vo=m$.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,yf=Symbol.for("react.element"),zl=Symbol.for("react.portal"),Ul=Symbol.for("react.fragment"),Ew=Symbol.for("react.strict_mode"),nx=Symbol.for("react.profiler"),v$=Symbol.for("react.provider"),x$=Symbol.for("react.context"),kw=Symbol.for("react.forward_ref"),rx=Symbol.for("react.suspense"),ix=Symbol.for("react.suspense_list"),Tw=Symbol.for("react.memo"),vs=Symbol.for("react.lazy"),b$=Symbol.for("react.offscreen"),aE=Symbol.iterator;function fu(e){return e===null||typeof e!="object"?null:(e=aE&&e[aE]||e["@@iterator"],typeof e=="function"?e:null)}var Bt=Object.assign,w0;function zu(e){if(w0===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);w0=t&&t[1]||""}return`
`+w0+e}var S0=!1;function _0(e,t){if(!e||S0)return"";S0=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),o=r.stack.split(`
`),s=i.length-1,a=o.length-1;1<=s&&0<=a&&i[s]!==o[a];)a--;for(;1<=s&&0<=a;s--,a--)if(i[s]!==o[a]){if(s!==1||a!==1)do if(s--,a--,0>a||i[s]!==o[a]){var l=`
`+i[s].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=s&&0<=a);break}}}finally{S0=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?zu(e):""}function TD(e){switch(e.tag){case 5:return zu(e.type);case 16:return zu("Lazy");case 13:return zu("Suspense");case 19:return zu("SuspenseList");case 0:case 2:case 15:return e=_0(e.type,!1),e;case 11:return e=_0(e.type.render,!1),e;case 1:return e=_0(e.type,!0),e;default:return""}}function ox(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Ul:return"Fragment";case zl:return"Portal";case nx:return"Profiler";case Ew:return"StrictMode";case rx:return"Suspense";case ix:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case x$:return(e.displayName||"Context")+".Consumer";case v$:return(e._context.displayName||"Context")+".Provider";case kw:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Tw:return t=e.displayName||null,t!==null?t:ox(e.type)||"Memo";case vs:t=e._payload,e=e._init;try{return ox(e(t))}catch{}}return null}function PD(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ox(t);case 8:return t===Ew?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Vs(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function w$(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function ID(e){var t=w$(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(s){r=""+s,o.call(this,s)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(s){r=""+s},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function vf(e){e._valueTracker||(e._valueTracker=ID(e))}function S$(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=w$(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function bg(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function sx(e,t){var n=t.checked;return Bt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function lE(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=Vs(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function _$(e,t){t=t.checked,t!=null&&Cw(e,"checked",t,!1)}function ax(e,t){_$(e,t);var n=Vs(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?lx(e,t.type,n):t.hasOwnProperty("defaultValue")&&lx(e,t.type,Vs(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function cE(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function lx(e,t,n){(t!=="number"||bg(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Uu=Array.isArray;function ac(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Vs(n),t=null,i=0;i<e.length;i++){if(e[i].value===n){e[i].selected=!0,r&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function cx(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ae(91));return Bt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function uE(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(ae(92));if(Uu(n)){if(1<n.length)throw Error(ae(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Vs(n)}}function C$(e,t){var n=Vs(t.value),r=Vs(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function dE(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function E$(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ux(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?E$(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var xf,k$=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,i){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(xf=xf||document.createElement("div"),xf.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=xf.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function bd(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Ju={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},$D=["Webkit","ms","Moz","O"];Object.keys(Ju).forEach(function(e){$D.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Ju[t]=Ju[e]})});function T$(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||Ju.hasOwnProperty(e)&&Ju[e]?(""+t).trim():t+"px"}function P$(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=T$(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}var AD=Bt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function dx(e,t){if(t){if(AD[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ae(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ae(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ae(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ae(62))}}function hx(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var fx=null;function Pw(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var px=null,lc=null,cc=null;function hE(e){if(e=_h(e)){if(typeof px!="function")throw Error(ae(280));var t=e.stateNode;t&&(t=Jm(t),px(e.stateNode,e.type,t))}}function I$(e){lc?cc?cc.push(e):cc=[e]:lc=e}function $$(){if(lc){var e=lc,t=cc;if(cc=lc=null,hE(e),t)for(e=0;e<t.length;e++)hE(t[e])}}function A$(e,t){return e(t)}function M$(){}var C0=!1;function O$(e,t,n){if(C0)return e(t,n);C0=!0;try{return A$(e,t,n)}finally{C0=!1,(lc!==null||cc!==null)&&(M$(),$$())}}function wd(e,t){var n=e.stateNode;if(n===null)return null;var r=Jm(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(ae(231,t,typeof n));return n}var gx=!1;if(Fo)try{var pu={};Object.defineProperty(pu,"passive",{get:function(){gx=!0}}),window.addEventListener("test",pu,pu),window.removeEventListener("test",pu,pu)}catch{gx=!1}function MD(e,t,n,r,i,o,s,a,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(u){this.onError(u)}}var ed=!1,wg=null,Sg=!1,mx=null,OD={onError:function(e){ed=!0,wg=e}};function LD(e,t,n,r,i,o,s,a,l){ed=!1,wg=null,MD.apply(OD,arguments)}function BD(e,t,n,r,i,o,s,a,l){if(LD.apply(this,arguments),ed){if(ed){var c=wg;ed=!1,wg=null}else throw Error(ae(198));Sg||(Sg=!0,mx=c)}}function ol(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function L$(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function fE(e){if(ol(e)!==e)throw Error(ae(188))}function RD(e){var t=e.alternate;if(!t){if(t=ol(e),t===null)throw Error(ae(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(i===null)break;var o=i.alternate;if(o===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return fE(i),e;if(o===r)return fE(i),t;o=o.sibling}throw Error(ae(188))}if(n.return!==r.return)n=i,r=o;else{for(var s=!1,a=i.child;a;){if(a===n){s=!0,n=i,r=o;break}if(a===r){s=!0,r=i,n=o;break}a=a.sibling}if(!s){for(a=o.child;a;){if(a===n){s=!0,n=o,r=i;break}if(a===r){s=!0,r=o,n=i;break}a=a.sibling}if(!s)throw Error(ae(189))}}if(n.alternate!==r)throw Error(ae(190))}if(n.tag!==3)throw Error(ae(188));return n.stateNode.current===n?e:t}function B$(e){return e=RD(e),e!==null?R$(e):null}function R$(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=R$(e);if(t!==null)return t;e=e.sibling}return null}var D$=Lr.unstable_scheduleCallback,pE=Lr.unstable_cancelCallback,DD=Lr.unstable_shouldYield,FD=Lr.unstable_requestPaint,Ut=Lr.unstable_now,ND=Lr.unstable_getCurrentPriorityLevel,Iw=Lr.unstable_ImmediatePriority,F$=Lr.unstable_UserBlockingPriority,_g=Lr.unstable_NormalPriority,jD=Lr.unstable_LowPriority,N$=Lr.unstable_IdlePriority,Gm=null,Gi=null;function zD(e){if(Gi&&typeof Gi.onCommitFiberRoot=="function")try{Gi.onCommitFiberRoot(Gm,e,void 0,(e.current.flags&128)===128)}catch{}}var Ii=Math.clz32?Math.clz32:HD,UD=Math.log,WD=Math.LN2;function HD(e){return e>>>=0,e===0?32:31-(UD(e)/WD|0)|0}var bf=64,wf=4194304;function Wu(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Cg(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,i=e.suspendedLanes,o=e.pingedLanes,s=n&268435455;if(s!==0){var a=s&~i;a!==0?r=Wu(a):(o&=s,o!==0&&(r=Wu(o)))}else s=n&~i,s!==0?r=Wu(s):o!==0&&(r=Wu(o));if(r===0)return 0;if(t!==0&&t!==r&&!(t&i)&&(i=r&-r,o=t&-t,i>=o||i===16&&(o&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-Ii(t),i=1<<n,r|=e[n],t&=~i;return r}function KD(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function VD(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,o=e.pendingLanes;0<o;){var s=31-Ii(o),a=1<<s,l=i[s];l===-1?(!(a&n)||a&r)&&(i[s]=KD(a,t)):l<=t&&(e.expiredLanes|=a),o&=~a}}function yx(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function j$(){var e=bf;return bf<<=1,!(bf&4194240)&&(bf=64),e}function E0(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function wh(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Ii(t),e[t]=n}function YD(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-Ii(n),o=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~o}}function $w(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Ii(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var rt=0;function z$(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var U$,Aw,W$,H$,K$,vx=!1,Sf=[],Ms=null,Os=null,Ls=null,Sd=new Map,_d=new Map,Ss=[],qD="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function gE(e,t){switch(e){case"focusin":case"focusout":Ms=null;break;case"dragenter":case"dragleave":Os=null;break;case"mouseover":case"mouseout":Ls=null;break;case"pointerover":case"pointerout":Sd.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":_d.delete(t.pointerId)}}function gu(e,t,n,r,i,o){return e===null||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},t!==null&&(t=_h(t),t!==null&&Aw(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function GD(e,t,n,r,i){switch(t){case"focusin":return Ms=gu(Ms,e,t,n,r,i),!0;case"dragenter":return Os=gu(Os,e,t,n,r,i),!0;case"mouseover":return Ls=gu(Ls,e,t,n,r,i),!0;case"pointerover":var o=i.pointerId;return Sd.set(o,gu(Sd.get(o)||null,e,t,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,_d.set(o,gu(_d.get(o)||null,e,t,n,r,i)),!0}return!1}function V$(e){var t=Ta(e.target);if(t!==null){var n=ol(t);if(n!==null){if(t=n.tag,t===13){if(t=L$(n),t!==null){e.blockedOn=t,K$(e.priority,function(){W$(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Ep(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=xx(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);fx=r,n.target.dispatchEvent(r),fx=null}else return t=_h(n),t!==null&&Aw(t),e.blockedOn=n,!1;t.shift()}return!0}function mE(e,t,n){Ep(e)&&n.delete(t)}function XD(){vx=!1,Ms!==null&&Ep(Ms)&&(Ms=null),Os!==null&&Ep(Os)&&(Os=null),Ls!==null&&Ep(Ls)&&(Ls=null),Sd.forEach(mE),_d.forEach(mE)}function mu(e,t){e.blockedOn===t&&(e.blockedOn=null,vx||(vx=!0,Lr.unstable_scheduleCallback(Lr.unstable_NormalPriority,XD)))}function Cd(e){function t(i){return mu(i,e)}if(0<Sf.length){mu(Sf[0],e);for(var n=1;n<Sf.length;n++){var r=Sf[n];r.blockedOn===e&&(r.blockedOn=null)}}for(Ms!==null&&mu(Ms,e),Os!==null&&mu(Os,e),Ls!==null&&mu(Ls,e),Sd.forEach(t),_d.forEach(t),n=0;n<Ss.length;n++)r=Ss[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<Ss.length&&(n=Ss[0],n.blockedOn===null);)V$(n),n.blockedOn===null&&Ss.shift()}var uc=Vo.ReactCurrentBatchConfig,Eg=!0;function ZD(e,t,n,r){var i=rt,o=uc.transition;uc.transition=null;try{rt=1,Mw(e,t,n,r)}finally{rt=i,uc.transition=o}}function QD(e,t,n,r){var i=rt,o=uc.transition;uc.transition=null;try{rt=4,Mw(e,t,n,r)}finally{rt=i,uc.transition=o}}function Mw(e,t,n,r){if(Eg){var i=xx(e,t,n,r);if(i===null)B0(e,t,r,kg,n),gE(e,r);else if(GD(i,e,t,n,r))r.stopPropagation();else if(gE(e,r),t&4&&-1<qD.indexOf(e)){for(;i!==null;){var o=_h(i);if(o!==null&&U$(o),o=xx(e,t,n,r),o===null&&B0(e,t,r,kg,n),o===i)break;i=o}i!==null&&r.stopPropagation()}else B0(e,t,r,null,n)}}var kg=null;function xx(e,t,n,r){if(kg=null,e=Pw(r),e=Ta(e),e!==null)if(t=ol(e),t===null)e=null;else if(n=t.tag,n===13){if(e=L$(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return kg=e,null}function Y$(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ND()){case Iw:return 1;case F$:return 4;case _g:case jD:return 16;case N$:return 536870912;default:return 16}default:return 16}}var Es=null,Ow=null,kp=null;function q$(){if(kp)return kp;var e,t=Ow,n=t.length,r,i="value"in Es?Es.value:Es.textContent,o=i.length;for(e=0;e<n&&t[e]===i[e];e++);var s=n-e;for(r=1;r<=s&&t[n-r]===i[o-r];r++);return kp=i.slice(e,1<r?1-r:void 0)}function Tp(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function _f(){return!0}function yE(){return!1}function Dr(e){function t(n,r,i,o,s){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=o,this.target=s,this.currentTarget=null;for(var a in e)e.hasOwnProperty(a)&&(n=e[a],this[a]=n?n(o):o[a]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?_f:yE,this.isPropagationStopped=yE,this}return Bt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=_f)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=_f)},persist:function(){},isPersistent:_f}),t}var zc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Lw=Dr(zc),Sh=Bt({},zc,{view:0,detail:0}),JD=Dr(Sh),k0,T0,yu,Xm=Bt({},Sh,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Bw,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==yu&&(yu&&e.type==="mousemove"?(k0=e.screenX-yu.screenX,T0=e.screenY-yu.screenY):T0=k0=0,yu=e),k0)},movementY:function(e){return"movementY"in e?e.movementY:T0}}),vE=Dr(Xm),eF=Bt({},Xm,{dataTransfer:0}),tF=Dr(eF),nF=Bt({},Sh,{relatedTarget:0}),P0=Dr(nF),rF=Bt({},zc,{animationName:0,elapsedTime:0,pseudoElement:0}),iF=Dr(rF),oF=Bt({},zc,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),sF=Dr(oF),aF=Bt({},zc,{data:0}),xE=Dr(aF),lF={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},cF={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},uF={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function dF(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=uF[e])?!!t[e]:!1}function Bw(){return dF}var hF=Bt({},Sh,{key:function(e){if(e.key){var t=lF[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Tp(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?cF[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Bw,charCode:function(e){return e.type==="keypress"?Tp(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Tp(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),fF=Dr(hF),pF=Bt({},Xm,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),bE=Dr(pF),gF=Bt({},Sh,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Bw}),mF=Dr(gF),yF=Bt({},zc,{propertyName:0,elapsedTime:0,pseudoElement:0}),vF=Dr(yF),xF=Bt({},Xm,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),bF=Dr(xF),wF=[9,13,27,32],Rw=Fo&&"CompositionEvent"in window,td=null;Fo&&"documentMode"in document&&(td=document.documentMode);var SF=Fo&&"TextEvent"in window&&!td,G$=Fo&&(!Rw||td&&8<td&&11>=td),wE=String.fromCharCode(32),SE=!1;function X$(e,t){switch(e){case"keyup":return wF.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Z$(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Wl=!1;function _F(e,t){switch(e){case"compositionend":return Z$(t);case"keypress":return t.which!==32?null:(SE=!0,wE);case"textInput":return e=t.data,e===wE&&SE?null:e;default:return null}}function CF(e,t){if(Wl)return e==="compositionend"||!Rw&&X$(e,t)?(e=q$(),kp=Ow=Es=null,Wl=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return G$&&t.locale!=="ko"?null:t.data;default:return null}}var EF={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function _E(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!EF[e.type]:t==="textarea"}function Q$(e,t,n,r){I$(r),t=Tg(t,"onChange"),0<t.length&&(n=new Lw("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var nd=null,Ed=null;function kF(e){cA(e,0)}function Zm(e){var t=Vl(e);if(S$(t))return e}function TF(e,t){if(e==="change")return t}var J$=!1;if(Fo){var I0;if(Fo){var $0="oninput"in document;if(!$0){var CE=document.createElement("div");CE.setAttribute("oninput","return;"),$0=typeof CE.oninput=="function"}I0=$0}else I0=!1;J$=I0&&(!document.documentMode||9<document.documentMode)}function EE(){nd&&(nd.detachEvent("onpropertychange",eA),Ed=nd=null)}function eA(e){if(e.propertyName==="value"&&Zm(Ed)){var t=[];Q$(t,Ed,e,Pw(e)),O$(kF,t)}}function PF(e,t,n){e==="focusin"?(EE(),nd=t,Ed=n,nd.attachEvent("onpropertychange",eA)):e==="focusout"&&EE()}function IF(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Zm(Ed)}function $F(e,t){if(e==="click")return Zm(t)}function AF(e,t){if(e==="input"||e==="change")return Zm(t)}function MF(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Li=typeof Object.is=="function"?Object.is:MF;function kd(e,t){if(Li(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!tx.call(t,i)||!Li(e[i],t[i]))return!1}return!0}function kE(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function TE(e,t){var n=kE(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=kE(n)}}function tA(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?tA(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function nA(){for(var e=window,t=bg();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=bg(e.document)}return t}function Dw(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function OF(e){var t=nA(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&tA(n.ownerDocument.documentElement,n)){if(r!==null&&Dw(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=n.textContent.length,o=Math.min(r.start,i);r=r.end===void 0?o:Math.min(r.end,i),!e.extend&&o>r&&(i=r,r=o,o=i),i=TE(n,o);var s=TE(n,r);i&&s&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),o>r?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var LF=Fo&&"documentMode"in document&&11>=document.documentMode,Hl=null,bx=null,rd=null,wx=!1;function PE(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;wx||Hl==null||Hl!==bg(r)||(r=Hl,"selectionStart"in r&&Dw(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),rd&&kd(rd,r)||(rd=r,r=Tg(bx,"onSelect"),0<r.length&&(t=new Lw("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Hl)))}function Cf(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Kl={animationend:Cf("Animation","AnimationEnd"),animationiteration:Cf("Animation","AnimationIteration"),animationstart:Cf("Animation","AnimationStart"),transitionend:Cf("Transition","TransitionEnd")},A0={},rA={};Fo&&(rA=document.createElement("div").style,"AnimationEvent"in window||(delete Kl.animationend.animation,delete Kl.animationiteration.animation,delete Kl.animationstart.animation),"TransitionEvent"in window||delete Kl.transitionend.transition);function Qm(e){if(A0[e])return A0[e];if(!Kl[e])return e;var t=Kl[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in rA)return A0[e]=t[n];return e}var iA=Qm("animationend"),oA=Qm("animationiteration"),sA=Qm("animationstart"),aA=Qm("transitionend"),lA=new Map,IE="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ia(e,t){lA.set(e,t),il(t,[e])}for(var M0=0;M0<IE.length;M0++){var O0=IE[M0],BF=O0.toLowerCase(),RF=O0[0].toUpperCase()+O0.slice(1);ia(BF,"on"+RF)}ia(iA,"onAnimationEnd");ia(oA,"onAnimationIteration");ia(sA,"onAnimationStart");ia("dblclick","onDoubleClick");ia("focusin","onFocus");ia("focusout","onBlur");ia(aA,"onTransitionEnd");bc("onMouseEnter",["mouseout","mouseover"]);bc("onMouseLeave",["mouseout","mouseover"]);bc("onPointerEnter",["pointerout","pointerover"]);bc("onPointerLeave",["pointerout","pointerover"]);il("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));il("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));il("onBeforeInput",["compositionend","keypress","textInput","paste"]);il("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));il("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));il("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Hu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),DF=new Set("cancel close invalid load scroll toggle".split(" ").concat(Hu));function $E(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,BD(r,t,void 0,e),e.currentTarget=null}function cA(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var o=void 0;if(t)for(var s=r.length-1;0<=s;s--){var a=r[s],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==o&&i.isPropagationStopped())break e;$E(i,a,c),o=l}else for(s=0;s<r.length;s++){if(a=r[s],l=a.instance,c=a.currentTarget,a=a.listener,l!==o&&i.isPropagationStopped())break e;$E(i,a,c),o=l}}}if(Sg)throw e=mx,Sg=!1,mx=null,e}function bt(e,t){var n=t[kx];n===void 0&&(n=t[kx]=new Set);var r=e+"__bubble";n.has(r)||(uA(t,e,2,!1),n.add(r))}function L0(e,t,n){var r=0;t&&(r|=4),uA(n,e,r,t)}var Ef="_reactListening"+Math.random().toString(36).slice(2);function Td(e){if(!e[Ef]){e[Ef]=!0,y$.forEach(function(n){n!=="selectionchange"&&(DF.has(n)||L0(n,!1,e),L0(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Ef]||(t[Ef]=!0,L0("selectionchange",!1,t))}}function uA(e,t,n,r){switch(Y$(t)){case 1:var i=ZD;break;case 4:i=QD;break;default:i=Mw}n=i.bind(null,t,n,e),i=void 0,!gx||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),r?i!==void 0?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):i!==void 0?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function B0(e,t,n,r,i){var o=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var s=r.tag;if(s===3||s===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(s===4)for(s=r.return;s!==null;){var l=s.tag;if((l===3||l===4)&&(l=s.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;s=s.return}for(;a!==null;){if(s=Ta(a),s===null)return;if(l=s.tag,l===5||l===6){r=o=s;continue e}a=a.parentNode}}r=r.return}O$(function(){var c=o,u=Pw(n),d=[];e:{var h=lA.get(e);if(h!==void 0){var f=Lw,p=e;switch(e){case"keypress":if(Tp(n)===0)break e;case"keydown":case"keyup":f=fF;break;case"focusin":p="focus",f=P0;break;case"focusout":p="blur",f=P0;break;case"beforeblur":case"afterblur":f=P0;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=vE;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=tF;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=mF;break;case iA:case oA:case sA:f=iF;break;case aA:f=vF;break;case"scroll":f=JD;break;case"wheel":f=bF;break;case"copy":case"cut":case"paste":f=sF;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=bE}var g=(t&4)!==0,y=!g&&e==="scroll",x=g?h!==null?h+"Capture":null:h;g=[];for(var w=c,_;w!==null;){_=w;var S=_.stateNode;if(_.tag===5&&S!==null&&(_=S,x!==null&&(S=wd(w,x),S!=null&&g.push(Pd(w,S,_)))),y)break;w=w.return}0<g.length&&(h=new f(h,p,null,n,u),d.push({event:h,listeners:g}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",f=e==="mouseout"||e==="pointerout",h&&n!==fx&&(p=n.relatedTarget||n.fromElement)&&(Ta(p)||p[No]))break e;if((f||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,f?(p=n.relatedTarget||n.toElement,f=c,p=p?Ta(p):null,p!==null&&(y=ol(p),p!==y||p.tag!==5&&p.tag!==6)&&(p=null)):(f=null,p=c),f!==p)){if(g=vE,S="onMouseLeave",x="onMouseEnter",w="mouse",(e==="pointerout"||e==="pointerover")&&(g=bE,S="onPointerLeave",x="onPointerEnter",w="pointer"),y=f==null?h:Vl(f),_=p==null?h:Vl(p),h=new g(S,w+"leave",f,n,u),h.target=y,h.relatedTarget=_,S=null,Ta(u)===c&&(g=new g(x,w+"enter",p,n,u),g.target=_,g.relatedTarget=y,S=g),y=S,f&&p)t:{for(g=f,x=p,w=0,_=g;_;_=wl(_))w++;for(_=0,S=x;S;S=wl(S))_++;for(;0<w-_;)g=wl(g),w--;for(;0<_-w;)x=wl(x),_--;for(;w--;){if(g===x||x!==null&&g===x.alternate)break t;g=wl(g),x=wl(x)}g=null}else g=null;f!==null&&AE(d,h,f,g,!1),p!==null&&y!==null&&AE(d,y,p,g,!0)}}e:{if(h=c?Vl(c):window,f=h.nodeName&&h.nodeName.toLowerCase(),f==="select"||f==="input"&&h.type==="file")var T=TF;else if(_E(h))if(J$)T=AF;else{T=IF;var P=PF}else(f=h.nodeName)&&f.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(T=$F);if(T&&(T=T(e,c))){Q$(d,T,n,u);break e}P&&P(e,h,c),e==="focusout"&&(P=h._wrapperState)&&P.controlled&&h.type==="number"&&lx(h,"number",h.value)}switch(P=c?Vl(c):window,e){case"focusin":(_E(P)||P.contentEditable==="true")&&(Hl=P,bx=c,rd=null);break;case"focusout":rd=bx=Hl=null;break;case"mousedown":wx=!0;break;case"contextmenu":case"mouseup":case"dragend":wx=!1,PE(d,n,u);break;case"selectionchange":if(LF)break;case"keydown":case"keyup":PE(d,n,u)}var I;if(Rw)e:{switch(e){case"compositionstart":var $="onCompositionStart";break e;case"compositionend":$="onCompositionEnd";break e;case"compositionupdate":$="onCompositionUpdate";break e}$=void 0}else Wl?X$(e,n)&&($="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&($="onCompositionStart");$&&(G$&&n.locale!=="ko"&&(Wl||$!=="onCompositionStart"?$==="onCompositionEnd"&&Wl&&(I=q$()):(Es=u,Ow="value"in Es?Es.value:Es.textContent,Wl=!0)),P=Tg(c,$),0<P.length&&($=new xE($,e,null,n,u),d.push({event:$,listeners:P}),I?$.data=I:(I=Z$(n),I!==null&&($.data=I)))),(I=SF?_F(e,n):CF(e,n))&&(c=Tg(c,"onBeforeInput"),0<c.length&&(u=new xE("onBeforeInput","beforeinput",null,n,u),d.push({event:u,listeners:c}),u.data=I))}cA(d,t)})}function Pd(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Tg(e,t){for(var n=t+"Capture",r=[];e!==null;){var i=e,o=i.stateNode;i.tag===5&&o!==null&&(i=o,o=wd(e,n),o!=null&&r.unshift(Pd(e,o,i)),o=wd(e,t),o!=null&&r.push(Pd(e,o,i))),e=e.return}return r}function wl(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function AE(e,t,n,r,i){for(var o=t._reactName,s=[];n!==null&&n!==r;){var a=n,l=a.alternate,c=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&c!==null&&(a=c,i?(l=wd(n,o),l!=null&&s.unshift(Pd(n,l,a))):i||(l=wd(n,o),l!=null&&s.push(Pd(n,l,a)))),n=n.return}s.length!==0&&e.push({event:t,listeners:s})}var FF=/\r\n?/g,NF=/\u0000|\uFFFD/g;function ME(e){return(typeof e=="string"?e:""+e).replace(FF,`
`).replace(NF,"")}function kf(e,t,n){if(t=ME(t),ME(e)!==t&&n)throw Error(ae(425))}function Pg(){}var Sx=null,_x=null;function Cx(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Ex=typeof setTimeout=="function"?setTimeout:void 0,jF=typeof clearTimeout=="function"?clearTimeout:void 0,OE=typeof Promise=="function"?Promise:void 0,zF=typeof queueMicrotask=="function"?queueMicrotask:typeof OE<"u"?function(e){return OE.resolve(null).then(e).catch(UF)}:Ex;function UF(e){setTimeout(function(){throw e})}function R0(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){e.removeChild(i),Cd(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Cd(t)}function Bs(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function LE(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Uc=Math.random().toString(36).slice(2),Vi="__reactFiber$"+Uc,Id="__reactProps$"+Uc,No="__reactContainer$"+Uc,kx="__reactEvents$"+Uc,WF="__reactListeners$"+Uc,HF="__reactHandles$"+Uc;function Ta(e){var t=e[Vi];if(t)return t;for(var n=e.parentNode;n;){if(t=n[No]||n[Vi]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=LE(e);e!==null;){if(n=e[Vi])return n;e=LE(e)}return t}e=n,n=e.parentNode}return null}function _h(e){return e=e[Vi]||e[No],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Vl(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ae(33))}function Jm(e){return e[Id]||null}var Tx=[],Yl=-1;function oa(e){return{current:e}}function St(e){0>Yl||(e.current=Tx[Yl],Tx[Yl]=null,Yl--)}function pt(e,t){Yl++,Tx[Yl]=e.current,e.current=t}var Ys={},Dn=oa(Ys),dr=oa(!1),Ha=Ys;function wc(e,t){var n=e.type.contextTypes;if(!n)return Ys;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i={},o;for(o in n)i[o]=t[o];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function hr(e){return e=e.childContextTypes,e!=null}function Ig(){St(dr),St(Dn)}function BE(e,t,n){if(Dn.current!==Ys)throw Error(ae(168));pt(Dn,t),pt(dr,n)}function dA(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in t))throw Error(ae(108,PD(e)||"Unknown",i));return Bt({},n,r)}function $g(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ys,Ha=Dn.current,pt(Dn,e),pt(dr,dr.current),!0}function RE(e,t,n){var r=e.stateNode;if(!r)throw Error(ae(169));n?(e=dA(e,t,Ha),r.__reactInternalMemoizedMergedChildContext=e,St(dr),St(Dn),pt(Dn,e)):St(dr),pt(dr,n)}var _o=null,ey=!1,D0=!1;function hA(e){_o===null?_o=[e]:_o.push(e)}function KF(e){ey=!0,hA(e)}function sa(){if(!D0&&_o!==null){D0=!0;var e=0,t=rt;try{var n=_o;for(rt=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}_o=null,ey=!1}catch(i){throw _o!==null&&(_o=_o.slice(e+1)),D$(Iw,sa),i}finally{rt=t,D0=!1}}return null}var ql=[],Gl=0,Ag=null,Mg=0,qr=[],Gr=0,Ka=null,Po=1,Io="";function ba(e,t){ql[Gl++]=Mg,ql[Gl++]=Ag,Ag=e,Mg=t}function fA(e,t,n){qr[Gr++]=Po,qr[Gr++]=Io,qr[Gr++]=Ka,Ka=e;var r=Po;e=Io;var i=32-Ii(r)-1;r&=~(1<<i),n+=1;var o=32-Ii(t)+i;if(30<o){var s=i-i%5;o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,Po=1<<32-Ii(t)+i|n<<i|r,Io=o+e}else Po=1<<o|n<<i|r,Io=e}function Fw(e){e.return!==null&&(ba(e,1),fA(e,1,0))}function Nw(e){for(;e===Ag;)Ag=ql[--Gl],ql[Gl]=null,Mg=ql[--Gl],ql[Gl]=null;for(;e===Ka;)Ka=qr[--Gr],qr[Gr]=null,Io=qr[--Gr],qr[Gr]=null,Po=qr[--Gr],qr[Gr]=null}var Ar=null,$r=null,Ct=!1,Si=null;function pA(e,t){var n=ti(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function DE(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Ar=e,$r=Bs(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Ar=e,$r=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Ka!==null?{id:Po,overflow:Io}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=ti(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Ar=e,$r=null,!0):!1;default:return!1}}function Px(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Ix(e){if(Ct){var t=$r;if(t){var n=t;if(!DE(e,t)){if(Px(e))throw Error(ae(418));t=Bs(n.nextSibling);var r=Ar;t&&DE(e,t)?pA(r,n):(e.flags=e.flags&-4097|2,Ct=!1,Ar=e)}}else{if(Px(e))throw Error(ae(418));e.flags=e.flags&-4097|2,Ct=!1,Ar=e}}}function FE(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Ar=e}function Tf(e){if(e!==Ar)return!1;if(!Ct)return FE(e),Ct=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Cx(e.type,e.memoizedProps)),t&&(t=$r)){if(Px(e))throw gA(),Error(ae(418));for(;t;)pA(e,t),t=Bs(t.nextSibling)}if(FE(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ae(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){$r=Bs(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}$r=null}}else $r=Ar?Bs(e.stateNode.nextSibling):null;return!0}function gA(){for(var e=$r;e;)e=Bs(e.nextSibling)}function Sc(){$r=Ar=null,Ct=!1}function jw(e){Si===null?Si=[e]:Si.push(e)}var VF=Vo.ReactCurrentBatchConfig;function vi(e,t){if(e&&e.defaultProps){t=Bt({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}var Og=oa(null),Lg=null,Xl=null,zw=null;function Uw(){zw=Xl=Lg=null}function Ww(e){var t=Og.current;St(Og),e._currentValue=t}function $x(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function dc(e,t){Lg=e,zw=Xl=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(lr=!0),e.firstContext=null)}function ii(e){var t=e._currentValue;if(zw!==e)if(e={context:e,memoizedValue:t,next:null},Xl===null){if(Lg===null)throw Error(ae(308));Xl=e,Lg.dependencies={lanes:0,firstContext:e}}else Xl=Xl.next=e;return t}var Pa=null;function Hw(e){Pa===null?Pa=[e]:Pa.push(e)}function mA(e,t,n,r){var i=t.interleaved;return i===null?(n.next=n,Hw(t)):(n.next=i.next,i.next=n),t.interleaved=n,jo(e,r)}function jo(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var xs=!1;function Kw(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function yA(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function $o(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Rs(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Ge&2){var i=r.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),r.pending=t,jo(e,n)}return i=r.interleaved,i===null?(t.next=t,Hw(r)):(t.next=i.next,i.next=t),r.interleaved=t,jo(e,n)}function Pp(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,$w(e,n)}}function NE(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?i=o=s:o=o.next=s,n=n.next}while(n!==null);o===null?i=o=t:o=o.next=t}else i=o=t;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Bg(e,t,n,r){var i=e.updateQueue;xs=!1;var o=i.firstBaseUpdate,s=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,c=l.next;l.next=null,s===null?o=c:s.next=c,s=l;var u=e.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==s&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(o!==null){var d=i.baseState;s=0,u=c=l=null,a=o;do{var h=a.lane,f=a.eventTime;if((r&h)===h){u!==null&&(u=u.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=e,g=a;switch(h=t,f=n,g.tag){case 1:if(p=g.payload,typeof p=="function"){d=p.call(f,d,h);break e}d=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=g.payload,h=typeof p=="function"?p.call(f,d,h):p,h==null)break e;d=Bt({},d,h);break e;case 2:xs=!0}}a.callback!==null&&a.lane!==0&&(e.flags|=64,h=i.effects,h===null?i.effects=[a]:h.push(a))}else f={eventTime:f,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=f,l=d):u=u.next=f,s|=h;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;h=a,a=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(1);if(u===null&&(l=d),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,t=i.shared.interleaved,t!==null){i=t;do s|=i.lane,i=i.next;while(i!==t)}else o===null&&(i.shared.lanes=0);Ya|=s,e.lanes=s,e.memoizedState=d}}function jE(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(ae(191,i));i.call(r)}}}var vA=new m$.Component().refs;function Ax(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:Bt({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var ty={isMounted:function(e){return(e=e._reactInternals)?ol(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=qn(),i=Fs(e),o=$o(r,i);o.payload=t,n!=null&&(o.callback=n),t=Rs(e,o,i),t!==null&&($i(t,e,i,r),Pp(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=qn(),i=Fs(e),o=$o(r,i);o.tag=1,o.payload=t,n!=null&&(o.callback=n),t=Rs(e,o,i),t!==null&&($i(t,e,i,r),Pp(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=qn(),r=Fs(e),i=$o(n,r);i.tag=2,t!=null&&(i.callback=t),t=Rs(e,i,r),t!==null&&($i(t,e,r,n),Pp(t,e,r))}};function zE(e,t,n,r,i,o,s){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,o,s):t.prototype&&t.prototype.isPureReactComponent?!kd(n,r)||!kd(i,o):!0}function xA(e,t,n){var r=!1,i=Ys,o=t.contextType;return typeof o=="object"&&o!==null?o=ii(o):(i=hr(t)?Ha:Dn.current,r=t.contextTypes,o=(r=r!=null)?wc(e,i):Ys),t=new t(n,o),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=ty,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=o),t}function UE(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&ty.enqueueReplaceState(t,t.state,null)}function Mx(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs=vA,Kw(e);var o=t.contextType;typeof o=="object"&&o!==null?i.context=ii(o):(o=hr(t)?Ha:Dn.current,i.context=wc(e,o)),i.state=e.memoizedState,o=t.getDerivedStateFromProps,typeof o=="function"&&(Ax(e,t,o,n),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&ty.enqueueReplaceState(i,i.state,null),Bg(e,n,i,r),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function vu(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ae(309));var r=n.stateNode}if(!r)throw Error(ae(147,e));var i=r,o=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===o?t.ref:(t=function(s){var a=i.refs;a===vA&&(a=i.refs={}),s===null?delete a[o]:a[o]=s},t._stringRef=o,t)}if(typeof e!="string")throw Error(ae(284));if(!n._owner)throw Error(ae(290,e))}return e}function Pf(e,t){throw e=Object.prototype.toString.call(t),Error(ae(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function WE(e){var t=e._init;return t(e._payload)}function bA(e){function t(x,w){if(e){var _=x.deletions;_===null?(x.deletions=[w],x.flags|=16):_.push(w)}}function n(x,w){if(!e)return null;for(;w!==null;)t(x,w),w=w.sibling;return null}function r(x,w){for(x=new Map;w!==null;)w.key!==null?x.set(w.key,w):x.set(w.index,w),w=w.sibling;return x}function i(x,w){return x=Ns(x,w),x.index=0,x.sibling=null,x}function o(x,w,_){return x.index=_,e?(_=x.alternate,_!==null?(_=_.index,_<w?(x.flags|=2,w):_):(x.flags|=2,w)):(x.flags|=1048576,w)}function s(x){return e&&x.alternate===null&&(x.flags|=2),x}function a(x,w,_,S){return w===null||w.tag!==6?(w=H0(_,x.mode,S),w.return=x,w):(w=i(w,_),w.return=x,w)}function l(x,w,_,S){var T=_.type;return T===Ul?u(x,w,_.props.children,S,_.key):w!==null&&(w.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===vs&&WE(T)===w.type)?(S=i(w,_.props),S.ref=vu(x,w,_),S.return=x,S):(S=Lp(_.type,_.key,_.props,null,x.mode,S),S.ref=vu(x,w,_),S.return=x,S)}function c(x,w,_,S){return w===null||w.tag!==4||w.stateNode.containerInfo!==_.containerInfo||w.stateNode.implementation!==_.implementation?(w=K0(_,x.mode,S),w.return=x,w):(w=i(w,_.children||[]),w.return=x,w)}function u(x,w,_,S,T){return w===null||w.tag!==7?(w=Ra(_,x.mode,S,T),w.return=x,w):(w=i(w,_),w.return=x,w)}function d(x,w,_){if(typeof w=="string"&&w!==""||typeof w=="number")return w=H0(""+w,x.mode,_),w.return=x,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case yf:return _=Lp(w.type,w.key,w.props,null,x.mode,_),_.ref=vu(x,null,w),_.return=x,_;case zl:return w=K0(w,x.mode,_),w.return=x,w;case vs:var S=w._init;return d(x,S(w._payload),_)}if(Uu(w)||fu(w))return w=Ra(w,x.mode,_,null),w.return=x,w;Pf(x,w)}return null}function h(x,w,_,S){var T=w!==null?w.key:null;if(typeof _=="string"&&_!==""||typeof _=="number")return T!==null?null:a(x,w,""+_,S);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case yf:return _.key===T?l(x,w,_,S):null;case zl:return _.key===T?c(x,w,_,S):null;case vs:return T=_._init,h(x,w,T(_._payload),S)}if(Uu(_)||fu(_))return T!==null?null:u(x,w,_,S,null);Pf(x,_)}return null}function f(x,w,_,S,T){if(typeof S=="string"&&S!==""||typeof S=="number")return x=x.get(_)||null,a(w,x,""+S,T);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case yf:return x=x.get(S.key===null?_:S.key)||null,l(w,x,S,T);case zl:return x=x.get(S.key===null?_:S.key)||null,c(w,x,S,T);case vs:var P=S._init;return f(x,w,_,P(S._payload),T)}if(Uu(S)||fu(S))return x=x.get(_)||null,u(w,x,S,T,null);Pf(w,S)}return null}function p(x,w,_,S){for(var T=null,P=null,I=w,$=w=0,L=null;I!==null&&$<_.length;$++){I.index>$?(L=I,I=null):L=I.sibling;var R=h(x,I,_[$],S);if(R===null){I===null&&(I=L);break}e&&I&&R.alternate===null&&t(x,I),w=o(R,w,$),P===null?T=R:P.sibling=R,P=R,I=L}if($===_.length)return n(x,I),Ct&&ba(x,$),T;if(I===null){for(;$<_.length;$++)I=d(x,_[$],S),I!==null&&(w=o(I,w,$),P===null?T=I:P.sibling=I,P=I);return Ct&&ba(x,$),T}for(I=r(x,I);$<_.length;$++)L=f(I,x,$,_[$],S),L!==null&&(e&&L.alternate!==null&&I.delete(L.key===null?$:L.key),w=o(L,w,$),P===null?T=L:P.sibling=L,P=L);return e&&I.forEach(function(K){return t(x,K)}),Ct&&ba(x,$),T}function g(x,w,_,S){var T=fu(_);if(typeof T!="function")throw Error(ae(150));if(_=T.call(_),_==null)throw Error(ae(151));for(var P=T=null,I=w,$=w=0,L=null,R=_.next();I!==null&&!R.done;$++,R=_.next()){I.index>$?(L=I,I=null):L=I.sibling;var K=h(x,I,R.value,S);if(K===null){I===null&&(I=L);break}e&&I&&K.alternate===null&&t(x,I),w=o(K,w,$),P===null?T=K:P.sibling=K,P=K,I=L}if(R.done)return n(x,I),Ct&&ba(x,$),T;if(I===null){for(;!R.done;$++,R=_.next())R=d(x,R.value,S),R!==null&&(w=o(R,w,$),P===null?T=R:P.sibling=R,P=R);return Ct&&ba(x,$),T}for(I=r(x,I);!R.done;$++,R=_.next())R=f(I,x,$,R.value,S),R!==null&&(e&&R.alternate!==null&&I.delete(R.key===null?$:R.key),w=o(R,w,$),P===null?T=R:P.sibling=R,P=R);return e&&I.forEach(function(Q){return t(x,Q)}),Ct&&ba(x,$),T}function y(x,w,_,S){if(typeof _=="object"&&_!==null&&_.type===Ul&&_.key===null&&(_=_.props.children),typeof _=="object"&&_!==null){switch(_.$$typeof){case yf:e:{for(var T=_.key,P=w;P!==null;){if(P.key===T){if(T=_.type,T===Ul){if(P.tag===7){n(x,P.sibling),w=i(P,_.props.children),w.return=x,x=w;break e}}else if(P.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===vs&&WE(T)===P.type){n(x,P.sibling),w=i(P,_.props),w.ref=vu(x,P,_),w.return=x,x=w;break e}n(x,P);break}else t(x,P);P=P.sibling}_.type===Ul?(w=Ra(_.props.children,x.mode,S,_.key),w.return=x,x=w):(S=Lp(_.type,_.key,_.props,null,x.mode,S),S.ref=vu(x,w,_),S.return=x,x=S)}return s(x);case zl:e:{for(P=_.key;w!==null;){if(w.key===P)if(w.tag===4&&w.stateNode.containerInfo===_.containerInfo&&w.stateNode.implementation===_.implementation){n(x,w.sibling),w=i(w,_.children||[]),w.return=x,x=w;break e}else{n(x,w);break}else t(x,w);w=w.sibling}w=K0(_,x.mode,S),w.return=x,x=w}return s(x);case vs:return P=_._init,y(x,w,P(_._payload),S)}if(Uu(_))return p(x,w,_,S);if(fu(_))return g(x,w,_,S);Pf(x,_)}return typeof _=="string"&&_!==""||typeof _=="number"?(_=""+_,w!==null&&w.tag===6?(n(x,w.sibling),w=i(w,_),w.return=x,x=w):(n(x,w),w=H0(_,x.mode,S),w.return=x,x=w),s(x)):n(x,w)}return y}var _c=bA(!0),wA=bA(!1),Ch={},Xi=oa(Ch),$d=oa(Ch),Ad=oa(Ch);function Ia(e){if(e===Ch)throw Error(ae(174));return e}function Vw(e,t){switch(pt(Ad,t),pt($d,e),pt(Xi,Ch),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ux(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=ux(t,e)}St(Xi),pt(Xi,t)}function Cc(){St(Xi),St($d),St(Ad)}function SA(e){Ia(Ad.current);var t=Ia(Xi.current),n=ux(t,e.type);t!==n&&(pt($d,e),pt(Xi,n))}function Yw(e){$d.current===e&&(St(Xi),St($d))}var $t=oa(0);function Rg(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var F0=[];function qw(){for(var e=0;e<F0.length;e++)F0[e]._workInProgressVersionPrimary=null;F0.length=0}var Ip=Vo.ReactCurrentDispatcher,N0=Vo.ReactCurrentBatchConfig,Va=0,Ot=null,Jt=null,sn=null,Dg=!1,id=!1,Md=0,YF=0;function kn(){throw Error(ae(321))}function Gw(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Li(e[n],t[n]))return!1;return!0}function Xw(e,t,n,r,i,o){if(Va=o,Ot=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Ip.current=e===null||e.memoizedState===null?ZF:QF,e=n(r,i),id){o=0;do{if(id=!1,Md=0,25<=o)throw Error(ae(301));o+=1,sn=Jt=null,t.updateQueue=null,Ip.current=JF,e=n(r,i)}while(id)}if(Ip.current=Fg,t=Jt!==null&&Jt.next!==null,Va=0,sn=Jt=Ot=null,Dg=!1,t)throw Error(ae(300));return e}function Zw(){var e=Md!==0;return Md=0,e}function Ui(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return sn===null?Ot.memoizedState=sn=e:sn=sn.next=e,sn}function oi(){if(Jt===null){var e=Ot.alternate;e=e!==null?e.memoizedState:null}else e=Jt.next;var t=sn===null?Ot.memoizedState:sn.next;if(t!==null)sn=t,Jt=e;else{if(e===null)throw Error(ae(310));Jt=e,e={memoizedState:Jt.memoizedState,baseState:Jt.baseState,baseQueue:Jt.baseQueue,queue:Jt.queue,next:null},sn===null?Ot.memoizedState=sn=e:sn=sn.next=e}return sn}function Od(e,t){return typeof t=="function"?t(e):t}function j0(e){var t=oi(),n=t.queue;if(n===null)throw Error(ae(311));n.lastRenderedReducer=e;var r=Jt,i=r.baseQueue,o=n.pending;if(o!==null){if(i!==null){var s=i.next;i.next=o.next,o.next=s}r.baseQueue=i=o,n.pending=null}if(i!==null){o=i.next,r=r.baseState;var a=s=null,l=null,c=o;do{var u=c.lane;if((Va&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:e(r,c.action);else{var d={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=d,s=r):l=l.next=d,Ot.lanes|=u,Ya|=u}c=c.next}while(c!==null&&c!==o);l===null?s=r:l.next=a,Li(r,t.memoizedState)||(lr=!0),t.memoizedState=r,t.baseState=s,t.baseQueue=l,n.lastRenderedState=r}if(e=n.interleaved,e!==null){i=e;do o=i.lane,Ot.lanes|=o,Ya|=o,i=i.next;while(i!==e)}else i===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function z0(e){var t=oi(),n=t.queue;if(n===null)throw Error(ae(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,o=t.memoizedState;if(i!==null){n.pending=null;var s=i=i.next;do o=e(o,s.action),s=s.next;while(s!==i);Li(o,t.memoizedState)||(lr=!0),t.memoizedState=o,t.baseQueue===null&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function _A(){}function CA(e,t){var n=Ot,r=oi(),i=t(),o=!Li(r.memoizedState,i);if(o&&(r.memoizedState=i,lr=!0),r=r.queue,Qw(TA.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||sn!==null&&sn.memoizedState.tag&1){if(n.flags|=2048,Ld(9,kA.bind(null,n,r,i,t),void 0,null),ln===null)throw Error(ae(349));Va&30||EA(n,t,i)}return i}function EA(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Ot.updateQueue,t===null?(t={lastEffect:null,stores:null},Ot.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function kA(e,t,n,r){t.value=n,t.getSnapshot=r,PA(t)&&IA(e)}function TA(e,t,n){return n(function(){PA(t)&&IA(e)})}function PA(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Li(e,n)}catch{return!0}}function IA(e){var t=jo(e,1);t!==null&&$i(t,e,1,-1)}function HE(e){var t=Ui();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Od,lastRenderedState:e},t.queue=e,e=e.dispatch=XF.bind(null,Ot,e),[t.memoizedState,e]}function Ld(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=Ot.updateQueue,t===null?(t={lastEffect:null,stores:null},Ot.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function $A(){return oi().memoizedState}function $p(e,t,n,r){var i=Ui();Ot.flags|=e,i.memoizedState=Ld(1|t,n,void 0,r===void 0?null:r)}function ny(e,t,n,r){var i=oi();r=r===void 0?null:r;var o=void 0;if(Jt!==null){var s=Jt.memoizedState;if(o=s.destroy,r!==null&&Gw(r,s.deps)){i.memoizedState=Ld(t,n,o,r);return}}Ot.flags|=e,i.memoizedState=Ld(1|t,n,o,r)}function KE(e,t){return $p(8390656,8,e,t)}function Qw(e,t){return ny(2048,8,e,t)}function AA(e,t){return ny(4,2,e,t)}function MA(e,t){return ny(4,4,e,t)}function OA(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function LA(e,t,n){return n=n!=null?n.concat([e]):null,ny(4,4,OA.bind(null,t,e),n)}function Jw(){}function BA(e,t){var n=oi();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Gw(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function RA(e,t){var n=oi();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Gw(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function DA(e,t,n){return Va&21?(Li(n,t)||(n=j$(),Ot.lanes|=n,Ya|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,lr=!0),e.memoizedState=n)}function qF(e,t){var n=rt;rt=n!==0&&4>n?n:4,e(!0);var r=N0.transition;N0.transition={};try{e(!1),t()}finally{rt=n,N0.transition=r}}function FA(){return oi().memoizedState}function GF(e,t,n){var r=Fs(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},NA(e))jA(t,n);else if(n=mA(e,t,n,r),n!==null){var i=qn();$i(n,e,r,i),zA(n,t,r)}}function XF(e,t,n){var r=Fs(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(NA(e))jA(t,i);else{var o=e.alternate;if(e.lanes===0&&(o===null||o.lanes===0)&&(o=t.lastRenderedReducer,o!==null))try{var s=t.lastRenderedState,a=o(s,n);if(i.hasEagerState=!0,i.eagerState=a,Li(a,s)){var l=t.interleaved;l===null?(i.next=i,Hw(t)):(i.next=l.next,l.next=i),t.interleaved=i;return}}catch{}finally{}n=mA(e,t,i,r),n!==null&&(i=qn(),$i(n,e,r,i),zA(n,t,r))}}function NA(e){var t=e.alternate;return e===Ot||t!==null&&t===Ot}function jA(e,t){id=Dg=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function zA(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,$w(e,n)}}var Fg={readContext:ii,useCallback:kn,useContext:kn,useEffect:kn,useImperativeHandle:kn,useInsertionEffect:kn,useLayoutEffect:kn,useMemo:kn,useReducer:kn,useRef:kn,useState:kn,useDebugValue:kn,useDeferredValue:kn,useTransition:kn,useMutableSource:kn,useSyncExternalStore:kn,useId:kn,unstable_isNewReconciler:!1},ZF={readContext:ii,useCallback:function(e,t){return Ui().memoizedState=[e,t===void 0?null:t],e},useContext:ii,useEffect:KE,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,$p(4194308,4,OA.bind(null,t,e),n)},useLayoutEffect:function(e,t){return $p(4194308,4,e,t)},useInsertionEffect:function(e,t){return $p(4,2,e,t)},useMemo:function(e,t){var n=Ui();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Ui();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=GF.bind(null,Ot,e),[r.memoizedState,e]},useRef:function(e){var t=Ui();return e={current:e},t.memoizedState=e},useState:HE,useDebugValue:Jw,useDeferredValue:function(e){return Ui().memoizedState=e},useTransition:function(){var e=HE(!1),t=e[0];return e=qF.bind(null,e[1]),Ui().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=Ot,i=Ui();if(Ct){if(n===void 0)throw Error(ae(407));n=n()}else{if(n=t(),ln===null)throw Error(ae(349));Va&30||EA(r,t,n)}i.memoizedState=n;var o={value:n,getSnapshot:t};return i.queue=o,KE(TA.bind(null,r,o,e),[e]),r.flags|=2048,Ld(9,kA.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=Ui(),t=ln.identifierPrefix;if(Ct){var n=Io,r=Po;n=(r&~(1<<32-Ii(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=Md++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=YF++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},QF={readContext:ii,useCallback:BA,useContext:ii,useEffect:Qw,useImperativeHandle:LA,useInsertionEffect:AA,useLayoutEffect:MA,useMemo:RA,useReducer:j0,useRef:$A,useState:function(){return j0(Od)},useDebugValue:Jw,useDeferredValue:function(e){var t=oi();return DA(t,Jt.memoizedState,e)},useTransition:function(){var e=j0(Od)[0],t=oi().memoizedState;return[e,t]},useMutableSource:_A,useSyncExternalStore:CA,useId:FA,unstable_isNewReconciler:!1},JF={readContext:ii,useCallback:BA,useContext:ii,useEffect:Qw,useImperativeHandle:LA,useInsertionEffect:AA,useLayoutEffect:MA,useMemo:RA,useReducer:z0,useRef:$A,useState:function(){return z0(Od)},useDebugValue:Jw,useDeferredValue:function(e){var t=oi();return Jt===null?t.memoizedState=e:DA(t,Jt.memoizedState,e)},useTransition:function(){var e=z0(Od)[0],t=oi().memoizedState;return[e,t]},useMutableSource:_A,useSyncExternalStore:CA,useId:FA,unstable_isNewReconciler:!1};function Ec(e,t){try{var n="",r=t;do n+=TD(r),r=r.return;while(r);var i=n}catch(o){i=`
Error generating stack: `+o.message+`
`+o.stack}return{value:e,source:t,stack:i,digest:null}}function U0(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function Ox(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var eN=typeof WeakMap=="function"?WeakMap:Map;function UA(e,t,n){n=$o(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){jg||(jg=!0,Wx=r),Ox(e,t)},n}function WA(e,t,n){n=$o(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){Ox(e,t)}}var o=e.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){Ox(e,t),typeof r!="function"&&(Ds===null?Ds=new Set([this]):Ds.add(this));var s=t.stack;this.componentDidCatch(t.value,{componentStack:s!==null?s:""})}),n}function VE(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new eN;var i=new Set;r.set(t,i)}else i=r.get(t),i===void 0&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=pN.bind(null,e,t,n),t.then(e,e))}function YE(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function qE(e,t,n,r,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=$o(-1,1),t.tag=2,Rs(n,t,1))),n.lanes|=1),e)}var tN=Vo.ReactCurrentOwner,lr=!1;function Hn(e,t,n,r){t.child=e===null?wA(t,null,n,r):_c(t,e.child,n,r)}function GE(e,t,n,r,i){n=n.render;var o=t.ref;return dc(t,i),r=Xw(e,t,n,r,o,i),n=Zw(),e!==null&&!lr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,zo(e,t,i)):(Ct&&n&&Fw(t),t.flags|=1,Hn(e,t,r,i),t.child)}function XE(e,t,n,r,i){if(e===null){var o=n.type;return typeof o=="function"&&!aS(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=o,HA(e,t,o,r,i)):(e=Lp(n.type,null,r,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(o=e.child,!(e.lanes&i)){var s=o.memoizedProps;if(n=n.compare,n=n!==null?n:kd,n(s,r)&&e.ref===t.ref)return zo(e,t,i)}return t.flags|=1,e=Ns(o,r),e.ref=t.ref,e.return=t,t.child=e}function HA(e,t,n,r,i){if(e!==null){var o=e.memoizedProps;if(kd(o,r)&&e.ref===t.ref)if(lr=!1,t.pendingProps=r=o,(e.lanes&i)!==0)e.flags&131072&&(lr=!0);else return t.lanes=e.lanes,zo(e,t,i)}return Lx(e,t,n,r,i)}function KA(e,t,n){var r=t.pendingProps,i=r.children,o=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},pt(Ql,Er),Er|=n;else{if(!(n&1073741824))return e=o!==null?o.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,pt(Ql,Er),Er|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,pt(Ql,Er),Er|=r}else o!==null?(r=o.baseLanes|n,t.memoizedState=null):r=n,pt(Ql,Er),Er|=r;return Hn(e,t,i,n),t.child}function VA(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Lx(e,t,n,r,i){var o=hr(n)?Ha:Dn.current;return o=wc(t,o),dc(t,i),n=Xw(e,t,n,r,o,i),r=Zw(),e!==null&&!lr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,zo(e,t,i)):(Ct&&r&&Fw(t),t.flags|=1,Hn(e,t,n,i),t.child)}function ZE(e,t,n,r,i){if(hr(n)){var o=!0;$g(t)}else o=!1;if(dc(t,i),t.stateNode===null)Ap(e,t),xA(t,n,r),Mx(t,n,r,i),r=!0;else if(e===null){var s=t.stateNode,a=t.memoizedProps;s.props=a;var l=s.context,c=n.contextType;typeof c=="object"&&c!==null?c=ii(c):(c=hr(n)?Ha:Dn.current,c=wc(t,c));var u=n.getDerivedStateFromProps,d=typeof u=="function"||typeof s.getSnapshotBeforeUpdate=="function";d||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==r||l!==c)&&UE(t,s,r,c),xs=!1;var h=t.memoizedState;s.state=h,Bg(t,r,s,i),l=t.memoizedState,a!==r||h!==l||dr.current||xs?(typeof u=="function"&&(Ax(t,n,u,r),l=t.memoizedState),(a=xs||zE(t,n,a,r,h,l,c))?(d||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(t.flags|=4194308)):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),s.props=r,s.state=l,s.context=c,r=a):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{s=t.stateNode,yA(e,t),a=t.memoizedProps,c=t.type===t.elementType?a:vi(t.type,a),s.props=c,d=t.pendingProps,h=s.context,l=n.contextType,typeof l=="object"&&l!==null?l=ii(l):(l=hr(n)?Ha:Dn.current,l=wc(t,l));var f=n.getDerivedStateFromProps;(u=typeof f=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==d||h!==l)&&UE(t,s,r,l),xs=!1,h=t.memoizedState,s.state=h,Bg(t,r,s,i);var p=t.memoizedState;a!==d||h!==p||dr.current||xs?(typeof f=="function"&&(Ax(t,n,f,r),p=t.memoizedState),(c=xs||zE(t,n,c,r,h,p,l)||!1)?(u||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(r,p,l),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(r,p,l)),typeof s.componentDidUpdate=="function"&&(t.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof s.componentDidUpdate!="function"||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),s.props=r,s.state=p,s.context=l,r=c):(typeof s.componentDidUpdate!="function"||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return Bx(e,t,n,r,o,i)}function Bx(e,t,n,r,i,o){VA(e,t);var s=(t.flags&128)!==0;if(!r&&!s)return i&&RE(t,n,!1),zo(e,t,o);r=t.stateNode,tN.current=t;var a=s&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&s?(t.child=_c(t,e.child,null,o),t.child=_c(t,null,a,o)):Hn(e,t,a,o),t.memoizedState=r.state,i&&RE(t,n,!0),t.child}function YA(e){var t=e.stateNode;t.pendingContext?BE(e,t.pendingContext,t.pendingContext!==t.context):t.context&&BE(e,t.context,!1),Vw(e,t.containerInfo)}function QE(e,t,n,r,i){return Sc(),jw(i),t.flags|=256,Hn(e,t,n,r),t.child}var Rx={dehydrated:null,treeContext:null,retryLane:0};function Dx(e){return{baseLanes:e,cachePool:null,transitions:null}}function qA(e,t,n){var r=t.pendingProps,i=$t.current,o=!1,s=(t.flags&128)!==0,a;if((a=s)||(a=e!==null&&e.memoizedState===null?!1:(i&2)!==0),a?(o=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),pt($t,i&1),e===null)return Ix(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(s=r.children,e=r.fallback,o?(r=t.mode,o=t.child,s={mode:"hidden",children:s},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=s):o=oy(s,r,0,null),e=Ra(e,r,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Dx(n),t.memoizedState=Rx,e):eS(t,s));if(i=e.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return nN(e,t,s,r,a,i,n);if(o){o=r.fallback,s=t.mode,i=e.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(s&1)&&t.child!==i?(r=t.child,r.childLanes=0,r.pendingProps=l,t.deletions=null):(r=Ns(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?o=Ns(a,o):(o=Ra(o,s,n,null),o.flags|=2),o.return=t,r.return=t,r.sibling=o,t.child=r,r=o,o=t.child,s=e.child.memoizedState,s=s===null?Dx(n):{baseLanes:s.baseLanes|n,cachePool:null,transitions:s.transitions},o.memoizedState=s,o.childLanes=e.childLanes&~n,t.memoizedState=Rx,r}return o=e.child,e=o.sibling,r=Ns(o,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function eS(e,t){return t=oy({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function If(e,t,n,r){return r!==null&&jw(r),_c(t,e.child,null,n),e=eS(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function nN(e,t,n,r,i,o,s){if(n)return t.flags&256?(t.flags&=-257,r=U0(Error(ae(422))),If(e,t,s,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(o=r.fallback,i=t.mode,r=oy({mode:"visible",children:r.children},i,0,null),o=Ra(o,i,s,null),o.flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,t.mode&1&&_c(t,e.child,null,s),t.child.memoizedState=Dx(s),t.memoizedState=Rx,o);if(!(t.mode&1))return If(e,t,s,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,o=Error(ae(419)),r=U0(o,r,void 0),If(e,t,s,r)}if(a=(s&e.childLanes)!==0,lr||a){if(r=ln,r!==null){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|s)?0:i,i!==0&&i!==o.retryLane&&(o.retryLane=i,jo(e,i),$i(r,e,i,-1))}return sS(),r=U0(Error(ae(421))),If(e,t,s,r)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=gN.bind(null,e),i._reactRetry=t,null):(e=o.treeContext,$r=Bs(i.nextSibling),Ar=t,Ct=!0,Si=null,e!==null&&(qr[Gr++]=Po,qr[Gr++]=Io,qr[Gr++]=Ka,Po=e.id,Io=e.overflow,Ka=t),t=eS(t,r.children),t.flags|=4096,t)}function JE(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),$x(e.return,t,n)}function W0(e,t,n,r,i){var o=e.memoizedState;o===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i)}function GA(e,t,n){var r=t.pendingProps,i=r.revealOrder,o=r.tail;if(Hn(e,t,r.children,n),r=$t.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&JE(e,n,t);else if(e.tag===19)JE(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(pt($t,r),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;n!==null;)e=n.alternate,e!==null&&Rg(e)===null&&(i=n),n=n.sibling;n=i,n===null?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),W0(t,!1,i,n,o);break;case"backwards":for(n=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&Rg(e)===null){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}W0(t,!0,n,null,o);break;case"together":W0(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ap(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function zo(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Ya|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ae(153));if(t.child!==null){for(e=t.child,n=Ns(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Ns(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function rN(e,t,n){switch(t.tag){case 3:YA(t),Sc();break;case 5:SA(t);break;case 1:hr(t.type)&&$g(t);break;case 4:Vw(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;pt(Og,r._currentValue),r._currentValue=i;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(pt($t,$t.current&1),t.flags|=128,null):n&t.child.childLanes?qA(e,t,n):(pt($t,$t.current&1),e=zo(e,t,n),e!==null?e.sibling:null);pt($t,$t.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return GA(e,t,n);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),pt($t,$t.current),r)break;return null;case 22:case 23:return t.lanes=0,KA(e,t,n)}return zo(e,t,n)}var XA,Fx,ZA,QA;XA=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Fx=function(){};ZA=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,Ia(Xi.current);var o=null;switch(n){case"input":i=sx(e,i),r=sx(e,r),o=[];break;case"select":i=Bt({},i,{value:void 0}),r=Bt({},r,{value:void 0}),o=[];break;case"textarea":i=cx(e,i),r=cx(e,r),o=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=Pg)}dx(n,r);var s;n=null;for(c in i)if(!r.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var a=i[c];for(s in a)a.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(xd.hasOwnProperty(c)?o||(o=[]):(o=o||[]).push(c,null));for(c in r){var l=r[c];if(a=i!=null?i[c]:void 0,r.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(s in a)!a.hasOwnProperty(s)||l&&l.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in l)l.hasOwnProperty(s)&&a[s]!==l[s]&&(n||(n={}),n[s]=l[s])}else n||(o||(o=[]),o.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(o=o||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(o=o||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(xd.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&bt("scroll",e),o||a===l||(o=[])):(o=o||[]).push(c,l))}n&&(o=o||[]).push("style",n);var c=o;(t.updateQueue=c)&&(t.flags|=4)}};QA=function(e,t,n,r){n!==r&&(t.flags|=4)};function xu(e,t){if(!Ct)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Tn(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function iN(e,t,n){var r=t.pendingProps;switch(Nw(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Tn(t),null;case 1:return hr(t.type)&&Ig(),Tn(t),null;case 3:return r=t.stateNode,Cc(),St(dr),St(Dn),qw(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(Tf(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Si!==null&&(Vx(Si),Si=null))),Fx(e,t),Tn(t),null;case 5:Yw(t);var i=Ia(Ad.current);if(n=t.type,e!==null&&t.stateNode!=null)ZA(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(ae(166));return Tn(t),null}if(e=Ia(Xi.current),Tf(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[Vi]=t,r[Id]=o,e=(t.mode&1)!==0,n){case"dialog":bt("cancel",r),bt("close",r);break;case"iframe":case"object":case"embed":bt("load",r);break;case"video":case"audio":for(i=0;i<Hu.length;i++)bt(Hu[i],r);break;case"source":bt("error",r);break;case"img":case"image":case"link":bt("error",r),bt("load",r);break;case"details":bt("toggle",r);break;case"input":lE(r,o),bt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},bt("invalid",r);break;case"textarea":uE(r,o),bt("invalid",r)}dx(n,o),i=null;for(var s in o)if(o.hasOwnProperty(s)){var a=o[s];s==="children"?typeof a=="string"?r.textContent!==a&&(o.suppressHydrationWarning!==!0&&kf(r.textContent,a,e),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(o.suppressHydrationWarning!==!0&&kf(r.textContent,a,e),i=["children",""+a]):xd.hasOwnProperty(s)&&a!=null&&s==="onScroll"&&bt("scroll",r)}switch(n){case"input":vf(r),cE(r,o,!0);break;case"textarea":vf(r),dE(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=Pg)}r=i,t.updateQueue=r,r!==null&&(t.flags|=4)}else{s=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=E$(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=s.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=s.createElement(n,{is:r.is}):(e=s.createElement(n),n==="select"&&(s=e,r.multiple?s.multiple=!0:r.size&&(s.size=r.size))):e=s.createElementNS(e,n),e[Vi]=t,e[Id]=r,XA(e,t,!1,!1),t.stateNode=e;e:{switch(s=hx(n,r),n){case"dialog":bt("cancel",e),bt("close",e),i=r;break;case"iframe":case"object":case"embed":bt("load",e),i=r;break;case"video":case"audio":for(i=0;i<Hu.length;i++)bt(Hu[i],e);i=r;break;case"source":bt("error",e),i=r;break;case"img":case"image":case"link":bt("error",e),bt("load",e),i=r;break;case"details":bt("toggle",e),i=r;break;case"input":lE(e,r),i=sx(e,r),bt("invalid",e);break;case"option":i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=Bt({},r,{value:void 0}),bt("invalid",e);break;case"textarea":uE(e,r),i=cx(e,r),bt("invalid",e);break;default:i=r}dx(n,i),a=i;for(o in a)if(a.hasOwnProperty(o)){var l=a[o];o==="style"?P$(e,l):o==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&k$(e,l)):o==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&bd(e,l):typeof l=="number"&&bd(e,""+l):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(xd.hasOwnProperty(o)?l!=null&&o==="onScroll"&&bt("scroll",e):l!=null&&Cw(e,o,l,s))}switch(n){case"input":vf(e),cE(e,r,!1);break;case"textarea":vf(e),dE(e);break;case"option":r.value!=null&&e.setAttribute("value",""+Vs(r.value));break;case"select":e.multiple=!!r.multiple,o=r.value,o!=null?ac(e,!!r.multiple,o,!1):r.defaultValue!=null&&ac(e,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=Pg)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Tn(t),null;case 6:if(e&&t.stateNode!=null)QA(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(ae(166));if(n=Ia(Ad.current),Ia(Xi.current),Tf(t)){if(r=t.stateNode,n=t.memoizedProps,r[Vi]=t,(o=r.nodeValue!==n)&&(e=Ar,e!==null))switch(e.tag){case 3:kf(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&kf(r.nodeValue,n,(e.mode&1)!==0)}o&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Vi]=t,t.stateNode=r}return Tn(t),null;case 13:if(St($t),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ct&&$r!==null&&t.mode&1&&!(t.flags&128))gA(),Sc(),t.flags|=98560,o=!1;else if(o=Tf(t),r!==null&&r.dehydrated!==null){if(e===null){if(!o)throw Error(ae(318));if(o=t.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(ae(317));o[Vi]=t}else Sc(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Tn(t),o=!1}else Si!==null&&(Vx(Si),Si=null),o=!0;if(!o)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||$t.current&1?tn===0&&(tn=3):sS())),t.updateQueue!==null&&(t.flags|=4),Tn(t),null);case 4:return Cc(),Fx(e,t),e===null&&Td(t.stateNode.containerInfo),Tn(t),null;case 10:return Ww(t.type._context),Tn(t),null;case 17:return hr(t.type)&&Ig(),Tn(t),null;case 19:if(St($t),o=t.memoizedState,o===null)return Tn(t),null;if(r=(t.flags&128)!==0,s=o.rendering,s===null)if(r)xu(o,!1);else{if(tn!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(s=Rg(e),s!==null){for(t.flags|=128,xu(o,!1),r=s.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)o=n,e=r,o.flags&=14680066,s=o.alternate,s===null?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,o.type=s.type,e=s.dependencies,o.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return pt($t,$t.current&1|2),t.child}e=e.sibling}o.tail!==null&&Ut()>kc&&(t.flags|=128,r=!0,xu(o,!1),t.lanes=4194304)}else{if(!r)if(e=Rg(s),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),xu(o,!0),o.tail===null&&o.tailMode==="hidden"&&!s.alternate&&!Ct)return Tn(t),null}else 2*Ut()-o.renderingStartTime>kc&&n!==1073741824&&(t.flags|=128,r=!0,xu(o,!1),t.lanes=4194304);o.isBackwards?(s.sibling=t.child,t.child=s):(n=o.last,n!==null?n.sibling=s:t.child=s,o.last=s)}return o.tail!==null?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Ut(),t.sibling=null,n=$t.current,pt($t,r?n&1|2:n&1),t):(Tn(t),null);case 22:case 23:return oS(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?Er&1073741824&&(Tn(t),t.subtreeFlags&6&&(t.flags|=8192)):Tn(t),null;case 24:return null;case 25:return null}throw Error(ae(156,t.tag))}function oN(e,t){switch(Nw(t),t.tag){case 1:return hr(t.type)&&Ig(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Cc(),St(dr),St(Dn),qw(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Yw(t),null;case 13:if(St($t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ae(340));Sc()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return St($t),null;case 4:return Cc(),null;case 10:return Ww(t.type._context),null;case 22:case 23:return oS(),null;case 24:return null;default:return null}}var $f=!1,Mn=!1,sN=typeof WeakSet=="function"?WeakSet:Set,ge=null;function Zl(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Nt(e,t,r)}else n.current=null}function Nx(e,t,n){try{n()}catch(r){Nt(e,t,r)}}var e2=!1;function aN(e,t){if(Sx=Eg,e=nA(),Dw(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var s=0,a=-1,l=-1,c=0,u=0,d=e,h=null;t:for(;;){for(var f;d!==n||i!==0&&d.nodeType!==3||(a=s+i),d!==o||r!==0&&d.nodeType!==3||(l=s+r),d.nodeType===3&&(s+=d.nodeValue.length),(f=d.firstChild)!==null;)h=d,d=f;for(;;){if(d===e)break t;if(h===n&&++c===i&&(a=s),h===o&&++u===r&&(l=s),(f=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=f}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(_x={focusedElem:e,selectionRange:n},Eg=!1,ge=t;ge!==null;)if(t=ge,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ge=e;else for(;ge!==null;){t=ge;try{var p=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var g=p.memoizedProps,y=p.memoizedState,x=t.stateNode,w=x.getSnapshotBeforeUpdate(t.elementType===t.type?g:vi(t.type,g),y);x.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var _=t.stateNode.containerInfo;_.nodeType===1?_.textContent="":_.nodeType===9&&_.documentElement&&_.removeChild(_.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ae(163))}}catch(S){Nt(t,t.return,S)}if(e=t.sibling,e!==null){e.return=t.return,ge=e;break}ge=t.return}return p=e2,e2=!1,p}function od(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&e)===e){var o=i.destroy;i.destroy=void 0,o!==void 0&&Nx(t,n,o)}i=i.next}while(i!==r)}}function ry(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function jx(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function JA(e){var t=e.alternate;t!==null&&(e.alternate=null,JA(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Vi],delete t[Id],delete t[kx],delete t[WF],delete t[HF])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function e3(e){return e.tag===5||e.tag===3||e.tag===4}function t2(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||e3(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function zx(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Pg));else if(r!==4&&(e=e.child,e!==null))for(zx(e,t,n),e=e.sibling;e!==null;)zx(e,t,n),e=e.sibling}function Ux(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(Ux(e,t,n),e=e.sibling;e!==null;)Ux(e,t,n),e=e.sibling}var fn=null,xi=!1;function hs(e,t,n){for(n=n.child;n!==null;)t3(e,t,n),n=n.sibling}function t3(e,t,n){if(Gi&&typeof Gi.onCommitFiberUnmount=="function")try{Gi.onCommitFiberUnmount(Gm,n)}catch{}switch(n.tag){case 5:Mn||Zl(n,t);case 6:var r=fn,i=xi;fn=null,hs(e,t,n),fn=r,xi=i,fn!==null&&(xi?(e=fn,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):fn.removeChild(n.stateNode));break;case 18:fn!==null&&(xi?(e=fn,n=n.stateNode,e.nodeType===8?R0(e.parentNode,n):e.nodeType===1&&R0(e,n),Cd(e)):R0(fn,n.stateNode));break;case 4:r=fn,i=xi,fn=n.stateNode.containerInfo,xi=!0,hs(e,t,n),fn=r,xi=i;break;case 0:case 11:case 14:case 15:if(!Mn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var o=i,s=o.destroy;o=o.tag,s!==void 0&&(o&2||o&4)&&Nx(n,t,s),i=i.next}while(i!==r)}hs(e,t,n);break;case 1:if(!Mn&&(Zl(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Nt(n,t,a)}hs(e,t,n);break;case 21:hs(e,t,n);break;case 22:n.mode&1?(Mn=(r=Mn)||n.memoizedState!==null,hs(e,t,n),Mn=r):hs(e,t,n);break;default:hs(e,t,n)}}function n2(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new sN),t.forEach(function(r){var i=mN.bind(null,e,r);n.has(r)||(n.add(r),r.then(i,i))})}}function gi(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var o=e,s=t,a=s;e:for(;a!==null;){switch(a.tag){case 5:fn=a.stateNode,xi=!1;break e;case 3:fn=a.stateNode.containerInfo,xi=!0;break e;case 4:fn=a.stateNode.containerInfo,xi=!0;break e}a=a.return}if(fn===null)throw Error(ae(160));t3(o,s,i),fn=null,xi=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){Nt(i,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)n3(t,e),t=t.sibling}function n3(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(gi(t,e),ji(e),r&4){try{od(3,e,e.return),ry(3,e)}catch(g){Nt(e,e.return,g)}try{od(5,e,e.return)}catch(g){Nt(e,e.return,g)}}break;case 1:gi(t,e),ji(e),r&512&&n!==null&&Zl(n,n.return);break;case 5:if(gi(t,e),ji(e),r&512&&n!==null&&Zl(n,n.return),e.flags&32){var i=e.stateNode;try{bd(i,"")}catch(g){Nt(e,e.return,g)}}if(r&4&&(i=e.stateNode,i!=null)){var o=e.memoizedProps,s=n!==null?n.memoizedProps:o,a=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{a==="input"&&o.type==="radio"&&o.name!=null&&_$(i,o),hx(a,s);var c=hx(a,o);for(s=0;s<l.length;s+=2){var u=l[s],d=l[s+1];u==="style"?P$(i,d):u==="dangerouslySetInnerHTML"?k$(i,d):u==="children"?bd(i,d):Cw(i,u,d,c)}switch(a){case"input":ax(i,o);break;case"textarea":C$(i,o);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var f=o.value;f!=null?ac(i,!!o.multiple,f,!1):h!==!!o.multiple&&(o.defaultValue!=null?ac(i,!!o.multiple,o.defaultValue,!0):ac(i,!!o.multiple,o.multiple?[]:"",!1))}i[Id]=o}catch(g){Nt(e,e.return,g)}}break;case 6:if(gi(t,e),ji(e),r&4){if(e.stateNode===null)throw Error(ae(162));i=e.stateNode,o=e.memoizedProps;try{i.nodeValue=o}catch(g){Nt(e,e.return,g)}}break;case 3:if(gi(t,e),ji(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Cd(t.containerInfo)}catch(g){Nt(e,e.return,g)}break;case 4:gi(t,e),ji(e);break;case 13:gi(t,e),ji(e),i=e.child,i.flags&8192&&(o=i.memoizedState!==null,i.stateNode.isHidden=o,!o||i.alternate!==null&&i.alternate.memoizedState!==null||(rS=Ut())),r&4&&n2(e);break;case 22:if(u=n!==null&&n.memoizedState!==null,e.mode&1?(Mn=(c=Mn)||u,gi(t,e),Mn=c):gi(t,e),ji(e),r&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!u&&e.mode&1)for(ge=e,u=e.child;u!==null;){for(d=ge=u;ge!==null;){switch(h=ge,f=h.child,h.tag){case 0:case 11:case 14:case 15:od(4,h,h.return);break;case 1:Zl(h,h.return);var p=h.stateNode;if(typeof p.componentWillUnmount=="function"){r=h,n=h.return;try{t=r,p.props=t.memoizedProps,p.state=t.memoizedState,p.componentWillUnmount()}catch(g){Nt(r,n,g)}}break;case 5:Zl(h,h.return);break;case 22:if(h.memoizedState!==null){i2(d);continue}}f!==null?(f.return=h,ge=f):i2(d)}u=u.sibling}e:for(u=null,d=e;;){if(d.tag===5){if(u===null){u=d;try{i=d.stateNode,c?(o=i.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(a=d.stateNode,l=d.memoizedProps.style,s=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=T$("display",s))}catch(g){Nt(e,e.return,g)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(g){Nt(e,e.return,g)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===e)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;d.sibling===null;){if(d.return===null||d.return===e)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:gi(t,e),ji(e),r&4&&n2(e);break;case 21:break;default:gi(t,e),ji(e)}}function ji(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(e3(n)){var r=n;break e}n=n.return}throw Error(ae(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(bd(i,""),r.flags&=-33);var o=t2(e);Ux(e,o,i);break;case 3:case 4:var s=r.stateNode.containerInfo,a=t2(e);zx(e,a,s);break;default:throw Error(ae(161))}}catch(l){Nt(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function lN(e,t,n){ge=e,r3(e)}function r3(e,t,n){for(var r=(e.mode&1)!==0;ge!==null;){var i=ge,o=i.child;if(i.tag===22&&r){var s=i.memoizedState!==null||$f;if(!s){var a=i.alternate,l=a!==null&&a.memoizedState!==null||Mn;a=$f;var c=Mn;if($f=s,(Mn=l)&&!c)for(ge=i;ge!==null;)s=ge,l=s.child,s.tag===22&&s.memoizedState!==null?o2(i):l!==null?(l.return=s,ge=l):o2(i);for(;o!==null;)ge=o,r3(o),o=o.sibling;ge=i,$f=a,Mn=c}r2(e)}else i.subtreeFlags&8772&&o!==null?(o.return=i,ge=o):r2(e)}}function r2(e){for(;ge!==null;){var t=ge;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Mn||ry(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!Mn)if(n===null)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:vi(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;o!==null&&jE(t,o,r);break;case 3:var s=t.updateQueue;if(s!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}jE(t,s,n)}break;case 5:var a=t.stateNode;if(n===null&&t.flags&4){n=a;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&Cd(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ae(163))}Mn||t.flags&512&&jx(t)}catch(h){Nt(t,t.return,h)}}if(t===e){ge=null;break}if(n=t.sibling,n!==null){n.return=t.return,ge=n;break}ge=t.return}}function i2(e){for(;ge!==null;){var t=ge;if(t===e){ge=null;break}var n=t.sibling;if(n!==null){n.return=t.return,ge=n;break}ge=t.return}}function o2(e){for(;ge!==null;){var t=ge;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{ry(4,t)}catch(l){Nt(t,n,l)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var i=t.return;try{r.componentDidMount()}catch(l){Nt(t,i,l)}}var o=t.return;try{jx(t)}catch(l){Nt(t,o,l)}break;case 5:var s=t.return;try{jx(t)}catch(l){Nt(t,s,l)}}}catch(l){Nt(t,t.return,l)}if(t===e){ge=null;break}var a=t.sibling;if(a!==null){a.return=t.return,ge=a;break}ge=t.return}}var cN=Math.ceil,Ng=Vo.ReactCurrentDispatcher,tS=Vo.ReactCurrentOwner,ni=Vo.ReactCurrentBatchConfig,Ge=0,ln=null,qt=null,xn=0,Er=0,Ql=oa(0),tn=0,Bd=null,Ya=0,iy=0,nS=0,sd=null,or=null,rS=0,kc=1/0,So=null,jg=!1,Wx=null,Ds=null,Af=!1,ks=null,zg=0,ad=0,Hx=null,Mp=-1,Op=0;function qn(){return Ge&6?Ut():Mp!==-1?Mp:Mp=Ut()}function Fs(e){return e.mode&1?Ge&2&&xn!==0?xn&-xn:VF.transition!==null?(Op===0&&(Op=j$()),Op):(e=rt,e!==0||(e=window.event,e=e===void 0?16:Y$(e.type)),e):1}function $i(e,t,n,r){if(50<ad)throw ad=0,Hx=null,Error(ae(185));wh(e,n,r),(!(Ge&2)||e!==ln)&&(e===ln&&(!(Ge&2)&&(iy|=n),tn===4&&_s(e,xn)),fr(e,r),n===1&&Ge===0&&!(t.mode&1)&&(kc=Ut()+500,ey&&sa()))}function fr(e,t){var n=e.callbackNode;VD(e,t);var r=Cg(e,e===ln?xn:0);if(r===0)n!==null&&pE(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&pE(n),t===1)e.tag===0?KF(s2.bind(null,e)):hA(s2.bind(null,e)),zF(function(){!(Ge&6)&&sa()}),n=null;else{switch(z$(r)){case 1:n=Iw;break;case 4:n=F$;break;case 16:n=_g;break;case 536870912:n=N$;break;default:n=_g}n=d3(n,i3.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function i3(e,t){if(Mp=-1,Op=0,Ge&6)throw Error(ae(327));var n=e.callbackNode;if(hc()&&e.callbackNode!==n)return null;var r=Cg(e,e===ln?xn:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=Ug(e,r);else{t=r;var i=Ge;Ge|=2;var o=s3();(ln!==e||xn!==t)&&(So=null,kc=Ut()+500,Ba(e,t));do try{hN();break}catch(a){o3(e,a)}while(1);Uw(),Ng.current=o,Ge=i,qt!==null?t=0:(ln=null,xn=0,t=tn)}if(t!==0){if(t===2&&(i=yx(e),i!==0&&(r=i,t=Kx(e,i))),t===1)throw n=Bd,Ba(e,0),_s(e,r),fr(e,Ut()),n;if(t===6)_s(e,r);else{if(i=e.current.alternate,!(r&30)&&!uN(i)&&(t=Ug(e,r),t===2&&(o=yx(e),o!==0&&(r=o,t=Kx(e,o))),t===1))throw n=Bd,Ba(e,0),_s(e,r),fr(e,Ut()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(ae(345));case 2:wa(e,or,So);break;case 3:if(_s(e,r),(r&130023424)===r&&(t=rS+500-Ut(),10<t)){if(Cg(e,0)!==0)break;if(i=e.suspendedLanes,(i&r)!==r){qn(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Ex(wa.bind(null,e,or,So),t);break}wa(e,or,So);break;case 4:if(_s(e,r),(r&4194240)===r)break;for(t=e.eventTimes,i=-1;0<r;){var s=31-Ii(r);o=1<<s,s=t[s],s>i&&(i=s),r&=~o}if(r=i,r=Ut()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*cN(r/1960))-r,10<r){e.timeoutHandle=Ex(wa.bind(null,e,or,So),r);break}wa(e,or,So);break;case 5:wa(e,or,So);break;default:throw Error(ae(329))}}}return fr(e,Ut()),e.callbackNode===n?i3.bind(null,e):null}function Kx(e,t){var n=sd;return e.current.memoizedState.isDehydrated&&(Ba(e,t).flags|=256),e=Ug(e,t),e!==2&&(t=or,or=n,t!==null&&Vx(t)),e}function Vx(e){or===null?or=e:or.push.apply(or,e)}function uN(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!Li(o(),i))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function _s(e,t){for(t&=~nS,t&=~iy,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Ii(t),r=1<<n;e[n]=-1,t&=~r}}function s2(e){if(Ge&6)throw Error(ae(327));hc();var t=Cg(e,0);if(!(t&1))return fr(e,Ut()),null;var n=Ug(e,t);if(e.tag!==0&&n===2){var r=yx(e);r!==0&&(t=r,n=Kx(e,r))}if(n===1)throw n=Bd,Ba(e,0),_s(e,t),fr(e,Ut()),n;if(n===6)throw Error(ae(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,wa(e,or,So),fr(e,Ut()),null}function iS(e,t){var n=Ge;Ge|=1;try{return e(t)}finally{Ge=n,Ge===0&&(kc=Ut()+500,ey&&sa())}}function qa(e){ks!==null&&ks.tag===0&&!(Ge&6)&&hc();var t=Ge;Ge|=1;var n=ni.transition,r=rt;try{if(ni.transition=null,rt=1,e)return e()}finally{rt=r,ni.transition=n,Ge=t,!(Ge&6)&&sa()}}function oS(){Er=Ql.current,St(Ql)}function Ba(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,jF(n)),qt!==null)for(n=qt.return;n!==null;){var r=n;switch(Nw(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Ig();break;case 3:Cc(),St(dr),St(Dn),qw();break;case 5:Yw(r);break;case 4:Cc();break;case 13:St($t);break;case 19:St($t);break;case 10:Ww(r.type._context);break;case 22:case 23:oS()}n=n.return}if(ln=e,qt=e=Ns(e.current,null),xn=Er=t,tn=0,Bd=null,nS=iy=Ya=0,or=sd=null,Pa!==null){for(t=0;t<Pa.length;t++)if(n=Pa[t],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,o=n.pending;if(o!==null){var s=o.next;o.next=i,r.next=s}n.pending=r}Pa=null}return e}function o3(e,t){do{var n=qt;try{if(Uw(),Ip.current=Fg,Dg){for(var r=Ot.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Dg=!1}if(Va=0,sn=Jt=Ot=null,id=!1,Md=0,tS.current=null,n===null||n.return===null){tn=1,Bd=t,qt=null;break}e:{var o=e,s=n.return,a=n,l=t;if(t=xn,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=a,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=YE(s);if(f!==null){f.flags&=-257,qE(f,s,a,o,t),f.mode&1&&VE(o,c,t),t=f,l=c;var p=t.updateQueue;if(p===null){var g=new Set;g.add(l),t.updateQueue=g}else p.add(l);break e}else{if(!(t&1)){VE(o,c,t),sS();break e}l=Error(ae(426))}}else if(Ct&&a.mode&1){var y=YE(s);if(y!==null){!(y.flags&65536)&&(y.flags|=256),qE(y,s,a,o,t),jw(Ec(l,a));break e}}o=l=Ec(l,a),tn!==4&&(tn=2),sd===null?sd=[o]:sd.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t;var x=UA(o,l,t);NE(o,x);break e;case 1:a=l;var w=o.type,_=o.stateNode;if(!(o.flags&128)&&(typeof w.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(Ds===null||!Ds.has(_)))){o.flags|=65536,t&=-t,o.lanes|=t;var S=WA(o,a,t);NE(o,S);break e}}o=o.return}while(o!==null)}l3(n)}catch(T){t=T,qt===n&&n!==null&&(qt=n=n.return);continue}break}while(1)}function s3(){var e=Ng.current;return Ng.current=Fg,e===null?Fg:e}function sS(){(tn===0||tn===3||tn===2)&&(tn=4),ln===null||!(Ya&268435455)&&!(iy&268435455)||_s(ln,xn)}function Ug(e,t){var n=Ge;Ge|=2;var r=s3();(ln!==e||xn!==t)&&(So=null,Ba(e,t));do try{dN();break}catch(i){o3(e,i)}while(1);if(Uw(),Ge=n,Ng.current=r,qt!==null)throw Error(ae(261));return ln=null,xn=0,tn}function dN(){for(;qt!==null;)a3(qt)}function hN(){for(;qt!==null&&!DD();)a3(qt)}function a3(e){var t=u3(e.alternate,e,Er);e.memoizedProps=e.pendingProps,t===null?l3(e):qt=t,tS.current=null}function l3(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=oN(n,t),n!==null){n.flags&=32767,qt=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{tn=6,qt=null;return}}else if(n=iN(n,t,Er),n!==null){qt=n;return}if(t=t.sibling,t!==null){qt=t;return}qt=t=e}while(t!==null);tn===0&&(tn=5)}function wa(e,t,n){var r=rt,i=ni.transition;try{ni.transition=null,rt=1,fN(e,t,n,r)}finally{ni.transition=i,rt=r}return null}function fN(e,t,n,r){do hc();while(ks!==null);if(Ge&6)throw Error(ae(327));n=e.finishedWork;var i=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(ae(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(YD(e,o),e===ln&&(qt=ln=null,xn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Af||(Af=!0,d3(_g,function(){return hc(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=ni.transition,ni.transition=null;var s=rt;rt=1;var a=Ge;Ge|=4,tS.current=null,aN(e,n),n3(n,e),OF(_x),Eg=!!Sx,_x=Sx=null,e.current=n,lN(n),FD(),Ge=a,rt=s,ni.transition=o}else e.current=n;if(Af&&(Af=!1,ks=e,zg=i),o=e.pendingLanes,o===0&&(Ds=null),zD(n.stateNode),fr(e,Ut()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(jg)throw jg=!1,e=Wx,Wx=null,e;return zg&1&&e.tag!==0&&hc(),o=e.pendingLanes,o&1?e===Hx?ad++:(ad=0,Hx=e):ad=0,sa(),null}function hc(){if(ks!==null){var e=z$(zg),t=ni.transition,n=rt;try{if(ni.transition=null,rt=16>e?16:e,ks===null)var r=!1;else{if(e=ks,ks=null,zg=0,Ge&6)throw Error(ae(331));var i=Ge;for(Ge|=4,ge=e.current;ge!==null;){var o=ge,s=o.child;if(ge.flags&16){var a=o.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(ge=c;ge!==null;){var u=ge;switch(u.tag){case 0:case 11:case 15:od(8,u,o)}var d=u.child;if(d!==null)d.return=u,ge=d;else for(;ge!==null;){u=ge;var h=u.sibling,f=u.return;if(JA(u),u===c){ge=null;break}if(h!==null){h.return=f,ge=h;break}ge=f}}}var p=o.alternate;if(p!==null){var g=p.child;if(g!==null){p.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(g!==null)}}ge=o}}if(o.subtreeFlags&2064&&s!==null)s.return=o,ge=s;else e:for(;ge!==null;){if(o=ge,o.flags&2048)switch(o.tag){case 0:case 11:case 15:od(9,o,o.return)}var x=o.sibling;if(x!==null){x.return=o.return,ge=x;break e}ge=o.return}}var w=e.current;for(ge=w;ge!==null;){s=ge;var _=s.child;if(s.subtreeFlags&2064&&_!==null)_.return=s,ge=_;else e:for(s=w;ge!==null;){if(a=ge,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:ry(9,a)}}catch(T){Nt(a,a.return,T)}if(a===s){ge=null;break e}var S=a.sibling;if(S!==null){S.return=a.return,ge=S;break e}ge=a.return}}if(Ge=i,sa(),Gi&&typeof Gi.onPostCommitFiberRoot=="function")try{Gi.onPostCommitFiberRoot(Gm,e)}catch{}r=!0}return r}finally{rt=n,ni.transition=t}}return!1}function a2(e,t,n){t=Ec(n,t),t=UA(e,t,1),e=Rs(e,t,1),t=qn(),e!==null&&(wh(e,1,t),fr(e,t))}function Nt(e,t,n){if(e.tag===3)a2(e,e,n);else for(;t!==null;){if(t.tag===3){a2(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ds===null||!Ds.has(r))){e=Ec(n,e),e=WA(t,e,1),t=Rs(t,e,1),e=qn(),t!==null&&(wh(t,1,e),fr(t,e));break}}t=t.return}}function pN(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=qn(),e.pingedLanes|=e.suspendedLanes&n,ln===e&&(xn&n)===n&&(tn===4||tn===3&&(xn&130023424)===xn&&500>Ut()-rS?Ba(e,0):nS|=n),fr(e,t)}function c3(e,t){t===0&&(e.mode&1?(t=wf,wf<<=1,!(wf&130023424)&&(wf=4194304)):t=1);var n=qn();e=jo(e,t),e!==null&&(wh(e,t,n),fr(e,n))}function gN(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),c3(e,n)}function mN(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(ae(314))}r!==null&&r.delete(t),c3(e,n)}var u3;u3=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||dr.current)lr=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return lr=!1,rN(e,t,n);lr=!!(e.flags&131072)}else lr=!1,Ct&&t.flags&1048576&&fA(t,Mg,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Ap(e,t),e=t.pendingProps;var i=wc(t,Dn.current);dc(t,n),i=Xw(null,t,r,e,i,n);var o=Zw();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,hr(r)?(o=!0,$g(t)):o=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Kw(t),i.updater=ty,t.stateNode=i,i._reactInternals=t,Mx(t,r,e,n),t=Bx(null,t,r,!0,o,n)):(t.tag=0,Ct&&o&&Fw(t),Hn(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Ap(e,t),e=t.pendingProps,i=r._init,r=i(r._payload),t.type=r,i=t.tag=vN(r),e=vi(r,e),i){case 0:t=Lx(null,t,r,e,n);break e;case 1:t=ZE(null,t,r,e,n);break e;case 11:t=GE(null,t,r,e,n);break e;case 14:t=XE(null,t,r,vi(r.type,e),n);break e}throw Error(ae(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:vi(r,i),Lx(e,t,r,i,n);case 1:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:vi(r,i),ZE(e,t,r,i,n);case 3:e:{if(YA(t),e===null)throw Error(ae(387));r=t.pendingProps,o=t.memoizedState,i=o.element,yA(e,t),Bg(t,r,null,n);var s=t.memoizedState;if(r=s.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=o,t.memoizedState=o,t.flags&256){i=Ec(Error(ae(423)),t),t=QE(e,t,r,n,i);break e}else if(r!==i){i=Ec(Error(ae(424)),t),t=QE(e,t,r,n,i);break e}else for($r=Bs(t.stateNode.containerInfo.firstChild),Ar=t,Ct=!0,Si=null,n=wA(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Sc(),r===i){t=zo(e,t,n);break e}Hn(e,t,r,n)}t=t.child}return t;case 5:return SA(t),e===null&&Ix(t),r=t.type,i=t.pendingProps,o=e!==null?e.memoizedProps:null,s=i.children,Cx(r,i)?s=null:o!==null&&Cx(r,o)&&(t.flags|=32),VA(e,t),Hn(e,t,s,n),t.child;case 6:return e===null&&Ix(t),null;case 13:return qA(e,t,n);case 4:return Vw(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=_c(t,null,r,n):Hn(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:vi(r,i),GE(e,t,r,i,n);case 7:return Hn(e,t,t.pendingProps,n),t.child;case 8:return Hn(e,t,t.pendingProps.children,n),t.child;case 12:return Hn(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,o=t.memoizedProps,s=i.value,pt(Og,r._currentValue),r._currentValue=s,o!==null)if(Li(o.value,s)){if(o.children===i.children&&!dr.current){t=zo(e,t,n);break e}}else for(o=t.child,o!==null&&(o.return=t);o!==null;){var a=o.dependencies;if(a!==null){s=o.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(o.tag===1){l=$o(-1,n&-n),l.tag=2;var c=o.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),$x(o.return,n,t),a.lanes|=n;break}l=l.next}}else if(o.tag===10)s=o.type===t.type?null:o.child;else if(o.tag===18){if(s=o.return,s===null)throw Error(ae(341));s.lanes|=n,a=s.alternate,a!==null&&(a.lanes|=n),$x(s,n,t),s=o.sibling}else s=o.child;if(s!==null)s.return=o;else for(s=o;s!==null;){if(s===t){s=null;break}if(o=s.sibling,o!==null){o.return=s.return,s=o;break}s=s.return}o=s}Hn(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,dc(t,n),i=ii(i),r=r(i),t.flags|=1,Hn(e,t,r,n),t.child;case 14:return r=t.type,i=vi(r,t.pendingProps),i=vi(r.type,i),XE(e,t,r,i,n);case 15:return HA(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:vi(r,i),Ap(e,t),t.tag=1,hr(r)?(e=!0,$g(t)):e=!1,dc(t,n),xA(t,r,i),Mx(t,r,i,n),Bx(null,t,r,!0,e,n);case 19:return GA(e,t,n);case 22:return KA(e,t,n)}throw Error(ae(156,t.tag))};function d3(e,t){return D$(e,t)}function yN(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ti(e,t,n,r){return new yN(e,t,n,r)}function aS(e){return e=e.prototype,!(!e||!e.isReactComponent)}function vN(e){if(typeof e=="function")return aS(e)?1:0;if(e!=null){if(e=e.$$typeof,e===kw)return 11;if(e===Tw)return 14}return 2}function Ns(e,t){var n=e.alternate;return n===null?(n=ti(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Lp(e,t,n,r,i,o){var s=2;if(r=e,typeof e=="function")aS(e)&&(s=1);else if(typeof e=="string")s=5;else e:switch(e){case Ul:return Ra(n.children,i,o,t);case Ew:s=8,i|=8;break;case nx:return e=ti(12,n,t,i|2),e.elementType=nx,e.lanes=o,e;case rx:return e=ti(13,n,t,i),e.elementType=rx,e.lanes=o,e;case ix:return e=ti(19,n,t,i),e.elementType=ix,e.lanes=o,e;case b$:return oy(n,i,o,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case v$:s=10;break e;case x$:s=9;break e;case kw:s=11;break e;case Tw:s=14;break e;case vs:s=16,r=null;break e}throw Error(ae(130,e==null?e:typeof e,""))}return t=ti(s,n,t,i),t.elementType=e,t.type=r,t.lanes=o,t}function Ra(e,t,n,r){return e=ti(7,e,r,t),e.lanes=n,e}function oy(e,t,n,r){return e=ti(22,e,r,t),e.elementType=b$,e.lanes=n,e.stateNode={isHidden:!1},e}function H0(e,t,n){return e=ti(6,e,null,t),e.lanes=n,e}function K0(e,t,n){return t=ti(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function xN(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=E0(0),this.expirationTimes=E0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=E0(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function lS(e,t,n,r,i,o,s,a,l){return e=new xN(e,t,n,a,l),t===1?(t=1,o===!0&&(t|=8)):t=0,o=ti(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Kw(o),e}function bN(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:zl,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function h3(e){if(!e)return Ys;e=e._reactInternals;e:{if(ol(e)!==e||e.tag!==1)throw Error(ae(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(hr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ae(171))}if(e.tag===1){var n=e.type;if(hr(n))return dA(e,n,t)}return t}function f3(e,t,n,r,i,o,s,a,l){return e=lS(n,r,!0,e,i,o,s,a,l),e.context=h3(null),n=e.current,r=qn(),i=Fs(n),o=$o(r,i),o.callback=t??null,Rs(n,o,i),e.current.lanes=i,wh(e,i,r),fr(e,r),e}function sy(e,t,n,r){var i=t.current,o=qn(),s=Fs(i);return n=h3(n),t.context===null?t.context=n:t.pendingContext=n,t=$o(o,s),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=Rs(i,t,s),e!==null&&($i(e,i,s,o),Pp(e,i,s)),s}function Wg(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function l2(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function cS(e,t){l2(e,t),(e=e.alternate)&&l2(e,t)}function wN(){return null}var p3=typeof reportError=="function"?reportError:function(e){console.error(e)};function uS(e){this._internalRoot=e}ay.prototype.render=uS.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ae(409));sy(e,t,null,null)};ay.prototype.unmount=uS.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;qa(function(){sy(null,e,null,null)}),t[No]=null}};function ay(e){this._internalRoot=e}ay.prototype.unstable_scheduleHydration=function(e){if(e){var t=H$();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Ss.length&&t!==0&&t<Ss[n].priority;n++);Ss.splice(n,0,e),n===0&&V$(e)}};function dS(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function ly(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function c2(){}function SN(e,t,n,r,i){if(i){if(typeof r=="function"){var o=r;r=function(){var c=Wg(s);o.call(c)}}var s=f3(t,r,e,0,null,!1,!1,"",c2);return e._reactRootContainer=s,e[No]=s.current,Td(e.nodeType===8?e.parentNode:e),qa(),s}for(;i=e.lastChild;)e.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var c=Wg(l);a.call(c)}}var l=lS(e,0,!1,null,null,!1,!1,"",c2);return e._reactRootContainer=l,e[No]=l.current,Td(e.nodeType===8?e.parentNode:e),qa(function(){sy(t,l,n,r)}),l}function cy(e,t,n,r,i){var o=n._reactRootContainer;if(o){var s=o;if(typeof i=="function"){var a=i;i=function(){var l=Wg(s);a.call(l)}}sy(t,s,e,i)}else s=SN(n,t,e,i,r);return Wg(s)}U$=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Wu(t.pendingLanes);n!==0&&($w(t,n|1),fr(t,Ut()),!(Ge&6)&&(kc=Ut()+500,sa()))}break;case 13:qa(function(){var r=jo(e,1);if(r!==null){var i=qn();$i(r,e,1,i)}}),cS(e,1)}};Aw=function(e){if(e.tag===13){var t=jo(e,134217728);if(t!==null){var n=qn();$i(t,e,134217728,n)}cS(e,134217728)}};W$=function(e){if(e.tag===13){var t=Fs(e),n=jo(e,t);if(n!==null){var r=qn();$i(n,e,t,r)}cS(e,t)}};H$=function(){return rt};K$=function(e,t){var n=rt;try{return rt=e,t()}finally{rt=n}};px=function(e,t,n){switch(t){case"input":if(ax(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=Jm(r);if(!i)throw Error(ae(90));S$(r),ax(r,i)}}}break;case"textarea":C$(e,n);break;case"select":t=n.value,t!=null&&ac(e,!!n.multiple,t,!1)}};A$=iS;M$=qa;var _N={usingClientEntryPoint:!1,Events:[_h,Vl,Jm,I$,$$,iS]},bu={findFiberByHostInstance:Ta,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},CN={bundleType:bu.bundleType,version:bu.version,rendererPackageName:bu.rendererPackageName,rendererConfig:bu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Vo.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=B$(e),e===null?null:e.stateNode},findFiberByHostInstance:bu.findFiberByHostInstance||wN,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Mf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Mf.isDisabled&&Mf.supportsFiber)try{Gm=Mf.inject(CN),Gi=Mf}catch{}}Rr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=_N;Rr.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!dS(t))throw Error(ae(200));return bN(e,t,null,n)};Rr.createRoot=function(e,t){if(!dS(e))throw Error(ae(299));var n=!1,r="",i=p3;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=lS(e,1,!1,null,null,n,!1,r,i),e[No]=t.current,Td(e.nodeType===8?e.parentNode:e),new uS(t)};Rr.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ae(188)):(e=Object.keys(e).join(","),Error(ae(268,e)));return e=B$(t),e=e===null?null:e.stateNode,e};Rr.flushSync=function(e){return qa(e)};Rr.hydrate=function(e,t,n){if(!ly(t))throw Error(ae(200));return cy(null,e,t,!0,n)};Rr.hydrateRoot=function(e,t,n){if(!dS(e))throw Error(ae(405));var r=n!=null&&n.hydratedSources||null,i=!1,o="",s=p3;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(s=n.onRecoverableError)),t=f3(t,null,e,1,n??null,i,!1,o,s),e[No]=t.current,Td(e),r)for(e=0;e<r.length;e++)n=r[e],i=n._getVersion,i=i(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new ay(t)};Rr.render=function(e,t,n){if(!ly(t))throw Error(ae(200));return cy(null,e,t,!1,n)};Rr.unmountComponentAtNode=function(e){if(!ly(e))throw Error(ae(40));return e._reactRootContainer?(qa(function(){cy(null,null,e,!1,function(){e._reactRootContainer=null,e[No]=null})}),!0):!1};Rr.unstable_batchedUpdates=iS;Rr.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!ly(n))throw Error(ae(200));if(e==null||e._reactInternals===void 0)throw Error(ae(38));return cy(e,t,n,!1,r)};Rr.version="18.2.0-next-9e3b772b8-20220608";function g3(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(g3)}catch(e){console.error(e)}}g3(),f$.exports=Rr;var Yo=f$.exports;const m3=rl(Yo);var u2=Yo;ex.createRoot=u2.createRoot,ex.hydrateRoot=u2.hydrateRoot;var Of=function(e){return e&&e.Math===Math&&e},xr=Of(typeof globalThis=="object"&&globalThis)||Of(typeof window=="object"&&window)||Of(typeof self=="object"&&self)||Of(typeof Ln=="object"&&Ln)||function(){return this}()||Ln||Function("return this")(),hS={},Jn=function(e){try{return!!e()}catch{return!0}},EN=Jn,aa=!EN(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),kN=Jn,uy=!kN(function(){var e=(function(){}).bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),TN=uy,Lf=Function.prototype.call,la=TN?Lf.bind(Lf):function(){return Lf.apply(Lf,arguments)},y3={},v3={}.propertyIsEnumerable,x3=Object.getOwnPropertyDescriptor,PN=x3&&!v3.call({1:2},1);y3.f=PN?function(t){var n=x3(this,t);return!!n&&n.enumerable}:v3;var b3=function(e,t){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:t}},w3=uy,S3=Function.prototype,Yx=S3.call,IN=w3&&S3.bind.bind(Yx,Yx),cn=w3?IN:function(e){return function(){return Yx.apply(e,arguments)}},_3=cn,$N=_3({}.toString),AN=_3("".slice),Wc=function(e){return AN($N(e),8,-1)},MN=cn,ON=Jn,LN=Wc,V0=Object,BN=MN("".split),RN=ON(function(){return!V0("z").propertyIsEnumerable(0)})?function(e){return LN(e)==="String"?BN(e,""):V0(e)}:V0,dy=function(e){return e==null},DN=dy,FN=TypeError,Hc=function(e){if(DN(e))throw FN("Can't call method on "+e);return e},NN=RN,jN=Hc,hy=function(e){return NN(jN(e))},qx=typeof document=="object"&&document.all,zN=typeof qx>"u"&&qx!==void 0,C3={all:qx,IS_HTMLDDA:zN},E3=C3,UN=E3.all,er=E3.IS_HTMLDDA?function(e){return typeof e=="function"||e===UN}:function(e){return typeof e=="function"},d2=er,k3=C3,WN=k3.all,sl=k3.IS_HTMLDDA?function(e){return typeof e=="object"?e!==null:d2(e)||e===WN}:function(e){return typeof e=="object"?e!==null:d2(e)},Y0=xr,HN=er,KN=function(e){return HN(e)?e:void 0},fy=function(e,t){return arguments.length<2?KN(Y0[e]):Y0[e]&&Y0[e][t]},VN=cn,T3=VN({}.isPrototypeOf),YN=typeof navigator<"u"&&String(navigator.userAgent)||"",P3=xr,q0=YN,h2=P3.process,f2=P3.Deno,p2=h2&&h2.versions||f2&&f2.version,g2=p2&&p2.v8,_i,Hg;g2&&(_i=g2.split("."),Hg=_i[0]>0&&_i[0]<4?1:+(_i[0]+_i[1]));!Hg&&q0&&(_i=q0.match(/Edge\/(\d+)/),(!_i||_i[1]>=74)&&(_i=q0.match(/Chrome\/(\d+)/),_i&&(Hg=+_i[1])));var qN=Hg,m2=qN,GN=Jn,XN=xr,ZN=XN.String,I3=!!Object.getOwnPropertySymbols&&!GN(function(){var e=Symbol("symbol detection");return!ZN(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&m2&&m2<41}),QN=I3,$3=QN&&!Symbol.sham&&typeof Symbol.iterator=="symbol",JN=fy,e7=er,t7=T3,n7=$3,r7=Object,A3=n7?function(e){return typeof e=="symbol"}:function(e){var t=JN("Symbol");return e7(t)&&t7(t.prototype,r7(e))},i7=String,o7=function(e){try{return i7(e)}catch{return"Object"}},s7=er,a7=o7,l7=TypeError,fS=function(e){if(s7(e))return e;throw l7(a7(e)+" is not a function")},c7=fS,u7=dy,pS=function(e,t){var n=e[t];return u7(n)?void 0:c7(n)},G0=la,X0=er,Z0=sl,d7=TypeError,h7=function(e,t){var n,r;if(t==="string"&&X0(n=e.toString)&&!Z0(r=G0(n,e))||X0(n=e.valueOf)&&!Z0(r=G0(n,e))||t!=="string"&&X0(n=e.toString)&&!Z0(r=G0(n,e)))return r;throw d7("Can't convert object to primitive value")},M3={exports:{}},y2=xr,f7=Object.defineProperty,gS=function(e,t){try{f7(y2,e,{value:t,configurable:!0,writable:!0})}catch{y2[e]=t}return t},p7=xr,g7=gS,v2="__core-js_shared__",m7=p7[v2]||g7(v2,{}),mS=m7,x2=mS;(M3.exports=function(e,t){return x2[e]||(x2[e]=t!==void 0?t:{})})("versions",[]).push({version:"3.32.2",mode:"global",copyright:"© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.32.2/LICENSE",source:"https://github.com/zloirock/core-js"});var yS=M3.exports,y7=Hc,v7=Object,Eh=function(e){return v7(y7(e))},x7=cn,b7=Eh,w7=x7({}.hasOwnProperty),ca=Object.hasOwn||function(t,n){return w7(b7(t),n)},S7=cn,_7=0,C7=Math.random(),E7=S7(1 .toString),O3=function(e){return"Symbol("+(e===void 0?"":e)+")_"+E7(++_7+C7,36)},k7=xr,T7=yS,b2=ca,P7=O3,I7=I3,$7=$3,Jl=k7.Symbol,Q0=T7("wks"),A7=$7?Jl.for||Jl:Jl&&Jl.withoutSetter||P7,qo=function(e){return b2(Q0,e)||(Q0[e]=I7&&b2(Jl,e)?Jl[e]:A7("Symbol."+e)),Q0[e]},M7=la,w2=sl,S2=A3,O7=pS,L7=h7,B7=qo,R7=TypeError,D7=B7("toPrimitive"),F7=function(e,t){if(!w2(e)||S2(e))return e;var n=O7(e,D7),r;if(n){if(t===void 0&&(t="default"),r=M7(n,e,t),!w2(r)||S2(r))return r;throw R7("Can't convert object to primitive value")}return t===void 0&&(t="number"),L7(e,t)},N7=F7,j7=A3,L3=function(e){var t=N7(e,"string");return j7(t)?t:t+""},z7=xr,_2=sl,Gx=z7.document,U7=_2(Gx)&&_2(Gx.createElement),B3=function(e){return U7?Gx.createElement(e):{}},W7=aa,H7=Jn,K7=B3,R3=!W7&&!H7(function(){return Object.defineProperty(K7("div"),"a",{get:function(){return 7}}).a!==7}),V7=aa,Y7=la,q7=y3,G7=b3,X7=hy,Z7=L3,Q7=ca,J7=R3,C2=Object.getOwnPropertyDescriptor;hS.f=V7?C2:function(t,n){if(t=X7(t),n=Z7(n),J7)try{return C2(t,n)}catch{}if(Q7(t,n))return G7(!Y7(q7.f,t,n),t[n])};var Kc={},ej=aa,tj=Jn,D3=ej&&tj(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),nj=sl,rj=String,ij=TypeError,al=function(e){if(nj(e))return e;throw ij(rj(e)+" is not an object")},oj=aa,sj=R3,aj=D3,Bf=al,E2=L3,lj=TypeError,J0=Object.defineProperty,cj=Object.getOwnPropertyDescriptor,ev="enumerable",tv="configurable",nv="writable";Kc.f=oj?aj?function(t,n,r){if(Bf(t),n=E2(n),Bf(r),typeof t=="function"&&n==="prototype"&&"value"in r&&nv in r&&!r[nv]){var i=cj(t,n);i&&i[nv]&&(t[n]=r.value,r={configurable:tv in r?r[tv]:i[tv],enumerable:ev in r?r[ev]:i[ev],writable:!1})}return J0(t,n,r)}:J0:function(t,n,r){if(Bf(t),n=E2(n),Bf(r),sj)try{return J0(t,n,r)}catch{}if("get"in r||"set"in r)throw lj("Accessors not supported");return"value"in r&&(t[n]=r.value),t};var uj=aa,dj=Kc,hj=b3,vS=uj?function(e,t,n){return dj.f(e,t,hj(1,n))}:function(e,t,n){return e[t]=n,e},F3={exports:{}},Xx=aa,fj=ca,N3=Function.prototype,pj=Xx&&Object.getOwnPropertyDescriptor,xS=fj(N3,"name"),gj=xS&&(function(){}).name==="something",mj=xS&&(!Xx||Xx&&pj(N3,"name").configurable),yj={EXISTS:xS,PROPER:gj,CONFIGURABLE:mj},vj=cn,xj=er,Zx=mS,bj=vj(Function.toString);xj(Zx.inspectSource)||(Zx.inspectSource=function(e){return bj(e)});var j3=Zx.inspectSource,wj=xr,Sj=er,k2=wj.WeakMap,_j=Sj(k2)&&/native code/.test(String(k2)),Cj=yS,Ej=O3,T2=Cj("keys"),z3=function(e){return T2[e]||(T2[e]=Ej(e))},bS={},kj=_j,U3=xr,Tj=sl,Pj=vS,rv=ca,iv=mS,Ij=z3,$j=bS,P2="Object already initialized",Qx=U3.TypeError,Aj=U3.WeakMap,Kg,Rd,Vg,Mj=function(e){return Vg(e)?Rd(e):Kg(e,{})},Oj=function(e){return function(t){var n;if(!Tj(t)||(n=Rd(t)).type!==e)throw Qx("Incompatible receiver, "+e+" required");return n}};if(kj||iv.state){var zi=iv.state||(iv.state=new Aj);zi.get=zi.get,zi.has=zi.has,zi.set=zi.set,Kg=function(e,t){if(zi.has(e))throw Qx(P2);return t.facade=e,zi.set(e,t),t},Rd=function(e){return zi.get(e)||{}},Vg=function(e){return zi.has(e)}}else{var Sl=Ij("state");$j[Sl]=!0,Kg=function(e,t){if(rv(e,Sl))throw Qx(P2);return t.facade=e,Pj(e,Sl,t),t},Rd=function(e){return rv(e,Sl)?e[Sl]:{}},Vg=function(e){return rv(e,Sl)}}var W3={set:Kg,get:Rd,has:Vg,enforce:Mj,getterFor:Oj},wS=cn,Lj=Jn,Bj=er,Rf=ca,Jx=aa,Rj=yj.CONFIGURABLE,Dj=j3,H3=W3,Fj=H3.enforce,Nj=H3.get,I2=String,Bp=Object.defineProperty,jj=wS("".slice),zj=wS("".replace),Uj=wS([].join),Wj=Jx&&!Lj(function(){return Bp(function(){},"length",{value:8}).length!==8}),Hj=String(String).split("String"),Kj=F3.exports=function(e,t,n){jj(I2(t),0,7)==="Symbol("&&(t="["+zj(I2(t),/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(t="get "+t),n&&n.setter&&(t="set "+t),(!Rf(e,"name")||Rj&&e.name!==t)&&(Jx?Bp(e,"name",{value:t,configurable:!0}):e.name=t),Wj&&n&&Rf(n,"arity")&&e.length!==n.arity&&Bp(e,"length",{value:n.arity});try{n&&Rf(n,"constructor")&&n.constructor?Jx&&Bp(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch{}var r=Fj(e);return Rf(r,"source")||(r.source=Uj(Hj,typeof t=="string"?t:"")),e};Function.prototype.toString=Kj(function(){return Bj(this)&&Nj(this).source||Dj(this)},"toString");var Vj=F3.exports,Yj=er,qj=Kc,Gj=Vj,Xj=gS,K3=function(e,t,n,r){r||(r={});var i=r.enumerable,o=r.name!==void 0?r.name:t;if(Yj(n)&&Gj(n,o,r),r.global)i?e[t]=n:Xj(t,n);else{try{r.unsafe?e[t]&&(i=!0):delete e[t]}catch{}i?e[t]=n:qj.f(e,t,{value:n,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return e},V3={},Zj=Math.ceil,Qj=Math.floor,Jj=Math.trunc||function(t){var n=+t;return(n>0?Qj:Zj)(n)},e9=Jj,ll=function(e){var t=+e;return t!==t||t===0?0:e9(t)},t9=ll,n9=Math.max,r9=Math.min,i9=function(e,t){var n=t9(e);return n<0?n9(n+t,0):r9(n,t)},o9=ll,s9=Math.min,Y3=function(e){return e>0?s9(o9(e),9007199254740991):0},a9=Y3,kh=function(e){return a9(e.length)},l9=hy,c9=i9,u9=kh,$2=function(e){return function(t,n,r){var i=l9(t),o=u9(i),s=c9(r,o),a;if(e&&n!==n){for(;o>s;)if(a=i[s++],a!==a)return!0}else for(;o>s;s++)if((e||s in i)&&i[s]===n)return e||s||0;return!e&&-1}},d9={includes:$2(!0),indexOf:$2(!1)},h9=cn,ov=ca,f9=hy,p9=d9.indexOf,g9=bS,A2=h9([].push),q3=function(e,t){var n=f9(e),r=0,i=[],o;for(o in n)!ov(g9,o)&&ov(n,o)&&A2(i,o);for(;t.length>r;)ov(n,o=t[r++])&&(~p9(i,o)||A2(i,o));return i},SS=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],m9=q3,y9=SS,v9=y9.concat("length","prototype");V3.f=Object.getOwnPropertyNames||function(t){return m9(t,v9)};var G3={};G3.f=Object.getOwnPropertySymbols;var x9=fy,b9=cn,w9=V3,S9=G3,_9=al,C9=b9([].concat),E9=x9("Reflect","ownKeys")||function(t){var n=w9.f(_9(t)),r=S9.f;return r?C9(n,r(t)):n},M2=ca,k9=E9,T9=hS,P9=Kc,I9=function(e,t,n){for(var r=k9(t),i=P9.f,o=T9.f,s=0;s<r.length;s++){var a=r[s];!M2(e,a)&&!(n&&M2(n,a))&&i(e,a,o(t,a))}},$9=Jn,A9=er,M9=/#|\.prototype\./,Th=function(e,t){var n=L9[O9(e)];return n===R9?!0:n===B9?!1:A9(t)?$9(t):!!t},O9=Th.normalize=function(e){return String(e).replace(M9,".").toLowerCase()},L9=Th.data={},B9=Th.NATIVE="N",R9=Th.POLYFILL="P",D9=Th,sv=xr,F9=hS.f,N9=vS,j9=K3,z9=gS,U9=I9,W9=D9,Vc=function(e,t){var n=e.target,r=e.global,i=e.stat,o,s,a,l,c,u;if(r?s=sv:i?s=sv[n]||z9(n,{}):s=(sv[n]||{}).prototype,s)for(a in t){if(c=t[a],e.dontCallGetSet?(u=F9(s,a),l=u&&u.value):l=s[a],o=W9(r?a:n+(i?".":"#")+a,e.forced),!o&&l!==void 0){if(typeof c==typeof l)continue;U9(c,l)}(e.sham||l&&l.sham)&&N9(c,"sham",!0),j9(s,a,c,e)}},X3={},H9=q3,K9=SS,V9=Object.keys||function(t){return H9(t,K9)},Y9=aa,q9=D3,G9=Kc,X9=al,Z9=hy,Q9=V9;X3.f=Y9&&!q9?Object.defineProperties:function(t,n){X9(t);for(var r=Z9(n),i=Q9(n),o=i.length,s=0,a;o>s;)G9.f(t,a=i[s++],r[a]);return t};var J9=fy,ez=J9("document","documentElement"),tz=al,nz=X3,O2=SS,rz=bS,iz=ez,oz=B3,sz=z3,L2=">",B2="<",eb="prototype",tb="script",Z3=sz("IE_PROTO"),av=function(){},Q3=function(e){return B2+tb+L2+e+B2+"/"+tb+L2},R2=function(e){e.write(Q3("")),e.close();var t=e.parentWindow.Object;return e=null,t},az=function(){var e=oz("iframe"),t="java"+tb+":",n;return e.style.display="none",iz.appendChild(e),e.src=String(t),n=e.contentWindow.document,n.open(),n.write(Q3("document.F=Object")),n.close(),n.F},Df,Rp=function(){try{Df=new ActiveXObject("htmlfile")}catch{}Rp=typeof document<"u"?document.domain&&Df?R2(Df):az():R2(Df);for(var e=O2.length;e--;)delete Rp[eb][O2[e]];return Rp()};rz[Z3]=!0;var J3=Object.create||function(t,n){var r;return t!==null?(av[eb]=tz(t),r=new av,av[eb]=null,r[Z3]=t):r=Rp(),n===void 0?r:nz.f(r,n)},lz=qo,cz=J3,uz=Kc.f,nb=lz("unscopables"),rb=Array.prototype;rb[nb]===void 0&&uz(rb,nb,{configurable:!0,value:cz(null)});var _S=function(e){rb[nb][e]=!0},dz=Vc,hz=Eh,fz=kh,pz=ll,gz=_S;dz({target:"Array",proto:!0},{at:function(t){var n=hz(this),r=fz(n),i=pz(t),o=i>=0?i:r+i;return o<0||o>=r?void 0:n[o]}});gz("at");var mz=xr,yz=cn,Ph=function(e,t){return yz(mz[e].prototype[t])},vz=Ph;vz("Array","at");var xz=Wc,eM=Array.isArray||function(t){return xz(t)==="Array"},bz=TypeError,wz=9007199254740991,Sz=function(e){if(e>wz)throw bz("Maximum allowed index exceeded");return e},_z=Wc,Cz=cn,tM=function(e){if(_z(e)==="Function")return Cz(e)},D2=tM,Ez=fS,kz=uy,Tz=D2(D2.bind),Pz=function(e,t){return Ez(e),t===void 0?e:kz?Tz(e,t):function(){return e.apply(t,arguments)}},Iz=eM,$z=kh,Az=Sz,Mz=Pz,nM=function(e,t,n,r,i,o,s,a){for(var l=i,c=0,u=s?Mz(s,a):!1,d,h;c<r;)c in n&&(d=u?u(n[c],c,t):n[c],o>0&&Iz(d)?(h=$z(d),l=nM(e,t,d,h,l,o-1)-1):(Az(l+1),e[l]=d),l++),c++;return l},rM=nM,Oz=qo,Lz=Oz("toStringTag"),iM={};iM[Lz]="z";var Bz=String(iM)==="[object z]",Rz=Bz,Dz=er,Dp=Wc,Fz=qo,Nz=Fz("toStringTag"),jz=Object,zz=Dp(function(){return arguments}())==="Arguments",Uz=function(e,t){try{return e[t]}catch{}},oM=Rz?Dp:function(e){var t,n,r;return e===void 0?"Undefined":e===null?"Null":typeof(n=Uz(t=jz(e),Nz))=="string"?n:zz?Dp(t):(r=Dp(t))==="Object"&&Dz(t.callee)?"Arguments":r},Wz=cn,Hz=Jn,sM=er,Kz=oM,Vz=fy,Yz=j3,aM=function(){},qz=[],lM=Vz("Reflect","construct"),CS=/^\s*(?:class|function)\b/,Gz=Wz(CS.exec),Xz=!CS.exec(aM),wu=function(t){if(!sM(t))return!1;try{return lM(aM,qz,t),!0}catch{return!1}},cM=function(t){if(!sM(t))return!1;switch(Kz(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return Xz||!!Gz(CS,Yz(t))}catch{return!0}};cM.sham=!0;var Zz=!lM||Hz(function(){var e;return wu(wu.call)||!wu(Object)||!wu(function(){e=!0})||e})?cM:wu,F2=eM,Qz=Zz,Jz=sl,eU=qo,tU=eU("species"),N2=Array,nU=function(e){var t;return F2(e)&&(t=e.constructor,Qz(t)&&(t===N2||F2(t.prototype))?t=void 0:Jz(t)&&(t=t[tU],t===null&&(t=void 0))),t===void 0?N2:t},rU=nU,uM=function(e,t){return new(rU(e))(t===0?0:t)},iU=Vc,oU=rM,sU=Eh,aU=kh,lU=ll,cU=uM;iU({target:"Array",proto:!0},{flat:function(){var t=arguments.length?arguments[0]:void 0,n=sU(this),r=aU(n),i=cU(n,0);return i.length=oU(i,n,n,r,0,t===void 0?1:lU(t)),i}});var uU=_S;uU("flat");var dU=Ph;dU("Array","flat");var hU=Vc,fU=rM,pU=fS,gU=Eh,mU=kh,yU=uM;hU({target:"Array",proto:!0},{flatMap:function(t){var n=gU(this),r=mU(n),i;return pU(t),i=yU(n,0),i.length=fU(i,n,n,r,0,1,t,arguments.length>1?arguments[1]:void 0),i}});var vU=_S;vU("flatMap");var xU=Ph;xU("Array","flatMap");var bU=oM,wU=String,Ih=function(e){if(bU(e)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return wU(e)},SU=Vc,_U=cn,CU=Hc,EU=ll,kU=Ih,TU=Jn,PU=_U("".charAt),IU=TU(function(){return"𠮷".at(-2)!=="\uD842"});SU({target:"String",proto:!0,forced:IU},{at:function(t){var n=kU(CU(this)),r=n.length,i=EU(t),o=i>=0?i:r+i;return o<0||o>=r?void 0:PU(n,o)}});var $U=Ph;$U("String","at");var AU=al,dM=function(){var e=AU(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t},ES=Jn,MU=xr,kS=MU.RegExp,TS=ES(function(){var e=kS("a","y");return e.lastIndex=2,e.exec("abcd")!==null}),OU=TS||ES(function(){return!kS("a","y").sticky}),LU=TS||ES(function(){var e=kS("^r","gy");return e.lastIndex=2,e.exec("str")!==null}),BU={BROKEN_CARET:LU,MISSED_STICKY:OU,UNSUPPORTED_Y:TS},RU=Jn,DU=xr,FU=DU.RegExp,NU=RU(function(){var e=FU(".","s");return!(e.dotAll&&e.exec(`
`)&&e.flags==="s")}),jU=Jn,zU=xr,UU=zU.RegExp,WU=jU(function(){var e=UU("(?<a>b)","g");return e.exec("b").groups.a!=="b"||"b".replace(e,"$<a>c")!=="bc"}),ec=la,py=cn,HU=Ih,KU=dM,VU=BU,YU=yS,qU=J3,GU=W3.get,XU=NU,ZU=WU,QU=YU("native-string-replace",String.prototype.replace),Yg=RegExp.prototype.exec,ib=Yg,JU=py("".charAt),eW=py("".indexOf),tW=py("".replace),lv=py("".slice),ob=function(){var e=/a/,t=/b*/g;return ec(Yg,e,"a"),ec(Yg,t,"a"),e.lastIndex!==0||t.lastIndex!==0}(),hM=VU.BROKEN_CARET,sb=/()??/.exec("")[1]!==void 0,nW=ob||sb||hM||XU||ZU;nW&&(ib=function(t){var n=this,r=GU(n),i=HU(t),o=r.raw,s,a,l,c,u,d,h;if(o)return o.lastIndex=n.lastIndex,s=ec(ib,o,i),n.lastIndex=o.lastIndex,s;var f=r.groups,p=hM&&n.sticky,g=ec(KU,n),y=n.source,x=0,w=i;if(p&&(g=tW(g,"y",""),eW(g,"g")===-1&&(g+="g"),w=lv(i,n.lastIndex),n.lastIndex>0&&(!n.multiline||n.multiline&&JU(i,n.lastIndex-1)!==`
`)&&(y="(?: "+y+")",w=" "+w,x++),a=new RegExp("^(?:"+y+")",g)),sb&&(a=new RegExp("^"+y+"$(?!\\s)",g)),ob&&(l=n.lastIndex),c=ec(Yg,p?a:n,w),p?c?(c.input=lv(c.input,x),c[0]=lv(c[0],x),c.index=n.lastIndex,n.lastIndex+=c[0].length):n.lastIndex=0:ob&&c&&(n.lastIndex=n.global?c.index+c[0].length:l),sb&&c&&c.length>1&&ec(QU,c[0],a,function(){for(u=1;u<arguments.length-2;u++)arguments[u]===void 0&&(c[u]=void 0)}),c&&f)for(c.groups=d=qU(null),u=0;u<f.length;u++)h=f[u],d[h[0]]=c[h[1]];return c});var PS=ib,rW=Vc,j2=PS;rW({target:"RegExp",proto:!0,forced:/./.exec!==j2},{exec:j2});var iW=uy,fM=Function.prototype,z2=fM.apply,U2=fM.call,oW=typeof Reflect=="object"&&Reflect.apply||(iW?U2.bind(z2):function(){return U2.apply(z2,arguments)}),W2=tM,H2=K3,sW=PS,K2=Jn,pM=qo,aW=vS,lW=pM("species"),cv=RegExp.prototype,cW=function(e,t,n,r){var i=pM(e),o=!K2(function(){var c={};return c[i]=function(){return 7},""[e](c)!==7}),s=o&&!K2(function(){var c=!1,u=/a/;return e==="split"&&(u={},u.constructor={},u.constructor[lW]=function(){return u},u.flags="",u[i]=/./[i]),u.exec=function(){return c=!0,null},u[i](""),!c});if(!o||!s||n){var a=W2(/./[i]),l=t(i,""[e],function(c,u,d,h,f){var p=W2(c),g=u.exec;return g===sW||g===cv.exec?o&&!f?{done:!0,value:a(u,d,h)}:{done:!0,value:p(d,u,h)}:{done:!1}});H2(String.prototype,e,l[0]),H2(cv,i,l[1])}r&&aW(cv[i],"sham",!0)},IS=cn,uW=ll,dW=Ih,hW=Hc,fW=IS("".charAt),V2=IS("".charCodeAt),pW=IS("".slice),Y2=function(e){return function(t,n){var r=dW(hW(t)),i=uW(n),o=r.length,s,a;return i<0||i>=o?e?"":void 0:(s=V2(r,i),s<55296||s>56319||i+1===o||(a=V2(r,i+1))<56320||a>57343?e?fW(r,i):s:e?pW(r,i,i+2):(s-55296<<10)+(a-56320)+65536)}},gW={codeAt:Y2(!1),charAt:Y2(!0)},mW=gW.charAt,yW=function(e,t,n){return t+(n?mW(e,t).length:1)},$S=cn,vW=Eh,xW=Math.floor,uv=$S("".charAt),bW=$S("".replace),dv=$S("".slice),wW=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,SW=/\$([$&'`]|\d{1,2})/g,gM=function(e,t,n,r,i,o){var s=n+e.length,a=r.length,l=SW;return i!==void 0&&(i=vW(i),l=wW),bW(o,l,function(c,u){var d;switch(uv(u,0)){case"$":return"$";case"&":return e;case"`":return dv(t,0,n);case"'":return dv(t,s);case"<":d=i[dv(u,1,-1)];break;default:var h=+u;if(h===0)return c;if(h>a){var f=xW(h/10);return f===0?c:f<=a?r[f-1]===void 0?uv(u,1):r[f-1]+uv(u,1):c}d=r[h-1]}return d===void 0?"":d})},q2=la,_W=al,CW=er,EW=Wc,kW=PS,TW=TypeError,PW=function(e,t){var n=e.exec;if(CW(n)){var r=q2(n,e,t);return r!==null&&_W(r),r}if(EW(e)==="RegExp")return q2(kW,e,t);throw TW("RegExp#exec called on incompatible receiver")},IW=oW,G2=la,gy=cn,$W=cW,AW=Jn,MW=al,OW=er,LW=dy,BW=ll,RW=Y3,_l=Ih,DW=Hc,FW=yW,NW=pS,jW=gM,zW=PW,UW=qo,ab=UW("replace"),WW=Math.max,HW=Math.min,KW=gy([].concat),hv=gy([].push),X2=gy("".indexOf),Z2=gy("".slice),VW=function(e){return e===void 0?e:String(e)},YW=function(){return"a".replace(/./,"$0")==="$0"}(),Q2=function(){return/./[ab]?/./[ab]("a","$0")==="":!1}(),qW=!AW(function(){var e=/./;return e.exec=function(){var t=[];return t.groups={a:"7"},t},"".replace(e,"$<a>")!=="7"});$W("replace",function(e,t,n){var r=Q2?"$":"$0";return[function(o,s){var a=DW(this),l=LW(o)?void 0:NW(o,ab);return l?G2(l,o,a,s):G2(t,_l(a),o,s)},function(i,o){var s=MW(this),a=_l(i);if(typeof o=="string"&&X2(o,r)===-1&&X2(o,"$<")===-1){var l=n(t,s,a,o);if(l.done)return l.value}var c=OW(o);c||(o=_l(o));var u=s.global,d;u&&(d=s.unicode,s.lastIndex=0);for(var h=[],f;f=zW(s,a),!(f===null||(hv(h,f),!u));){var p=_l(f[0]);p===""&&(s.lastIndex=FW(a,RW(s.lastIndex),d))}for(var g="",y=0,x=0;x<h.length;x++){f=h[x];for(var w=_l(f[0]),_=WW(HW(BW(f.index),a.length),0),S=[],T,P=1;P<f.length;P++)hv(S,VW(f[P]));var I=f.groups;if(c){var $=KW([w],S,_,a);I!==void 0&&hv($,I),T=_l(IW(o,void 0,$))}else T=jW(w,a,_,S,I,o);_>=y&&(g+=Z2(a,y,_)+T,y=_+w.length)}return g+Z2(a,y)}]},!qW||!YW||Q2);var GW=sl,XW=Wc,ZW=qo,QW=ZW("match"),JW=function(e){var t;return GW(e)&&((t=e[QW])!==void 0?!!t:XW(e)==="RegExp")},eH=la,tH=ca,nH=T3,rH=dM,J2=RegExp.prototype,iH=function(e){var t=e.flags;return t===void 0&&!("flags"in J2)&&!tH(e,"flags")&&nH(J2,e)?eH(rH,e):t},oH=Vc,sH=la,AS=cn,ek=Hc,aH=er,lH=dy,cH=JW,Su=Ih,uH=pS,dH=iH,hH=gM,fH=qo,pH=fH("replace"),gH=TypeError,mM=AS("".indexOf);AS("".replace);var tk=AS("".slice),mH=Math.max,nk=function(e,t,n){return n>e.length?-1:t===""?n:mM(e,t,n)};oH({target:"String",proto:!0},{replaceAll:function(t,n){var r=ek(this),i,o,s,a,l,c,u,d,h,f=0,p=0,g="";if(!lH(t)){if(i=cH(t),i&&(o=Su(ek(dH(t))),!~mM(o,"g")))throw gH("`.replaceAll` does not allow non-global regexes");if(s=uH(t,pH),s)return sH(s,t,r,n)}for(a=Su(r),l=Su(t),c=aH(n),c||(n=Su(n)),u=l.length,d=mH(1,u),f=nk(a,l,0);f!==-1;)h=c?Su(n(l,f,a)):hH(l,a,f,[],void 0,n),g+=tk(a,p,f)+h,p=f+u,f=nk(a,l,f+d);return p<a.length&&(g+=tk(a,p)),g}});var yH=Ph;yH("String","replaceAll");const Ir="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",vH="a0",yM="A00000000000000000000000000";function vM(e){if(e>="a"&&e<="z")return e.charCodeAt(0)-"a".charCodeAt(0)+2;if(e>="A"&&e<="Z")return"Z".charCodeAt(0)-e.charCodeAt(0)+2;throw new Error("Invalid index key head: "+e)}function xM(e){if(e.length!==vM(e.charAt(0)))throw new Error("invalid integer part of index key: "+e)}function rk(e){if(e===void 0)throw Error("n is undefined")}function ik(e){xM(e);const[t,...n]=e.split("");let r=!0;for(let i=n.length-1;r&&i>=0;i--){const o=Ir.indexOf(n[i])+1;o===Ir.length?n[i]="0":(n[i]=Ir.charAt(o),r=!1)}if(r){if(t==="Z")return"a0";if(t==="z")return;const i=String.fromCharCode(t.charCodeAt(0)+1);return i>"a"?n.push("0"):n.pop(),i+n.join("")}else return t+n.join("")}function xH(e){xM(e);const[t,...n]=e.split("");let r=!0;for(let i=n.length-1;r&&i>=0;i--){const o=Ir.indexOf(n[i])-1;o===-1?n[i]=Ir.slice(-1):(n[i]=Ir.charAt(o),r=!1)}if(r){if(t==="a")return"Z"+Ir.slice(-1);if(t==="A")return;const i=String.fromCharCode(t.charCodeAt(0)-1);return i<"Z"?n.push(Ir.slice(-1)):n.pop(),i+n.join("")}else return t+n.join("")}function tc(e,t){if(t!==void 0&&e>=t)throw new Error(e+" >= "+t);if(e.slice(-1)==="0"||t&&t.slice(-1)==="0")throw new Error("trailing zero");if(t){let i=0;for(;(e.charAt(i)||"0")===t.charAt(i);)i++;if(i>0)return t.slice(0,i)+tc(e.slice(i),t.slice(i))}const n=e?Ir.indexOf(e.charAt(0)):0,r=t!==void 0?Ir.indexOf(t.charAt(0)):Ir.length;if(r-n>1){const i=Math.round(.5*(n+r));return Ir.charAt(i)}else return t&&t.length>1?t.slice(0,1):Ir.charAt(n)+tc(e.slice(1),void 0)}function Ku(e){const t=vM(e.charAt(0));if(t>e.length)throw new Error("invalid index: "+e);return e.slice(0,t)}function ok(e){if(e===yM)throw new Error("invalid index: "+e);const t=Ku(e);if(e.slice(t.length).slice(-1)==="0")throw new Error("invalid index: "+e)}function Cl(e,t){if(e!==void 0&&ok(e),t!==void 0&&ok(t),e!==void 0&&t!==void 0&&e>=t)throw new Error(e+" >= "+t);if(e===void 0&&t===void 0)return vH;if(e===void 0){if(t===void 0)throw Error("b is undefined");const a=Ku(t),l=t.slice(a.length);if(a===yM)return a+tc("",l);if(a<t)return a;const c=xH(a);return rk(c),c}if(t===void 0){const a=Ku(e),l=e.slice(a.length),c=ik(a);return c===void 0?a+tc(l,void 0):c}const n=Ku(e),r=e.slice(n.length),i=Ku(t),o=t.slice(i.length);if(n===i)return n+tc(r,o);const s=ik(n);return rk(s),s<t?s:n+tc(r,void 0)}function qs(e,t,n){if(n===0)return[];if(n===1)return[Cl(e,t)];if(t===void 0){let o=Cl(e,t);const s=[o];for(let a=0;a<n-1;a++)o=Cl(o,t),s.push(o);return s}if(e===void 0){let o=Cl(e,t);const s=[o];for(let a=0;a<n-1;a++)o=Cl(e,o),s.push(o);return s.reverse(),s}const r=Math.floor(n/2),i=Cl(e,t);return[...qs(e,i,r),i,...qs(i,t,n-r-1)]}function El(e,t,n){return qs(e,t,n)}function fv(e,t){return qs(e,void 0,t)}function ld(e,t){return qs(e,t,1)[0]}function Co(e){return qs(e,void 0,1)[0]}function bH(e){return qs(void 0,e,1)[0]}function bM(e,t="a1"){return[t,...qs(t,void 0,e)]}function ir(e,t){return e.index<t.index?-1:e.index>t.index?1:0}function qg(e,t){const n=[];e:for(const r of e){for(const i of n)if(t?t(r,i):r===i)continue e;n.push(r)}return n}function Ae(e){return e.filter(t=>t!=null)}function Kn(e){return e[e.length-1]}function wM(e,t){let n,r=1/0;for(const i of e){const o=t(i);o<r&&(n=i,r=o)}return n}function wH(e,t){const n=[],r=[];for(const i of e)t(i)?n.push(i):r.push(i);return[n,r]}function SH(e,t){let n,r;return function(...i){return n||(n=!0,setTimeout(()=>n=!1,t),r=e(...i)),r}}function SM(e){const t=(...n)=>{try{return e(...n)}catch(r){throw r instanceof Error&&Error.captureStackTrace&&Error.captureStackTrace(r,t),r}};return t}function _H(e,t){const n=t&&e&&typeof e=="object"&&t in e?e[t]:e;throw new Error(`Unknown switch case ${n}`)}const _M=SM((e,t)=>{if(!e)throw new Error(t||"Assertion Error")}),CH=SM((e,t)=>{if(e==null)throw new Error(t??"value must be defined");return e});function CM(e,t){let n;const r=(...i)=>(n||(n={},n.promise=new Promise((o,s)=>{n.resolve=o,n.reject=s})),clearTimeout(n.timeout),n.latestArgs=i,n.timeout=setTimeout(()=>{const o=n;n=void 0;try{o.resolve(e(...o.latestArgs))}catch(s){o.reject(s)}},t),n.promise);return r.cancel=()=>{n&&clearTimeout(n.timeout)},r}const sk=new WeakMap;function MS(e,t){if(typeof e!="object"||e===null)return;let n=sk.get(e);n||(n={tags:{},extras:{}},sk.set(e,n)),t.tags&&(n.tags={...n.tags,...t.tags}),t.extras&&(n.extras={...n.extras,...t.extras})}function OS(e){let t=0;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return t+""}function fc(e=""){let t=0,n=0,r=0,i=0;function o(){const s=t^t<<11;return t=n,n=r,r=i,i^=(i>>>19^s^s>>>8)>>>0,i/4294967296*2}for(let s=0;s<e.length+64;s++)t^=e.charCodeAt(s)|0,o();return o}function lb(e,t,n,r=!1){const[i,o]=t,[s,a]=n,l=s+(e-i)/(o-i)*(a-s);return r?s<a?Math.max(Math.min(l,a),s):Math.max(Math.min(l,s),a):l}function LS(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Gg(e,t){if(LS(e,t))return e[t]}function pr(e){if(!e)return e;if(Array.isArray(e)){const t=[],n=e.length;for(let r=0;r<n;r++)t.push(pr(e[r]));return t}else if(typeof e=="object"){const t=Object.keys(e),n=t.length,r={};for(let i=0;i<n;i++){const o=t[i];r[o]=pr(e[o])}return r}return e}function ak(e){return Object.keys(e)}function Vt(e){return Object.values(e)}function js(e){return Object.entries(e)}function EM(e){return Object.fromEntries(e)}function pv(e,t){const n={};let r=!1;for(const[i,o]of js(e))t(i,o)?n[i]=o:r=!0;return r?n:e}const EH=()=>typeof process<"u"&&!1,Xg=[],kH=()=>{const e=Xg.splice(0,Xg.length);for(const t of e)t()};let gv;function TH(){gv||(gv=requestAnimationFrame(()=>{gv=void 0,kH()}))}function PH(e){if(EH())return e();Xg.includes(e)||(Xg.push(e),TH())}function IH(e,t){return e.id>t.id?1:-1}function $H(e){return e!==null}const Ao=typeof window<"u"&&window.structuredClone?window.structuredClone:e=>e&&JSON.parse(JSON.stringify(e));class Fp{constructor(t){v(this,"nextValue");v(this,"diff");this.previousValue=t}get(){var r,i,o,s;const t=((i=(r=this.diff)==null?void 0:r.removed)==null?void 0:i.size)??0,n=((s=(o=this.diff)==null?void 0:o.added)==null?void 0:s.size)??0;if(!(t===0&&n===0))return{value:this.nextValue,diff:this.diff}}_add(t,n){var r,i;this.nextValue??(this.nextValue=new Set(this.previousValue)),this.nextValue.add(t),this.diff??(this.diff={}),n?(r=this.diff.removed)==null||r.delete(t):((i=this.diff).added??(i.added=new Set),this.diff.added.add(t))}add(t){var i,o,s;const n=this.previousValue.has(t);if(n)return((o=(i=this.diff)==null?void 0:i.removed)==null?void 0:o.has(t))?this._add(t,n):void 0;(s=this.nextValue)!=null&&s.has(t)||this._add(t,n)}_remove(t,n){var r,i;this.nextValue??(this.nextValue=new Set(this.previousValue)),this.nextValue.delete(t),this.diff??(this.diff={}),n?((r=this.diff).removed??(r.removed=new Set),this.diff.removed.add(t)):(i=this.diff.added)==null||i.delete(t)}remove(t){var i,o,s,a;const n=this.previousValue.has(t);if(!n)return((o=(i=this.diff)==null?void 0:i.added)==null?void 0:o.has(t))?this._remove(t,n):void 0;(a=(s=this.diff)==null?void 0:s.removed)!=null&&a.has(t)||this._remove(t,n)}}let $h=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((t,n)=>(n&=63,n<36?t+=n.toString(36):n<62?t+=(n-26).toString(36).toUpperCase():n>62?t+="-":t+="_",t),"");class BS{constructor(t,n){v(this,"createDefaultProperties");v(this,"migrations");v(this,"validator");v(this,"scope");v(this,"isInstance",t=>(t==null?void 0:t.typeName)===this.typeName);this.typeName=t,this.createDefaultProperties=n.createDefaultProperties,this.migrations=n.migrations,this.validator=n.validator??{validate:r=>r},this.scope=n.scope??"document"}create(t){const n={...this.createDefaultProperties(),id:this.createId()};for(const[r,i]of Object.entries(t))i!==void 0&&(n[r]=i);return n.typeName=this.typeName,n}clone(t){return{...Ao(t),id:this.createId()}}createId(t){return this.typeName+":"+(t??$h())}createCustomId(t){return this.typeName+":"+t}parseId(t){if(!this.isId(t))throw new Error(`ID "${t}" is not a valid ID for type "${this.typeName}"`);return t.slice(this.typeName.length+1)}isId(t){if(!t)return!1;for(let n=0;n<this.typeName.length;n++)if(t[n]!==this.typeName[n])return!1;return t[this.typeName.length]===":"}withDefaultProperties(t){return new BS(this.typeName,{createDefaultProperties:t,migrations:this.migrations,validator:this.validator,scope:this.scope})}validate(t){return this.validator.validate(t)}}function Go(e,t){return new BS(e,{createDefaultProperties:()=>({}),migrations:t.migrations??{currentVersion:0,firstVersion:0,migrators:{}},validator:t.validator,scope:t.scope})}var lk=8,kM=class{constructor(){v(this,"arraySize",0);v(this,"array",Array(lk));v(this,"set",null)}get isEmpty(){if(this.array)return this.arraySize===0;if(this.set)return this.set.size===0;throw new Error("no set or array")}add(e){if(this.array)return this.array.indexOf(e)!==-1?!1:this.arraySize<lk?(this.array[this.arraySize]=e,this.arraySize++,!0):(this.set=new Set(this.array),this.array=null,this.set.add(e),!0);if(this.set)return this.set.has(e)?!1:(this.set.add(e),!0);throw new Error("no set or array")}remove(e){if(this.array){const t=this.array.indexOf(e);return t===-1?!1:(this.array[t]=void 0,this.arraySize--,t!==this.arraySize&&(this.array[t]=this.array[this.arraySize],this.array[this.arraySize]=void 0),!0)}if(this.set)return this.set.has(e)?(this.set.delete(e),!0):!1;throw new Error("no set or array")}visit(e){if(this.array){for(let t=0;t<this.arraySize;t++){const n=this.array[t];typeof n<"u"&&e(n)}return}if(this.set){this.set.forEach(e);return}throw new Error("no set or array")}};function TM(e){return e&&typeof e=="object"&&"parents"in e}function PM(e){for(let t=0,n=e.parents.length;t<n;t++)if(e.parents[t].__unsafe__getWithoutCapture(),e.parents[t].lastChangedEpoch!==e.parentEpochs[t])return!0;return!1}var Zg=(e,t)=>{if(e.children.remove(t)&&e.children.isEmpty&&TM(e))for(let n=0,r=e.parents.length;n<r;n++)Zg(e.parents[n],e)},RS=(e,t)=>{if(e.children.add(t)&&TM(e))for(let n=0,r=e.parents.length;n<r;n++)RS(e.parents[n],e)};function IM(e,t){return e===t||Object.is(e,t)||!!(e&&t&&typeof e.equals=="function"&&e.equals(t))}var ri=Object.freeze([]),ck=Symbol.for("__signia__"),uk=globalThis;uk[ck]?console.error('Multiple versions of signia detected. This will cause unexpected behavior. Please add "resolutions" (yarn/pnpm) or "overrides" (npm) in your package.json to ensure only one version of signia is loaded.'):uk[ck]=!0;var AH=class{constructor(e,t){v(this,"offset",0);v(this,"numNewParents",0);v(this,"maybeRemoved");this.below=e,this.child=t}},at=null;function $M(e){at=new AH(at,e)}function AM(){const e=at;if(at=e.below,e.numNewParents>0||e.offset!==e.child.parents.length){for(let n=e.offset;n<e.child.parents.length;n++){const r=e.child.parents[n];e.child.parents.indexOf(r)>=e.offset&&Zg(r,e.child)}if(e.child.parents.length=e.offset,e.child.parentEpochs.length=e.offset,at!=null&&at.maybeRemoved)for(let n=0;n<at.maybeRemoved.length;n++){const r=at.maybeRemoved[n];e.child.parents.indexOf(r)===-1&&Zg(r,e.child)}}}function cb(e){if(at){const t=at.child.parents.indexOf(e);if(t<0&&(at.numNewParents++,at.child.isActivelyListening&&RS(e,at.child)),t<0||t>=at.offset){if(t!==at.offset&&t>0){const n=at.child.parents[at.offset];at.maybeRemoved?at.maybeRemoved.indexOf(n)===-1&&at.maybeRemoved.push(n):at.maybeRemoved=[n]}at.child.parents[at.offset]=e,at.child.parentEpochs[at.offset]=e.lastChangedEpoch,at.offset++}}}var Mr=Symbol("RESET_VALUE"),MM=class{constructor(e){v(this,"index",0);v(this,"buffer");this.capacity=e,this.buffer=new Array(e)}pushEntry(e,t,n){if(n!==void 0){if(n===Mr){this.clear();return}this.buffer[this.index]=[e,t,n],this.index=(this.index+1)%this.capacity}}clear(){this.index=0,this.buffer.fill(void 0)}getChangesSince(e){const{index:t,capacity:n,buffer:r}=this;for(let i=0;i<n;i++){const o=(t-1+n-i)%n,s=r[o];if(!s)return Mr;const[a,l]=s;if(i===0&&e>=l)return[];if(a<=e&&e<l){const c=i+1,u=new Array(c);for(let d=0;d<c;d++)u[d]=r[(o+d)%n][2];return u}}return Mr}},$a=-1,gn=$a+1,mv=!1;function MH(){gn++}var OH=class{constructor(e){v(this,"initialAtomValues",new Map);this.parent=e}get isRoot(){return this.parent===null}commit(){if(this.isRoot){const e=this.initialAtomValues;this.initialAtomValues=new Map,OM(e.keys())}else this.initialAtomValues.forEach((e,t)=>{this.parent.initialAtomValues.has(t)||this.parent.initialAtomValues.set(t,e)})}abort(){gn++,this.initialAtomValues.forEach((e,t)=>{var n;t.set(e),(n=t.historyBuffer)==null||n.clear()}),this.commit()}};function OM(e){if(mv)throw new Error("cannot change atoms during reaction cycle");try{mv=!0;const t=new Set,n=r=>{r.lastTraversedEpoch!==gn&&(r.lastTraversedEpoch=gn,"maybeScheduleEffect"in r?t.add(r):r.children.visit(n))};for(const r of e)r.children.visit(n);for(const r of t)r.maybeScheduleEffect()}finally{mv=!1}}function LH(e,t){Ts?Ts.initialAtomValues.has(e)||Ts.initialAtomValues.set(e,t):OM([e])}var Ts=null;function BH(e){const t=new OH(Ts);Ts=t;try{let n=!1;const r=e(()=>n=!0);return n?t.abort():t.commit(),r}catch(n){throw t.abort(),n}finally{Ts=Ts.parent}}function Xr(e){return Ts?e():BH(e)}var RH=class{constructor(e,t,n){v(this,"isEqual");v(this,"computeDiff");v(this,"lastChangedEpoch",gn);v(this,"children",new kM);v(this,"historyBuffer");this.name=e,this.current=t,this.isEqual=(n==null?void 0:n.isEqual)??null,n&&(n.historyLength&&(this.historyBuffer=new MM(n.historyLength)),this.computeDiff=n.computeDiff)}__unsafe__getWithoutCapture(){return this.current}get value(){return cb(this),this.current}set(e,t){var r,i;if(((r=this.isEqual)==null?void 0:r.call(this,this.current,e))??IM(this.current,e))return this.current;MH(),this.historyBuffer&&this.historyBuffer.pushEntry(this.lastChangedEpoch,gn,t??((i=this.computeDiff)==null?void 0:i.call(this,this.current,e,this.lastChangedEpoch,gn))??Mr),this.lastChangedEpoch=gn;const n=this.current;return this.current=e,LH(this,n),e}update(e){return this.set(e(this.current))}getDiffSince(e){var t;return cb(this),e>=this.lastChangedEpoch?ri:((t=this.historyBuffer)==null?void 0:t.getChangesSince(e))??Mr}};function jt(e,t,n){return new RH(e,t,n)}var ub=Symbol("UNINITIALIZED"),pc=e=>e===ub,db=class{constructor(e,t){this.value=e,this.diff=t}};function Vu(e,t){return new db(e,t)}var LM=class{constructor(e,t,n){v(this,"lastChangedEpoch",$a);v(this,"lastTraversedEpoch",$a);v(this,"lastCheckedEpoch",$a);v(this,"parents",[]);v(this,"parentEpochs",[]);v(this,"children",new kM);v(this,"historyBuffer");v(this,"state",ub);v(this,"computeDiff");v(this,"isEqual");this.name=e,this.derive=t,n!=null&&n.historyLength&&(this.historyBuffer=new MM(n.historyLength)),this.computeDiff=n==null?void 0:n.computeDiff,this.isEqual=(n==null?void 0:n.isEqual)??IM}get isActivelyListening(){return!this.children.isEmpty}__unsafe__getWithoutCapture(){var t;const e=this.lastChangedEpoch===$a;if(!e&&(this.lastCheckedEpoch===gn||!PM(this)))return this.lastCheckedEpoch=gn,this.state;try{$M(this);const n=this.derive(this.state,this.lastCheckedEpoch),r=n instanceof db?n.value:n;if(this.state===ub||!this.isEqual(r,this.state)){if(this.historyBuffer&&!e){const i=n instanceof db?n.diff:void 0;this.historyBuffer.pushEntry(this.lastChangedEpoch,gn,i??((t=this.computeDiff)==null?void 0:t.call(this,this.state,r,this.lastCheckedEpoch,gn))??Mr)}this.lastChangedEpoch=gn,this.state=r}return this.lastCheckedEpoch=gn,this.state}finally{AM()}}get value(){const e=this.__unsafe__getWithoutCapture();return cb(this),e}getDiffSince(e){var t;return this.value,e>=this.lastChangedEpoch?ri:((t=this.historyBuffer)==null?void 0:t.getChangesSince(e))??Mr}};function dk(e={},t,n,r){const i=r.get,o=Symbol.for("__signia__computed__"+n);return r.get=function(){let s=this[o];return s||(s=new LM(n,i.bind(this),e),Object.defineProperty(this,o,{enumerable:!1,configurable:!1,writable:!1,value:s})),s.value},r}function ce(){if(arguments.length===1){const e=arguments[0];return(t,n,r)=>dk(e,t,n,r)}else return typeof arguments[0]=="string"?new LM(arguments[0],arguments[1],arguments[2]):dk(void 0,arguments[0],arguments[1],arguments[2])}var Ah=class{constructor(e,t,n){v(this,"_isActivelyListening",!1);v(this,"lastTraversedEpoch",$a);v(this,"lastReactedEpoch",$a);v(this,"_scheduleCount",0);v(this,"parentEpochs",[]);v(this,"parents",[]);v(this,"_scheduleEffect");v(this,"maybeExecute",()=>{this._isActivelyListening&&this.execute()});this.name=e,this.runEffect=t,this._scheduleEffect=n==null?void 0:n.scheduleEffect}get isActivelyListening(){return this._isActivelyListening}get scheduleCount(){return this._scheduleCount}maybeScheduleEffect(){if(this._isActivelyListening&&this.lastReactedEpoch!==gn){if(this.parents.length&&!PM(this)){this.lastReactedEpoch=gn;return}this.scheduleEffect()}}scheduleEffect(){this._scheduleCount++,this._scheduleEffect?this._scheduleEffect(this.maybeExecute):this.execute()}attach(){this._isActivelyListening=!0;for(let e=0,t=this.parents.length;e<t;e++)RS(this.parents[e],this)}detach(){this._isActivelyListening=!1;for(let e=0,t=this.parents.length;e<t;e++)Zg(this.parents[e],this)}execute(){try{$M(this);const e=this.runEffect(this.lastReactedEpoch);return this.lastReactedEpoch=gn,e}finally{AM()}}};function my(e,t,n){const r=new Ah(e,t,n);return r.attach(),r.scheduleEffect(),()=>{r.detach()}}function DH(e,t,n){const r=new Ah(e,t,n);return{scheduler:r,start:i=>{const o=(i==null?void 0:i.force)??!1;r.attach(),o?r.scheduleEffect():r.maybeScheduleEffect()},stop:()=>{r.detach()}}}class hk{constructor(){v(this,"items",new WeakMap)}get(t,n){return this.items.has(t)||this.items.set(t,n(t)),this.items.get(t)}}var Qg={exports:{}};Qg.exports;(function(e,t){var n=200,r="__lodash_hash_undefined__",i=1,o=2,s=9007199254740991,a="[object Arguments]",l="[object Array]",c="[object AsyncFunction]",u="[object Boolean]",d="[object Date]",h="[object Error]",f="[object Function]",p="[object GeneratorFunction]",g="[object Map]",y="[object Number]",x="[object Null]",w="[object Object]",_="[object Promise]",S="[object Proxy]",T="[object RegExp]",P="[object Set]",I="[object String]",$="[object Symbol]",L="[object Undefined]",R="[object WeakMap]",K="[object ArrayBuffer]",Q="[object DataView]",j="[object Float32Array]",B="[object Float64Array]",z="[object Int8Array]",q="[object Int16Array]",U="[object Int32Array]",D="[object Uint8Array]",F="[object Uint8ClampedArray]",J="[object Uint16Array]",Z="[object Uint32Array]",ne=/[\\^$.*+?()[\]{}|]/g,de=/^\[object .+?Constructor\]$/,Ce=/^(?:0|[1-9]\d*)$/,he={};he[j]=he[B]=he[z]=he[q]=he[U]=he[D]=he[F]=he[J]=he[Z]=!0,he[a]=he[l]=he[K]=he[u]=he[Q]=he[d]=he[h]=he[f]=he[g]=he[y]=he[w]=he[T]=he[P]=he[I]=he[R]=!1;var je=typeof Ln=="object"&&Ln&&Ln.Object===Object&&Ln,$e=typeof self=="object"&&self&&self.Object===Object&&self,Ee=je||$e||Function("return this")(),Ie=t&&!t.nodeType&&t,Fe=Ie&&!0&&e&&!e.nodeType&&e,ct=Fe&&Fe.exports===Ie,mt=ct&&je.process,Wt=function(){try{return mt&&mt.binding&&mt.binding("util")}catch{}}(),_t=Wt&&Wt.isTypedArray;function jn(O,H){for(var te=-1,pe=O==null?0:O.length,xt=0,ze=[];++te<pe;){var Dt=O[te];H(Dt,te,O)&&(ze[xt++]=Dt)}return ze}function Sn(O,H){for(var te=-1,pe=H.length,xt=O.length;++te<pe;)O[xt+te]=H[te];return O}function Zt(O,H){for(var te=-1,pe=O==null?0:O.length;++te<pe;)if(H(O[te],te,O))return!0;return!1}function _n(O,H){for(var te=-1,pe=Array(O);++te<O;)pe[te]=H(te);return pe}function Cn(O){return function(H){return O(H)}}function Rt(O,H){return O.has(H)}function rn(O,H){return O==null?void 0:O[H]}function yt(O){var H=-1,te=Array(O.size);return O.forEach(function(pe,xt){te[++H]=[xt,pe]}),te}function nr(O,H){return function(te){return O(H(te))}}function is(O){var H=-1,te=Array(O.size);return O.forEach(function(pe){te[++H]=pe}),te}var zn=Array.prototype,os=Function.prototype,A=Object.prototype,C=Ee["__core-js_shared__"],k=os.toString,M=A.hasOwnProperty,N=function(){var O=/[^.]+$/.exec(C&&C.keys&&C.keys.IE_PROTO||"");return O?"Symbol(src)_1."+O:""}(),G=A.toString,ee=RegExp("^"+k.call(M).replace(ne,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),De=ct?Ee.Buffer:void 0,et=Ee.Symbol,Ye=Ee.Uint8Array,st=A.propertyIsEnumerable,Ze=zn.splice,ut=et?et.toStringTag:void 0,po=Object.getOwnPropertySymbols,m0=De?De.isBuffer:void 0,ef=nr(Object.keys,Object),fa=bl(Ee,"DataView"),ss=bl(Ee,"Map"),xl=bl(Ee,"Promise"),lu=bl(Ee,"Set"),as=bl(Ee,"WeakMap"),go=bl(Object,"create"),y0=pa(fa),mo=pa(ss),cu=pa(xl),tf=pa(lu),nf=pa(as),rf=et?et.prototype:void 0,ls=rf?rf.valueOf:void 0;function un(O){var H=-1,te=O==null?0:O.length;for(this.clear();++H<te;){var pe=O[H];this.set(pe[0],pe[1])}}function of(){this.__data__=go?go(null):{},this.size=0}function sf(O){var H=this.has(O)&&delete this.__data__[O];return this.size-=H?1:0,H}function af(O){var H=this.__data__;if(go){var te=H[O];return te===r?void 0:te}return M.call(H,O)?H[O]:void 0}function lf(O){var H=this.__data__;return go?H[O]!==void 0:M.call(H,O)}function v0(O,H){var te=this.__data__;return this.size+=this.has(O)?0:1,te[O]=go&&H===void 0?r:H,this}un.prototype.clear=of,un.prototype.delete=sf,un.prototype.get=af,un.prototype.has=lf,un.prototype.set=v0;function fe(O){var H=-1,te=O==null?0:O.length;for(this.clear();++H<te;){var pe=O[H];this.set(pe[0],pe[1])}}function W(){this.__data__=[],this.size=0}function se(O){var H=this.__data__,te=df(H,O);if(te<0)return!1;var pe=H.length-1;return te==pe?H.pop():Ze.call(H,te,1),--this.size,!0}function ue(O){var H=this.__data__,te=df(H,O);return te<0?void 0:H[te][1]}function Je(O){return df(this.__data__,O)>-1}function Ht(O,H){var te=this.__data__,pe=df(te,O);return pe<0?(++this.size,te.push([O,H])):te[pe][1]=H,this}fe.prototype.clear=W,fe.prototype.delete=se,fe.prototype.get=ue,fe.prototype.has=Je,fe.prototype.set=Ht;function Kt(O){var H=-1,te=O==null?0:O.length;for(this.clear();++H<te;){var pe=O[H];this.set(pe[0],pe[1])}}function vt(){this.size=0,this.__data__={hash:new un,map:new(ss||fe),string:new un}}function Fr(O){var H=hf(this,O).delete(O);return this.size-=H?1:0,H}function uu(O){return hf(this,O).get(O)}function cf(O){return hf(this,O).has(O)}function KC(O,H){var te=hf(this,O),pe=te.size;return te.set(O,H),this.size+=te.size==pe?0:1,this}Kt.prototype.clear=vt,Kt.prototype.delete=Fr,Kt.prototype.get=uu,Kt.prototype.has=cf,Kt.prototype.set=KC;function uf(O){var H=-1,te=O==null?0:O.length;for(this.__data__=new Kt;++H<te;)this.add(O[H])}function C8(O){return this.__data__.set(O,r),this}function E8(O){return this.__data__.has(O)}uf.prototype.add=uf.prototype.push=C8,uf.prototype.has=E8;function cs(O){var H=this.__data__=new fe(O);this.size=H.size}function k8(){this.__data__=new fe,this.size=0}function T8(O){var H=this.__data__,te=H.delete(O);return this.size=H.size,te}function P8(O){return this.__data__.get(O)}function I8(O){return this.__data__.has(O)}function $8(O,H){var te=this.__data__;if(te instanceof fe){var pe=te.__data__;if(!ss||pe.length<n-1)return pe.push([O,H]),this.size=++te.size,this;te=this.__data__=new Kt(pe)}return te.set(O,H),this.size=te.size,this}cs.prototype.clear=k8,cs.prototype.delete=T8,cs.prototype.get=P8,cs.prototype.has=I8,cs.prototype.set=$8;function A8(O,H){var te=ff(O),pe=!te&&V8(O),xt=!te&&!pe&&x0(O),ze=!te&&!pe&&!xt&&eE(O),Dt=te||pe||xt||ze,on=Dt?_n(O.length,String):[],dn=on.length;for(var Pt in O)(H||M.call(O,Pt))&&!(Dt&&(Pt=="length"||xt&&(Pt=="offset"||Pt=="parent")||ze&&(Pt=="buffer"||Pt=="byteLength"||Pt=="byteOffset")||z8(Pt,dn)))&&on.push(Pt);return on}function df(O,H){for(var te=O.length;te--;)if(XC(O[te][0],H))return te;return-1}function M8(O,H,te){var pe=H(O);return ff(O)?pe:Sn(pe,te(O))}function du(O){return O==null?O===void 0?L:x:ut&&ut in Object(O)?N8(O):K8(O)}function VC(O){return hu(O)&&du(O)==a}function YC(O,H,te,pe,xt){return O===H?!0:O==null||H==null||!hu(O)&&!hu(H)?O!==O&&H!==H:O8(O,H,te,pe,YC,xt)}function O8(O,H,te,pe,xt,ze){var Dt=ff(O),on=ff(H),dn=Dt?l:us(O),Pt=on?l:us(H);dn=dn==a?w:dn,Pt=Pt==a?w:Pt;var wr=dn==w,pi=Pt==w,En=dn==Pt;if(En&&x0(O)){if(!x0(H))return!1;Dt=!0,wr=!1}if(En&&!wr)return ze||(ze=new cs),Dt||eE(O)?qC(O,H,te,pe,xt,ze):D8(O,H,dn,te,pe,xt,ze);if(!(te&i)){var Nr=wr&&M.call(O,"__wrapped__"),jr=pi&&M.call(H,"__wrapped__");if(Nr||jr){var ds=Nr?O.value():O,yo=jr?H.value():H;return ze||(ze=new cs),xt(ds,yo,te,pe,ze)}}return En?(ze||(ze=new cs),F8(O,H,te,pe,xt,ze)):!1}function L8(O){if(!JC(O)||W8(O))return!1;var H=ZC(O)?ee:de;return H.test(pa(O))}function B8(O){return hu(O)&&QC(O.length)&&!!he[du(O)]}function R8(O){if(!H8(O))return ef(O);var H=[];for(var te in Object(O))M.call(O,te)&&te!="constructor"&&H.push(te);return H}function qC(O,H,te,pe,xt,ze){var Dt=te&i,on=O.length,dn=H.length;if(on!=dn&&!(Dt&&dn>on))return!1;var Pt=ze.get(O);if(Pt&&ze.get(H))return Pt==H;var wr=-1,pi=!0,En=te&o?new uf:void 0;for(ze.set(O,H),ze.set(H,O);++wr<on;){var Nr=O[wr],jr=H[wr];if(pe)var ds=Dt?pe(jr,Nr,wr,H,O,ze):pe(Nr,jr,wr,O,H,ze);if(ds!==void 0){if(ds)continue;pi=!1;break}if(En){if(!Zt(H,function(yo,ga){if(!Rt(En,ga)&&(Nr===yo||xt(Nr,yo,te,pe,ze)))return En.push(ga)})){pi=!1;break}}else if(!(Nr===jr||xt(Nr,jr,te,pe,ze))){pi=!1;break}}return ze.delete(O),ze.delete(H),pi}function D8(O,H,te,pe,xt,ze,Dt){switch(te){case Q:if(O.byteLength!=H.byteLength||O.byteOffset!=H.byteOffset)return!1;O=O.buffer,H=H.buffer;case K:return!(O.byteLength!=H.byteLength||!ze(new Ye(O),new Ye(H)));case u:case d:case y:return XC(+O,+H);case h:return O.name==H.name&&O.message==H.message;case T:case I:return O==H+"";case g:var on=yt;case P:var dn=pe&i;if(on||(on=is),O.size!=H.size&&!dn)return!1;var Pt=Dt.get(O);if(Pt)return Pt==H;pe|=o,Dt.set(O,H);var wr=qC(on(O),on(H),pe,xt,ze,Dt);return Dt.delete(O),wr;case $:if(ls)return ls.call(O)==ls.call(H)}return!1}function F8(O,H,te,pe,xt,ze){var Dt=te&i,on=GC(O),dn=on.length,Pt=GC(H),wr=Pt.length;if(dn!=wr&&!Dt)return!1;for(var pi=dn;pi--;){var En=on[pi];if(!(Dt?En in H:M.call(H,En)))return!1}var Nr=ze.get(O);if(Nr&&ze.get(H))return Nr==H;var jr=!0;ze.set(O,H),ze.set(H,O);for(var ds=Dt;++pi<dn;){En=on[pi];var yo=O[En],ga=H[En];if(pe)var tE=Dt?pe(ga,yo,En,H,O,ze):pe(yo,ga,En,O,H,ze);if(!(tE===void 0?yo===ga||xt(yo,ga,te,pe,ze):tE)){jr=!1;break}ds||(ds=En=="constructor")}if(jr&&!ds){var pf=O.constructor,gf=H.constructor;pf!=gf&&"constructor"in O&&"constructor"in H&&!(typeof pf=="function"&&pf instanceof pf&&typeof gf=="function"&&gf instanceof gf)&&(jr=!1)}return ze.delete(O),ze.delete(H),jr}function GC(O){return M8(O,G8,j8)}function hf(O,H){var te=O.__data__;return U8(H)?te[typeof H=="string"?"string":"hash"]:te.map}function bl(O,H){var te=rn(O,H);return L8(te)?te:void 0}function N8(O){var H=M.call(O,ut),te=O[ut];try{O[ut]=void 0;var pe=!0}catch{}var xt=G.call(O);return pe&&(H?O[ut]=te:delete O[ut]),xt}var j8=po?function(O){return O==null?[]:(O=Object(O),jn(po(O),function(H){return st.call(O,H)}))}:X8,us=du;(fa&&us(new fa(new ArrayBuffer(1)))!=Q||ss&&us(new ss)!=g||xl&&us(xl.resolve())!=_||lu&&us(new lu)!=P||as&&us(new as)!=R)&&(us=function(O){var H=du(O),te=H==w?O.constructor:void 0,pe=te?pa(te):"";if(pe)switch(pe){case y0:return Q;case mo:return g;case cu:return _;case tf:return P;case nf:return R}return H});function z8(O,H){return H=H??s,!!H&&(typeof O=="number"||Ce.test(O))&&O>-1&&O%1==0&&O<H}function U8(O){var H=typeof O;return H=="string"||H=="number"||H=="symbol"||H=="boolean"?O!=="__proto__":O===null}function W8(O){return!!N&&N in O}function H8(O){var H=O&&O.constructor,te=typeof H=="function"&&H.prototype||A;return O===te}function K8(O){return G.call(O)}function pa(O){if(O!=null){try{return k.call(O)}catch{}try{return O+""}catch{}}return""}function XC(O,H){return O===H||O!==O&&H!==H}var V8=VC(function(){return arguments}())?VC:function(O){return hu(O)&&M.call(O,"callee")&&!st.call(O,"callee")},ff=Array.isArray;function Y8(O){return O!=null&&QC(O.length)&&!ZC(O)}var x0=m0||Z8;function q8(O,H){return YC(O,H)}function ZC(O){if(!JC(O))return!1;var H=du(O);return H==f||H==p||H==c||H==S}function QC(O){return typeof O=="number"&&O>-1&&O%1==0&&O<=s}function JC(O){var H=typeof O;return O!=null&&(H=="object"||H=="function")}function hu(O){return O!=null&&typeof O=="object"}var eE=_t?Cn(_t):B8;function G8(O){return Y8(O)?A8(O):R8(O)}function X8(){return[]}function Z8(){return!1}e.exports=q8})(Qg,Qg.exports);var FH=Qg.exports;const NH=rl(FH);function jH(e){if(e.length===0)return new Set;const t=e[0],n=e.slice(1),r=new Set;for(const i of t)n.every(o=>o.has(i))&&r.add(i);return r}function zH(e,t){const n={};for(const r of t)e.has(r)||(n.added??(n.added=new Set),n.added.add(r));for(const r of e)t.has(r)||(n.removed??(n.removed=new Set),n.removed.add(r));return n.added||n.removed?n:void 0}function fk(e,t){for(const[n,r]of Object.entries(e)){const i=r,o=t[n];if("eq"in i&&o!==i.eq||"neq"in i&&o===i.neq||"gt"in i&&(typeof o!="number"||o<=i.gt))return!1}return!0}function pk(e,t,n){const r=Object.fromEntries(Object.keys(n).map(i=>[i,new Set]));for(const[i,o]of Object.entries(n))if("eq"in o){const a=e.index(t,i).value.get(o.eq);if(a)for(const l of a)r[i].add(l)}else if("neq"in o){const s=e.index(t,i);for(const[a,l]of s.value)if(a!==o.neq)for(const c of l)r[i].add(c)}else if("gt"in o){const s=e.index(t,i);for(const[a,l]of s.value)if(a>o.gt)for(const c of l)r[i].add(c)}return jH(Object.values(r))}class UH{constructor(t,n){v(this,"indexCache",new Map);v(this,"historyCache",new Map);this.atoms=t,this.history=n}filterHistory(t){if(this.historyCache.has(t))return this.historyCache.get(t);const n=ce("filterHistory:"+t,(r,i)=>{if(pc(r))return this.history.value;const o=this.history.getDiffSince(i);if(o===Mr)return this.history.value;const s={added:{},removed:{},updated:{}};let a=0,l=0,c=0;for(const u of o){for(const d of Vt(u.added))if(d.typeName===t)if(s.removed[d.id]){const h=s.removed[d.id];delete s.removed[d.id],l--,h!==d&&(s.updated[d.id]=[h,d],c++)}else s.added[d.id]=d,a++;for(const[d,h]of Vt(u.updated))h.typeName===t&&(s.added[h.id]?s.added[h.id]=h:s.updated[h.id]?s.updated[h.id]=[s.updated[h.id][0],h]:(s.updated[h.id]=[d,h],c++));for(const d of Vt(u.removed))d.typeName===t&&(s.added[d.id]?(delete s.added[d.id],a--):s.updated[d.id]?(s.removed[d.id]=s.updated[d.id][0],delete s.updated[d.id],c--,l++):(s.removed[d.id]=d,l++))}return a||l||c?Vu(this.history.value,s):r},{historyLength:100});return this.historyCache.set(t,n),n}index(t,n){const r=t+":"+n;if(this.indexCache.has(r))return this.indexCache.get(r);const i=this.__uncached_createIndex(t,n);return this.indexCache.set(r,i),i}__uncached_createIndex(t,n){const r=this.filterHistory(t),i=()=>{r.value;const o=new Map;for(const s of Vt(this.atoms.value)){const a=s.value;if(a.typeName===t){const l=a[n];o.has(l)||o.set(l,new Set),o.get(l).add(a.id)}}return o};return ce("index:"+t+":"+n,(o,s)=>{if(pc(o))return i();const a=r.getDiffSince(s);if(a===Mr)return i();const l=new Map,c=(f,p)=>{let g=l.get(f);g||(g=new Fp(o.get(f)??new Set)),g.add(p),l.set(f,g)},u=(f,p)=>{let g=l.get(f);g||(g=new Fp(o.get(f)??new Set)),g.remove(p),l.set(f,g)};for(const f of a){for(const p of Vt(f.added))if(p.typeName===t){const g=p[n];c(g,p.id)}for(const[p,g]of Vt(f.updated))if(g.typeName===t){const y=p[n],x=g[n];y!==x&&(u(y,g.id),c(x,g.id))}for(const p of Vt(f.removed))if(p.typeName===t){const g=p[n];u(g,p.id)}}let d,h;for(const[f,p]of l){const g=p.get();g&&(d||(d=new Map(o)),h||(h=new Map),g.value.size===0?d.delete(f):d.set(f,g.value),h.set(f,g.diff))}return d&&h?Vu(d,h):o},{historyLength:100})}record(t,n=()=>({}),r="record:"+t+(n?":"+n.toString():"")){const i=this.ids(t,n,r);return ce(r,()=>{var o;for(const s of i.value)return(o=this.atoms.value[s])==null?void 0:o.value})}records(t,n=()=>({}),r="records:"+t+(n?":"+n.toString():"")){const i=this.ids(t,n,"ids:"+r);return ce(r,()=>[...i.value].map(o=>{const s=this.atoms.value[o];if(!s)throw new Error("no atom found for record id: "+o);return s.value}))}ids(t,n=()=>({}),r="ids:"+t+(n?":"+n.toString():"")){const i=this.filterHistory(t),o=()=>{i.value;const l=n();return Object.keys(l).length===0?new Set(Vt(this.atoms.value).flatMap(c=>{const u=c.value;return u.typeName===t?u.id:[]})):pk(this,t,l)},s=l=>{const c=o(),u=zH(l,c);return u?Vu(c,u):l},a=ce("ids_query:"+r,n,{isEqual:NH});return ce("query:"+r,(l,c)=>{const u=a.value;if(pc(l))return o();if(c<a.lastChangedEpoch)return s(l);const d=i.getDiffSince(c);if(d===Mr)return s(l);const h=new Fp(l);for(const p of d){for(const g of Vt(p.added))g.typeName===t&&fk(u,g)&&h.add(g.id);for(const[g,y]of Vt(p.updated))y.typeName===t&&(fk(u,y)?h.add(y.id):h.remove(y.id));for(const g of Vt(p.removed))g.typeName===t&&h.remove(g.id)}const f=h.get();return f?Vu(f.value,f.diff):l},{historyLength:50})}exec(t,n){const r=pk(this,t,n);if(r.size===0)return ri;const i=this.atoms.value;return[...r].map(o=>i[o].value)}}class BM{constructor(t){v(this,"id",$h());v(this,"atoms",jt("store_atoms",{}));v(this,"history",jt("history",0,{historyLength:1e3}));v(this,"query",new UH(this.atoms,this.history));v(this,"listeners",new Set);v(this,"historyAccumulator",new HH);v(this,"historyReactor");v(this,"schema");v(this,"props");v(this,"scopedTypes");v(this,"onAfterCreate");v(this,"onAfterChange");v(this,"onBeforeDelete");v(this,"onAfterDelete");v(this,"_runCallbacks",!0);v(this,"put",(t,n)=>{Xr(()=>{const r={},i={},o=this.atoms.__unsafe__getWithoutCapture();let s=null,a,l=!1;for(let d=0,h=t.length;d<h;d++){a=t[d];const f=(s??o)[a.id];if(f){const p=f.__unsafe__getWithoutCapture();a=this.schema.validateRecord(this,a,n??"updateRecord",p),f.set(a);const g=f.__unsafe__getWithoutCapture();p!==g&&(l=!0,r[a.id]=[p,g])}else l=!0,a=this.schema.validateRecord(this,a,n??"createRecord",null),i[a.id]=a,s||(s={...o}),s[a.id]=jt("atom:"+a.id,a)}if(s&&this.atoms.set(s),!l)return;this.updateHistory({added:i,updated:r,removed:{}});const{onAfterCreate:c,onAfterChange:u}=this;c&&this._runCallbacks&&Object.values(i).forEach(d=>{c(d)}),u&&this._runCallbacks&&Object.values(r).forEach(([d,h])=>{u(d,h)})})});v(this,"remove",t=>{Xr(()=>{if(this.onBeforeDelete&&this._runCallbacks)for(const r of t){const i=this.atoms.__unsafe__getWithoutCapture()[r];i&&this.onBeforeDelete(i.value)}let n;if(this.atoms.update(r=>{let i;for(const o of t)o in r&&(i||(i={...r}),n||(n={}),delete i[o],n[o]=r[o].value);return i??r}),!!n&&(this.updateHistory({added:{},updated:{},removed:n}),this.onAfterDelete&&this._runCallbacks))for(let r=0,i=t.length;r<i;r++)this.onAfterDelete(n[t[r]])})});v(this,"get",t=>{var n;return(n=this.atoms.value[t])==null?void 0:n.value});v(this,"unsafeGetWithoutCapture",t=>{var n;return(n=this.atoms.value[t])==null?void 0:n.__unsafe__getWithoutCapture()});v(this,"serialize",(t="document")=>{const n={};for(const[r,i]of js(this.atoms.value)){const o=i.value;(t==="all"||this.scopedTypes[t].has(o.typeName))&&(n[r]=o)}return n});v(this,"allRecords",()=>Vt(this.atoms.value).map(t=>t.value));v(this,"clear",()=>{this.remove(ak(this.atoms.value))});v(this,"update",(t,n)=>{const r=this.atoms.value[t];if(!r){console.error(`Record ${t} not found. This is probably an error`);return}this.put([n(r.__unsafe__getWithoutCapture())])});v(this,"has",t=>!!this.atoms.value[t]);v(this,"listen",(t,n)=>{this._flushHistory();const r={onHistory:t,filters:{source:(n==null?void 0:n.source)??"all",scope:(n==null?void 0:n.scope)??"all"}};return this.listeners.add(r),this.historyReactor.scheduler.isActivelyListening||this.historyReactor.start(),()=>{this.listeners.delete(r),this.listeners.size===0&&this.historyReactor.stop()}});v(this,"isMergingRemoteChanges",!1);v(this,"mergeRemoteChanges",t=>{if(this.isMergingRemoteChanges)return t();try{this.isMergingRemoteChanges=!0,Xr(t)}finally{this.isMergingRemoteChanges=!1}});v(this,"createComputedCache",(t,n)=>{const r=new hk;return{get:i=>{const o=this.atoms.value[i];if(o)return r.get(o,()=>ce(t+":"+i,()=>n(o.value))).value}}});v(this,"createSelectedComputedCache",(t,n,r)=>{const i=new hk;return{get:o=>{const s=this.atoms.value[o];if(!s)return;const a=ce(t+":"+o+":selector",()=>n(s.value));return i.get(s,()=>ce(t+":"+o,()=>r(a.value))).value}}});v(this,"_integrityChecker");v(this,"_isPossiblyCorrupted",!1);const{initialData:n,schema:r}=t;this.schema=r,this.props=t.props,n&&this.atoms.set(EM(js(n).map(([i,o])=>[i,jt("atom:"+i,this.schema.validateRecord(this,o,"initialize",null))]))),this.historyReactor=DH("Store.historyReactor",()=>{this.history.value,this._flushHistory()},{scheduleEffect:i=>PH(i)}),this.scopedTypes={document:new Set(Vt(this.schema.types).filter(i=>i.scope==="document").map(i=>i.typeName)),session:new Set(Vt(this.schema.types).filter(i=>i.scope==="session").map(i=>i.typeName)),presence:new Set(Vt(this.schema.types).filter(i=>i.scope==="presence").map(i=>i.typeName))}}_flushHistory(){if(this.historyAccumulator.hasChanges()){const t=this.historyAccumulator.flush();for(const{changes:n,source:r}of t){let i=null,o=null,s=null;for(const{onHistory:a,filters:l}of this.listeners)if(!(l.source!=="all"&&l.source!==r))if(l.scope!=="all")if(l.scope==="document"){if(o??(o=this.filterChangesByScope(n,"document")),!o)continue;a({changes:o,source:r})}else if(l.scope==="session"){if(i??(i=this.filterChangesByScope(n,"session")),!i)continue;a({changes:i,source:r})}else{if(s??(s=this.filterChangesByScope(n,"presence")),!s)continue;a({changes:s,source:r})}else a({changes:n,source:r})}}}filterChangesByScope(t,n){const r={added:pv(t.added,(i,o)=>this.scopedTypes[n].has(o.typeName)),updated:pv(t.updated,(i,o)=>this.scopedTypes[n].has(o[1].typeName)),removed:pv(t.removed,(i,o)=>this.scopedTypes[n].has(o.typeName))};return Object.keys(r.added).length===0&&Object.keys(r.updated).length===0&&Object.keys(r.removed).length===0?null:r}updateHistory(t){this.historyAccumulator.add({changes:t,source:this.isMergingRemoteChanges?"remote":"user"}),this.listeners.size===0&&this.historyAccumulator.clear(),this.history.set(this.history.value+1,t)}validate(t){this.allRecords().forEach(n=>this.schema.validateRecord(this,n,t,null))}getSnapshot(t="document"){return{store:this.serialize(t),schema:this.schema.serialize()}}loadSnapshot(t){const n=this.schema.migrateStoreSnapshot(t.store,t.schema);if(n.type==="error")throw new Error(`Failed to migrate snapshot: ${n.reason}`);Xr(()=>{this.clear(),this.put(Object.values(n.value)),this.ensureStoreIsUsable()})}extractingChanges(t){const n=[],r=this.historyAccumulator.intercepting(i=>n.push(i.changes));try{return Xr(t),yy(n)}finally{r()}}applyDiff(t,n=!0){const r=this._runCallbacks;try{this._runCallbacks=n,Xr(()=>{const i=Vt(t.added).concat(Vt(t.updated).map(([s,a])=>a)),o=ak(t.removed);i.length&&this.put(i),o.length&&this.remove(o)})}finally{this._runCallbacks=r}}ensureStoreIsUsable(){var t;this._integrityChecker??(this._integrityChecker=this.schema.createIntegrityChecker(this)),(t=this._integrityChecker)==null||t.call(this)}markAsPossiblyCorrupted(){this._isPossiblyCorrupted=!0}isPossiblyCorrupted(){return this._isPossiblyCorrupted}}function yy(e){const t={added:{},removed:{},updated:{}};for(const n of e){for(const[r,i]of js(n.added))if(t.removed[r]){const o=t.removed[r];delete t.removed[r],o!==i&&(t.updated[r]=[o,i])}else t.added[r]=i;for(const[r,[i,o]]of js(n.updated)){if(t.added[r]){t.added[r]=o,delete t.updated[r],delete t.removed[r];continue}if(t.updated[r]){t.updated[r][1]=o,delete t.removed[r];continue}t.updated[r]=n.updated[r],delete t.removed[r]}for(const[r,i]of js(n.removed))t.added[r]?delete t.added[r]:t.updated[r]?(t.removed[r]=t.updated[r][0],delete t.updated[r]):t.removed[r]=i}return t}function WH(e){const t=[];let n=e[0],r;for(let i=1,o=e.length;i<o;i++)r=e[i],n.source!==r.source?(t.push(n),n=r):n={source:n.source,changes:yy([n.changes,r.changes])};return t.push(n),t}class HH{constructor(){v(this,"_history",[]);v(this,"_interceptors",new Set)}intercepting(t){return this._interceptors.add(t),()=>{this._interceptors.delete(t)}}add(t){this._history.push(t);for(const n of this._interceptors)n(t)}flush(){const t=WH(this._history);return this._history=[],t}clear(){this._history=[]}hasChanges(){return this._history.length>0}}function KH(e){return typeof e=="object"&&e!==null&&"id"in e&&"typeName"in e}function Qe(e){const{currentVersion:t,firstVersion:n,migrators:r={},subTypeKey:i,subTypeMigrations:o}=e;if(typeof t=="number"&&typeof n=="number"){if(t===n)throw Error("Current version is equal to initial version.");if(t<n)throw Error("Current version is lower than initial version.")}return{firstVersion:n??0,currentVersion:t??0,migrators:r,subTypeKey:i,subTypeMigrations:o}}var Yu=(e=>(e.IncompatibleSubtype="incompatible-subtype",e.UnknownType="unknown-type",e.TargetVersionTooNew="target-version-too-new",e.TargetVersionTooOld="target-version-too-old",e.MigrationError="migration-error",e.UnrecognizedSubtype="unrecognized-subtype",e))(Yu||{});function Ff({record:e,migrations:t,fromVersion:n,toVersion:r}){let i=n;if(!KH(e))throw new Error("[migrateRecord] object is not a record");const{typeName:o,id:s,...a}=e;let l=a;for(;i<r;){const c=i+1,u=t.migrators[c];if(!u)return{type:"error",reason:"target-version-too-new"};l=u.up(l),i=c}for(;i>r;){const c=i-1,u=t.migrators[i];if(!u)return{type:"error",reason:"target-version-too-old"};l=u.down(l),i=c}return{type:"success",value:{...l,id:s,typeName:o}}}function DS({value:e,migrations:t,fromVersion:n,toVersion:r}){let i=n;for(;i<r;){const o=i+1,s=t.migrators[o];if(!s)return{type:"error",reason:"target-version-too-new"};e=s.up(e),i=o}for(;i>r;){const o=i-1,s=t.migrators[i];if(!s)return{type:"error",reason:"target-version-too-old"};e=s.down(e),i=o}return{type:"success",value:e}}class FS{constructor(t,n){this.types=t,this.options=n}static create(t,n){return new FS(t,n??{})}get currentStoreVersion(){var t;return((t=this.options.snapshotMigrations)==null?void 0:t.currentVersion)??0}validateRecord(t,n,r,i){try{const o=Gg(this.types,n.typeName);if(!o)throw new Error(`Missing definition for record type ${n.typeName}`);return o.validate(n)}catch(o){if(this.options.onValidationFailure)return this.options.onValidationFailure({store:t,record:n,phase:r,recordBefore:i,error:o});throw o}}migratePersistedRecord(t,n,r="up"){var d;const i=Gg(this.types,t.typeName),o=n.recordVersions[t.typeName];if(!o||!i)return{type:"error",reason:Yu.UnknownType};const s=i.migrations.currentVersion,a=o.version;if(s!==a){const h=Ff(r==="up"?{record:t,migrations:i.migrations,fromVersion:a,toVersion:s}:{record:t,migrations:i.migrations,fromVersion:s,toVersion:a});if(h.type==="error")return h;t=h.value}if(!i.migrations.subTypeKey)return{type:"success",value:t};const l=(d=i.migrations.subTypeMigrations)==null?void 0:d[t[i.migrations.subTypeKey]],c="subTypeVersions"in o?o.subTypeVersions[t[i.migrations.subTypeKey]]:void 0;if(l===void 0)return{type:"error",reason:Yu.UnrecognizedSubtype};if(c===void 0)return{type:"error",reason:Yu.IncompatibleSubtype};const u=Ff(r==="up"?{record:t,migrations:l,fromVersion:c,toVersion:l.currentVersion}:{record:t,migrations:l,fromVersion:l.currentVersion,toVersion:c});return u.type==="error"?u:{type:"success",value:u.value}}migrateStoreSnapshot(t,n){const r=this.options.snapshotMigrations;if(!r)return{type:"success",value:t};const i=r.currentVersion,o=n.storeVersion??0;if(i<o)return{type:"error",reason:Yu.TargetVersionTooOld};if(i>o){const a=DS({value:t,migrations:r,fromVersion:o,toVersion:i});if(a.type==="error")return a;t=a.value}const s=[];for(const a of Vt(t)){const l=this.migratePersistedRecord(a,n);if(l.type==="error")return l;l.value&&l.value!==a&&s.push(l.value)}if(s.length){t={...t};for(const a of s)t[a.id]=a}return{type:"success",value:t}}createIntegrityChecker(t){var n,r;return((r=(n=this.options).createIntegrityChecker)==null?void 0:r.call(n,t))??void 0}serialize(){var t;return{schemaVersion:1,storeVersion:((t=this.options.snapshotMigrations)==null?void 0:t.currentVersion)??0,recordVersions:Object.fromEntries(Vt(this.types).map(n=>[n.typeName,n.migrations.subTypeKey&&n.migrations.subTypeMigrations?{version:n.migrations.currentVersion,subTypeKey:n.migrations.subTypeKey,subTypeVersions:n.migrations.subTypeMigrations?Object.fromEntries(Object.entries(n.migrations.subTypeMigrations).map(([r,i])=>[r,i.currentVersion])):void 0}:{version:n.migrations.currentVersion}]))}}serializeEarliestVersion(){var t;return{schemaVersion:1,storeVersion:((t=this.options.snapshotMigrations)==null?void 0:t.firstVersion)??0,recordVersions:Object.fromEntries(Vt(this.types).map(n=>[n.typeName,n.migrations.subTypeKey&&n.migrations.subTypeMigrations?{version:n.migrations.firstVersion,subTypeKey:n.migrations.subTypeKey,subTypeVersions:n.migrations.subTypeMigrations?Object.fromEntries(Object.entries(n.migrations.subTypeMigrations).map(([r,i])=>[r,i.firstVersion])):void 0}:{version:n.migrations.firstVersion}]))}}}const VH=(e,t)=>{if(e.schemaVersion>t.schemaVersion)return 1;if(e.schemaVersion<t.schemaVersion)return-1;if(e.storeVersion>t.storeVersion)return 1;if(e.storeVersion<t.storeVersion)return-1;for(const n of Object.keys(e.recordVersions)){const r=e.recordVersions[n],i=t.recordVersions[n];if(r.version>i.version)return 1;if(r.version<i.version)return-1;if("subTypeVersions"in r&&!("subTypeVersions"in i))return 1;if(!("subTypeVersions"in r)&&"subTypeVersions"in i)return-1;if(!(!("subTypeVersions"in r)||!("subTypeVersions"in i)))for(const o of Object.keys(r.subTypeVersions)){const s=r.subTypeVersions[o],a=i.subTypeVersions[o];if(s>a)return 1;if(s<a)return-1}}return 0};function YH(e){if(!e.length)return null;let t="";for(const n of e)typeof n=="number"?t+=`.${n}`:n.startsWith("(")?t.endsWith(")")?t=`${t.slice(0,-1)}, ${n.slice(1)}`:t+=n:t+=`.${n}`;return t.startsWith(".")?t.slice(1):t}class Lt extends Error{constructor(n,r=[]){const i=YH(r),o=n.split(`
`).map((s,a)=>a===0?s:`  ${s}`).join(`
`);super(r?`At ${i}: ${o}`:o);v(this,"name","ValidationError");this.rawMessage=n,this.path=r}}function Yc(e,t){try{return t()}catch(n){throw n instanceof Lt?new Lt(n.rawMessage,[e,...n.path]):new Lt(n.toString(),[e])}}function Tc(e){if(e===null)return"null";if(Array.isArray(e))return"an array";const t=typeof e;switch(t){case"bigint":case"boolean":case"function":case"number":case"string":case"symbol":return`a ${t}`;case"object":return`an ${t}`;case"undefined":return"undefined";default:_H(t)}}class gr{constructor(t){this.validationFn=t}validate(t){return this.validationFn(t)}nullable(){return new gr(t=>t===null?null:this.validate(t))}optional(){return new gr(t=>{if(t!==void 0)return this.validate(t)})}refine(t){return new gr(n=>t(this.validate(n)))}check(t,n){return typeof t=="string"?this.refine(r=>(Yc(`(check ${t})`,()=>n(r)),r)):this.refine(r=>(t(r),r))}}class qH extends gr{constructor(t){super(n=>{const r=ZH.validate(n);for(let i=0;i<r.length;i++)Yc(i,()=>t.validate(r[i]));return r}),this.itemValidator=t}nonEmpty(){return this.check(t=>{if(t.length===0)throw new Lt("Expected a non-empty array")})}lengthGreaterThan1(){return this.check(t=>{if(t.length<=1)throw new Lt("Expected an array with length greater than 1")})}}class Jg extends gr{constructor(t,n=!1){super(r=>{if(typeof r!="object"||r===null)throw new Lt(`Expected object, got ${Tc(r)}`);for(const[i,o]of Object.entries(t))Yc(i,()=>{o.validate(Gg(r,i))});if(!n){for(const i of Object.keys(r))if(!LS(t,i))throw new Lt("Unexpected property",[i])}return r}),this.config=t,this.shouldAllowUnknownProperties=n}allowUnknownProperties(){return new Jg(this.config,!0)}extend(t){return new Jg({...this.config,...t})}}class NS extends gr{constructor(t,n,r){super(i=>{if(typeof i!="object"||i===null)throw new Lt(`Expected an object, got ${Tc(i)}`,[]);const o=Gg(i,t);if(typeof o!="string")throw new Lt(`Expected a string for key "${t}", got ${Tc(o)}`);const s=LS(n,o)?n[o]:void 0;return s===void 0?this.unknownValueValidation(i,o):Yc(`(${t} = ${o})`,()=>s.validate(i))}),this.key=t,this.config=n,this.unknownValueValidation=r}validateUnknownVariants(t){return new NS(this.key,this.config,t)}}class GH extends gr{constructor(t,n){super(r=>{if(typeof r!="object"||r===null)throw new Lt(`Expected object, got ${Tc(r)}`);for(const[i,o]of Object.entries(r))Yc(i,()=>{t.validate(i),n.validate(o)});return r}),this.keyValidator=t,this.valueValidator=n}}function jS(e){return new gr(t=>{if(typeof t!==e)throw new Lt(`Expected ${e}, got ${Tc(t)}`);return t})}const XH=new gr(e=>e),We=jS("string"),Be=jS("number").check(e=>{if(Number.isNaN(e))throw new Lt("Expected a number, got NaN");if(!Number.isFinite(e))throw new Lt(`Expected a finite number, got ${e}`)}),zS=Be.check(e=>{if(e<0)throw new Lt(`Expected a positive number, got ${e}`)}),yr=Be.check(e=>{if(e<=0)throw new Lt(`Expected a non-zero positive number, got ${e}`)}),RM=Be.check(e=>{if(!Number.isInteger(e))throw new Lt(`Expected an integer, got ${e}`)});RM.check(e=>{if(e<0)throw new Lt(`Expected a positive integer, got ${e}`)});RM.check(e=>{if(e<=0)throw new Lt(`Expected a non-zero positive integer, got ${e}`)});const ot=jS("boolean");function vr(e){return new gr(t=>{if(t!==e)throw new Lt(`Expected ${e}, got ${JSON.stringify(t)}`);return e})}const ZH=new gr(e=>{if(!Array.isArray(e))throw new Lt(`Expected an array, got ${Tc(e)}`);return e});function Zi(e){return new qH(e)}function Ne(e){return new Jg(e)}function DM(e,t){return new GH(e,t)}function US(e,t){return new NS(e,t,(n,r)=>{throw new Lt(`Expected one of ${Object.keys(t).map(i=>JSON.stringify(i)).join(" or ")}, got ${JSON.stringify(r)}`,[e])})}function Xo(e,t){return new gr(n=>{const r=n&&typeof n=="object"&&"id"in n&&typeof n.id=="string"?`${e}(id = ${n.id})`:e;return Yc(r,()=>t.validate(n))})}function wn(e){return new gr(t=>{if(!e.has(t)){const n=Array.from(e,r=>JSON.stringify(r)).join(" or ");throw new Lt(`Expected ${n}, got ${t}`)}return t})}const Dd=Ne({x:Be,y:Be,z:Be.optional()}),cd=Ne({x:Be,y:Be,w:Be,h:Be});function Ai(e){return We.refine(t=>{if(!t.startsWith(`${e}:`))throw new Error(`${e} ID must start with "${e}:"`);return t})}const QH=Xo("camera",Ne({typeName:vr("camera"),id:Ai("camera"),x:Be,y:Be,z:Be})),JH=Qe({}),$n=Go("camera",{validator:QH,migrations:JH,scope:"session"}).withDefaultProperties(()=>({x:0,y:0,z:1})),eK=Xo("document",Ne({typeName:vr("document"),id:vr("document:document"),gridSize:Be,name:We})),gk={AddName:1},tK=Qe({currentVersion:gk.AddName,migrators:{[gk.AddName]:{up:e=>({...e,name:""}),down:({name:e,...t})=>t}}}),WS=Go("document",{migrations:tK,validator:eK,scope:"document"}).withDefaultProperties(()=>({gridSize:10,name:""})),hb=WS.createId("document"),nK=new Set(["accent","white","black","selection-stroke","selection-fill","laser","muted-1"]),FM=wn(nK),rK=new Set(["none","default","pointer","cross","grab","rotate","grabbing","resize-edge","resize-corner","text","move","ew-resize","ns-resize","nesw-resize","nwse-resize","nesw-rotate","nwse-rotate","swne-rotate","senw-rotate","zoom-in","zoom-out"]),NM=wn(rK),iK=Ne({color:FM,type:NM,rotation:Be}),oK=new Set(["starting","paused","active","stopping"]),jM=Ne({points:Zi(Dd),size:zS,color:FM,opacity:Be,state:wn(oK),delay:Be}),sK=new Set(["start","middle","end"]),aK=new Set([...sK,"start-legacy","end-legacy","middle-legacy"]),vy=wn(aK),lK=new Set(["arrow","triangle","square","dot","pipe","diamond","inverted","bar","none"]),em=wn(lK),zM=new Set(["color","labelColor","dash","fill","size","font","align","verticalAlign","icon","geo","arrowheadStart","arrowheadEnd","spline"]),cK=new Set(["black","grey","light-violet","violet","blue","light-blue","yellow","orange","green","light-green","light-red","red"]),si=wn(cK),uK=new Set(["draw","solid","dashed","dotted"]),qc=wn(uK),dK=new Set(["none","semi","solid","pattern"]),xy=wn(dK),hK=new Set(["draw","sans","serif","mono"]),Mh=wn(hK),UM=new Set(["rectangle","ellipse","triangle","diamond","pentagon","hexagon","octagon","star","rhombus","rhombus-2","oval","trapezoid","arrow-right","arrow-left","arrow-up","arrow-down","x-box","check-box"]),WM=wn(UM),fK=new Set(["activity","airplay","alert-circle","alert-octagon","alert-triangle","align-center","align-justify","align-left","align-right","anchor","aperture","archive","arrow-down-circle","arrow-down-left","arrow-down-right","arrow-down","arrow-left-circle","arrow-left","arrow-right-circle","arrow-right","arrow-up-circle","arrow-up-left","arrow-up-right","arrow-up","at-sign","award","bar-chart-2","bar-chart","battery-charging","battery","bell-off","bell","bluetooth","bold","book-open","book","bookmark","geo","briefcase","calendar","camera-off","camera","cast","check-circle","check-square","check","chevron-down","chevron-left","chevron-right","chevron-up","chevrons-down","chevrons-left","chevrons-right","chevrons-up","chrome","circle","clipboard","clock","cloud-drizzle","cloud-lightning","cloud-off","cloud-rain","cloud-snow","cloud","codepen","codesandbox","coffee","columns","command","compass","copy","corner-down-left","corner-down-right","corner-left-down","corner-left-up","corner-right-down","corner-right-up","corner-up-left","corner-up-right","cpu","credit-card","crop","crosshair","database","delete","disc","divide-circle","divide-square","divide","dollar-sign","download-cloud","download","dribbble","droplet","edit-2","edit-3","edit","external-link","eye-off","eye","facebook","fast-forward","feather","figma","file-minus","file-plus","file-text","file","film","filter","flag","folder-minus","folder-plus","folder","framer","frown","gift","git-branch","git-commit","git-merge","git-pull-request","github","gitlab","globe","grid","hard-drive","hash","headphones","heart","help-circle","hexagon","home","image","inbox","info","instagram","italic","key","layers","layout","life-buoy","link-2","link","linkedin","list","loader","lock","log-in","log-out","mail","map-pin","map","maximize-2","maximize","meh","menu","message-circle","message-square","mic-off","mic","minimize-2","minimize","minus-circle","minus-square","minus","monitor","moon","more-horizontal","more-vertical","mouse-pointer","move","music","navigation-2","navigation","octagon","package","paperclip","pause-circle","pause","pen-tool","percent","phone-call","phone-forwarded","phone-incoming","phone-missed","phone-off","phone-outgoing","phone","pie-chart","play-circle","play","plus-circle","plus-square","plus","pocket","power","printer","radio","refresh-ccw","refresh-cw","repeat","rewind","rotate-ccw","rotate-cw","rss","save","scissors","search","send","server","settings","share-2","share","shield-off","shield","shopping-bag","shopping-cart","shuffle","sidebar","skip-back","skip-forward","slack","slash","sliders","smartphone","smile","speaker","square","star","stop-circle","sun","sunrise","sunset","table","tablet","tag","target","terminal","thermometer","thumbs-down","thumbs-up","toggle-left","toggle-right","tool","trash-2","trash","trello","trending-down","trending-up","triangle","truck","tv","twitch","twitter","type","umbrella","underline","unlock","upload-cloud","upload","user-check","user-minus","user-plus","user-x","user","users","video-off","video","voicemail","volume-1","volume-2","volume-x","volume","watch","wifi-off","wifi","wind","x-circle","x-octagon","x-square","x","youtube","zap-off","zap","zoom-in","zoom-out"]),HM=wn(fK),KM=Be.check(e=>{if(e<0||e>1)throw new Lt("Opacity must be between 0 and 1")}),pK=new Set(["s","m","l","xl"]),Zo=wn(pK),gK=new Set(["cubic","line"]),VM=wn(gK),mK=new Set(["start","middle","end"]),HS=wn(mK),Fd=Ai("page"),yK=Xo("page",Ne({typeName:vr("page"),id:Fd,name:We,index:We})),vK=Qe({}),ei=Go("page",{validator:yK,migrations:vK,scope:"document"});function Un(e){return ei.isId(e)}Ai("instance");const xK=Xo("instance",Ne({typeName:vr("instance"),id:Ai("instance"),currentPageId:Fd,followingUserId:We.nullable(),brush:cd.nullable(),opacityForNextShape:KM,propsForNextShape:Ne({color:si,labelColor:si,dash:qc,fill:xy,size:Zo,font:Mh,align:vy,verticalAlign:HS,icon:HM,geo:WM,arrowheadStart:em,arrowheadEnd:em,spline:VM}),cursor:iK,scribble:jM.nullable(),isFocusMode:ot,isDebugMode:ot,isToolLocked:ot,exportBackground:ot,screenBounds:cd,zoomBrush:cd.nullable(),isPenMode:ot,isGridMode:ot})),rr={AddTransparentExportBgs:1,RemoveDialog:2,AddToolLockMode:3,RemoveExtraPropsForNextShape:4,AddLabelColor:5,AddFollowingUserId:6,RemoveAlignJustify:7,AddZoom:8,AddVerticalAlign:9,AddScribbleDelay:10,RemoveUserId:11,AddIsPenModeAndIsGridMode:12,HoistOpacity:13},bK=Qe({currentVersion:rr.HoistOpacity,migrators:{[rr.AddTransparentExportBgs]:{up:e=>({...e,exportBackground:!0}),down:({exportBackground:e,...t})=>t},[rr.RemoveDialog]:{up:({dialog:e,...t})=>t,down:e=>({...e,dialog:null})},[rr.AddToolLockMode]:{up:e=>({...e,isToolLocked:!1}),down:({isToolLocked:e,...t})=>t},[rr.RemoveExtraPropsForNextShape]:{up:({propsForNextShape:e,...t})=>({...t,propsForNextShape:Object.fromEntries(Object.entries(e).filter(([n])=>zM.has(n)))}),down:e=>e},[rr.AddLabelColor]:{up:({propsForNextShape:e,...t})=>({...t,propsForNextShape:{...e,labelColor:"black"}}),down:e=>{const{labelColor:t,...n}=e.propsForNextShape;return{...e,propsForNextShape:{...n}}}},[rr.AddFollowingUserId]:{up:e=>({...e,followingUserId:null}),down:({followingUserId:e,...t})=>t},[rr.RemoveAlignJustify]:{up:e=>{let t=e.propsForNextShape.align;return t==="justify"&&(t="start"),{...e,propsForNextShape:{...e.propsForNextShape,align:t}}},down:e=>({...e})},[rr.AddZoom]:{up:e=>({...e,zoomBrush:null}),down:({zoomBrush:e,...t})=>t},[rr.AddVerticalAlign]:{up:e=>({...e,propsForNextShape:{...e.propsForNextShape,verticalAlign:"middle"}}),down:e=>{const{verticalAlign:t,...n}=e.propsForNextShape;return{...e,propsForNextShape:n}}},[rr.AddScribbleDelay]:{up:e=>e.scribble!==null?{...e,scribble:{...e.scribble,delay:0}}:{...e},down:e=>{if(e.scribble!==null){const{delay:t,...n}=e.scribble;return{...e,scribble:n}}return{...e}}},[rr.RemoveUserId]:{up:({userId:e,...t})=>t,down:e=>({...e,userId:"user:none"})},[rr.AddIsPenModeAndIsGridMode]:{up:e=>({...e,isPenMode:!1,isGridMode:!1}),down:({isPenMode:e,isGridMode:t,...n})=>n},[rr.HoistOpacity]:{up:({propsForNextShape:{opacity:e,...t},...n})=>({...n,opacityForNextShape:Number(e??"1"),propsForNextShape:t}),down:({opacityForNextShape:e,...t})=>({...t,propsForNextShape:{...t.propsForNextShape,opacity:e<.175?"0.1":e<.375?"0.25":e<.625?"0.5":e<.875?"0.75":"1"}})}}}),by=Go("instance",{migrations:bK,validator:xK,scope:"session"}).withDefaultProperties(()=>({followingUserId:null,opacityForNextShape:1,propsForNextShape:{color:"black",labelColor:"black",dash:"draw",fill:"none",size:"m",icon:"file",font:"draw",align:"middle",verticalAlign:"middle",geo:"rectangle",arrowheadStart:"none",arrowheadEnd:"arrow",spline:"line"},brush:null,scribble:null,cursor:{type:"default",color:"black",rotation:0},isFocusMode:!1,exportBackground:!1,isDebugMode:!1,isToolLocked:!1,screenBounds:{x:0,y:0,w:1080,h:720},zoomBrush:null,isGridMode:!1,isPenMode:!1})),ar=by.createId("instance"),wK=We.refine(e=>{if(!e.startsWith("page:")&&!e.startsWith("shape:"))throw new Error('Parent ID must start with "page:" or "shape:"');return e}),bi=Ai("shape");function br(e,t){return Ne({id:bi,typeName:vr("shape"),x:Be,y:Be,rotation:Be,index:We,parentId:wK,type:vr(e),isLocked:ot,opacity:KM,props:t})}const SK=Xo("instance_page_state",Ne({typeName:vr("instance_page_state"),id:Ai("instance_page_state"),pageId:Fd,selectedIds:Zi(bi),hintingIds:Zi(bi),erasingIds:Zi(bi),hoveredId:bi.nullable(),editingId:bi.nullable(),croppingId:bi.nullable(),focusLayerId:bi.nullable()})),yv={AddCroppingId:1,RemoveInstanceIdAndCameraId:2},_K=Qe({currentVersion:yv.RemoveInstanceIdAndCameraId,migrators:{[yv.AddCroppingId]:{up(e){return{...e,croppingId:null}},down({croppingId:e,...t}){return t}},[yv.RemoveInstanceIdAndCameraId]:{up({instanceId:e,cameraId:t,...n}){return n},down(e){return{...e,instanceId:ar,cameraId:$n.createId("void")}}}}}),An=Go("instance_page_state",{migrations:_K,validator:SK,scope:"session"}).withDefaultProperties(()=>({editingId:null,croppingId:null,selectedIds:[],hoveredId:null,erasingIds:[],hintingIds:[],focusLayerId:null})),CK=Xo("pointer",Ne({typeName:vr("pointer"),id:Ai("pointer"),x:Be,y:Be,lastActivityTimestamp:Be})),EK=Qe({}),KS=Go("pointer",{validator:CK,migrations:EK,scope:"session"}).withDefaultProperties(()=>({x:0,y:0,lastActivityTimestamp:0})),fb=KS.createId("pointer");function kK(e,t){return e.index<t.index?-1:e.index>t.index?1:0}function mk(e){e.typeName==="asset"&&("src"in e&&(e.src="<redacted>"),"src"in e.props&&(e.props.src="<redacted>"))}const TK=({error:e,phase:t,record:n,recordBefore:r})=>{throw MS(e,{tags:{origin:"store.validateRecord",storePhase:t,isExistingValidationIssue:t==="initialize"},extras:{recordBefore:r?mk(Ao(r)):void 0,recordAfter:mk(Ao(n))}}),e};function PK(){return[ei.create({name:"Page 1",index:"a1"})]}function IK(e){const t=e.query.ids("page"),n=()=>{if(!e.has(hb))return e.put([WS.create({id:hb,name:e.props.defaultName})]),n();if(!e.has(fb))return e.put([KS.create({id:fb})]),n();const r=t.value;if(r.size===0)return e.put(PK()),n();const i=()=>[...r].map(l=>e.get(l)).sort(kK)[0].id,o=e.get(ar);if(o){if(!r.has(o.currentPageId))return e.put([{...o,currentPageId:i()}]),n()}else return e.put([by.create({id:ar,currentPageId:i(),exportBackground:!0})]),n();const s=new Set,a=new Set;for(const l of r){const c=An.createId(l);e.has(c)||s.add(c);const u=$n.createId(l);e.has(u)||a.add(u)}s.size>0&&e.put([...s].map(l=>An.create({id:l,pageId:An.parseId(l)}))),a.size>0&&e.put([...a].map(l=>$n.create({id:l})))};return n}const wy=Ai("asset");function VS(e,t){return Ne({id:wy,typeName:vr("asset"),type:vr(e),props:t})}const $K=VS("bookmark",Ne({title:We,description:We,image:We,src:We.nullable()})),AK=Qe({}),MK=VS("image",Ne({w:Be,h:Be,name:We,isAnimated:ot,mimeType:We.nullable(),src:We.nullable()})),vv={AddIsAnimated:1,RenameWidthHeight:2},OK=Qe({currentVersion:vv.RenameWidthHeight,migrators:{[vv.AddIsAnimated]:{up:e=>({...e,props:{...e.props,isAnimated:!1}}),down:e=>{const{isAnimated:t,...n}=e.props;return{...e,props:n}}},[vv.RenameWidthHeight]:{up:e=>{const{width:t,height:n,...r}=e.props;return{...e,props:{w:t,h:n,...r}}},down:e=>{const{w:t,h:n,...r}=e.props;return{...e,props:{width:t,height:n,...r}}}}}}),LK=VS("video",Ne({w:Be,h:Be,name:We,isAnimated:ot,mimeType:We.nullable(),src:We.nullable()})),xv={AddIsAnimated:1,RenameWidthHeight:2},BK=Qe({currentVersion:xv.RenameWidthHeight,migrators:{[xv.AddIsAnimated]:{up:e=>({...e,props:{...e.props,isAnimated:!1}}),down:e=>{const{isAnimated:t,...n}=e.props;return{...e,props:n}}},[xv.RenameWidthHeight]:{up:e=>{const{width:t,height:n,...r}=e.props;return{...e,props:{w:t,h:n,...r}}},down:e=>{const{w:t,h:n,...r}=e.props;return{...e,props:{width:t,height:n,...r}}}}}}),RK=Xo("instance_presence",Ne({typeName:vr("instance_presence"),id:Ai("instance_presence"),userId:We,userName:We,lastActivityTimestamp:Be,followingUserId:We.nullable(),cursor:Ne({x:Be,y:Be,type:NM,rotation:Be}),color:We,camera:Ne({x:Be,y:Be,z:Be}),screenBounds:cd,selectedIds:Zi(Ai("shape")),currentPageId:Ai("page"),brush:cd.nullable(),scribble:jM.nullable()})),bv={AddScribbleDelay:1,RemoveInstanceId:2},DK=Qe({currentVersion:bv.RemoveInstanceId,migrators:{[bv.AddScribbleDelay]:{up:e=>e.scribble!==null?{...e,scribble:{...e.scribble,delay:0}}:{...e},down:e=>{if(e.scribble!==null){const{delay:t,...n}=e.scribble;return{...e,scribble:n}}return{...e}}},[bv.RemoveInstanceId]:{up:({instanceId:e,...t})=>t,down:e=>({...e,instanceId:ar})}}}),FK=Go("instance_presence",{migrations:DK,validator:RK,scope:"presence"}).withDefaultProperties(()=>({lastActivityTimestamp:0,followingUserId:null,color:"#FF0000",camera:{x:0,y:0,z:1},cursor:{x:0,y:0,type:"default",rotation:0},screenBounds:{x:0,y:0,w:1,h:1},selectedIds:[],brush:null,scribble:null})),NK=Xo("asset",US("type",{image:MK,video:LK,bookmark:$K})),jK=Qe({subTypeKey:"type",subTypeMigrations:{image:OK,video:BK,bookmark:AK}}),Oh=Go("asset",{migrations:jK,validator:NK,scope:"document"}),wv={AddIsLocked:1,HoistOpacity:2},Sv=Qe({currentVersion:wv.HoistOpacity,migrators:{[wv.AddIsLocked]:{up:e=>({...e,isLocked:!1}),down:e=>{const{isLocked:t,...n}=e;return{...n}}},[wv.HoistOpacity]:{up:({props:{opacity:e,...t},...n})=>({...n,opacity:Number(e??"1"),props:t}),down:({opacity:e,...t})=>({...t,props:{...t.props,opacity:e<.175?"0.1":e<.375?"0.25":e<.625?"0.5":e<.875?"0.75":"1"}})}}});function Aa(e){return e?e.typeName==="shape":!1}function Vr(e){return e?e.startsWith("shape:"):!1}function gt(e){return`shape:${e??$h()}`}const yk=US("type",{binding:Ne({type:vr("binding"),boundShapeId:bi,normalizedAnchor:Dd,isExact:ot}),point:Ne({type:vr("point"),x:Be,y:Be})}),zK=br("arrow",Ne({labelColor:si,color:si,fill:xy,dash:qc,size:Zo,arrowheadStart:em,arrowheadEnd:em,font:Mh,start:yk,end:yk,bend:Be,text:We})),vk={AddLabelColor:1},UK=Qe({currentVersion:vk.AddLabelColor,migrators:{[vk.AddLabelColor]:{up:e=>({...e,props:{...e.props,labelColor:"black"}}),down:e=>{const{labelColor:t,...n}=e.props;return{...e,props:n}}}}}),WK=br("bookmark",Ne({w:yr,h:yr,assetId:wy.nullable(),url:We})),xk={NullAssetId:1},HK=Qe({currentVersion:xk.NullAssetId,migrators:{[xk.NullAssetId]:{up:e=>e.props.assetId===void 0?{...e,props:{...e.props,assetId:null}}:e,down:e=>{if(e.props.assetId===null){const{assetId:t,...n}=e.props;return{...e,props:n}}return e}}}}),KK=new Set(["free","straight"]),YM=Ne({type:wn(KK),points:Zi(Dd)}),VK=br("draw",Ne({color:si,fill:xy,dash:qc,size:Zo,segments:Zi(YM),isComplete:ot,isClosed:ot,isPen:ot})),bk={AddInPen:1},YK=Qe({currentVersion:bk.AddInPen,migrators:{[bk.AddInPen]:{up:e=>{const{points:t}=e.props.segments[0];if(t.length===0)return{...e,props:{...e.props,isPen:!1}};let n=!(t[0].z===0||t[0].z===.5);return t[1]&&(n=n&&!(t[1].z===0||t[1].z===.5)),{...e,props:{...e.props,isPen:n}}},down:e=>{const{isPen:t,...n}=e.props;return{...e,props:{...n}}}}}}),wk=/(^\/r\/[^/]+\/?$)/,dt=e=>{try{return new URL(e)}catch{return}},Pc=[{type:"tldraw",title:"tldraw",hostnames:["beta.tldraw.com","lite.tldraw.com","www.tldraw.com"],minWidth:300,minHeight:300,width:720,height:500,doesResize:!0,toEmbedUrl:e=>{const t=dt(e);if(t&&t.pathname.match(wk))return e},fromEmbedUrl:e=>{const t=dt(e);if(t&&t.pathname.match(wk))return e}},{type:"codesandbox",title:"CodeSandbox",hostnames:["codesandbox.io"],minWidth:300,minHeight:300,width:720,height:500,doesResize:!0,toEmbedUrl:e=>{const t=dt(e),n=t&&t.pathname.match(/\/s\/([^/]+)\/?/);if(n)return`https://codesandbox.io/embed/${n[1]}`},fromEmbedUrl:e=>{const t=dt(e),n=t&&t.pathname.match(/\/embed\/([^/]+)\/?/);if(n)return`https://codesandbox.io/s/${n[1]}`}},{type:"codepen",title:"Codepen",hostnames:["codepen.io"],minWidth:300,minHeight:300,width:520,height:400,doesResize:!0,toEmbedUrl:e=>{const t=/https:\/\/codepen.io\/([^/]+)\/pen\/([^/]+)/,n=e.match(t);if(n){const[r,i,o]=n;return`https://codepen.io/${i}/embed/${o}`}},fromEmbedUrl:e=>{const t=/https:\/\/codepen.io\/([^/]+)\/embed\/([^/]+)/,n=e.match(t);if(n){const[r,i,o]=n;return`https://codepen.io/${i}/pen/${o}`}}},{type:"scratch",title:"Scratch",hostnames:["scratch.mit.edu"],width:520,height:400,doesResize:!1,toEmbedUrl:e=>{const t=/https?:\/\/scratch.mit.edu\/projects\/([^/]+)/,n=e.match(t);if(n){const[r,i]=n;return`https://scratch.mit.edu/projects/embed/${i}`}},fromEmbedUrl:e=>{const t=/https:\/\/scratch.mit.edu\/projects\/embed\/([^/]+)/,n=e.match(t);if(n){const[r,i]=n;return`https://scratch.mit.edu/projects/${i}`}}},{type:"youtube",title:"YouTube",hostnames:["*.youtube.com","youtube.com","youtu.be"],width:800,height:450,doesResize:!0,overridePermissions:{"allow-presentation":!0},isAspectRatioLocked:!0,toEmbedUrl:e=>{const t=dt(e);if(!t)return;const n=t.hostname.replace(/^www./,"");if(n==="youtu.be")return`https://www.youtube.com/embed/${t.pathname.split("/").filter(Boolean)[0]}`;if((n==="youtube.com"||n==="m.youtube.com")&&t.pathname.match(/^\/watch/))return`https://www.youtube.com/embed/${t.searchParams.get("v")}`},fromEmbedUrl:e=>{const t=dt(e);if(!t)return;if(t.hostname.replace(/^www./,"")==="youtube.com"){const r=t.pathname.match(/^\/embed\/([^/]+)\/?/);if(r)return`https://www.youtube.com/watch?v=${r[1]}`}}},{type:"figma",title:"Figma",hostnames:["figma.com"],width:720,height:500,doesResize:!0,toEmbedUrl:e=>{if(e.match(/https:\/\/([\w\.-]+\.)?figma.com\/(file|proto)\/([0-9a-zA-Z]{22,128})(?:\/.*)?$/)&&!e.includes("figma.com/embed"))return`https://www.figma.com/embed?embed_host=share&url=${e}`},fromEmbedUrl:e=>{const t=dt(e);if(t&&t.pathname.match(/^\/embed\/?$/)){const n=t.searchParams.get("url");if(n)return n}}},{type:"google_maps",title:"Google Maps",hostnames:["google.*"],width:720,height:500,doesResize:!0,toEmbedUrl:e=>{if(e.includes("/maps/")){const t=e.match(/@(.*),(.*),(.*)z/);let n;if(t){const[,r,i,o]=t;n=`https://${new URL(e).host.replace("www.","")}/maps/embed/v1/view?key=${{}.NEXT_PUBLIC_GC_API_KEY}&center=${r},${i}&zoom=${o}`}else n="";return n}},fromEmbedUrl:e=>{const t=dt(e);if(!t)return;if(t.pathname.match(/^\/maps\/embed\/v1\/view\/?$/)&&t.searchParams.has("center")&&t.searchParams.get("zoom")){const r=t.searchParams.get("zoom"),[i,o]=t.searchParams.get("center").split(",");return`https://www.google.com/maps/@${i},${o},${r}z`}}},{type:"google_calendar",title:"Google Calendar",hostnames:["calendar.google.*"],width:720,height:500,minWidth:460,minHeight:360,doesResize:!0,instructionLink:"https://support.google.com/calendar/answer/41207?hl=en",toEmbedUrl:e=>{const t=dt(e),n=t==null?void 0:t.searchParams.get("cid");if(t!=null&&t.pathname.match(/\/calendar\/u\/0/)&&n){t.pathname="/calendar/embed";const r=Array.from(t.searchParams.keys());for(const i of r)t.searchParams.delete(i);return t.searchParams.set("src",n),t.href}},fromEmbedUrl:e=>{const t=dt(e),n=t==null?void 0:t.searchParams.get("src");if(t!=null&&t.pathname.match(/\/calendar\/embed/)&&n){t.pathname="/calendar/u/0";const r=Array.from(t.searchParams.keys());for(const i of r)t.searchParams.delete(i);return t.searchParams.set("cid",n),t.href}}},{type:"google_slides",title:"Google Slides",hostnames:["docs.google.*"],width:720,height:500,minWidth:460,minHeight:360,doesResize:!0,toEmbedUrl:e=>{const t=dt(e);if(t!=null&&t.pathname.match(/^\/presentation/)&&(t!=null&&t.pathname.match(/\/pub\/?$/))){t.pathname=t.pathname.replace(/\/pub$/,"/embed");const n=Array.from(t.searchParams.keys());for(const r of n)t.searchParams.delete(r);return t.href}},fromEmbedUrl:e=>{const t=dt(e);if(t!=null&&t.pathname.match(/^\/presentation/)&&(t!=null&&t.pathname.match(/\/embed\/?$/))){t.pathname=t.pathname.replace(/\/embed$/,"/pub");const n=Array.from(t.searchParams.keys());for(const r of n)t.searchParams.delete(r);return t.href}}},{type:"github_gist",title:"GitHub Gist",hostnames:["gist.github.com"],width:720,height:500,doesResize:!0,toEmbedUrl:e=>{const t=dt(e);if(t&&t.pathname.match(/\/([^/]+)\/([^/]+)/))return e},fromEmbedUrl:e=>{const t=dt(e);if(t&&t.pathname.match(/\/([^/]+)\/([^/]+)/))return e}},{type:"replit",title:"Replit",hostnames:["replit.com"],width:720,height:500,doesResize:!0,toEmbedUrl:e=>{const t=dt(e);if(t&&t.pathname.match(/\/@([^/]+)\/([^/]+)/))return`${e}?embed=true`},fromEmbedUrl:e=>{const t=dt(e);if(t&&t.pathname.match(/\/@([^/]+)\/([^/]+)/)&&t.searchParams.has("embed"))return t.searchParams.delete("embed"),t.href}},{type:"felt",title:"Felt",hostnames:["felt.com"],width:720,height:500,doesResize:!0,toEmbedUrl:e=>{const t=dt(e);if(t&&t.pathname.match(/^\/map\//))return t.origin+"/embed"+t.pathname},fromEmbedUrl:e=>{const t=dt(e);if(t&&t.pathname.match(/^\/embed\/map\//))return t.pathname=t.pathname.replace(/^\/embed/,""),t.href}},{type:"spotify",title:"Spotify",hostnames:["open.spotify.com"],width:720,height:500,minHeight:500,overrideOutlineRadius:12,doesResize:!0,toEmbedUrl:e=>{const t=dt(e);if(t&&t.pathname.match(/^\/(artist|album)\//))return t.origin+"/embed"+t.pathname},fromEmbedUrl:e=>{const t=dt(e);if(t&&t.pathname.match(/^\/embed\/(artist|album)\//))return t.origin+t.pathname.replace(/^\/embed/,"")}},{type:"vimeo",title:"Vimeo",hostnames:["vimeo.com","player.vimeo.com"],width:640,height:360,doesResize:!0,isAspectRatioLocked:!0,toEmbedUrl:e=>{const t=dt(e);if(t&&t.hostname==="vimeo.com"&&t.pathname.match(/^\/[0-9]+/))return"https://player.vimeo.com/video/"+t.pathname.split("/")[1]+"?title=0&byline=0"},fromEmbedUrl:e=>{const t=dt(e);if(t&&t.hostname==="player.vimeo.com"){const n=t.pathname.match(/^\/video\/([^/]+)\/?$/);if(n)return"https://vimeo.com/"+n[1]}}},{type:"excalidraw",title:"Excalidraw",hostnames:["excalidraw.com"],width:720,height:500,doesResize:!0,isAspectRatioLocked:!0,toEmbedUrl:e=>{const t=dt(e);if(t&&t.hash.match(/#room=/))return e},fromEmbedUrl:e=>{const t=dt(e);if(t&&t.hash.match(/#room=/))return e}},{type:"observable",title:"Observable",hostnames:["observablehq.com"],width:720,height:500,doesResize:!0,isAspectRatioLocked:!1,backgroundColor:"#fff",toEmbedUrl:e=>{const t=dt(e);if(t&&t.pathname.match(/^\/@([^/]+)\/([^/]+)\/?$/))return`${t.origin}/embed${t.pathname}?cell=*`;if(t&&t.pathname.match(/^\/d\/([^/]+)\/?$/)){const n=t.pathname.replace(/^\/d/,"");return`${t.origin}/embed${n}?cell=*`}},fromEmbedUrl:e=>{const t=dt(e);if(t&&t.pathname.match(/^\/embed\/@([^/]+)\/([^/]+)\/?$/))return`${t.origin}${t.pathname.replace("/embed","")}#cell-*`;if(t&&t.pathname.match(/^\/embed\/([^/]+)\/?$/))return`${t.origin}${t.pathname.replace("/embed","/d")}#cell-*`}}],qM={"allow-downloads-without-user-activation":!1,"allow-downloads":!1,"allow-modals":!1,"allow-orientation-lock":!1,"allow-pointer-lock":!1,"allow-popups":!0,"allow-popups-to-escape-sandbox":!1,"allow-presentation":!1,"allow-storage-access-by-user-activation":!1,"allow-top-navigation":!1,"allow-top-navigation-by-user-activation":!1,"allow-scripts":!0,"allow-same-origin":!0,"allow-forms":!0},qK=br("embed",Ne({w:yr,h:yr,url:We,tmpOldUrl:We.optional(),doesResize:ot,overridePermissions:DM(wn(new Set(Object.keys(qM))),ot.optional()).optional()})),Sk={GenOriginalUrlInEmbed:1},GK=Qe({currentVersion:Sk.GenOriginalUrlInEmbed,migrators:{[Sk.GenOriginalUrlInEmbed]:{up:e=>{const t=e.props.url,n=new URL(t).host.replace("www.","");let r;for(const i of Pc)if(i.hostnames.includes(n))try{r=i.fromEmbedUrl(t)}catch(o){console.warn(o)}return{...e,props:{...e.props,tmpOldUrl:e.props.url,url:r??""}}},down:e=>{let t=e.props.tmpOldUrl;if(!t||t===""){const i=e.props.url,o=new URL(i).host.replace("www.","");for(const s of Pc)if(s.hostnames.includes(o))try{t=s.toEmbedUrl(i)}catch(a){console.warn(a)}}const{tmpOldUrl:n,...r}=e.props;return{...e,props:{...r,url:t??""}}}}}}),XK=br("frame",Ne({w:yr,h:yr,name:We})),ZK=Qe({}),QK=br("geo",Ne({geo:WM,labelColor:si,color:si,fill:xy,dash:qc,size:Zo,font:Mh,align:vy,verticalAlign:HS,url:We,w:yr,h:yr,growY:zS,text:We})),ma={AddUrlProp:1,AddLabelColor:2,RemoveJustify:3,AddCheckBox:4,AddVerticalAlign:5,MigrateLegacyAlign:6},JK=Qe({currentVersion:ma.MigrateLegacyAlign,migrators:{[ma.AddUrlProp]:{up:e=>({...e,props:{...e.props,url:""}}),down:e=>{const{url:t,...n}=e.props;return{...e,props:n}}},[ma.AddLabelColor]:{up:e=>({...e,props:{...e.props,labelColor:"black"}}),down:e=>{const{labelColor:t,...n}=e.props;return{...e,props:n}}},[ma.RemoveJustify]:{up:e=>{let t=e.props.align;return t==="justify"&&(t="start"),{...e,props:{...e.props,align:t}}},down:e=>({...e})},[ma.AddCheckBox]:{up:e=>({...e}),down:e=>({...e,props:{...e.props,geo:e.props.geo==="check-box"?"rectangle":e.props.geo}})},[ma.AddVerticalAlign]:{up:e=>({...e,props:{...e.props,verticalAlign:"middle"}}),down:e=>{const{verticalAlign:t,...n}=e.props;return{...e,props:n}}},[ma.MigrateLegacyAlign]:{up:e=>{let t;switch(e.props.align){case"start":t="start-legacy";break;case"end":t="end-legacy";break;default:t="middle-legacy";break}return{...e,props:{...e.props,align:t}}},down:e=>{let t;switch(e.props.align){case"start-legacy":t="start";break;case"end-legacy":t="end";break;case"middle-legacy":t="middle";break;default:t=e.props.align}return{...e,props:{...e.props,align:t}}}}}}),eV=br("group",Ne({})),tV=Qe({}),nV=br("highlight",Ne({color:si,size:Zo,segments:Zi(YM),isComplete:ot,isPen:ot})),rV=Qe({}),iV=Ne({topLeft:Dd,bottomRight:Dd}),oV=br("image",Ne({w:yr,h:yr,playing:ot,url:We,assetId:wy.nullable(),crop:iV.nullable()})),_v={AddUrlProp:1,AddCropProp:2},sV=Qe({currentVersion:_v.AddCropProp,migrators:{[_v.AddUrlProp]:{up:e=>({...e,props:{...e.props,url:""}}),down:e=>{const{url:t,...n}=e.props;return{...e,props:n}}},[_v.AddCropProp]:{up:e=>({...e,props:{...e.props,crop:null}}),down:e=>{const{crop:t,...n}=e.props;return{...e,props:n}}}}}),aV=new Set(["vertex","virtual","create"]),lV=Ne({id:We,type:wn(aV),canBind:ot.optional(),index:We,x:Be,y:Be}),cV=br("line",Ne({color:si,dash:qc,size:Zo,spline:VM,handles:DM(We,lV)})),uV=Qe({}),dV=br("note",Ne({color:si,size:Zo,font:Mh,align:vy,verticalAlign:HS,growY:zS,url:We,text:We})),_u={AddUrlProp:1,RemoveJustify:2,MigrateLegacyAlign:3,AddVerticalAlign:4},hV=Qe({currentVersion:_u.AddVerticalAlign,migrators:{[_u.AddUrlProp]:{up:e=>({...e,props:{...e.props,url:""}}),down:e=>{const{url:t,...n}=e.props;return{...e,props:n}}},[_u.RemoveJustify]:{up:e=>{let t=e.props.align;return t==="justify"&&(t="start"),{...e,props:{...e.props,align:t}}},down:e=>({...e})},[_u.MigrateLegacyAlign]:{up:e=>{let t;switch(e.props.align){case"start":t="start-legacy";break;case"end":t="end-legacy";break;default:t="middle-legacy";break}return{...e,props:{...e.props,align:t}}},down:e=>{let t;switch(e.props.align){case"start-legacy":t="start";break;case"end-legacy":t="end";break;case"middle-legacy":t="middle";break;default:t=e.props.align}return{...e,props:{...e.props,align:t}}}},[_u.AddVerticalAlign]:{up:e=>({...e,props:{...e.props,verticalAlign:"middle"}}),down:e=>{const{verticalAlign:t,...n}=e.props;return{...e,props:n}}}}}),fV=br("text",Ne({color:si,size:Zo,font:Mh,align:vy,w:yr,text:We,scale:yr,autoSize:ot})),_k={RemoveJustify:1},pV=Qe({currentVersion:_k.RemoveJustify,migrators:{[_k.RemoveJustify]:{up:e=>{let t=e.props.align;return t==="justify"&&(t="start"),{...e,props:{...e.props,align:t}}},down:e=>({...e})}}}),gV=br("video",Ne({w:yr,h:yr,time:Be,playing:ot,url:We,assetId:wy.nullable()})),Ck={AddUrlProp:1},mV=Qe({currentVersion:Ck.AddUrlProp,migrators:{[Ck.AddUrlProp]:{up:e=>({...e,props:{...e.props,url:""}}),down:e=>{const{url:t,...n}=e.props;return{...e,props:n}}}}}),Cu={RemoveCodeAndIconShapeTypes:1,AddInstancePresenceType:2,RemoveTLUserAndPresenceAndAddPointer:3,RemoveUserDocument:4},yV=Qe({currentVersion:Cu.RemoveUserDocument,migrators:{[Cu.RemoveCodeAndIconShapeTypes]:{up:e=>Object.fromEntries(Object.entries(e).filter(([t,n])=>n.typeName!=="shape"||n.type!=="icon"&&n.type!=="code")),down:e=>e},[Cu.AddInstancePresenceType]:{up:e=>e,down:e=>Object.fromEntries(Object.entries(e).filter(([t,n])=>n.typeName!=="instance_presence"))},[Cu.RemoveTLUserAndPresenceAndAddPointer]:{up:e=>Object.fromEntries(Object.entries(e).filter(([t,n])=>!n.typeName.match(/^(user|user_presence)$/))),down:e=>Object.fromEntries(Object.entries(e).filter(([t,n])=>n.typeName!=="pointer"))},[Cu.RemoveUserDocument]:{up:e=>Object.fromEntries(Object.entries(e).filter(([t,n])=>!n.typeName.match("user_document"))),down:e=>e}}}),Ek={group:{migrations:tV,validator:eV},bookmark:{migrations:HK,validator:WK},embed:{migrations:GK,validator:qK},image:{migrations:sV,validator:oV},text:{migrations:pV,validator:fV},video:{migrations:mV,validator:gV}},vV={arrow:{migrations:UK,validator:zK},draw:{migrations:YK,validator:VK},frame:{migrations:ZK,validator:XK},geo:{migrations:JK,validator:QK},line:{migrations:uV,validator:cV},note:{migrations:hV,validator:dV},highlight:{migrations:rV,validator:nV}};function xV(e={}){const{customShapes:t}=e;for(const i in t)if(i in Ek)throw Error(`Can't override default shape ${i}!`);const n=Object.entries({...Ek,...vV,...t}),r=Go("shape",{migrations:Qe({currentVersion:Sv.currentVersion,firstVersion:Sv.firstVersion,migrators:Sv.migrators,subTypeKey:"type",subTypeMigrations:{...Object.fromEntries(n.map(([i,o])=>[i,o.migrations??Qe({})]))}}),scope:"document",validator:Xo("shape",US("type",{...Object.fromEntries(n.map(([i,o])=>[i,o.validator??XH]))}))}).withDefaultProperties(()=>({x:0,y:0,rotation:0,isLocked:!1,opacity:1}));return FS.create({asset:Oh,camera:$n,document:WS,instance:by,instance_page_state:An,page:ei,shape:r,instance_presence:FK,pointer:KS},{snapshotMigrations:yV,onValidationFailure:TK,createIntegrityChecker:IK})}br("icon",Ne({size:Zo,icon:HM,dash:qc,color:si,scale:Be}));Qe({});const Nd=[{locale:"ar",label:"عربي"},{locale:"ca",label:"Català"},{locale:"da",label:"Danish"},{locale:"de",label:"Deutsch"},{locale:"en",label:"English"},{locale:"es",label:"Español"},{locale:"fa",label:"فارسی"},{locale:"fi",label:"Suomi"},{locale:"fr",label:"Français"},{locale:"gl",label:"Galego"},{locale:"he",label:"עברית"},{locale:"it",label:"Italiano"},{locale:"ja",label:"日本語"},{locale:"ko-kr",label:"한국어"},{locale:"ku",label:"کوردی"},{locale:"hi-in",label:"हिन्दी"},{locale:"hu",label:"Magyar"},{locale:"my",label:"မြန်မာစာ"},{locale:"ne",label:"नेपाली"},{locale:"no",label:"Norwegian"},{locale:"pl",label:"Polski"},{locale:"pt-br",label:"Português - Brasil"},{locale:"pt-pt",label:"Português - Europeu"},{locale:"ro",label:"Română"},{locale:"ru",label:"Russian"},{locale:"sv",label:"Svenska"},{locale:"te",label:"తెలుగు"},{locale:"th",label:"ภาษาไทย"},{locale:"tr",label:"Türkçe"},{locale:"uk",label:"Ukrainian"},{locale:"vi",label:"Tiếng Việt"},{locale:"zh-cn",label:"Chinese - Simplified"},{locale:"zh-tw",label:"繁體中文 (台灣)"}];function bV(){const e=typeof window<"u"?window.navigator.languages??["en"]:["en"];return wV(e)}function wV(e){for(const t of e){const n=SV(t);if(n)return n}return"en"}const kk={zh:"zh-cn",pt:"pt-br",ko:"ko-kr",hi:"hi-in"};function SV(e){const t=Nd.find(i=>i.locale===e.toLowerCase());if(t)return t.locale;const[n,r]=e.split(/[-_]/).map(i=>i.toLowerCase());if(r){const i=Nd.find(o=>o.locale===n);if(i)return i.locale}return n in kk?kk[n]:null}const Nf="2.0.0-canary.f2e95988e03c";let GM={fonts:{draw:`https://unpkg.com/@tldraw/assets@${Nf}/fonts/Shantell_Sans-Normal-SemiBold.woff2`,serif:`https://unpkg.com/@tldraw/assets@${Nf}/fonts/IBMPlexSerif-Medium.woff2`,sansSerif:`https://unpkg.com/@tldraw/assets@${Nf}/fonts/IBMPlexSans-Medium.woff2`,monospace:`https://unpkg.com/@tldraw/assets@${Nf}/fonts/IBMPlexMono-Medium.woff2`}};var XM={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(e){(function(){var t={}.hasOwnProperty;function n(){for(var r=[],i=0;i<arguments.length;i++){var o=arguments[i];if(o){var s=typeof o;if(s==="string"||s==="number")r.push(o);else if(Array.isArray(o)){if(o.length){var a=n.apply(null,o);a&&r.push(a)}}else if(s==="object"){if(o.toString!==Object.prototype.toString&&!o.toString.toString().includes("[native code]")){r.push(o.toString());continue}for(var l in o)t.call(o,l)&&o[l]&&r.push(l)}}}return r.join(" ")}e.exports?(n.default=n,e.exports=n):window.classNames=n})()})(XM);var _V=XM.exports;const Me=rl(_V);function Sy(e,t){const n=ke.useRef(t);n.current=t;const[r,i,o]=ke.useMemo(()=>{let s=null;const a=u=>(s=u,()=>{s=null}),l=new Ah(`useStateTracking(${e})`,()=>{var u;return(u=n.current)==null?void 0:u.call(n)},{scheduleEffect(){s==null||s()}});return[l,a,()=>l.scheduleCount]},[e]);return ke.useSyncExternalStore(i,o,o),ke.useEffect(()=>(r.attach(),r.maybeScheduleEffect(),()=>{r.detach()}),[r]),r.execute()}var Tk={apply(e,t,n){return Sy(e.displayName??e.name??"tracked(???)",()=>e.apply(t,n))}},CV=Symbol.for("react.memo"),EV=Symbol.for("react.forward_ref");function Ke(e){let t=null;const n=e.$$typeof;return n===CV&&(e=e.type,t=e.compare),n===EV?b.memo(b.forwardRef(new Proxy(e.render,Tk))):b.memo(new Proxy(e,Tk),t)}function kV(){const e=arguments[0],t=arguments[1],n=arguments.length===3?void 0:arguments[2],r=arguments.length===3?arguments[2]:arguments[3];return b.useMemo(()=>ce(`useComputed(${e})`,t,n),r)}function ye(){const e=arguments,t=e.length===3?e[2]:[e[0]],n=e.length===3?e[0]:`useValue(${e[0].name})`,r=b.useRef(!0);r.current=!0;const i=b.useMemo(()=>e.length===1?e[0]:ce(n,()=>{if(r.current)return e[1]();try{return e[1]()}catch{return{}}}),t);try{const{subscribe:o,getSnapshot:s}=b.useMemo(()=>({subscribe:a=>my(`useValue(${n})`,()=>{i.value,a()}),getSnapshot:()=>i.value}),[i]);return b.useSyncExternalStore(o,s,s)}finally{r.current=!1}}const YS=ke.createContext({}),re=()=>ke.useContext(YS),qS={openWindow:(e,t)=>window.open(e,t,"noopener noreferrer"),refreshPage:()=>window.location.reload(),hardReset:async()=>{var e;return await((e=window.__tldraw__hardReset)==null?void 0:e.call(window))}};function ZM(){qS.hardReset()}function TV(){qS.refreshPage()}const Bn={linear:e=>e,easeInQuad:e=>e*e,easeOutQuad:e=>e*(2-e),easeInOutQuad:e=>e<.5?2*e*e:-1+(4-2*e)*e,easeInCubic:e=>e*e*e,easeOutCubic:e=>--e*e*e+1,easeInOutCubic:e=>e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1,easeInQuart:e=>e*e*e*e,easeOutQuart:e=>1- --e*e*e*e,easeInOutQuart:e=>e<.5?8*e*e*e*e:1-8*--e*e*e*e,easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>1+--e*e*e*e*e,easeInOutQuint:e=>e<.5?16*e*e*e*e*e:1+16*--e*e*e*e*e,easeInSine:e=>1-Math.cos(e*Math.PI/2),easeOutSine:e=>Math.sin(e*Math.PI/2),easeInOutSine:e=>-(Math.cos(Math.PI*e)-1)/2,easeInExpo:e=>e<=0?0:Math.pow(2,10*e-10),easeOutExpo:e=>e>=1?1:1-Math.pow(2,-10*e),easeInOutExpo:e=>e<=0?0:e>=1?1:e<.5?Math.pow(2,20*e-10)/2:(2-Math.pow(2,-20*e+10))/2};class E{constructor(t=0,n=0,r=1){this.x=t,this.y=n,this.z=r}get pressure(){return this.z}set(t=this.x,n=this.y,r=this.z){return this.x=t,this.y=n,this.z=r,this}setTo({x:t=0,y:n=0,z:r=1}){return this.x=t,this.y=n,this.z=r,this}rot(t){if(t===0)return this;const{x:n,y:r}=this,i=Math.sin(t),o=Math.cos(t);return this.x=n*o-r*i,this.y=n*i+r*o,this}rotWith(t,n){if(n===0)return this;const r=this.x-t.x,i=this.y-t.y,o=Math.sin(n),s=Math.cos(n);return this.x=t.x+(r*s-i*o),this.y=t.y+(r*o+i*s),this}clone(){const{x:t,y:n,z:r}=this;return new E(t,n,r)}sub(t){return this.x-=t.x,this.y-=t.y,this}subXY(t,n){return this.x-=t,this.y-=n,this}subScalar(t){return this.x-=t,this.y-=t,this}add(t){return this.x+=t.x,this.y+=t.y,this}addXY(t,n){return this.x+=t,this.y+=n,this}addScalar(t){return this.x+=t,this.y+=t,this}clamp(t,n){return this.x=Math.max(this.x,t),this.y=Math.max(this.y,t),n!==void 0&&(this.x=Math.min(this.x,n),this.y=Math.min(this.y,n)),this}div(t){return this.x/=t,this.y/=t,this}divV(t){return this.x/=t.x,this.y/=t.y,this}mul(t){return this.x*=t,this.y*=t,this}mulV(t){return this.x*=t.x,this.y*=t.y,this}abs(){return this.x=Math.abs(this.x),this.y=Math.abs(this.y),this}nudge(t,n){const r=E.Tan(t,this);return this.add(r.mul(n))}neg(){return this.x*=-1,this.y*=-1,this}cross(t){return this.x=this.y*t.z-this.z*t.y,this.y=this.z*t.x-this.x*t.z,this}dpr(t){return E.Dpr(this,t)}cpr(t){return E.Cpr(this,t)}len2(){return E.Len2(this)}len(){return E.Len(this)}pry(t){return E.Pry(this,t)}per(){const{x:t,y:n}=this;return this.x=n,this.y=-t,this}uni(){return E.Uni(this)}tan(t){return E.Tan(this,t)}dist(t){return E.Dist(this,t)}distanceToLineSegment(t,n){return E.DistanceToLineSegment(t,n,this)}slope(t){return E.Slope(this,t)}snapToGrid(t){return this.x=Math.round(this.x/t)*t,this.y=Math.round(this.y/t)*t,this}angle(t){return E.Angle(this,t)}toAngle(){return E.ToAngle(this)}lrp(t,n){return this.x=this.x+(t.x-this.x)*n,this.y=this.y+(t.y-this.y)*n,this}equals(t){return E.Equals(this,t)}equalsXY(t,n){return E.EqualsXY(this,t,n)}norm(){const t=this.len();return this.x=t===0?0:this.x/t,this.y=t===0?0:this.y/t,this}toFixed(){return E.ToFixed(this)}toString(){return E.ToString(E.ToFixed(this))}toJson(){return E.ToJson(this)}toArray(){return E.ToArray(this)}static Add(t,n){return new E(t.x+n.x,t.y+n.y)}static AddXY(t,n,r){return new E(t.x+n,t.y+r)}static Sub(t,n){return new E(t.x-n.x,t.y-n.y)}static SubXY(t,n,r){return new E(t.x-n,t.y-r)}static AddScalar(t,n){return new E(t.x+n,t.y+n)}static SubScalar(t,n){return new E(t.x-n,t.y-n)}static Div(t,n){return new E(t.x/n,t.y/n)}static Mul(t,n){return new E(t.x*n,t.y*n)}static DivV(t,n){return new E(t.x/n.x,t.y/n.y)}static MulV(t,n){return new E(t.x*n.x,t.y*n.y)}static Neg(t){return new E(-t.x,-t.y)}static Per(t){return new E(t.y,-t.x)}static Dist2(t,n){return E.Sub(t,n).len2()}static Abs(t){return new E(Math.abs(t.x),Math.abs(t.y))}static Dist(t,n){return Math.hypot(t.y-n.y,t.x-n.x)}static Dpr(t,n){return t.x*n.x+t.y*n.y}static Cross(t,n){return new E(t.y*n.z-t.z*n.y,t.z*n.x-t.x*n.z)}static Cpr(t,n){return t.x*n.y-n.x*t.y}static Len2(t){return t.x*t.x+t.y*t.y}static Len(t){return Math.sqrt(E.Len2(t))}static Pry(t,n){return E.Dpr(t,n)/E.Len(n)}static Uni(t){return E.Div(t,E.Len(t))}static Tan(t,n){return E.Uni(E.Sub(t,n))}static Min(t,n){return new E(Math.min(t.x,n.x),Math.min(t.y,n.y))}static Max(t,n){return new E(Math.max(t.x,n.x),Math.max(t.y,n.y))}static From({x:t,y:n,z:r=1}){return new E(t,n,r)}static FromArray(t){return new E(t[0],t[1])}static Rot(t,n=0){const r=Math.sin(n),i=Math.cos(n);return new E(t.x*i-t.y*r,t.x*r+t.y*i)}static RotWith(t,n,r){const i=t.x-n.x,o=t.y-n.y,s=Math.sin(r),a=Math.cos(r);return new E(n.x+(i*a-o*s),n.y+(i*s+o*a))}static NearestPointOnLineThroughPoint(t,n,r){return E.Mul(n,E.Sub(r,t).pry(n)).add(t)}static NearestPointOnLineSegment(t,n,r,i=!0){const o=E.Tan(n,t),s=E.Add(t,E.Mul(o,E.Sub(r,t).pry(o)));if(i){if(s.x<Math.min(t.x,n.x))return E.Cast(t.x<n.x?t:n);if(s.x>Math.max(t.x,n.x))return E.Cast(t.x>n.x?t:n);if(s.y<Math.min(t.y,n.y))return E.Cast(t.y<n.y?t:n);if(s.y>Math.max(t.y,n.y))return E.Cast(t.y>n.y?t:n)}return s}static DistanceToLineThroughPoint(t,n,r){return E.Dist(r,E.NearestPointOnLineThroughPoint(t,n,r))}static DistanceToLineSegment(t,n,r,i=!0){return E.Dist(r,E.NearestPointOnLineSegment(t,n,r,i))}static Snap(t,n=1){return new E(Math.round(t.x/n)*n,Math.round(t.y/n)*n)}static Cast(t){return t instanceof E?t:E.From(t)}static Slope(t,n){return t.x===n.y?NaN:(t.y-n.y)/(t.x-n.x)}static Angle(t,n){return Math.atan2(n.y-t.y,n.x-t.x)}static Lrp(t,n,r){return E.Sub(n,t).mul(r).add(t)}static Med(t,n){return new E((t.x+n.x)/2,(t.y+n.y)/2)}static Equals(t,n){return Math.abs(t.x-n.x)<1e-4&&Math.abs(t.y-n.y)<1e-4}static EqualsXY(t,n,r){return t.x===n&&t.y===r}static Clockwise(t,n,r){return(r.x-t.x)*(n.y-t.y)-(n.x-t.x)*(r.y-t.y)<0}static Rescale(t,n){const r=E.Len(t);return new E(n*t.x/r,n*t.y/r)}static ScaleWithOrigin(t,n,r){return E.Sub(t,r).mul(n).add(r)}static ToFixed(t,n=2){return new E(+t.x.toFixed(n),+t.y.toFixed(n),+t.z.toFixed(n))}static Nudge(t,n,r){return E.Add(t,E.Tan(n,t).mul(r))}static ToString(t){return`${t.x}, ${t.y}`}static ToAngle(t){let n=Math.atan2(t.y,t.x);return n<0&&(n+=Math.PI*2),n}static ToArray(t){return[t.x,t.y,t.z]}static ToJson(t){const{x:n,y:r,z:i}=t;return{x:n,y:r,z:i}}static Average(t){const n=t.length,r=new E(0,0);for(let i=0;i<n;i++)r.add(t[i]);return r.div(n)}static Clamp(t,n,r){return r===void 0?new E(Math.min(Math.max(t.x,n)),Math.min(Math.max(t.y,n))):new E(Math.min(Math.max(t.x,n),r),Math.min(Math.max(t.y,n),r))}static PointsBetween(t,n,r=6){const i=[];for(let o=0;o<r;o++){const s=Bn.easeInQuad(o/(r-1)),a=E.Lrp(t,n,s);a.z=Math.min(1,.5+Math.abs(.5-PV(s))*.65),i.push(a)}return i}static SnapToGrid(t,n=8){return new E(Math.round(t.x/n)*n,Math.round(t.y/n)*n)}}const PV=e=>e<.5?2*e*e:-1+(4-2*e)*e,Et=Math.PI,tt=Et/2,kt=Et*2,Pk=Math.PI/180,IV=Math.sin;function Ci(e,t,n){return Math.max(t,typeof n<"u"?Math.min(e,n):e)}function jf(e,t=1e10){return e?Math.round(e*t)/t:0}function ud(e,t,n=1e-6){return Math.abs(e-t)<=n}function jd(e,t){const n=Math.pow(e-t,2)/Math.pow(e+t,2);return Et*(e+t)*(1+3*n/(10+Math.sqrt(4-3*n)))}function GS(e){return e=e%kt,e<0?e=e+kt:e===0&&(e=0),e}function Ps(e,t){const n=(t-e)%kt;return 2*n%kt-n}function $V(e,t){return kt-Ps(e,t)}function ya(e,t,n){return e+Ps(e,t)*n}function QM(e,t){return Ps(e,t)}function AV(e,t,n){return QM(E.Angle(e,t),E.Angle(e,n))}function JM(e){return(kt+e)%kt}function tm(e,t){const n=kt/t;let r=Math.floor((JM(e)+n/2)/n)*n%kt;return r<Et&&(r+=kt),r>Et&&(r-=kt),r}function e5(e,t){return e===t||ud(e%(Math.PI/2)-t%(Math.PI/2),0)}function MV(e){return e*Et/180}function OV(e){return e*180/Et}function zf(e,t,n,r){const i=AV(e,n,r);return t*kt*(i/kt)}function Sa(e,t,n,r){return new E(e+n*Math.cos(r),t+n*Math.sin(r))}function Cv(e,t,n){const r=e/2,i=t/2,o=[];for(let s=0;s<n;s++){const a=kt/n,l=-tt+s*a;o.push(new E(r+r*Math.cos(l),i+i*Math.sin(l)))}return o}function Eu(e,t,n,r){return e<r&&n<t}function wi(e,t,n,r){const i=Math.max(e,n),o=Math.min(t,r);return i<=o?[i,o]:null}const LV=(e,t,n)=>{const r=kt/e/2,i=Math.floor(e/4)*2,o=e*2-i,s=0,a=Math.floor(e/2)*2,l=Math.cos(-tt+i*r)*t/2,c=Math.cos(-tt+o*r)*t/2,u=Math.sin(-tt+s*r)*n/2,d=Math.sin(-tt+a*r)*n/2;return new me(0,0,l-c,d-u)};function Ik(e,t,n){return(t.x-e.x)*(n.y-e.y)-(n.x-e.x)*(t.y-e.y)}function ai(e,t){let n=0,r,i;for(let o=0;o<t.length;o++)r=t[o],i=t[(o+1)%t.length],r.y<=e.y?i.y>e.y&&Ik(r,i,e)>0&&(n+=1):i.y<=e.y&&Ik(r,i,e)<0&&(n-=1);return n!==0}function BV(e,t,n=8){const r=t.length;for(let i=1;i<r;i++){const o=t[i-1],s=t[i];if(E.DistanceToLineSegment(o,s,e)<n)return!0}return!1}function Y(e){return+e.toFixed(4)}function nm(e){return+e.toFixed(2)}const $k=e=>Math.abs(e)<Number.MAX_SAFE_INTEGER,It=class It{constructor(t=0,n=0,r=0,i=0){v(this,"x",0);v(this,"y",0);v(this,"w",0);v(this,"h",0);this.x=t,this.y=n,this.w=r,this.h=i}get point(){return new E(this.x,this.y)}set point(t){this.x=t.x,this.y=t.y}get minX(){return this.x}set minX(t){this.x=t}get midX(){return this.x+this.w/2}get maxX(){return this.x+this.w}get minY(){return this.y}set minY(t){this.y=t}get midY(){return this.y+this.h/2}get maxY(){return this.y+this.h}get width(){return this.w}set width(t){this.w=t}get height(){return this.h}set height(t){this.h=t}get aspectRatio(){return this.width/this.height}get center(){return new E(this.midX,this.midY)}set center(t){this.minX=t.x-this.width/2,this.minY=t.y-this.height/2}get corners(){return[new E(this.minX,this.minY),new E(this.maxX,this.minY),new E(this.maxX,this.maxY),new E(this.minX,this.maxY)]}get snapPoints(){return[new E(this.minX,this.minY),new E(this.maxX,this.minY),new E(this.maxX,this.maxY),new E(this.minX,this.maxY),this.center]}get sides(){const{corners:t}=this;return[[t[0],t[1]],[t[1],t[2]],[t[2],t[3]],[t[3],t[0]]]}get size(){return new E(this.w,this.h)}toFixed(){return this.x=jf(this.x),this.y=jf(this.y),this.w=jf(this.w),this.h=jf(this.h),this}setTo(t){return this.x=t.x,this.y=t.y,this.w=t.w,this.h=t.h,this}set(t=0,n=0,r=0,i=0){return this.x=t,this.y=n,this.w=r,this.h=i,this}expand(t){const n=Math.min(this.minX,t.minX),r=Math.min(this.minY,t.minY),i=Math.max(this.maxX,t.maxX),o=Math.max(this.maxY,t.maxY);return this.x=n,this.y=r,this.w=i-n,this.h=o-r,this}expandBy(t){return this.x-=t,this.y-=t,this.w+=t*2,this.h+=t*2,this}scale(t){return this.x/=t,this.y/=t,this.w/=t,this.h/=t,this}clone(){const{x:t,y:n,w:r,h:i}=this;return new It(t,n,r,i)}translate(t){return this.x+=t.x,this.y+=t.y,this}snapToGrid(t){const n=Math.round(this.minX/t)*t,r=Math.round(this.minY/t)*t,i=Math.round(this.maxX/t)*t,o=Math.round(this.maxY/t)*t;this.minX=n,this.minY=r,this.width=Math.max(1,i-n),this.height=Math.max(1,o-r)}collides(t){return It.Collides(this,t)}contains(t){return It.Contains(this,t)}includes(t){return It.Includes(this,t)}containsPoint(t,n){return It.ContainsPoint(this,t,n)}getHandlePoint(t){switch(t){case"top_left":return new E(this.minX,this.minY);case"top_right":return new E(this.maxX,this.minY);case"bottom_left":return new E(this.minX,this.maxY);case"bottom_right":return new E(this.maxX,this.maxY);case"top":return new E(this.midX,this.minY);case"right":return new E(this.maxX,this.midY);case"bottom":return new E(this.midX,this.maxY);case"left":return new E(this.minX,this.midY)}}toJson(){return{x:this.minX,y:this.minY,w:this.w,h:this.h}}resize(t,n,r){const{minX:i,minY:o,maxX:s,maxY:a}=this;let{minX:l,minY:c,maxX:u,maxY:d}=this;switch(t){case"left":case"top_left":case"bottom_left":{l+=n;break}case"right":case"top_right":case"bottom_right":{u+=n;break}}switch(t){case"top":case"top_left":case"top_right":{c+=r;break}case"bottom":case"bottom_left":case"bottom_right":{d+=r;break}}const h=(u-l)/(s-i),f=(d-c)/(a-o),p=h<0,g=f<0;if(p){const y=u;u=l,l=y}if(g){const y=d;d=c,c=y}this.minX=l,this.minY=c,this.width=Math.abs(u-l),this.height=Math.abs(d-c)}union(t){const n=Math.min(this.minX,t.x),r=Math.min(this.minY,t.y),i=Math.max(this.maxX,t.w+t.x),o=Math.max(this.maxY,t.h+t.y);return this.x=n,this.y=r,this.width=i-n,this.height=o-r,this}static From(t){return new It(t.x,t.y,t.w,t.h)}static FromPoints(t){if(t.length===0)return new It;let n=1/0,r=1/0,i=-1/0,o=-1/0,s;for(let a=0,l=t.length;a<l;a++)s=t[a],n=Math.min(s.x,n),r=Math.min(s.y,r),i=Math.max(s.x,i),o=Math.max(s.y,o);return new It(n,r,i-n,o-r)}static Expand(t,n){const r=Math.min(n.minX,t.minX),i=Math.min(n.minY,t.minY),o=Math.max(n.maxX,t.maxX),s=Math.max(n.maxY,t.maxY);return new It(r,i,o-r,s-i)}static ExpandBy(t,n){return new It(t.minX-n,t.minY-n,t.width+n*2,t.height+n*2)}static Resize(t,n,r,i,o=!1){const{minX:s,minY:a,maxX:l,maxY:c}=t;let{minX:u,minY:d,maxX:h,maxY:f}=t;switch(n){case"left":case"top_left":case"bottom_left":{u+=r;break}case"right":case"top_right":case"bottom_right":{h+=r;break}}switch(n){case"top":case"top_left":case"top_right":{d+=i;break}case"bottom":case"bottom_left":case"bottom_right":{f+=i;break}}const p=(h-u)/(l-s),g=(f-d)/(c-a),y=p<0,x=g<0;if(o){const _=(l-s)/(c-a),S=Math.abs(h-u),T=Math.abs(f-d),P=S*(g<0?1:-1)*(1/_),I=T*(p<0?1:-1)*_,$=_<S/T;switch(n){case"top_left":{$?d=f+P:u=h+I;break}case"top_right":{$?d=f+P:h=u-I;break}case"bottom_right":{$?f=d-P:h=u-I;break}case"bottom_left":{$?f=d-P:u=h+I;break}case"bottom":case"top":{const L=(u+h)/2,R=T*_;u=L-R/2,h=L+R/2;break}case"left":case"right":{const L=(d+f)/2,R=S/_;d=L-R/2,f=L+R/2;break}}}if(y){const _=h;h=u,u=_}if(x){const _=f;f=d,d=_}const w=new It(u,d,Math.abs(h-u),Math.abs(f-d));return{box:w,scaleX:+(w.width/t.width*(p>0?1:-1)).toFixed(5),scaleY:+(w.height/t.height*(g>0?1:-1)).toFixed(5)}}equals(t){return It.Equals(this,t)}static Equals(t,n){return n.x===t.x&&n.y===t.y&&n.w===t.w&&n.h===t.h}};v(It,"Collides",(t,n)=>!(t.maxX<n.minX||t.minX>n.maxX||t.maxY<n.minY||t.minY>n.maxY)),v(It,"Contains",(t,n)=>t.minX<n.minX&&t.minY<n.minY&&t.maxY>n.maxY&&t.maxX>n.maxX),v(It,"Includes",(t,n)=>It.Collides(t,n)||It.Contains(t,n)),v(It,"ContainsPoint",(t,n,r)=>typeof n=="number"?!(n<t.minX||r<t.minY||n>t.maxX||r>t.maxY):!(n.x<t.minX||n.y<t.minY||n.x>t.maxX||n.y>t.maxY)),v(It,"Common",t=>{let n=1/0,r=1/0,i=-1/0,o=-1/0;for(let s=0;s<t.length;s++){const a=t[s];n=Math.min(n,a.minX),r=Math.min(r,a.minY),i=Math.max(i,a.maxX),o=Math.max(o,a.maxY)}return new It(n,r,i-n,o-r)}),v(It,"Sides",(t,n=0)=>{const{corners:r}=t;return[[r[0],r[1]],[r[1],r[2]],[r[2],r[3]],[r[3],r[0]]]});let me=It;function RV(e){switch(e){case"top":return"bottom";case"bottom":return"top";case"top_left":return"bottom_left";case"top_right":return"bottom_right";case"bottom_left":return"top_left";case"bottom_right":return"top_right";default:return e}}function DV(e){switch(e){case"left":return"right";case"right":return"left";case"top_left":return"top_right";case"top_right":return"top_left";case"bottom_left":return"bottom_right";case"bottom_right":return"bottom_left";default:return e}}function FV(e){return e==="top_left"||e==="top_right"||e==="bottom_right"||e==="bottom_left"}class t5{constructor(t){v(this,"_values");v(this,"_computed",{});this._values=t}get values(){return this._values}set values(t){this._values=t,this._computed={}}get length(){if(this._computed.length!==void 0)return this._computed.length;const{lut:t}=this;let n=t[0],r=0;for(let i=1;i<t.length;i++){const o=t[i];r+=n.dist(o),n=o}return this._computed.length=r,r}get bounds(){if(this._computed.bounds!==void 0)return this._computed.bounds;let t=1/0,n=1/0,r=-1/0,i=-1/0;const{lut:o}=this;for(const a of o)t=Math.min(a.x,t),n=Math.min(a.y,n),r=Math.max(a.x,r),i=Math.max(a.y,i);const s=new me(t,n,r-t,i-n);return this._computed.bounds=s,s}get lut(){if(this._computed.lut)return this._computed.lut;const{p:t}=this.values,n=[];for(let r=0;r<t+1;r++)n.push(this.getPoint(r/t));return this._computed.lut=n,n}get midPoint(){if(this._computed.midPoint)return this._computed.midPoint;const t=this.getPoint(.5);return this._computed.midPoint=t,t}get path(){if(this._computed.path)return this._computed.path;const t=this.getPath();return this._computed.path=t,t}getPointAtLength(t){const n=Math.max(0,Math.min(1,t/this.length));return this.getPoint(n)}getNormal(t){return this.getPoint(t-.0025).tan(this.getPoint(t+.0025)).per().uni().toFixed()}getNormalAtLength(t){return this.getNormal(t/this.length)}getClosestPointTo(t){const{lut:n}=this;let r=0,i=n[0],o=n[0].dist(t);for(let a=1;a<n.length;a++){const l=E.Dist(n[a],t);l<o&&(o=l,i=n[a],r=a/n.length)}const s=1/this.values.p;for(let a=Math.max(0,r-s/2);a<Math.min(1,r+s/2);a+=s/10){const l=this.getPoint(a),c=E.Dist(l,t);c<o&&(o=c,i=l)}return{point:i,distance:o}}update(t){this._computed={},this.values={...this.values,...t}}}var cwe;class NV extends t5{constructor(n,r,i,o,s=25){super({a:n,b:r,c:i,d:o,p:s});v(this,cwe,function*(){const{a:n,b:r,c:i,d:o}=this.values;yield*[n,r,i,o]})}getPath(n=!0){const{a:r,b:i,c:o,d:s}=this.values;return E.Equals(r,s)?"":`${n?`M${r.x.toFixed(2)},${r.y.toFixed(2)}C`:""}${i.x.toFixed(2)},${i.y.toFixed(2)} ${o.x.toFixed(2)},${o.y.toFixed(2)} ${s.x.toFixed(2)},${s.y.toFixed(2)}`}getPoint(n){const{a:r,b:i,c:o,d:s}=this.values;return new E((1-n)*(1-n)*(1-n)*r.x+3*((1-n)*(1-n))*n*i.x+3*(1-n)*(n*n)*o.x+n*n*n*s.x,(1-n)*(1-n)*(1-n)*r.y+3*((1-n)*(1-n))*n*i.y+3*(1-n)*(n*n)*o.y+n*n*n*s.y)}getX(n){const{a:r,b:i,c:o,d:s}=this.values;return(1-n)*(1-n)*(1-n)*r.x+3*((1-n)*(1-n))*n*i.x+3*(1-n)*(n*n)*o.x+n*n*n*s.x}getY(n){const{a:r,b:i,c:o,d:s}=this.values;return(1-n)*(1-n)*(1-n)*r.y+3*((1-n)*(1-n))*n*i.y+3*(1-n)*(n*n)*o.y+n*n*n*s.y}}cwe=Symbol.iterator;class n5{constructor(t,n=50,r=1){v(this,"computed",{});this.points=t,this.p=n,this.k=r}get length(){if(this.computed.length!==void 0)return this.computed.length;const{segments:t}=this,n=t.reduce((r,i)=>r+i.length,0);return this.computed.length=n,n}get bounds(){if(this.computed.bounds!==void 0)return this.computed.bounds;const{segments:t}=this,n=me.Common(t.map(r=>r.bounds));return this.computed.bounds=n,n}get head(){const{points:t}=this;return t[0]}get tail(){const{points:t}=this;return t[t.length-1]}get path(){if(this.computed.path!==void 0)return this.computed.path;const t=this.segments.map(n=>n.path).filter(n=>n!=null&&n!=="").join(" ");return this.computed.path=t,t}addPoint(t){const{points:n,k:r,p:i}=this;return n.push(t),this.computed={},this.getSegmentsFromPoints(this.points,i,r),this}removePoint(t){const{points:n,k:r,p:i}=this,o=typeof t=="number"?Math.floor(t):n.indexOf(t);return o===-1?this:(n.splice(o,1),this.computed={},this.getSegmentsFromPoints(this.points,i,r),this)}getPointAtLength(t){const{segments:n}=this;let r=t;if(t<=0)return n[0].getPoint(0);if(t>=this.length)return n[n.length-1].getPoint(1);for(let i=0;i<n.length;i++){const o=n[i],{length:s}=o;if(r<s)return o.getPoint(r/s);r-=o.length}return n[n.length-1].getPoint(1)}getPoint(t){return t<=0?this.segments[0].getPoint(0):t>=1?this.segments[this.segments.length-1].getPoint(1):this.getPointAtLength(t*this.length)}getNormal(t){const{length:n}=this;return this.getNormalAtLength(t*n)}getNormalAtLength(t){const{segments:n}=this;if(t<0)return new E(0,0);let r=t;for(const i of n){const o=i.length;if(r<=o)return i.getNormal(r/o);r-=o}return new E(0,0)}getClosestPointTo(t){const{head:n,segments:r}=this;let i=n,o=E.Dist(t,n);for(const s of r){const a=s.getClosestPointTo(t);a.distance<o&&(o=a.distance,i=a.point)}return{point:i,distance:o}}}class XS extends n5{constructor(n,r=1.2,i=20){super(n,r,i);v(this,"segments");this.segments=this.getSegmentsFromPoints(n,r,i)}getSegmentsFromPoints(n,r=1.25,i=20){const o=n.length,s=o-2,a=[];for(let l=0;l<o-1;l++){const c=l===0?n[0]:n[l-1],u=n[l],d=n[l+1],h=l===s?d:n[l+2];a.push(new NV(u,l===0?c:new E(u.x+(d.x-c.x)/6*r,u.y+(d.y-c.y)/6*r),l===s?d:new E(d.x-(h.x-u.x)/6*r,d.y-(h.y-u.y)/6*r),d,i))}return a}static FromPoints(n){return new XS(n)}}class jV extends t5{constructor(t,n,r=2){super({a:t,b:n,p:r}),this.a=t,this.b=n,this.values.p=Math.max(10,Math.ceil(this.length/20))}get length(){return E.Dist(this.a,this.b)}get tangent(){return E.Tan(this.a,this.b)}get angle(){return E.Angle(this.a,this.b)}get bounds(){return me.FromPoints([this.a,this.b])}getX(t){const{a:n,b:r}=this.values;return n.x+(r.x-n.x)*t}getY(t){const{a:n,b:r}=this.values;return n.y+(r.y-n.y)*t}getPoint(t){const{a:n,b:r}=this.values;return E.Lrp(n,r,t)}getPath(t=!0){const{a:n,b:r}=this.values;return E.Equals(n,r)?"":t?`M${n.x},${n.y}L${r.x},${r.y}`:`${r.x},${r.y}`}getNormal(){const{a:t,b:n}=this.values;return E.Sub(t,n).per().uni().toFixed()}getClosestPointTo(t){const{a:n,b:r}=this.values,i=E.NearestPointOnLineSegment(n,r,t),o=i.dist(t);return{point:i,distance:o}}static Length(t){return E.Dist(t.a,t.b)}static Tangent(t){return E.Tan(t.a,t.b)}static Angle(t){return E.Angle(t.a,t.b)}}const ht=class ht{constructor(t,n,r,i,o,s){v(this,"a",1);v(this,"b",0);v(this,"c",0);v(this,"d",1);v(this,"e",0);v(this,"f",0);this.a=t,this.b=n,this.c=r,this.d=i,this.e=o,this.f=s}equals(t){return this.a===t.a&&this.b===t.b&&this.c===t.c&&this.d===t.d&&this.e===t.e&&this.f===t.f}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0,this}multiply(t){const n=t,{a:r,b:i,c:o,d:s,e:a,f:l}=this;return this.a=r*n.a+o*n.b,this.c=r*n.c+o*n.d,this.e=r*n.e+o*n.f+a,this.b=i*n.a+s*n.b,this.d=i*n.c+s*n.d,this.f=i*n.e+s*n.f+l,this}rotate(t,n,r){return t===0?this:n===void 0?this.multiply(ht.Rotate(t)):this.translate(n,r).multiply(ht.Rotate(t)).translate(-n,-r)}translate(t,n){return this.multiply(ht.Translate(t,n))}scale(t,n){return this.multiply(ht.Scale(t,n))}invert(){const{a:t,b:n,c:r,d:i,e:o,f:s}=this,a=t*i-n*r;return this.a=i/a,this.b=n/-a,this.c=r/-a,this.d=t/a,this.e=(i*o-r*s)/-a,this.f=(n*o-t*s)/a,this}applyToPoint(t){return ht.applyToPoint(this,t)}applyToPoints(t){return ht.applyToPoints(this,t)}decomposed(){return ht.Decompose(this)}toCssString(){return ht.toCssString(this)}setTo(t){return Object.assign(this,t),this}decompose(){return ht.Decompose(this)}clone(){return new ht(this.a,this.b,this.c,this.d,this.e,this.f)}static Identity(){return new ht(1,0,0,1,0,0)}static Translate(t,n){return new ht(1,0,0,1,t,n)}static Rotate(t,n,r){if(t===0)return ht.Identity();const i=Math.cos(t),o=Math.sin(t),s=new ht(i,o,-o,i,0,0);return n===void 0?s:ht.Compose(ht.Translate(n,r),s,ht.Translate(-n,-r))}static Multiply(t,n){return{a:t.a*n.a+t.c*n.b,c:t.a*n.c+t.c*n.d,e:t.a*n.e+t.c*n.f+t.e,b:t.b*n.a+t.d*n.b,d:t.b*n.c+t.d*n.d,f:t.b*n.e+t.d*n.f+t.f}}static Inverse(t){const n=t.a*t.d-t.b*t.c;return{a:t.d/n,b:t.b/-n,c:t.c/-n,d:t.a/n,e:(t.d*t.e-t.c*t.f)/-n,f:(t.b*t.e-t.a*t.f)/n}}static Absolute(t){const n=t.a*t.d-t.b*t.c;return{a:t.d/n,b:t.b/-n,c:t.c/-n,d:t.a/n,e:(t.d*t.e-t.c*t.f)/n,f:(t.b*t.e-t.a*t.f)/-n}}static Compose(...t){const n=ht.Identity();for(let r=0,i=t.length;r<i;r++)n.multiply(t[r]);return n}static Decompose(t){let n,r,i;if(t.a!==0||t.c!==0){const o=Math.hypot(t.a,t.c);n=o,r=(t.a*t.d-t.b*t.c)/o,i=Math.acos(t.a/o)*(t.c>0?-1:1)}else if(t.b!==0||t.d!==0){const o=Math.hypot(t.b,t.d);n=(t.a*t.d-t.b*t.c)/o,r=o,i=tt+Math.acos(t.b/o)*(t.d>0?-1:1)}else n=0,r=0,i=0;return{x:t.e,y:t.f,scaleX:n,scaleY:r,rotation:JM(i)}}static Smooth(t,n=1e10){return t.a=Math.round(t.a*n)/n,t.b=Math.round(t.b*n)/n,t.c=Math.round(t.c*n)/n,t.d=Math.round(t.d*n)/n,t.e=Math.round(t.e*n)/n,t.f=Math.round(t.f*n)/n,t}static toCssString(t){return`matrix(${Y(t.a)}, ${Y(t.b)}, ${Y(t.c)}, ${Y(t.d)}, ${Y(t.e)}, ${Y(t.f)})`}static applyToPoint(t,n){return new E(t.a*n.x+t.c*n.y+t.e,t.b*n.x+t.d*n.y+t.f,n.z)}static applyToXY(t,n,r){return[t.a*n+t.c*r+t.e,t.b*n+t.d*r+t.f]}static applyToPoints(t,n){return n.map(r=>new E(t.a*r.x+t.c*r.y+t.e,t.b*r.x+t.d*r.y+t.f,r.z))}static applyToBounds(t,n){return new me(t.e+n.minX,t.f+n.minY,n.width,n.height)}static From(t){return new ht(t.a,t.b,t.c,t.d,t.e,t.f)}};v(ht,"Scale",(t,n,r,i)=>{const o=new ht(t,0,0,0,n,0);return r===void 0?o:ht.Compose(ht.Translate(r,i),o,ht.Translate(-r,-i))});let ie=ht;class ZS extends n5{constructor(n,r=1.2,i=20){super(n,r,i);v(this,"segments");this.segments=this.getSegmentsFromPoints(n,i)}getSegmentsFromPoints(n,r=50){const i=[];for(let o=0;o<n.length-1;o++)i.push(new jV(n[o],n[o+1],r));return i}static FromPoints(n){return new ZS(n)}}const{PI:zV}=Math,kl=zV+1e-4;function zd(e,t={}){const{size:n=16,smoothing:r=.5,start:i={},end:o={},last:s=!1}=t,{cap:a=!0}=i,{cap:l=!0}=o;if(e.length===0||n<=0)return[];const c=e[0],u=e[e.length-1],d=u.runningLength,h=i.taper===!1?0:i.taper===!0?Math.max(n,d):i.taper,f=o.taper===!1?0:o.taper===!0?Math.max(n,d):o.taper,p=Math.pow(n*r,2),g=[],y=[];let x=e[0].vector,w=e[0].point,_=w,S=w,T=_,P=!1,I;for(let j=0;j<e.length;j++){I=e[j];const{point:B,vector:z}=e[j],q=I.vector.dpr(x),U=(j<e.length-1?e[j+1]:e[j]).vector,D=j<e.length-1?U.dpr(I.vector):1,F=q<0&&!P,J=D!==null&&D<.2;if(F||J){if(D>-.62&&d-I.runningLength>I.radius){const ne=x.clone().mul(I.radius);x.clone().cpr(U)<0?(S=E.Add(B,ne),T=E.Sub(B,ne)):(S=E.Sub(B,ne),T=E.Add(B,ne)),g.push(S),y.push(T)}else{const ne=x.clone().mul(I.radius).per(),de=E.Sub(I.input,ne);for(let Ce=1/13,he=0;he<1;he+=Ce)S=E.RotWith(de,I.input,kl*he),g.push(S),T=E.RotWith(de,I.input,kl+kl*-he),y.push(T)}w=S,_=T,J&&(P=!0);continue}if(P=!1,I===c||I===u){const ne=E.Per(z).mul(I.radius);g.push(E.Sub(B,ne)),y.push(E.Add(B,ne));continue}const Z=E.Lrp(U,z,D).per().mul(I.radius);S=E.Sub(B,Z),(j<=1||E.Dist2(w,S)>p)&&(g.push(S),w=S),T=E.Add(B,Z),(j<=1||E.Dist2(_,T)>p)&&(y.push(T),_=T),x=z}const $=c.point,L=e.length>1?e[e.length-1].point:E.AddXY(c.point,1,1);if(e.length===1&&(!(h||f)||s)){const j=E.Add($,E.Sub($,L).uni().per().mul(-c.radius)),B=[];for(let z=1/13,q=z;q<=1;q+=z)B.push(E.RotWith(j,$,kl*2*q));return B}const R=[];if(!(h||f&&e.length===1))if(a)for(let j=1/8,B=j;B<=1;B+=j){const z=E.RotWith(y[0],$,kl*B);R.push(z)}else{const j=E.Sub(g[0],y[0]),B=E.Mul(j,.5),z=E.Mul(j,.51);R.push(E.Sub($,B),E.Sub($,z),E.Add($,z),E.Add($,B))}const K=[],Q=u.vector.clone().per().neg();if(f||h&&e.length===1)K.push(L);else if(l){const j=E.Add(L,E.Mul(Q,u.radius));for(let B=1/29,z=B;z<1;z+=B)K.push(E.RotWith(j,L,kl*3*z))}else K.push(E.Add(L,E.Mul(Q,u.radius)),E.Add(L,E.Mul(Q,u.radius*.99)),E.Sub(L,E.Mul(Q,u.radius*.99)),E.Sub(L,E.Mul(Q,u.radius)));return g.concat(K,y.reverse(),R)}const UV=.025,WV=.01;function zs(e,t={}){var y;const{streamline:n=.5,size:r=16,simulatePressure:i=!1}=t;if(e.length===0)return[];const o=.15+(1-n)*.85;let s=e.map(E.From),a=0;if(!i){let x=s[0];for(;x&&!(x.z>=UV);)s.shift(),x=s[0]}if(!i){let x=s[s.length-1];for(;x&&!(x.z>=WV);)s.pop(),x=s[s.length-1]}if(s.length===0)return[{point:E.From(e[0]),input:E.From(e[0]),pressure:i?.5:.15,vector:new E(1,1),distance:0,runningLength:0,radius:1}];let l=s[1];for(;l&&!(E.Dist(l,s[0])>r/3);)s[0].z=Math.max(s[0].z,l.z),s.splice(1,1),l=s[1];const c=s.pop();for(l=s[s.length-1];l&&!(E.Dist(l,c)>r/3);)s.pop(),l=s[s.length-1],a++;s.push(c);const u=t.last||!t.simulatePressure||s.length>1&&E.Dist(s[s.length-1],s[s.length-2])<r||a>0;if(s.length===2&&t.simulatePressure){const x=s[1];s=s.slice(0,-1);for(let w=1;w<5;w++){const _=E.Lrp(s[0],x,w/4);_.z=(s[0].z+(x.z-s[0].z))*w/4,s.push(_)}}const d=[{point:s[0],input:s[0],pressure:i?.5:s[0].z,vector:new E(1,1),distance:0,runningLength:0,radius:1}];let h=0,f=d[0],p,g;u&&n>0&&s.push(s[s.length-1].clone());for(let x=1,w=s.length;x<w;x++)p=!o||t.last&&x===w-1?s[x].clone():s[x].clone().lrp(f.point,1-o),!f.point.equals(p)&&(g=E.Dist(p,f.point),h+=g,!(x<4&&h<r)&&(f={input:s[x],point:p,pressure:i?.5:s[x].z,vector:E.Sub(f.point,p).uni(),distance:g,runningLength:h,radius:1},d.push(f)));if((y=d[1])!=null&&y.vector&&(d[0].vector=d[1].vector.clone()),h<1){const x=Math.max(.5,...d.map(w=>w.pressure));d.forEach(w=>w.pressure=x)}return d}const{min:fs}=Math,Ev=.275;function Ud(e,t){const{size:n=16,thinning:r=.5,simulatePressure:i=!0,easing:o=y=>y,start:s={},end:a={}}=t,{easing:l=Bn.easeOutQuad}=s,{easing:c=Bn.easeOutCubic}=a,u=e[e.length-1].runningLength;let d,h=e[0].pressure,f;if(!i&&u<n){const y=e.reduce((x,w)=>Math.max(x,w.pressure),.5);return e.forEach(x=>{x.pressure=y,x.radius=n*o(.5-r*(.5-x.pressure))}),e}else{let y;for(let x=0,w=e.length;x<w&&(f=e[x],!(f.runningLength>n*5));x++){const _=fs(1,f.distance/n);if(i){const S=fs(1,1-_);y=fs(1,h+(S-h)*(_*Ev))}else y=fs(1,h+(f.pressure-h)*.5);h=h+(y-h)*.5}for(let x=0;x<e.length;x++){if(f=e[x],r){let{pressure:w}=f;const _=fs(1,f.distance/n);if(i){const S=fs(1,1-_);w=fs(1,h+(S-h)*(_*Ev))}else w=fs(1,h+(w-h)*(_*Ev));f.radius=n*o(.5-r*(.5-w)),h=w}else f.radius=n/2;d===void 0&&(d=f.radius)}}const p=s.taper===!1?0:s.taper===!0?Math.max(n,u):s.taper,g=a.taper===!1?0:a.taper===!0?Math.max(n,u):a.taper;if(p||g)for(let y=0;y<e.length;y++){f=e[y];const{runningLength:x}=f,w=x<p?l(x/p):1,_=u-x<g?c((u-x)/g):1;f.radius=Math.max(.01,f.radius*Math.min(w,_))}return e}function HV(e,t={}){return zd(Ud(zs(e,t),t),t)}function QS(e,t,n,r){const i=e.x-n.x,o=e.y-n.y,s=r.x-n.x,a=r.y-n.y,l=t.x-e.x,c=t.y-e.y,u=s*o-a*i,d=l*o-c*i,h=a*l-s*c;if(u===0||d===0||h===0)return null;if(h!==0){const f=u/h,p=d/h;if(0<=f&&f<=1&&0<=p&&p<=1)return E.AddXY(e,f*l,f*c)}return null}function r5(e,t,n,r){const i=(t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y),o=2*((t.x-e.x)*(e.x-n.x)+(t.y-e.y)*(e.y-n.y)),s=n.x*n.x+n.y*n.y+e.x*e.x+e.y*e.y-2*(n.x*e.x+n.y*e.y)-r*r,a=o*o-4*i*s;if(a<0||a===0)return null;const l=Math.sqrt(a),c=(-o+l)/(2*i),u=(-o-l)/(2*i);if((c<0||c>1)&&(u<0||u>1))return null;const d=[];return 0<=c&&c<=1&&d.push(E.Lrp(e,t,c)),0<=u&&u<=1&&d.push(E.Lrp(e,t,u)),d.length===0?null:d}function JS(e,t,n){const r=[];let i;for(let o=0,s=n.length-1;o<s;o++)i=QS(e,t,n[o],n[o+1]),i&&r.push(i);return r.length===0?null:r}function KV(e,t,n){const r=[];let i;for(let o=1,s=n.length;o<s+1;o++)i=QS(e,t,n[o-1],n[o%n.length]),i&&r.push(i);return r.length===0?null:r}function VV(e,t,n,r){let i=n.x-e.x,o=n.y-e.y;const s=Math.sqrt(i*i+o*o),a=(s*s-r*r+t*t)/(2*s),l=Math.sqrt(t*t-a*a);return i/=s,o/=s,[new E(e.x+i*a-o*l,e.y+o*a+i*l),new E(e.x+i*a+o*l,e.y+o*a-i*l)]}function Ak(e,t,n){const r=[];let i,o,s;for(let a=0,l=n.length;a<l;a++)i=n[a],o=n[(a+1)%n.length],s=r5(i,o,e,t),s&&r.push(...s);return r.length===0?null:r}function Mk(e,t,n){const r=[];let i,o,s;for(let a=1,l=n.length;a<l;a++)i=n[a-1],o=n[a],s=r5(i,o,e,t),s&&r.push(...s);return r.length===0?null:r}function Uf(e,t,n){return(n.y-e.y)*(t.x-e.x)>(t.y-e.y)*(n.x-e.x)}function to(e,t,n,r){return Uf(e,n,r)!==Uf(t,n,r)&&Uf(e,t,n)!==Uf(e,t,r)}function pb(e,t){const n=[];let r,i,o,s;for(let a=0,l=e.length;a<l;a++)r=e[a],ai(r,t)&&n.push(r);for(let a=0,l=t.length;a<l;a++)r=t[a],ai(r,e)&&n.push(r);for(let a=0,l=e.length;a<l;a++){r=e[a],i=e[(a+1)%e.length];for(let c=0,u=t.length;c<u;c++){o=t[c],s=t[(c+1)%t.length];const d=QS(r,i,o,s);d!==null&&n.push(d)}}return n.length===0?null:YV(n)}function YV(e){const t=E.Average(e);return e.sort((n,r)=>E.Angle(t,n)-E.Angle(t,r))}function qV(e,t){let n,r,i,o;for(let s=0,a=e.length;s<a;s++){n=e[s],r=e[(s+1)%a];for(let l=0,c=t.length;l<c;l++)if(i=t[l],o=t[(l+1)%c],to(n,r,i,o))return!0}return!1}function Ft(e){return`${Y(e.x)},${Y(e.y)} `}function i5(e=""){let t=0,n=0,r=0,i=0;function o(){const s=t^t<<11;return t=n,n=r,r=i,i^=(i>>>19^s^s>>>8)>>>0,i/4294967296*2}for(let s=0;s<e.length+64;s++)t^=e.charCodeAt(s)|0,o();return o}function Wd(e){let t="M";const n=e.length;let r,i,o;for(let s=0,a=n;s<a;s+=3)r=e[s],i=e[s+1],o=e[s+2],t+=`${Ft(r)}L${Ft(i)}Q${Ft(o)}`;return t+=`${Ft(e[0])}`,t}function Hd(e,t,n,r,i){const o=[],s=i5(e);let a=t[0],l;const c=t.length;for(let u=0,d=c*i;u<d;u++){l=E.AddXY(t[(u+1)%c],s()*n,s()*n);const h=E.Sub(l,a),f=E.Len(h),p=E.Div(h,f).mul(Math.min(f/4,r));o.push(E.Add(a,p),E.Add(l,p.neg()),l),a=l}return o}function Ok(e,t,n){let r=`M${Ft(t[0])}L`,i=`M${Ft(t[0])}L`,o=`M${Ft(t[0])}L`;const s=n/3,a=n*2,l=i5(e);let c=t[0],u,d=t[0],h;const f=t.length;for(let p=0,g=f-1;p<g;p++){u=E.AddXY(t[p+1],l()*s,l()*s),h=E.AddXY(t[p+1],l(),l()*s);const y=E.Sub(u,c),x=E.Len(y),w=E.Div(y,x).mul(Math.min(x/4,a)),_=E.Add(c,w),S=E.Add(u,w.neg()),T=E.Sub(h,d),P=E.Len(T),I=E.Div(T,P).mul(Math.min(P/4,a)),$=E.Add(d,I),L=E.Add(h,I.neg());p===g-1?(r+=`${Ft(_)} L ${Ft(u)}`,i+=`${Ft(_)} L ${Ft(u)}`,o+=`${Ft($)} L ${Ft(h)}`):(r+=`${Ft(_)}L ${Ft(S)}Q ${Ft(u)}`,i+=`${Ft(_)}L ${Ft(S)}Q ${Ft(u)}`,o+=`${Ft($)}L ${Ft(L)}Q ${Ft(h)}`,c=u,d=h)}return[r,i+o]}var GV=200,e_="__lodash_hash_undefined__",XV=1/0,ZV="[object Function]",QV="[object GeneratorFunction]",JV=/[\\^$.*+?()[\]{}|]/g,eY=/^\[object .+?Constructor\]$/,tY=typeof Ln=="object"&&Ln&&Ln.Object===Object&&Ln,nY=typeof self=="object"&&self&&self.Object===Object&&self,t_=tY||nY||Function("return this")();function rY(e,t){var n=e?e.length:0;return!!n&&sY(e,t,0)>-1}function iY(e,t,n){for(var r=-1,i=e?e.length:0;++r<i;)if(n(t,e[r]))return!0;return!1}function oY(e,t,n,r){for(var i=e.length,o=n+(r?1:-1);r?o--:++o<i;)if(t(e[o],o,e))return o;return-1}function sY(e,t,n){if(t!==t)return oY(e,aY,n);for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1}function aY(e){return e!==e}function lY(e,t){return e.has(t)}function cY(e,t){return e==null?void 0:e[t]}function uY(e){var t=!1;if(e!=null&&typeof e.toString!="function")try{t=!!(e+"")}catch{}return t}function o5(e){var t=-1,n=Array(e.size);return e.forEach(function(r){n[++t]=r}),n}var dY=Array.prototype,hY=Function.prototype,s5=Object.prototype,kv=t_["__core-js_shared__"],Lk=function(){var e=/[^.]+$/.exec(kv&&kv.keys&&kv.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),a5=hY.toString,n_=s5.hasOwnProperty,fY=s5.toString,pY=RegExp("^"+a5.call(n_).replace(JV,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),gY=dY.splice,mY=r_(t_,"Map"),Tv=r_(t_,"Set"),Kd=r_(Object,"create");function Ga(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function yY(){this.__data__=Kd?Kd(null):{}}function vY(e){return this.has(e)&&delete this.__data__[e]}function xY(e){var t=this.__data__;if(Kd){var n=t[e];return n===e_?void 0:n}return n_.call(t,e)?t[e]:void 0}function bY(e){var t=this.__data__;return Kd?t[e]!==void 0:n_.call(t,e)}function wY(e,t){var n=this.__data__;return n[e]=Kd&&t===void 0?e_:t,this}Ga.prototype.clear=yY;Ga.prototype.delete=vY;Ga.prototype.get=xY;Ga.prototype.has=bY;Ga.prototype.set=wY;function Gc(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function SY(){this.__data__=[]}function _Y(e){var t=this.__data__,n=_y(t,e);if(n<0)return!1;var r=t.length-1;return n==r?t.pop():gY.call(t,n,1),!0}function CY(e){var t=this.__data__,n=_y(t,e);return n<0?void 0:t[n][1]}function EY(e){return _y(this.__data__,e)>-1}function kY(e,t){var n=this.__data__,r=_y(n,e);return r<0?n.push([e,t]):n[r][1]=t,this}Gc.prototype.clear=SY;Gc.prototype.delete=_Y;Gc.prototype.get=CY;Gc.prototype.has=EY;Gc.prototype.set=kY;function Xc(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function TY(){this.__data__={hash:new Ga,map:new(mY||Gc),string:new Ga}}function PY(e){return Cy(this,e).delete(e)}function IY(e){return Cy(this,e).get(e)}function $Y(e){return Cy(this,e).has(e)}function AY(e,t){return Cy(this,e).set(e,t),this}Xc.prototype.clear=TY;Xc.prototype.delete=PY;Xc.prototype.get=IY;Xc.prototype.has=$Y;Xc.prototype.set=AY;function rm(e){var t=-1,n=e?e.length:0;for(this.__data__=new Xc;++t<n;)this.add(e[t])}function MY(e){return this.__data__.set(e,e_),this}function OY(e){return this.__data__.has(e)}rm.prototype.add=rm.prototype.push=MY;rm.prototype.has=OY;function _y(e,t){for(var n=e.length;n--;)if(zY(e[n][0],t))return n;return-1}function LY(e){if(!l5(e)||FY(e))return!1;var t=UY(e)||uY(e)?pY:eY;return t.test(NY(e))}function BY(e,t,n){var r=-1,i=rY,o=e.length,s=!0,a=[],l=a;if(n)s=!1,i=iY;else if(o>=GV){var c=t?null:RY(e);if(c)return o5(c);s=!1,i=lY,l=new rm}else l=t?[]:a;e:for(;++r<o;){var u=e[r],d=t?t(u):u;if(u=n||u!==0?u:0,s&&d===d){for(var h=l.length;h--;)if(l[h]===d)continue e;t&&l.push(d),a.push(u)}else i(l,d,n)||(l!==a&&l.push(d),a.push(u))}return a}var RY=Tv&&1/o5(new Tv([,-0]))[1]==XV?function(e){return new Tv(e)}:WY;function Cy(e,t){var n=e.__data__;return DY(t)?n[typeof t=="string"?"string":"hash"]:n.map}function r_(e,t){var n=cY(e,t);return LY(n)?n:void 0}function DY(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function FY(e){return!!Lk&&Lk in e}function NY(e){if(e!=null){try{return a5.call(e)}catch{}try{return e+""}catch{}}return""}function jY(e){return e&&e.length?BY(e):[]}function zY(e,t){return e===t||e!==e&&t!==t}function UY(e){var t=l5(e)?fY.call(e):"";return t==ZV||t==QV}function l5(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function WY(){}var HY=jY;const c5=rl(HY),bo=2e3,im=40,ko=320,Tl=[.1,.25,.5,1,2,4,8],ku=.1,Cs=8,KY=.5,VY=.1,YY=.2,qY=.005,GY=.05,XY=10,ZY=1,QY=1e3,JY=1e3,eq=5,zr=8,tq=450,nq=200,gb=6,Vd=4,rq=32,om={};for(let e=1;e<=Math.ceil(Cs);e++)om[e+"_dark"]=`hash_pattern_zoom_${e}_dark`,om[e+"_light"]=`hash_pattern_zoom_${e}_light`;const Bk={duration:0,easing:Bn.easeInOutCubic},Np=.09,Ma=48,sm=10,iq=10,u5=300,d5=320,i_=[{offsetX:0,offsetY:2,blur:4,spread:0,color:"#00000029"},{offsetX:0,offsetY:3,blur:6,spread:0,color:"#0000001f"}],Rk=[{min:-1,mid:.15,step:100},{min:.05,mid:.375,step:25},{min:.15,mid:1,step:5},{min:.7,mid:2.5,step:1}],yn={lineHeight:1.35,fontWeight:"normal",fontVariant:"normal",fontStyle:"normal",padding:"0px",maxWidth:"auto"},Is={s:18,m:24,l:36,xl:44},Da={s:18,m:22,l:26,xl:32},bs={s:18,m:20,l:24,xl:28},Mo={draw:"var(--tl-font-draw)",sans:"var(--tl-font-sans)",serif:"var(--tl-font-serif)",mono:"var(--tl-font-mono)"},Tu={color:[{id:"black",type:"color",icon:"color"},{id:"grey",type:"color",icon:"color"},{id:"light-violet",type:"color",icon:"color"},{id:"violet",type:"color",icon:"color"},{id:"blue",type:"color",icon:"color"},{id:"light-blue",type:"color",icon:"color"},{id:"yellow",type:"color",icon:"color"},{id:"orange",type:"color",icon:"color"},{id:"green",type:"color",icon:"color"},{id:"light-green",type:"color",icon:"color"},{id:"light-red",type:"color",icon:"color"},{id:"red",type:"color",icon:"color"}],fill:[{id:"none",type:"fill",icon:"fill-none"},{id:"semi",type:"fill",icon:"fill-semi"},{id:"solid",type:"fill",icon:"fill-solid"},{id:"pattern",type:"fill",icon:"fill-pattern"}],dash:[{id:"draw",type:"dash",icon:"dash-draw"},{id:"dashed",type:"dash",icon:"dash-dashed"},{id:"dotted",type:"dash",icon:"dash-dotted"},{id:"solid",type:"dash",icon:"dash-solid"}],size:[{id:"s",type:"size",icon:"size-small"},{id:"m",type:"size",icon:"size-medium"},{id:"l",type:"size",icon:"size-large"},{id:"xl",type:"size",icon:"size-extra-large"}],font:[{id:"draw",type:"font",icon:"font-draw"},{id:"sans",type:"font",icon:"font-sans"},{id:"serif",type:"font",icon:"font-serif"},{id:"mono",type:"font",icon:"font-mono"}],align:[{id:"start",type:"align",icon:"text-align-left"},{id:"middle",type:"align",icon:"text-align-center"},{id:"end",type:"align",icon:"text-align-right"}],verticalAlign:[{id:"start",type:"verticalAlign",icon:"vertical-align-start"},{id:"middle",type:"verticalAlign",icon:"vertical-align-center"},{id:"end",type:"verticalAlign",icon:"vertical-align-end"}],geo:[{id:"rectangle",type:"geo",icon:"geo-rectangle"},{id:"ellipse",type:"geo",icon:"geo-ellipse"},{id:"triangle",type:"geo",icon:"geo-triangle"},{id:"diamond",type:"geo",icon:"geo-diamond"},{id:"pentagon",type:"geo",icon:"geo-pentagon"},{id:"hexagon",type:"geo",icon:"geo-hexagon"},{id:"octagon",type:"geo",icon:"geo-octagon"},{id:"star",type:"geo",icon:"geo-star"},{id:"rhombus",type:"geo",icon:"geo-rhombus"},{id:"rhombus-2",type:"geo",icon:"geo-rhombus-2"},{id:"oval",type:"geo",icon:"geo-oval"},{id:"trapezoid",type:"geo",icon:"geo-trapezoid"},{id:"arrow-right",type:"geo",icon:"geo-arrow-right"},{id:"arrow-left",type:"geo",icon:"geo-arrow-left"},{id:"arrow-up",type:"geo",icon:"geo-arrow-up"},{id:"arrow-down",type:"geo",icon:"geo-arrow-down"},{id:"x-box",type:"geo",icon:"geo-x-box"},{id:"check-box",type:"geo",icon:"geo-check-box"}],arrowheadStart:[{id:"none",type:"arrowheadStart",icon:"arrowhead-none"},{id:"arrow",type:"arrowheadStart",icon:"arrowhead-arrow"},{id:"triangle",type:"arrowheadStart",icon:"arrowhead-triangle"},{id:"square",type:"arrowheadStart",icon:"arrowhead-square"},{id:"dot",type:"arrowheadStart",icon:"arrowhead-dot"},{id:"diamond",type:"arrowheadStart",icon:"arrowhead-diamond"},{id:"inverted",type:"arrowheadStart",icon:"arrowhead-triangle-inverted"},{id:"bar",type:"arrowheadStart",icon:"arrowhead-bar"}],arrowheadEnd:[{id:"none",type:"arrowheadEnd",icon:"arrowhead-none"},{id:"arrow",type:"arrowheadEnd",icon:"arrowhead-arrow"},{id:"triangle",type:"arrowheadEnd",icon:"arrowhead-triangle"},{id:"square",type:"arrowheadEnd",icon:"arrowhead-square"},{id:"dot",type:"arrowheadEnd",icon:"arrowhead-dot"},{id:"diamond",type:"arrowheadEnd",icon:"arrowhead-diamond"},{id:"inverted",type:"arrowheadEnd",icon:"arrowhead-triangle-inverted"},{id:"bar",type:"arrowheadEnd",icon:"arrowhead-bar"}],spline:[{id:"line",type:"spline",icon:"spline-line"},{id:"cubic",type:"spline",icon:"spline-cubic"}]},oq=new Set(["bend","w","h","start","end","text","name","url","growY"]);function Dk(e,t){let n=0;for(;e[t+n];)n+=e[t+n]+1;return n+1}function sq(e){return new TextDecoder("ascii").decode(e.slice(0,3))==="GIF"}function aq(e){const t=new Uint8Array(e);let n,r,i=0,o=0;if(!sq(e))return!1;for(n=t[10]&128,r=t[10]&7,i+=6,i+=7,i+=n?3*Math.pow(2,r+1):0;o<2&&i<t.length;)switch(t[i]){case 44:o+=1,n=t[i+9]&128,r=t[i+9]&7,i+=10,i+=n?3*Math.pow(2,r+1):0,i+=Dk(t,i+1)+1;break;case 33:i+=2,i+=Dk(t,i);break;case 59:i=t.length;break;default:i=t.length;break}return o>1}let mb=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];typeof Int32Array<"u"&&(mb=new Int32Array(mb));const lq=(e,t)=>{let n=t===0?0:~~t^-1;for(let r=0;r<e.length;r++)n=mb[(n^e[r])&255]^n>>>8;return n^-1};var h5={},Ey={};Ey.byteLength=dq;Ey.toByteArray=fq;Ey.fromByteArray=mq;var Yi=[],Kr=[],cq=typeof Uint8Array<"u"?Uint8Array:Array,Pv="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var Pl=0,uq=Pv.length;Pl<uq;++Pl)Yi[Pl]=Pv[Pl],Kr[Pv.charCodeAt(Pl)]=Pl;Kr["-".charCodeAt(0)]=62;Kr["_".charCodeAt(0)]=63;function f5(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");n===-1&&(n=t);var r=n===t?0:4-n%4;return[n,r]}function dq(e){var t=f5(e),n=t[0],r=t[1];return(n+r)*3/4-r}function hq(e,t,n){return(t+n)*3/4-n}function fq(e){var t,n=f5(e),r=n[0],i=n[1],o=new cq(hq(e,r,i)),s=0,a=i>0?r-4:r,l;for(l=0;l<a;l+=4)t=Kr[e.charCodeAt(l)]<<18|Kr[e.charCodeAt(l+1)]<<12|Kr[e.charCodeAt(l+2)]<<6|Kr[e.charCodeAt(l+3)],o[s++]=t>>16&255,o[s++]=t>>8&255,o[s++]=t&255;return i===2&&(t=Kr[e.charCodeAt(l)]<<2|Kr[e.charCodeAt(l+1)]>>4,o[s++]=t&255),i===1&&(t=Kr[e.charCodeAt(l)]<<10|Kr[e.charCodeAt(l+1)]<<4|Kr[e.charCodeAt(l+2)]>>2,o[s++]=t>>8&255,o[s++]=t&255),o}function pq(e){return Yi[e>>18&63]+Yi[e>>12&63]+Yi[e>>6&63]+Yi[e&63]}function gq(e,t,n){for(var r,i=[],o=t;o<n;o+=3)r=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(e[o+2]&255),i.push(pq(r));return i.join("")}function mq(e){for(var t,n=e.length,r=n%3,i=[],o=16383,s=0,a=n-r;s<a;s+=o)i.push(gq(e,s,s+o>a?a:s+o));return r===1?(t=e[n-1],i.push(Yi[t>>2]+Yi[t<<4&63]+"==")):r===2&&(t=(e[n-2]<<8)+e[n-1],i.push(Yi[t>>10]+Yi[t>>4&63]+Yi[t<<2&63]+"=")),i.join("")}var o_={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */o_.read=function(e,t,n,r,i){var o,s,a=i*8-r-1,l=(1<<a)-1,c=l>>1,u=-7,d=n?i-1:0,h=n?-1:1,f=e[t+d];for(d+=h,o=f&(1<<-u)-1,f>>=-u,u+=a;u>0;o=o*256+e[t+d],d+=h,u-=8);for(s=o&(1<<-u)-1,o>>=-u,u+=r;u>0;s=s*256+e[t+d],d+=h,u-=8);if(o===0)o=1-c;else{if(o===l)return s?NaN:(f?-1:1)*(1/0);s=s+Math.pow(2,r),o=o-c}return(f?-1:1)*s*Math.pow(2,o-r)};o_.write=function(e,t,n,r,i,o){var s,a,l,c=o*8-i-1,u=(1<<c)-1,d=u>>1,h=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:o-1,p=r?1:-1,g=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=u):(s=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-s))<1&&(s--,l*=2),s+d>=1?t+=h/l:t+=h*Math.pow(2,1-d),t*l>=2&&(s++,l/=2),s+d>=u?(a=0,s=u):s+d>=1?(a=(t*l-1)*Math.pow(2,i),s=s+d):(a=t*Math.pow(2,d-1)*Math.pow(2,i),s=0));i>=8;e[n+f]=a&255,f+=p,a/=256,i-=8);for(s=s<<i|a,c+=i;c>0;e[n+f]=s&255,f+=p,s/=256,c-=8);e[n+f-p]|=g*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(e){const t=Ey,n=o_,r=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=a,e.SlowBuffer=w,e.INSPECT_MAX_BYTES=50;const i=2147483647;e.kMaxLength=i,a.TYPED_ARRAY_SUPPORT=o(),!a.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function o(){try{const A=new Uint8Array(1),C={foo:function(){return 42}};return Object.setPrototypeOf(C,Uint8Array.prototype),Object.setPrototypeOf(A,C),A.foo()===42}catch{return!1}}Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}});function s(A){if(A>i)throw new RangeError('The value "'+A+'" is invalid for option "size"');const C=new Uint8Array(A);return Object.setPrototypeOf(C,a.prototype),C}function a(A,C,k){if(typeof A=="number"){if(typeof C=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return d(A)}return l(A,C,k)}a.poolSize=8192;function l(A,C,k){if(typeof A=="string")return h(A,C);if(ArrayBuffer.isView(A))return p(A);if(A==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof A);if(yt(A,ArrayBuffer)||A&&yt(A.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(yt(A,SharedArrayBuffer)||A&&yt(A.buffer,SharedArrayBuffer)))return g(A,C,k);if(typeof A=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const M=A.valueOf&&A.valueOf();if(M!=null&&M!==A)return a.from(M,C,k);const N=y(A);if(N)return N;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof A[Symbol.toPrimitive]=="function")return a.from(A[Symbol.toPrimitive]("string"),C,k);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof A)}a.from=function(A,C,k){return l(A,C,k)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array);function c(A){if(typeof A!="number")throw new TypeError('"size" argument must be of type number');if(A<0)throw new RangeError('The value "'+A+'" is invalid for option "size"')}function u(A,C,k){return c(A),A<=0?s(A):C!==void 0?typeof k=="string"?s(A).fill(C,k):s(A).fill(C):s(A)}a.alloc=function(A,C,k){return u(A,C,k)};function d(A){return c(A),s(A<0?0:x(A)|0)}a.allocUnsafe=function(A){return d(A)},a.allocUnsafeSlow=function(A){return d(A)};function h(A,C){if((typeof C!="string"||C==="")&&(C="utf8"),!a.isEncoding(C))throw new TypeError("Unknown encoding: "+C);const k=_(A,C)|0;let M=s(k);const N=M.write(A,C);return N!==k&&(M=M.slice(0,N)),M}function f(A){const C=A.length<0?0:x(A.length)|0,k=s(C);for(let M=0;M<C;M+=1)k[M]=A[M]&255;return k}function p(A){if(yt(A,Uint8Array)){const C=new Uint8Array(A);return g(C.buffer,C.byteOffset,C.byteLength)}return f(A)}function g(A,C,k){if(C<0||A.byteLength<C)throw new RangeError('"offset" is outside of buffer bounds');if(A.byteLength<C+(k||0))throw new RangeError('"length" is outside of buffer bounds');let M;return C===void 0&&k===void 0?M=new Uint8Array(A):k===void 0?M=new Uint8Array(A,C):M=new Uint8Array(A,C,k),Object.setPrototypeOf(M,a.prototype),M}function y(A){if(a.isBuffer(A)){const C=x(A.length)|0,k=s(C);return k.length===0||A.copy(k,0,0,C),k}if(A.length!==void 0)return typeof A.length!="number"||nr(A.length)?s(0):f(A);if(A.type==="Buffer"&&Array.isArray(A.data))return f(A.data)}function x(A){if(A>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return A|0}function w(A){return+A!=A&&(A=0),a.alloc(+A)}a.isBuffer=function(C){return C!=null&&C._isBuffer===!0&&C!==a.prototype},a.compare=function(C,k){if(yt(C,Uint8Array)&&(C=a.from(C,C.offset,C.byteLength)),yt(k,Uint8Array)&&(k=a.from(k,k.offset,k.byteLength)),!a.isBuffer(C)||!a.isBuffer(k))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(C===k)return 0;let M=C.length,N=k.length;for(let G=0,ee=Math.min(M,N);G<ee;++G)if(C[G]!==k[G]){M=C[G],N=k[G];break}return M<N?-1:N<M?1:0},a.isEncoding=function(C){switch(String(C).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(C,k){if(!Array.isArray(C))throw new TypeError('"list" argument must be an Array of Buffers');if(C.length===0)return a.alloc(0);let M;if(k===void 0)for(k=0,M=0;M<C.length;++M)k+=C[M].length;const N=a.allocUnsafe(k);let G=0;for(M=0;M<C.length;++M){let ee=C[M];if(yt(ee,Uint8Array))G+ee.length>N.length?(a.isBuffer(ee)||(ee=a.from(ee)),ee.copy(N,G)):Uint8Array.prototype.set.call(N,ee,G);else if(a.isBuffer(ee))ee.copy(N,G);else throw new TypeError('"list" argument must be an Array of Buffers');G+=ee.length}return N};function _(A,C){if(a.isBuffer(A))return A.length;if(ArrayBuffer.isView(A)||yt(A,ArrayBuffer))return A.byteLength;if(typeof A!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof A);const k=A.length,M=arguments.length>2&&arguments[2]===!0;if(!M&&k===0)return 0;let N=!1;for(;;)switch(C){case"ascii":case"latin1":case"binary":return k;case"utf8":case"utf-8":return Zt(A).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return k*2;case"hex":return k>>>1;case"base64":return Rt(A).length;default:if(N)return M?-1:Zt(A).length;C=(""+C).toLowerCase(),N=!0}}a.byteLength=_;function S(A,C,k){let M=!1;if((C===void 0||C<0)&&(C=0),C>this.length||((k===void 0||k>this.length)&&(k=this.length),k<=0)||(k>>>=0,C>>>=0,k<=C))return"";for(A||(A="utf8");;)switch(A){case"hex":return F(this,C,k);case"utf8":case"utf-8":return B(this,C,k);case"ascii":return U(this,C,k);case"latin1":case"binary":return D(this,C,k);case"base64":return j(this,C,k);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return J(this,C,k);default:if(M)throw new TypeError("Unknown encoding: "+A);A=(A+"").toLowerCase(),M=!0}}a.prototype._isBuffer=!0;function T(A,C,k){const M=A[C];A[C]=A[k],A[k]=M}a.prototype.swap16=function(){const C=this.length;if(C%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let k=0;k<C;k+=2)T(this,k,k+1);return this},a.prototype.swap32=function(){const C=this.length;if(C%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let k=0;k<C;k+=4)T(this,k,k+3),T(this,k+1,k+2);return this},a.prototype.swap64=function(){const C=this.length;if(C%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let k=0;k<C;k+=8)T(this,k,k+7),T(this,k+1,k+6),T(this,k+2,k+5),T(this,k+3,k+4);return this},a.prototype.toString=function(){const C=this.length;return C===0?"":arguments.length===0?B(this,0,C):S.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(C){if(!a.isBuffer(C))throw new TypeError("Argument must be a Buffer");return this===C?!0:a.compare(this,C)===0},a.prototype.inspect=function(){let C="";const k=e.INSPECT_MAX_BYTES;return C=this.toString("hex",0,k).replace(/(.{2})/g,"$1 ").trim(),this.length>k&&(C+=" ... "),"<Buffer "+C+">"},r&&(a.prototype[r]=a.prototype.inspect),a.prototype.compare=function(C,k,M,N,G){if(yt(C,Uint8Array)&&(C=a.from(C,C.offset,C.byteLength)),!a.isBuffer(C))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof C);if(k===void 0&&(k=0),M===void 0&&(M=C?C.length:0),N===void 0&&(N=0),G===void 0&&(G=this.length),k<0||M>C.length||N<0||G>this.length)throw new RangeError("out of range index");if(N>=G&&k>=M)return 0;if(N>=G)return-1;if(k>=M)return 1;if(k>>>=0,M>>>=0,N>>>=0,G>>>=0,this===C)return 0;let ee=G-N,De=M-k;const et=Math.min(ee,De),Ye=this.slice(N,G),st=C.slice(k,M);for(let Ze=0;Ze<et;++Ze)if(Ye[Ze]!==st[Ze]){ee=Ye[Ze],De=st[Ze];break}return ee<De?-1:De<ee?1:0};function P(A,C,k,M,N){if(A.length===0)return-1;if(typeof k=="string"?(M=k,k=0):k>2147483647?k=2147483647:k<-2147483648&&(k=-2147483648),k=+k,nr(k)&&(k=N?0:A.length-1),k<0&&(k=A.length+k),k>=A.length){if(N)return-1;k=A.length-1}else if(k<0)if(N)k=0;else return-1;if(typeof C=="string"&&(C=a.from(C,M)),a.isBuffer(C))return C.length===0?-1:I(A,C,k,M,N);if(typeof C=="number")return C=C&255,typeof Uint8Array.prototype.indexOf=="function"?N?Uint8Array.prototype.indexOf.call(A,C,k):Uint8Array.prototype.lastIndexOf.call(A,C,k):I(A,[C],k,M,N);throw new TypeError("val must be string, number or Buffer")}function I(A,C,k,M,N){let G=1,ee=A.length,De=C.length;if(M!==void 0&&(M=String(M).toLowerCase(),M==="ucs2"||M==="ucs-2"||M==="utf16le"||M==="utf-16le")){if(A.length<2||C.length<2)return-1;G=2,ee/=2,De/=2,k/=2}function et(st,Ze){return G===1?st[Ze]:st.readUInt16BE(Ze*G)}let Ye;if(N){let st=-1;for(Ye=k;Ye<ee;Ye++)if(et(A,Ye)===et(C,st===-1?0:Ye-st)){if(st===-1&&(st=Ye),Ye-st+1===De)return st*G}else st!==-1&&(Ye-=Ye-st),st=-1}else for(k+De>ee&&(k=ee-De),Ye=k;Ye>=0;Ye--){let st=!0;for(let Ze=0;Ze<De;Ze++)if(et(A,Ye+Ze)!==et(C,Ze)){st=!1;break}if(st)return Ye}return-1}a.prototype.includes=function(C,k,M){return this.indexOf(C,k,M)!==-1},a.prototype.indexOf=function(C,k,M){return P(this,C,k,M,!0)},a.prototype.lastIndexOf=function(C,k,M){return P(this,C,k,M,!1)};function $(A,C,k,M){k=Number(k)||0;const N=A.length-k;M?(M=Number(M),M>N&&(M=N)):M=N;const G=C.length;M>G/2&&(M=G/2);let ee;for(ee=0;ee<M;++ee){const De=parseInt(C.substr(ee*2,2),16);if(nr(De))return ee;A[k+ee]=De}return ee}function L(A,C,k,M){return rn(Zt(C,A.length-k),A,k,M)}function R(A,C,k,M){return rn(_n(C),A,k,M)}function K(A,C,k,M){return rn(Rt(C),A,k,M)}function Q(A,C,k,M){return rn(Cn(C,A.length-k),A,k,M)}a.prototype.write=function(C,k,M,N){if(k===void 0)N="utf8",M=this.length,k=0;else if(M===void 0&&typeof k=="string")N=k,M=this.length,k=0;else if(isFinite(k))k=k>>>0,isFinite(M)?(M=M>>>0,N===void 0&&(N="utf8")):(N=M,M=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const G=this.length-k;if((M===void 0||M>G)&&(M=G),C.length>0&&(M<0||k<0)||k>this.length)throw new RangeError("Attempt to write outside buffer bounds");N||(N="utf8");let ee=!1;for(;;)switch(N){case"hex":return $(this,C,k,M);case"utf8":case"utf-8":return L(this,C,k,M);case"ascii":case"latin1":case"binary":return R(this,C,k,M);case"base64":return K(this,C,k,M);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Q(this,C,k,M);default:if(ee)throw new TypeError("Unknown encoding: "+N);N=(""+N).toLowerCase(),ee=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function j(A,C,k){return C===0&&k===A.length?t.fromByteArray(A):t.fromByteArray(A.slice(C,k))}function B(A,C,k){k=Math.min(A.length,k);const M=[];let N=C;for(;N<k;){const G=A[N];let ee=null,De=G>239?4:G>223?3:G>191?2:1;if(N+De<=k){let et,Ye,st,Ze;switch(De){case 1:G<128&&(ee=G);break;case 2:et=A[N+1],(et&192)===128&&(Ze=(G&31)<<6|et&63,Ze>127&&(ee=Ze));break;case 3:et=A[N+1],Ye=A[N+2],(et&192)===128&&(Ye&192)===128&&(Ze=(G&15)<<12|(et&63)<<6|Ye&63,Ze>2047&&(Ze<55296||Ze>57343)&&(ee=Ze));break;case 4:et=A[N+1],Ye=A[N+2],st=A[N+3],(et&192)===128&&(Ye&192)===128&&(st&192)===128&&(Ze=(G&15)<<18|(et&63)<<12|(Ye&63)<<6|st&63,Ze>65535&&Ze<1114112&&(ee=Ze))}}ee===null?(ee=65533,De=1):ee>65535&&(ee-=65536,M.push(ee>>>10&1023|55296),ee=56320|ee&1023),M.push(ee),N+=De}return q(M)}const z=4096;function q(A){const C=A.length;if(C<=z)return String.fromCharCode.apply(String,A);let k="",M=0;for(;M<C;)k+=String.fromCharCode.apply(String,A.slice(M,M+=z));return k}function U(A,C,k){let M="";k=Math.min(A.length,k);for(let N=C;N<k;++N)M+=String.fromCharCode(A[N]&127);return M}function D(A,C,k){let M="";k=Math.min(A.length,k);for(let N=C;N<k;++N)M+=String.fromCharCode(A[N]);return M}function F(A,C,k){const M=A.length;(!C||C<0)&&(C=0),(!k||k<0||k>M)&&(k=M);let N="";for(let G=C;G<k;++G)N+=is[A[G]];return N}function J(A,C,k){const M=A.slice(C,k);let N="";for(let G=0;G<M.length-1;G+=2)N+=String.fromCharCode(M[G]+M[G+1]*256);return N}a.prototype.slice=function(C,k){const M=this.length;C=~~C,k=k===void 0?M:~~k,C<0?(C+=M,C<0&&(C=0)):C>M&&(C=M),k<0?(k+=M,k<0&&(k=0)):k>M&&(k=M),k<C&&(k=C);const N=this.subarray(C,k);return Object.setPrototypeOf(N,a.prototype),N};function Z(A,C,k){if(A%1!==0||A<0)throw new RangeError("offset is not uint");if(A+C>k)throw new RangeError("Trying to access beyond buffer length")}a.prototype.readUintLE=a.prototype.readUIntLE=function(C,k,M){C=C>>>0,k=k>>>0,M||Z(C,k,this.length);let N=this[C],G=1,ee=0;for(;++ee<k&&(G*=256);)N+=this[C+ee]*G;return N},a.prototype.readUintBE=a.prototype.readUIntBE=function(C,k,M){C=C>>>0,k=k>>>0,M||Z(C,k,this.length);let N=this[C+--k],G=1;for(;k>0&&(G*=256);)N+=this[C+--k]*G;return N},a.prototype.readUint8=a.prototype.readUInt8=function(C,k){return C=C>>>0,k||Z(C,1,this.length),this[C]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(C,k){return C=C>>>0,k||Z(C,2,this.length),this[C]|this[C+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(C,k){return C=C>>>0,k||Z(C,2,this.length),this[C]<<8|this[C+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(C,k){return C=C>>>0,k||Z(C,4,this.length),(this[C]|this[C+1]<<8|this[C+2]<<16)+this[C+3]*16777216},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(C,k){return C=C>>>0,k||Z(C,4,this.length),this[C]*16777216+(this[C+1]<<16|this[C+2]<<8|this[C+3])},a.prototype.readBigUInt64LE=zn(function(C){C=C>>>0,Wt(C,"offset");const k=this[C],M=this[C+7];(k===void 0||M===void 0)&&_t(C,this.length-8);const N=k+this[++C]*2**8+this[++C]*2**16+this[++C]*2**24,G=this[++C]+this[++C]*2**8+this[++C]*2**16+M*2**24;return BigInt(N)+(BigInt(G)<<BigInt(32))}),a.prototype.readBigUInt64BE=zn(function(C){C=C>>>0,Wt(C,"offset");const k=this[C],M=this[C+7];(k===void 0||M===void 0)&&_t(C,this.length-8);const N=k*2**24+this[++C]*2**16+this[++C]*2**8+this[++C],G=this[++C]*2**24+this[++C]*2**16+this[++C]*2**8+M;return(BigInt(N)<<BigInt(32))+BigInt(G)}),a.prototype.readIntLE=function(C,k,M){C=C>>>0,k=k>>>0,M||Z(C,k,this.length);let N=this[C],G=1,ee=0;for(;++ee<k&&(G*=256);)N+=this[C+ee]*G;return G*=128,N>=G&&(N-=Math.pow(2,8*k)),N},a.prototype.readIntBE=function(C,k,M){C=C>>>0,k=k>>>0,M||Z(C,k,this.length);let N=k,G=1,ee=this[C+--N];for(;N>0&&(G*=256);)ee+=this[C+--N]*G;return G*=128,ee>=G&&(ee-=Math.pow(2,8*k)),ee},a.prototype.readInt8=function(C,k){return C=C>>>0,k||Z(C,1,this.length),this[C]&128?(255-this[C]+1)*-1:this[C]},a.prototype.readInt16LE=function(C,k){C=C>>>0,k||Z(C,2,this.length);const M=this[C]|this[C+1]<<8;return M&32768?M|4294901760:M},a.prototype.readInt16BE=function(C,k){C=C>>>0,k||Z(C,2,this.length);const M=this[C+1]|this[C]<<8;return M&32768?M|4294901760:M},a.prototype.readInt32LE=function(C,k){return C=C>>>0,k||Z(C,4,this.length),this[C]|this[C+1]<<8|this[C+2]<<16|this[C+3]<<24},a.prototype.readInt32BE=function(C,k){return C=C>>>0,k||Z(C,4,this.length),this[C]<<24|this[C+1]<<16|this[C+2]<<8|this[C+3]},a.prototype.readBigInt64LE=zn(function(C){C=C>>>0,Wt(C,"offset");const k=this[C],M=this[C+7];(k===void 0||M===void 0)&&_t(C,this.length-8);const N=this[C+4]+this[C+5]*2**8+this[C+6]*2**16+(M<<24);return(BigInt(N)<<BigInt(32))+BigInt(k+this[++C]*2**8+this[++C]*2**16+this[++C]*2**24)}),a.prototype.readBigInt64BE=zn(function(C){C=C>>>0,Wt(C,"offset");const k=this[C],M=this[C+7];(k===void 0||M===void 0)&&_t(C,this.length-8);const N=(k<<24)+this[++C]*2**16+this[++C]*2**8+this[++C];return(BigInt(N)<<BigInt(32))+BigInt(this[++C]*2**24+this[++C]*2**16+this[++C]*2**8+M)}),a.prototype.readFloatLE=function(C,k){return C=C>>>0,k||Z(C,4,this.length),n.read(this,C,!0,23,4)},a.prototype.readFloatBE=function(C,k){return C=C>>>0,k||Z(C,4,this.length),n.read(this,C,!1,23,4)},a.prototype.readDoubleLE=function(C,k){return C=C>>>0,k||Z(C,8,this.length),n.read(this,C,!0,52,8)},a.prototype.readDoubleBE=function(C,k){return C=C>>>0,k||Z(C,8,this.length),n.read(this,C,!1,52,8)};function ne(A,C,k,M,N,G){if(!a.isBuffer(A))throw new TypeError('"buffer" argument must be a Buffer instance');if(C>N||C<G)throw new RangeError('"value" argument is out of bounds');if(k+M>A.length)throw new RangeError("Index out of range")}a.prototype.writeUintLE=a.prototype.writeUIntLE=function(C,k,M,N){if(C=+C,k=k>>>0,M=M>>>0,!N){const De=Math.pow(2,8*M)-1;ne(this,C,k,M,De,0)}let G=1,ee=0;for(this[k]=C&255;++ee<M&&(G*=256);)this[k+ee]=C/G&255;return k+M},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(C,k,M,N){if(C=+C,k=k>>>0,M=M>>>0,!N){const De=Math.pow(2,8*M)-1;ne(this,C,k,M,De,0)}let G=M-1,ee=1;for(this[k+G]=C&255;--G>=0&&(ee*=256);)this[k+G]=C/ee&255;return k+M},a.prototype.writeUint8=a.prototype.writeUInt8=function(C,k,M){return C=+C,k=k>>>0,M||ne(this,C,k,1,255,0),this[k]=C&255,k+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(C,k,M){return C=+C,k=k>>>0,M||ne(this,C,k,2,65535,0),this[k]=C&255,this[k+1]=C>>>8,k+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(C,k,M){return C=+C,k=k>>>0,M||ne(this,C,k,2,65535,0),this[k]=C>>>8,this[k+1]=C&255,k+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(C,k,M){return C=+C,k=k>>>0,M||ne(this,C,k,4,4294967295,0),this[k+3]=C>>>24,this[k+2]=C>>>16,this[k+1]=C>>>8,this[k]=C&255,k+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(C,k,M){return C=+C,k=k>>>0,M||ne(this,C,k,4,4294967295,0),this[k]=C>>>24,this[k+1]=C>>>16,this[k+2]=C>>>8,this[k+3]=C&255,k+4};function de(A,C,k,M,N){mt(C,M,N,A,k,7);let G=Number(C&BigInt(4294967295));A[k++]=G,G=G>>8,A[k++]=G,G=G>>8,A[k++]=G,G=G>>8,A[k++]=G;let ee=Number(C>>BigInt(32)&BigInt(4294967295));return A[k++]=ee,ee=ee>>8,A[k++]=ee,ee=ee>>8,A[k++]=ee,ee=ee>>8,A[k++]=ee,k}function Ce(A,C,k,M,N){mt(C,M,N,A,k,7);let G=Number(C&BigInt(4294967295));A[k+7]=G,G=G>>8,A[k+6]=G,G=G>>8,A[k+5]=G,G=G>>8,A[k+4]=G;let ee=Number(C>>BigInt(32)&BigInt(4294967295));return A[k+3]=ee,ee=ee>>8,A[k+2]=ee,ee=ee>>8,A[k+1]=ee,ee=ee>>8,A[k]=ee,k+8}a.prototype.writeBigUInt64LE=zn(function(C,k=0){return de(this,C,k,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeBigUInt64BE=zn(function(C,k=0){return Ce(this,C,k,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeIntLE=function(C,k,M,N){if(C=+C,k=k>>>0,!N){const et=Math.pow(2,8*M-1);ne(this,C,k,M,et-1,-et)}let G=0,ee=1,De=0;for(this[k]=C&255;++G<M&&(ee*=256);)C<0&&De===0&&this[k+G-1]!==0&&(De=1),this[k+G]=(C/ee>>0)-De&255;return k+M},a.prototype.writeIntBE=function(C,k,M,N){if(C=+C,k=k>>>0,!N){const et=Math.pow(2,8*M-1);ne(this,C,k,M,et-1,-et)}let G=M-1,ee=1,De=0;for(this[k+G]=C&255;--G>=0&&(ee*=256);)C<0&&De===0&&this[k+G+1]!==0&&(De=1),this[k+G]=(C/ee>>0)-De&255;return k+M},a.prototype.writeInt8=function(C,k,M){return C=+C,k=k>>>0,M||ne(this,C,k,1,127,-128),C<0&&(C=255+C+1),this[k]=C&255,k+1},a.prototype.writeInt16LE=function(C,k,M){return C=+C,k=k>>>0,M||ne(this,C,k,2,32767,-32768),this[k]=C&255,this[k+1]=C>>>8,k+2},a.prototype.writeInt16BE=function(C,k,M){return C=+C,k=k>>>0,M||ne(this,C,k,2,32767,-32768),this[k]=C>>>8,this[k+1]=C&255,k+2},a.prototype.writeInt32LE=function(C,k,M){return C=+C,k=k>>>0,M||ne(this,C,k,4,2147483647,-2147483648),this[k]=C&255,this[k+1]=C>>>8,this[k+2]=C>>>16,this[k+3]=C>>>24,k+4},a.prototype.writeInt32BE=function(C,k,M){return C=+C,k=k>>>0,M||ne(this,C,k,4,2147483647,-2147483648),C<0&&(C=4294967295+C+1),this[k]=C>>>24,this[k+1]=C>>>16,this[k+2]=C>>>8,this[k+3]=C&255,k+4},a.prototype.writeBigInt64LE=zn(function(C,k=0){return de(this,C,k,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),a.prototype.writeBigInt64BE=zn(function(C,k=0){return Ce(this,C,k,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function he(A,C,k,M,N,G){if(k+M>A.length)throw new RangeError("Index out of range");if(k<0)throw new RangeError("Index out of range")}function je(A,C,k,M,N){return C=+C,k=k>>>0,N||he(A,C,k,4),n.write(A,C,k,M,23,4),k+4}a.prototype.writeFloatLE=function(C,k,M){return je(this,C,k,!0,M)},a.prototype.writeFloatBE=function(C,k,M){return je(this,C,k,!1,M)};function $e(A,C,k,M,N){return C=+C,k=k>>>0,N||he(A,C,k,8),n.write(A,C,k,M,52,8),k+8}a.prototype.writeDoubleLE=function(C,k,M){return $e(this,C,k,!0,M)},a.prototype.writeDoubleBE=function(C,k,M){return $e(this,C,k,!1,M)},a.prototype.copy=function(C,k,M,N){if(!a.isBuffer(C))throw new TypeError("argument should be a Buffer");if(M||(M=0),!N&&N!==0&&(N=this.length),k>=C.length&&(k=C.length),k||(k=0),N>0&&N<M&&(N=M),N===M||C.length===0||this.length===0)return 0;if(k<0)throw new RangeError("targetStart out of bounds");if(M<0||M>=this.length)throw new RangeError("Index out of range");if(N<0)throw new RangeError("sourceEnd out of bounds");N>this.length&&(N=this.length),C.length-k<N-M&&(N=C.length-k+M);const G=N-M;return this===C&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(k,M,N):Uint8Array.prototype.set.call(C,this.subarray(M,N),k),G},a.prototype.fill=function(C,k,M,N){if(typeof C=="string"){if(typeof k=="string"?(N=k,k=0,M=this.length):typeof M=="string"&&(N=M,M=this.length),N!==void 0&&typeof N!="string")throw new TypeError("encoding must be a string");if(typeof N=="string"&&!a.isEncoding(N))throw new TypeError("Unknown encoding: "+N);if(C.length===1){const ee=C.charCodeAt(0);(N==="utf8"&&ee<128||N==="latin1")&&(C=ee)}}else typeof C=="number"?C=C&255:typeof C=="boolean"&&(C=Number(C));if(k<0||this.length<k||this.length<M)throw new RangeError("Out of range index");if(M<=k)return this;k=k>>>0,M=M===void 0?this.length:M>>>0,C||(C=0);let G;if(typeof C=="number")for(G=k;G<M;++G)this[G]=C;else{const ee=a.isBuffer(C)?C:a.from(C,N),De=ee.length;if(De===0)throw new TypeError('The value "'+C+'" is invalid for argument "value"');for(G=0;G<M-k;++G)this[G+k]=ee[G%De]}return this};const Ee={};function Ie(A,C,k){Ee[A]=class extends k{constructor(){super(),Object.defineProperty(this,"message",{value:C.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${A}]`,this.stack,delete this.name}get code(){return A}set code(N){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:N,writable:!0})}toString(){return`${this.name} [${A}]: ${this.message}`}}}Ie("ERR_BUFFER_OUT_OF_BOUNDS",function(A){return A?`${A} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),Ie("ERR_INVALID_ARG_TYPE",function(A,C){return`The "${A}" argument must be of type number. Received type ${typeof C}`},TypeError),Ie("ERR_OUT_OF_RANGE",function(A,C,k){let M=`The value of "${A}" is out of range.`,N=k;return Number.isInteger(k)&&Math.abs(k)>2**32?N=Fe(String(k)):typeof k=="bigint"&&(N=String(k),(k>BigInt(2)**BigInt(32)||k<-(BigInt(2)**BigInt(32)))&&(N=Fe(N)),N+="n"),M+=` It must be ${C}. Received ${N}`,M},RangeError);function Fe(A){let C="",k=A.length;const M=A[0]==="-"?1:0;for(;k>=M+4;k-=3)C=`_${A.slice(k-3,k)}${C}`;return`${A.slice(0,k)}${C}`}function ct(A,C,k){Wt(C,"offset"),(A[C]===void 0||A[C+k]===void 0)&&_t(C,A.length-(k+1))}function mt(A,C,k,M,N,G){if(A>k||A<C){const ee=typeof C=="bigint"?"n":"";let De;throw G>3?C===0||C===BigInt(0)?De=`>= 0${ee} and < 2${ee} ** ${(G+1)*8}${ee}`:De=`>= -(2${ee} ** ${(G+1)*8-1}${ee}) and < 2 ** ${(G+1)*8-1}${ee}`:De=`>= ${C}${ee} and <= ${k}${ee}`,new Ee.ERR_OUT_OF_RANGE("value",De,A)}ct(M,N,G)}function Wt(A,C){if(typeof A!="number")throw new Ee.ERR_INVALID_ARG_TYPE(C,"number",A)}function _t(A,C,k){throw Math.floor(A)!==A?(Wt(A,k),new Ee.ERR_OUT_OF_RANGE(k||"offset","an integer",A)):C<0?new Ee.ERR_BUFFER_OUT_OF_BOUNDS:new Ee.ERR_OUT_OF_RANGE(k||"offset",`>= ${k?1:0} and <= ${C}`,A)}const jn=/[^+/0-9A-Za-z-_]/g;function Sn(A){if(A=A.split("=")[0],A=A.trim().replace(jn,""),A.length<2)return"";for(;A.length%4!==0;)A=A+"=";return A}function Zt(A,C){C=C||1/0;let k;const M=A.length;let N=null;const G=[];for(let ee=0;ee<M;++ee){if(k=A.charCodeAt(ee),k>55295&&k<57344){if(!N){if(k>56319){(C-=3)>-1&&G.push(239,191,189);continue}else if(ee+1===M){(C-=3)>-1&&G.push(239,191,189);continue}N=k;continue}if(k<56320){(C-=3)>-1&&G.push(239,191,189),N=k;continue}k=(N-55296<<10|k-56320)+65536}else N&&(C-=3)>-1&&G.push(239,191,189);if(N=null,k<128){if((C-=1)<0)break;G.push(k)}else if(k<2048){if((C-=2)<0)break;G.push(k>>6|192,k&63|128)}else if(k<65536){if((C-=3)<0)break;G.push(k>>12|224,k>>6&63|128,k&63|128)}else if(k<1114112){if((C-=4)<0)break;G.push(k>>18|240,k>>12&63|128,k>>6&63|128,k&63|128)}else throw new Error("Invalid code point")}return G}function _n(A){const C=[];for(let k=0;k<A.length;++k)C.push(A.charCodeAt(k)&255);return C}function Cn(A,C){let k,M,N;const G=[];for(let ee=0;ee<A.length&&!((C-=2)<0);++ee)k=A.charCodeAt(ee),M=k>>8,N=k%256,G.push(N),G.push(M);return G}function Rt(A){return t.toByteArray(Sn(A))}function rn(A,C,k,M){let N;for(N=0;N<M&&!(N+k>=C.length||N>=A.length);++N)C[N+k]=A[N];return N}function yt(A,C){return A instanceof C||A!=null&&A.constructor!=null&&A.constructor.name!=null&&A.constructor.name===C.name}function nr(A){return A!==A}const is=function(){const A="0123456789abcdef",C=new Array(256);for(let k=0;k<16;++k){const M=k*16;for(let N=0;N<16;++N)C[M+N]=A[k]+A[N]}return C}();function zn(A){return typeof BigInt>"u"?os:A}function os(){throw new Error("BigInt not supported")}})(h5);const Fk=(e,t)=>h5.Buffer.from(e,t);function yq(e,t){const n=(r,i)=>t(Fk(r),i)>>>0;return n.signed=(r,i)=>t(Fk(r),i),n.unsigned=n,n.model=e,n}const vq=yq("crc-32",lq);function p5(e,t){return e.getUint8(t+0)===137&&e.getUint8(t+1)===80&&e.getUint8(t+2)===78&&e.getUint8(t+3)===71&&e.getUint8(t+4)===13&&e.getUint8(t+5)===10&&e.getUint8(t+6)===26&&e.getUint8(t+7)===10}function xq(e,t){return[String.fromCharCode(e.getUint8(t)),String.fromCharCode(e.getUint8(t+1)),String.fromCharCode(e.getUint8(t+2)),String.fromCharCode(e.getUint8(t+3))].join("")}function bq(e){return vq(e)}const Nk=4,jk=4;function wq(e,t=0){const n={};if(!p5(e,t))throw new Error("Not a PNG");for(t+=8;t<=e.buffer.byteLength;){const r=t,i=e.getInt32(t);t+=4;const o=xq(e,t);if(o==="IDAT"&&n[o]){t+=i+Nk+jk;continue}if(o==="IEND")break;n[o]={start:r,dataOffset:t+4,size:i},t+=i+Nk+jk}return n}function Sq(e,t){return{ppux:e.getUint32(t),ppuy:e.getUint32(t+4),unit:e.getUint8(t+4)}}function yb(e,t){return wq(e)[t]}function _q(e,t=1,n){let r=46,i=0;const o=yb(e,"pHYs");o&&(r=o.start,i=o.size);const s=yb(e,"IDAT");s&&(r=s.start,i=0);const a=new ArrayBuffer(21),l=new DataView(a);l.setUint32(0,9),l.setUint8(4,"p".charCodeAt(0)),l.setUint8(5,"H".charCodeAt(0)),l.setUint8(6,"Y".charCodeAt(0)),l.setUint8(7,"s".charCodeAt(0));const c=2835.5;l.setInt32(8,c*t),l.setInt32(12,c*t),l.setInt8(16,1);const u=new Uint8Array(a.slice(4,17));l.setInt32(17,bq(u));const d=e.buffer.slice(0,r),h=e.buffer.slice(r+i);return new Blob([d,a,h],n)}const s_=["image/jpeg","image/png","image/gif","image/svg+xml"],g5=["video/mp4","video/quicktime"],Cq=s_.concat(g5).join(", "),m5=e=>s_.includes(e);async function Eq(e){return await new Promise((t,n)=>{const r=document.createElement("video");r.onloadeddata=()=>t({w:r.videoWidth,h:r.videoHeight}),r.onerror=i=>{console.error(i),n(new Error("Could not get video size"))},r.crossOrigin="anonymous",r.src=e})}async function kq(e){return fetch(e).then(function(t){return t.arrayBuffer()})}async function Tq(e){return await new Promise((t,n)=>{const r=new Image;r.onload=async()=>{try{const i=await kq(e),o=new DataView(i);if(p5(o,0)){const s=yb(o,"pHYs");if(s){const a=Sq(o,s.dataOffset);if(a.unit===0&&a.ppux===a.ppuy){const l=Math.round(a.ppux/2834.5);t({w:r.width/l,h:r.height/l});return}}}t({w:r.width,h:r.height})}catch(i){console.error(i),t({w:r.width,h:r.height})}},r.onerror=i=>{console.error(i),n(new Error("Could not get image size"))},r.crossOrigin="anonymous",r.src=e})}async function Pq(e,t,n){return await new Promise(r=>{const i=new Image;i.onload=()=>{const o=document.createElement("canvas"),s=o.getContext("2d");if(!s)return;o.width=t*2,o.height=n*2,s.drawImage(i,0,0,o.width,o.height);const a=o.toDataURL();r(a)},i.crossOrigin="anonymous",i.src=e})}async function Iq(e){return await new Promise((t,n)=>{const r=new FileReader;r.onerror=()=>n(r.error),r.onload=async()=>{let i=r.result;const o=m5(e.type),s=o?Tq:Eq;e.type==="video/quicktime"&&i.includes("video/quicktime")&&(i=i.replace("video/quicktime","video/mp4"));const a=await s(i),l=Aq(a,{w:QY,h:JY});l!==a&&(e.type==="image/jpeg"||e.type==="image/png")&&(i=await Pq(i,l.w,l.h));const c=Oh.createId(OS(i)),u=await $q(e),d={id:c,type:o?"image":"video",typeName:"asset",props:{name:e.name,src:i,w:l.w,h:l.h,mimeType:e.type,isAnimated:u.isAnimated}};t(d)},r.readAsDataURL(e)})}async function $q(e){return e.type==="image/gif"?await new Promise((t,n)=>{const r=new FileReader;r.onerror=()=>n(r.error),r.onload=()=>{t({isAnimated:r.result?aq(r.result):!1})},r.readAsArrayBuffer(e)}):{isAnimated:!m5(e.type)}}function Aq(e,t){const n=e.w/t.w,r=e.h/t.h;return n<=1&&r<=1?e:n>r?{w:e.w/n,h:e.h/n}:{w:e.w/r,h:e.h/r}}async function a_(e,t,n,r=!1){const i=new E(n.x,n.y),o=new Map,s=await Promise.all(t.map(async(f,p)=>{if(!f.type)throw new Error("No mime type");if(!s_.concat(g5).includes(f.type))return console.warn(`${f.name} not loaded - Extension not allowed.`),null;try{const g=await e.onCreateAssetFromFile(f);if(g.type==="bookmark")return;if(!g)throw Error("Could not create an asset");return o.set(f,g),{id:gt(),type:g.type,x:i.x+p,y:i.y,props:{w:g.props.w,h:g.props.h}}}catch(g){return console.error(g),null}})),a=Ae(s).sort((f,p)=>f.x-p.x);if(a.length===0)return;for(let f=0;f<a.length;f++){const p=a[f];if(f===0)p.x-=p.props.w/2,p.y-=p.props.h/2;else{const g=a[f-1];p.x=g.x+g.props.w,p.y=g.y}}const l=await Promise.all(t.map(async(f,p)=>{const g=a[p];if(!g)return;const y=o.get(f);if(!y)return;let x=e.getAssetById(y.id);return x?(o.delete(f),g.props&&(g.props.assetId=x.id),g):(x=e.getAssetBySrc(y.props.src),x?(g.props&&(g.props.assetId=x.id),g):(g.props&&(g.props.assetId=y.id),g))})),c=Ae(l);e.createAssets(Ae([...o.values()])),e.createShapes(c),e.setSelectedIds(c.map(f=>f.id));const{selectedIds:u,viewportPageBounds:d}=e,h=me.Common(Ae(u.map(f=>e.getPageBoundsById(f))));h&&!d.contains(h)&&e.zoomToSelection()}function y5(e,t,n,r){e.createShapes([{id:gt(),type:"embed",x:n.x-(r.width||450)/2,y:n.y-(r.height||450)/2,props:{w:r.width,h:r.height,doesResize:r.doesResize,url:t}}],!0)}async function Mq(e,t,n){const r=Oh.createId(OS(t)),i=e.getAssetById(r);if(i){e.createShapes([{id:gt(),type:"bookmark",x:n.x-150,y:n.y-160,opacity:1,props:{assetId:i.id,url:i.props.src}}]);return}e.batch(async()=>{const o=gt();e.createShapes([{id:o,type:"bookmark",x:n.x,y:n.y,opacity:1,props:{url:t}}],!0);const s=await e.onCreateBookmarkFromUrl(t);s&&(e.createAssets([{id:r,typeName:"asset",type:"bookmark",props:{src:t,description:s.description,image:s.image,title:s.title}}]),e.updateShapes([{id:o,type:"bookmark",opacity:1,props:{assetId:r}}]))})}async function Oq(e,t,n){const r=new DOMParser().parseFromString(t,"image/svg+xml").querySelector("svg");if(!r)throw new Error("No <svg/> element present");let i=parseFloat(r.getAttribute("width")||"0"),o=parseFloat(r.getAttribute("height")||"0");if(!(i&&o)){document.body.appendChild(r);const a=r.getBoundingClientRect();document.body.removeChild(r),i=a.width,o=a.height}const s=await e.onCreateAssetFromFile(new File([t],"asset.svg",{type:"image/svg+xml"}));s.type!=="bookmark"&&(s.props.w=i,s.props.h=o),e.batch(()=>{e.createAssets([s]),e.createShapes([{id:gt(),type:"image",x:n.x-i/2,y:n.y-o/2,opacity:1,props:{assetId:s.id,w:i,h:o}}],!0)})}const Lq=e=>{try{const t=new URL(e);return t.protocol==="http:"||t.protocol==="https:"}catch{return!1}},Bq=e=>{const t=e.split(/[\n\s]/);for(const n of t)try{const r=new URL(n);if(!(r.protocol==="http:"||r.protocol==="https:"))return}catch{return}return c5(t)},Rq=e=>/^<svg/.test(e);function Dq(e,t,n){return fetch(e).then(function(r){return r.arrayBuffer()}).then(function(r){return new File([r],t,{type:n})})}const l_={peopleMenu:zk("peopleMenu"),highlighterTool:zk("highlighterTool",{all:!0})},nn={preventDefaultLogging:mi("preventDefaultLogging",{defaults:{all:!1}}),pointerCaptureLogging:mi("pointerCaptureLogging",{defaults:{all:!1}}),pointerCaptureTracking:mi("pointerCaptureTracking",{defaults:{all:!1}}),pointerCaptureTrackingObject:mi("pointerCaptureTrackingObject",{defaults:{all:new Map},shouldStoreForSession:!1}),elementRemovalLogging:mi("elementRemovalLogging",{defaults:{all:!1}}),debugSvg:mi("debugSvg",{defaults:{all:!1}}),throwToBlob:mi("throwToBlob",{defaults:{all:!1}}),logMessages:mi("uiLog",{defaults:{all:[]}}),resetConnectionEveryPing:mi("resetConnectionEveryPing",{defaults:{all:!1}}),debugCursors:mi("debugCursors",{defaults:{all:!1}}),forceSrgb:mi("forceSrgbColors",{defaults:{all:!1}})};typeof window<"u"&&(window.tldrawLog=e=>{nn.logMessages.set(nn.logMessages.value.concat(e))});if(typeof Element<"u"){const e=Element.prototype.removeChild;my("element removal logging",()=>{nn.elementRemovalLogging.value?Element.prototype.removeChild=function(t){return console.warn("[tldraw] removing child:",t),e.call(this,t)}:Element.prototype.removeChild=e})}function mi(e,{defaults:t,shouldStoreForSession:n=!0}){return v5({name:e,defaults:t,shouldStoreForSession:n})}function zk(e,t={all:!0,production:!1}){return v5({name:e,defaults:t,shouldStoreForSession:!0})}function v5(e){const t=Nq(e),n=e.shouldStoreForSession?Fq(e.name):null,r=jt(`debug:${e.name}`,n??t);return typeof window<"u"&&(e.shouldStoreForSession&&my(`debug:${e.name}`,()=>{const i=r.value;try{i===t?window.sessionStorage.removeItem(`tldraw_debug:${e.name}`):window.sessionStorage.setItem(`tldraw_debug:${e.name}`,JSON.stringify(i))}catch{}}),Object.defineProperty(window,`tldraw${e.name.replace(/^[a-z]/,i=>i.toUpperCase())}`,{get(){return r.value},set(i){r.set(i)},configurable:!0})),Object.assign(r,e)}function Fq(e){try{return JSON.parse((window==null?void 0:window.sessionStorage.getItem(`tldraw_debug:${e}`))??"null")}catch{return null}}function Iv(e){try{return e()}catch{return null}}function Nq(e){switch(Iv(()=>({}).TLDRAW_ENV)??Iv(()=>({}).VERCEL_PUBLIC_TLDRAW_ENV)??Iv(()=>({}).NEXT_PUBLIC_TLDRAW_ENV)??"production"){case"production":return e.defaults.production??e.defaults.all;case"preview":case"staging":return e.defaults.staging??e.defaults.all;default:return e.defaults.development??e.defaults.all}}function am(e){if(e instanceof HTMLElement)return e;if(e.parentElement)return am(e.parentElement);throw Error("Could not find a parent element of an HTML type!")}function Xe(e){e.preventDefault(),nn.preventDefaultLogging.value&&console.warn("preventDefault called on event:",e)}function Lh(e,t){if(e.setPointerCapture(t.pointerId),nn.pointerCaptureTracking.value){const n=nn.pointerCaptureTrackingObject.value;n.set(e,(n.get(e)??0)+1)}nn.pointerCaptureLogging.value&&console.warn("setPointerCapture called on element:",e,t)}function Bh(e,t){if(e.hasPointerCapture(t.pointerId)){if(e.releasePointerCapture(t.pointerId),nn.pointerCaptureTracking.value){const n=nn.pointerCaptureTrackingObject.value;n.get(e)===1?n.delete(e):n.has(e)?n.set(e,n.get(e)-1):console.warn("Release without capture")}nn.pointerCaptureLogging.value&&console.warn("releasePointerCapture called on element:",e,t)}}function c_(e,t){return t.map(r=>{const{offsetX:i,offsetY:o,blur:s,spread:a,color:l}=r,c=new E(i,o),{x:u,y:d}=c.rot(-e);return`${u}px ${d}px ${s}px ${a}px ${l}`}).join(", ")}function x5(){const[e,t]=b.useState(!1);return b.useEffect(()=>{const n=window.matchMedia("(prefers-reduced-motion: reduce)"),r=()=>{t(n.matches)};return r(),n.addEventListener("change",r),()=>n.removeEventListener("change",r)},[]),e}const $v=(e,t)=>e.length<=t?e:e.substring(0,t-3)+"...",Qi=e=>e.stopPropagation();function en(e,t){e.isKilled=!0;const{top:n,left:r}=t.getBoundingClientRect();return{point:{x:e.clientX-r,y:e.clientY-n,z:e.pressure},shiftKey:e.shiftKey,altKey:e.altKey,ctrlKey:e.metaKey||e.ctrlKey,pointerId:e.pointerId,button:e.button,isPen:e.pointerType==="pen"}}function Zr(e){return`${Y(e.x)},${Y(e.y)} `}function Qr(e,t){return`${Y((e.x+t.x)/2)},${Y((e.y+t.y)/2)} `}function Yd(e,t=!0){const n=e.length;if(n<2)return"";let r=e[0],i=e[1];if(n===2)return`M${Zr(r)}L${Zr(i)}`;let o="";for(let s=2,a=n-1;s<a;s++)r=e[s],i=e[s+1],o+=Qr(r,i);return t?`M${Qr(e[0],e[1])}Q${Zr(e[1])}${Qr(e[1],e[2])}T${o}${Qr(e[n-1],e[0])}${Qr(e[0],e[1])}Z`:`M${Zr(e[0])}Q${Zr(e[1])}${Qr(e[1],e[2])}${e.length>3?"T":""}${o}L${Zr(e[n-1])}`}function Fa(e,t=!1){const n=e.length;if(n<2)return"";let r=e[0].point,i=e[1].point;if(n===2)return`M${Zr(r)}L${Zr(i)}`;let o="";for(let s=2,a=n-1;s<a;s++)r=e[s].point,i=e[s+1].point,o+=Qr(r,i);return t?`M${Qr(e[0].point,e[1].point)}Q${Zr(e[1].point)}${Qr(e[1].point,e[2].point)}T${o}${Qr(e[n-1].point,e[0].point)}${Qr(e[0].point,e[1].point)}Z`:`M${Zr(e[0].point)}Q${Zr(e[1].point)}${Qr(e[1].point,e[2].point)}${e.length>3?"T":""}${o}L${Zr(e[n-1].point)}`}function jq(){const e=re();return b.useMemo(function(){let r,i;function o(p){p.isKilled||p.button!==0&&p.button!==1&&p.button!==5||(Lh(p.currentTarget,p),e.dispatch({type:"pointer",target:"canvas",name:"pointer_down",...en(p,e.getContainer())}))}function s(p){p.isKilled||p.clientX===r&&p.clientY===i||(r=p.clientX,i=p.clientY,e.dispatch({type:"pointer",target:"canvas",name:"pointer_move",...en(p,e.getContainer())}))}function a(p){p.isKilled||p.button!==0&&p.button!==1&&p.button!==2&&p.button!==5||(r=p.clientX,i=p.clientY,Bh(p.currentTarget,p),e.dispatch({type:"pointer",target:"canvas",name:"pointer_up",...en(p,e.getContainer())}))}function l(p){p.isKilled||e.dispatch({type:"pointer",target:"canvas",name:"pointer_enter",...en(p,e.getContainer())})}function c(p){p.isKilled||e.dispatch({type:"pointer",target:"canvas",name:"pointer_leave",...en(p,e.getContainer())})}function u(p){p.isKilled=!0,document.body.click(),Xe(p)}function d(p){p.isKilled=!0,p.target.tagName!=="A"&&p.target.tagName!=="TEXTAREA"&&Xe(p)}function h(p){Xe(p)}async function f(p){var y,x;if(Xe(p),!((x=(y=p.dataTransfer)==null?void 0:y.files)!=null&&x.length))return;const g=Array.from(p.dataTransfer.files).filter(w=>!w.name.endsWith(".tldr"));await a_(e,g,e.screenToPage(p.clientX,p.clientY),!1)}return{onPointerDown:o,onPointerMove:s,onPointerUp:a,onPointerEnter:l,onPointerLeave:c,onDragOver:h,onDrop:f,onTouchStart:u,onTouchEnd:d}},[e])}function zq(){const e=re();b.useEffect(()=>{if(window.matchMedia){const t=window.matchMedia("(pointer: coarse)"),n=()=>{e.isCoarsePointer=t.matches};return n(),t.addEventListener("change",n),()=>t.removeEventListener("change",n)}},[e])}const b5=b.createContext(null);function Uq({container:e,children:t}){return m.jsx(b5.Provider,{value:e,children:t})}function tr(){return CH(b.useContext(b5),"useContainer used outside of <Tldraw />")}function Wq(){const e=re(),t=tr(),n=ye("isFocused",()=>e.isFocused,[e]);b.useEffect(()=>{if(!n)return;const r=c=>{if(c.altKey&&(e.isIn("zoom")||!e.root.path.value.endsWith(".idle"))&&!Pu()&&Xe(c),c.isKilled)return;switch(c.isKilled=!0,c.key){case"=":{if(c.metaKey||c.ctrlKey){Xe(c);return}break}case"-":{if(c.metaKey||c.ctrlKey){Xe(c);return}break}case"0":{if(c.metaKey||c.ctrlKey){Xe(c);return}break}case"Tab":{if(Pu()||e.isMenuOpen)return;break}case",":{if(!Pu()&&(Xe(c),!e.inputs.keys.has("Comma"))){const{x:d,y:h,z:f}=e.inputs.currentScreenPoint,{pageState:{hoveredId:p}}=e;e.inputs.keys.add("Comma");const g={type:"pointer",name:"pointer_down",point:{x:d,y:h,z:f},shiftKey:c.shiftKey,altKey:c.altKey,ctrlKey:c.metaKey||c.ctrlKey,pointerId:0,button:0,isPen:e.isPenMode,...p?{target:"shape",shape:e.getShapeById(p)}:{target:"canvas"}};e.dispatch(g);return}break}case"Escape":{e.inputs.keys.has("Escape")||(e.inputs.keys.add("Escape"),e.cancel(),t.focus());return}default:if(Pu()||e.isMenuOpen)return}const u={type:"keyboard",name:e.inputs.keys.has(c.code)?"key_repeat":"key_down",key:c.key,code:c.code,shiftKey:c.shiftKey,altKey:c.altKey,ctrlKey:c.metaKey||c.ctrlKey};e.dispatch(u)},i=c=>{var d;if(c.isKilled||(c.isKilled=!0,Pu()||e.isMenuOpen))return;if(c.key===","&&((d=document.activeElement)!=null&&d.ELEMENT_NODE&&Xe(c),e.inputs.keys.has(c.code))){const{x:h,y:f,z:p}=e.inputs.currentScreenPoint,{pageState:{hoveredId:g}}=e;e.inputs.keys.delete(c.code);const y={type:"pointer",name:"pointer_up",point:{x:h,y:f,z:p},shiftKey:c.shiftKey,altKey:c.altKey,ctrlKey:c.metaKey||c.ctrlKey,pointerId:0,button:0,isPen:e.isPenMode,...g?{target:"shape",shape:e.getShapeById(g)}:{target:"canvas"}};e.dispatch(y);return}const u={type:"keyboard",name:"key_up",key:c.key,code:c.code,shiftKey:c.shiftKey,altKey:c.altKey,ctrlKey:c.metaKey||c.ctrlKey};e.dispatch(u)};function o(c){var u,d;if(t.contains(c.target)){const h=c.touches[0].pageX,f=c.touches[0].radiusX||0;(h-f<10||h+f>e.viewportScreenBounds.width-10)&&(((u=c.target)==null?void 0:u.tagName)==="BUTTON"&&((d=c.target)==null||d.click()),Xe(c))}}const s=c=>{t.contains(c.target)&&(c.ctrlKey||c.metaKey)&&Xe(c)};function a(){e.complete()}function l(){e.updateViewportScreenBounds()}return t.addEventListener("touchstart",o,{passive:!1}),document.addEventListener("wheel",s,{passive:!1}),document.addEventListener("gesturestart",Xe),document.addEventListener("gesturechange",Xe),document.addEventListener("gestureend",Xe),document.addEventListener("keydown",r),document.addEventListener("keyup",i),window.addEventListener("blur",a),window.addEventListener("focus",l),()=>{t.removeEventListener("touchstart",o),document.removeEventListener("wheel",s),document.removeEventListener("gesturestart",Xe),document.removeEventListener("gesturechange",Xe),document.removeEventListener("gestureend",Xe),document.removeEventListener("keydown",r),document.removeEventListener("keyup",i),window.removeEventListener("blur",a),window.removeEventListener("focus",l)}},[e,t,n])}const Hq=["input","select","button","textarea"];function Pu(){const{activeElement:e}=document;return!!(e&&(e.getAttribute("contenteditable")||Hq.indexOf(e.tagName.toLowerCase())>-1))}function Kq(){return m.jsx("div",{className:"tl-background"})}function ky(e,t,n,r,i,o){b.useLayoutEffect(()=>{const s=e.current;if(!s||t===void 0)return;let a=`translate(${t}px, ${n}px)`;r!==void 0&&(a+=` scale(${r})`),i!==void 0&&(a+=` rotate(${i}rad)`),o&&(a+=` translate(${o.x}px, ${o.y}px)`),s.style.transform=a})}const Av=({brush:e,color:t,opacity:n})=>{const r=b.useRef(null);return ky(r,e.x,e.y),m.jsx("svg",{className:"tl-overlays__item",ref:r,children:t?m.jsxs("g",{className:"tl-brush",opacity:n,children:[m.jsx("rect",{width:Y(Math.max(1,e.w)),height:Y(Math.max(1,e.h)),fill:t,opacity:.75}),m.jsx("rect",{width:Y(Math.max(1,e.w)),height:Y(Math.max(1,e.h)),fill:"none",stroke:t,opacity:.1})]}):m.jsx("rect",{className:"tl-brush tl-brush__default",width:Y(Math.max(1,e.w)),height:Y(Math.max(1,e.h))})})},Vq=({className:e,zoom:t,point:n,color:r,viewport:i,opacity:o=1})=>{const s=b.useRef(null);return ky(s,Ci(n.x,i.minX+5/t,i.maxX-5/t),Ci(n.y,i.minY+5/t,i.maxY-5/t),1/t,E.Angle(i.center,n)),m.jsxs("svg",{ref:s,className:Me("tl-overlays__item",e),children:[m.jsx("use",{href:"#cursor_hint",color:r,strokeWidth:3,stroke:"var(--color-background)"}),m.jsx("use",{href:"#cursor_hint",color:r,opacity:o})]})},Yq=({className:e,zoom:t,point:n,color:r,name:i})=>{const o=b.useRef(null);return ky(o,n==null?void 0:n.x,n==null?void 0:n.y,1/t),n?m.jsxs("div",{ref:o,className:Me("tl-overlays__item",e),children:[m.jsx("svg",{className:"tl-cursor",children:m.jsx("use",{href:"#cursor",color:r})}),i!==null&&i!==""&&m.jsx("div",{className:"tl-nametag",style:{backgroundColor:r},children:i})]}):null},Uk=b.memo(Yq),qq=({x:e,y:t,z:n,size:r})=>m.jsxs("svg",{className:"tl-grid",version:"1.1",xmlns:"http://www.w3.org/2000/svg",children:[m.jsx("defs",{children:Rk.map(({min:i,mid:o,step:s},a)=>{const l=s*r*n,c=.5+e*n,u=.5+t*n,d=c>0?c%l:l+c%l,h=u>0?u%l:l+u%l,f=n<o?lb(n,[i,o],[0,1]):1;return m.jsx("pattern",{id:`grid-${s}`,width:l,height:l,patternUnits:"userSpaceOnUse",children:m.jsx("circle",{className:"tl-grid-dot",cx:d,cy:h,r:1,opacity:f})},`grid-pattern-${a}`)})}),Rk.map(({step:i},o)=>m.jsx("rect",{width:"100%",height:"100%",fill:`url(#grid-${i})`},`grid-rect-${o}`))]}),Gq=({handle:e,className:t})=>m.jsxs("g",{className:Me("tl-handle",{"tl-handle__hint":e.type!=="vertex"},t),children:[m.jsx("circle",{className:"tl-handle__bg"}),m.jsx("circle",{className:"tl-handle__fg"})]}),Wk=({scribble:e,zoom:t,color:n,opacity:r,className:i})=>{if(!e.points.length)return;const o=Yd(HV(e.points,{size:e.size/t,start:{taper:!0,easing:Bn.linear},last:e.state==="stopping",simulatePressure:!1,streamline:.32}));return m.jsx("svg",{className:i&&Me("tl-overlays__item",i),children:m.jsx("path",{className:"tl-scribble",d:o,fill:n??`var(--color-${e.color})`,opacity:r??e.opacity})})},Xq=()=>m.jsx("div",{className:"tl-shape-error-boundary"}),Zq=()=>m.jsx("circle",{cx:4,cy:4,r:8,strokeWidth:"1",stroke:"red"});function Qq({points:e,zoom:t}){const n=2.5/t,r=e.reduce((h,f)=>Math.min(h,f.x),1/0),i=e.reduce((h,f)=>Math.max(h,f.x),-1/0),o=e.reduce((h,f)=>Math.min(h,f.y),1/0),s=e.reduce((h,f)=>Math.max(h,f.y),-1/0),a=e.some(h=>h.x===r&&h.y===o);let l,c,u,d;return a?(l=r,c=o,u=i,d=s):(l=r,c=s,u=i,d=o),m.jsxs("g",{className:"tl-snap-line",children:[m.jsx("line",{x1:l,y1:c,x2:u,y2:d}),e.map((h,f)=>m.jsx("g",{transform:`translate(${h.x},${h.y})`,children:m.jsx("path",{className:"tl-snap-point",d:`M ${-n},${-n} L ${n},${n} M ${-n},${n} L ${n},${-n}`})},f))]})}function Jq({gaps:e,direction:t,zoom:n}){const r=3.5/n;let i=[-1/0,1/0],o=null;const s=t==="horizontal";for(const l of e){if(o=wi(i[0],i[1],s?l.startEdge[0].y:l.startEdge[0].x,s?l.startEdge[1].y:l.startEdge[1].x),o)i=o;else continue;if(o=wi(i[0],i[1],s?l.endEdge[0].y:l.endEdge[0].x,s?l.endEdge[1].y:l.endEdge[1].x),o)i=o;else continue}if(i===null)return null;const a=(i[0]+i[1])/2;return m.jsx("g",{className:"tl-snap-line",children:e.map(({startEdge:l,endEdge:c},u)=>m.jsx(b.Fragment,{children:s?m.jsxs(m.Fragment,{children:[m.jsx("line",{x1:l[0].x,y1:a-2*r,x2:l[1].x,y2:a+2*r}),m.jsx("line",{x1:c[0].x,y1:a-2*r,x2:c[1].x,y2:a+2*r}),m.jsx("line",{x1:l[0].x,y1:a,x2:c[0].x,y2:a}),m.jsx("line",{x1:(l[0].x+c[0].x)/2,y1:a-r,x2:(l[0].x+c[0].x)/2,y2:a+r})]}):m.jsxs(m.Fragment,{children:[m.jsx("line",{x1:a-2*r,y1:l[0].y,x2:a+2*r,y2:l[1].y}),m.jsx("line",{x1:a-2*r,y1:c[0].y,x2:a+2*r,y2:c[1].y}),m.jsx("line",{x1:a,y1:l[0].y,x2:a,y2:c[0].y}),m.jsx("line",{x1:a-r,y1:(l[0].y+c[0].y)/2,x2:a+r,y2:(l[0].y+c[0].y)/2})]})},u))})}const eG=({className:e,line:t,zoom:n})=>m.jsx("svg",{className:Me("tl-overlays__item",e),children:t.type==="points"?m.jsx(Qq,{...t,zoom:n}):t.type==="gaps"?m.jsx(Jq,{...t,zoom:n}):null}),Ty=()=>m.jsx("svg",{width:16,height:16,viewBox:"0 0 16 16",children:m.jsxs("g",{strokeWidth:2,fill:"none",fillRule:"evenodd",children:[m.jsx("circle",{strokeOpacity:.25,cx:8,cy:8,r:7,stroke:"black"}),m.jsx("path",{strokeLinecap:"round",d:"M15 8c0-4.5-4.5-7-7-7",stroke:"black",children:m.jsx("animateTransform",{attributeName:"transform",type:"rotate",from:"0 8 8",to:"360 8 8",dur:"1s",repeatCount:"indefinite"})})]})}),tG=()=>null,nG={error:null};class w5 extends b.Component{constructor(){super(...arguments);v(this,"state",nG)}static getDerivedStateFromError(n){return{error:n}}componentDidCatch(n){var r,i;(i=(r=this.props).onError)==null||i.call(r,n)}render(){const{error:n}=this.state;return n!==null?this.props.fallback(n):this.props.children}}function qd({children:e,fallback:t,...n}){return t===null?m.jsx(m.Fragment,{children:e}):m.jsx(w5,{fallback:t,...n,children:e})}class rG{constructor(t){this.shape=t}equals(t){var n,r;return((n=this.shape)==null?void 0:n.props)===((r=t==null?void 0:t.shape)==null?void 0:r.props)}}const iG=({shape:e,util:t})=>Sy("Indicator:"+e.type,()=>t.indicator(e)),oG=({editor:e,id:t})=>{const n=ye("shape",()=>new rG(e.store.get(t)),[e,t]),{ShapeIndicatorErrorFallback:r}=di();return n.shape?m.jsx(qd,{fallback:r?i=>m.jsx(r,{error:i}):null,onError:i=>e.annotateError(i,{origin:"react.shapeIndicator",willCrashApp:!1}),children:m.jsx(iG,{shape:n.shape,util:e.getShapeUtil(n.shape)},n.shape.id)}):null},sG=({id:e,className:t,color:n,opacity:r})=>{const i=re(),o=ye("transform",()=>{const s=i.getPageTransformById(e);return s?s.toCssString():""},[i,e]);return m.jsx("svg",{className:Me("tl-overlays__item",t),children:m.jsx("g",{className:"tl-shape-indicator",transform:o,stroke:n??"var(--color-selected)",opacity:r,children:m.jsx(oG,{editor:i,id:e})})})},Py=b.memo(sG),S5=b.createContext({});function aG({overrides:e,children:t}){return m.jsx(S5.Provider,{value:{Background:Kq,SvgDefs:tG,Brush:Av,ZoomBrush:Av,CollaboratorBrush:Av,Cursor:Uk,CollaboratorCursor:Uk,CollaboratorHint:Vq,CollaboratorShapeIndicator:Py,Grid:qq,Scribble:Wk,SnapLine:eG,Handle:Gq,CollaboratorScribble:Wk,ErrorFallback:R5,ShapeErrorFallback:Xq,ShapeIndicatorErrorFallback:Zq,Spinner:Ty,...e},children:t})}function di(){return b.useContext(S5)}const lG=["textarea","input"];function cG(e){const t=re();b.useEffect(()=>{const n=e.current;if(!n)return;const r=i=>{var o;if(i instanceof PointerEvent&&i.pointerType==="pen"){i.isKilled=!0;const{target:s}=i;if(lG.includes((o=s.tagName)==null?void 0:o.toLocaleLowerCase())||t.isIn("select.editing_shape"))return;Xe(i)}};return n.addEventListener("touchstart",r),n.addEventListener("touchend",r),()=>{n.removeEventListener("touchstart",r),n.addEventListener("touchend",r)}},[t,e])}function uG(e,t,n){return Math.max(t,Math.min(e,n))}const vn={toVector(e,t){return e===void 0&&(e=t),Array.isArray(e)?e:[e,e]},add(e,t){return[e[0]+t[0],e[1]+t[1]]},sub(e,t){return[e[0]-t[0],e[1]-t[1]]},addTo(e,t){e[0]+=t[0],e[1]+=t[1]},subTo(e,t){e[0]-=t[0],e[1]-=t[1]}};function Hk(e,t,n){return t===0||Math.abs(t)===1/0?Math.pow(e,n*5):e*t*n/(t+n*e)}function Kk(e,t,n,r=.15){return r===0?uG(e,t,n):e<t?-Hk(t-e,n-t,r)+t:e>n?+Hk(e-n,n-t,r)+n:e}function dG(e,[t,n],[r,i]){const[[o,s],[a,l]]=e;return[Kk(t,o,s,r),Kk(n,a,l,i)]}function hG(e,t){if(typeof e!="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fG(e){var t=hG(e,"string");return typeof t=="symbol"?t:String(t)}function In(e,t,n){return t=fG(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Vk(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function Mt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Vk(Object(n),!0).forEach(function(r){In(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vk(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}const _5={pointer:{start:"down",change:"move",end:"up"},mouse:{start:"down",change:"move",end:"up"},touch:{start:"start",change:"move",end:"end"},gesture:{start:"start",change:"change",end:"end"}};function Yk(e){return e?e[0].toUpperCase()+e.slice(1):""}const pG=["enter","leave"];function gG(e=!1,t){return e&&!pG.includes(t)}function mG(e,t="",n=!1){const r=_5[e],i=r&&r[t]||t;return"on"+Yk(e)+Yk(i)+(gG(n,i)?"Capture":"")}const yG=["gotpointercapture","lostpointercapture"];function vG(e){let t=e.substring(2).toLowerCase();const n=!!~t.indexOf("passive");n&&(t=t.replace("passive",""));const r=yG.includes(t)?"capturecapture":"capture",i=!!~t.indexOf(r);return i&&(t=t.replace("capture","")),{device:t,capture:i,passive:n}}function xG(e,t=""){const n=_5[e],r=n&&n[t]||t;return e+r}function C5(e){return"touches"in e}function bG(e){return C5(e)?"touch":"pointerType"in e?e.pointerType:"mouse"}function wG(e){return Array.from(e.touches).filter(t=>{var n,r;return t.target===e.currentTarget||((n=e.currentTarget)===null||n===void 0||(r=n.contains)===null||r===void 0?void 0:r.call(n,t.target))})}function vb(e,t){try{const n=t.clientX-e.clientX,r=t.clientY-e.clientY,i=(t.clientX+e.clientX)/2,o=(t.clientY+e.clientY)/2,s=Math.hypot(n,r);return{angle:-(Math.atan2(n,r)*180)/Math.PI,distance:s,origin:[i,o]}}catch{}return null}function SG(e){return wG(e).map(t=>t.identifier)}function qk(e,t){const[n,r]=Array.from(e.touches).filter(i=>t.includes(i.identifier));return vb(n,r)}const Gk=40,Xk=800;function E5(e){let{deltaX:t,deltaY:n,deltaMode:r}=e;return r===1?(t*=Gk,n*=Gk):r===2&&(t*=Xk,n*=Xk),[t,n]}function _G(e){const t={};if("buttons"in e&&(t.buttons=e.buttons),"shiftKey"in e){const{shiftKey:n,altKey:r,metaKey:i,ctrlKey:o}=e;Object.assign(t,{shiftKey:n,altKey:r,metaKey:i,ctrlKey:o})}return t}function lm(e,...t){return typeof e=="function"?e(...t):e}function CG(){}function EG(...e){return e.length===0?CG:e.length===1?e[0]:function(){let t;for(const n of e)t=n.apply(this,arguments)||t;return t}}function Zk(e,t){return Object.assign({},t,e||{})}const kG=32;class k5{constructor(t,n,r){this.ctrl=t,this.args=n,this.key=r,this.state||(this.state={},this.computeValues([0,0]),this.computeInitial(),this.init&&this.init(),this.reset())}get state(){return this.ctrl.state[this.key]}set state(t){this.ctrl.state[this.key]=t}get shared(){return this.ctrl.state.shared}get eventStore(){return this.ctrl.gestureEventStores[this.key]}get timeoutStore(){return this.ctrl.gestureTimeoutStores[this.key]}get config(){return this.ctrl.config[this.key]}get sharedConfig(){return this.ctrl.config.shared}get handler(){return this.ctrl.handlers[this.key]}reset(){const{state:t,shared:n,ingKey:r,args:i}=this;n[r]=t._active=t.active=t._blocked=t._force=!1,t._step=[!1,!1],t.intentional=!1,t._movement=[0,0],t._distance=[0,0],t._direction=[0,0],t._delta=[0,0],t._bounds=[[-1/0,1/0],[-1/0,1/0]],t.args=i,t.axis=void 0,t.memo=void 0,t.elapsedTime=t.timeDelta=0,t.direction=[0,0],t.distance=[0,0],t.overflow=[0,0],t._movementBound=[!1,!1],t.velocity=[0,0],t.movement=[0,0],t.delta=[0,0],t.timeStamp=0}start(t){const n=this.state,r=this.config;n._active||(this.reset(),this.computeInitial(),n._active=!0,n.target=t.target,n.currentTarget=t.currentTarget,n.lastOffset=r.from?lm(r.from,n):n.offset,n.offset=n.lastOffset,n.startTime=n.timeStamp=t.timeStamp)}computeValues(t){const n=this.state;n._values=t,n.values=this.config.transform(t)}computeInitial(){const t=this.state;t._initial=t._values,t.initial=t.values}compute(t){const{state:n,config:r,shared:i}=this;n.args=this.args;let o=0;if(t&&(n.event=t,r.preventDefault&&t.cancelable&&n.event.preventDefault(),n.type=t.type,i.touches=this.ctrl.pointerIds.size||this.ctrl.touchIds.size,i.locked=!!document.pointerLockElement,Object.assign(i,_G(t)),i.down=i.pressed=i.buttons%2===1||i.touches>0,o=t.timeStamp-n.timeStamp,n.timeStamp=t.timeStamp,n.elapsedTime=n.timeStamp-n.startTime),n._active){const P=n._delta.map(Math.abs);vn.addTo(n._distance,P)}this.axisIntent&&this.axisIntent(t);const[s,a]=n._movement,[l,c]=r.threshold,{_step:u,values:d}=n;if(r.hasCustomTransform?(u[0]===!1&&(u[0]=Math.abs(s)>=l&&d[0]),u[1]===!1&&(u[1]=Math.abs(a)>=c&&d[1])):(u[0]===!1&&(u[0]=Math.abs(s)>=l&&Math.sign(s)*l),u[1]===!1&&(u[1]=Math.abs(a)>=c&&Math.sign(a)*c)),n.intentional=u[0]!==!1||u[1]!==!1,!n.intentional)return;const h=[0,0];if(r.hasCustomTransform){const[P,I]=d;h[0]=u[0]!==!1?P-u[0]:0,h[1]=u[1]!==!1?I-u[1]:0}else h[0]=u[0]!==!1?s-u[0]:0,h[1]=u[1]!==!1?a-u[1]:0;this.restrictToAxis&&!n._blocked&&this.restrictToAxis(h);const f=n.offset,p=n._active&&!n._blocked||n.active;p&&(n.first=n._active&&!n.active,n.last=!n._active&&n.active,n.active=i[this.ingKey]=n._active,t&&(n.first&&("bounds"in r&&(n._bounds=lm(r.bounds,n)),this.setup&&this.setup()),n.movement=h,this.computeOffset()));const[g,y]=n.offset,[[x,w],[_,S]]=n._bounds;n.overflow=[g<x?-1:g>w?1:0,y<_?-1:y>S?1:0],n._movementBound[0]=n.overflow[0]?n._movementBound[0]===!1?n._movement[0]:n._movementBound[0]:!1,n._movementBound[1]=n.overflow[1]?n._movementBound[1]===!1?n._movement[1]:n._movementBound[1]:!1;const T=n._active?r.rubberband||[0,0]:[0,0];if(n.offset=dG(n._bounds,n.offset,T),n.delta=vn.sub(n.offset,f),this.computeMovement(),p&&(!n.last||o>kG)){n.delta=vn.sub(n.offset,f);const P=n.delta.map(Math.abs);vn.addTo(n.distance,P),n.direction=n.delta.map(Math.sign),n._direction=n._delta.map(Math.sign),!n.first&&o>0&&(n.velocity=[P[0]/o,P[1]/o],n.timeDelta=o)}}emit(){const t=this.state,n=this.shared,r=this.config;if(t._active||this.clean(),(t._blocked||!t.intentional)&&!t._force&&!r.triggerAllEvents)return;const i=this.handler(Mt(Mt(Mt({},n),t),{},{[this.aliasKey]:t.values}));i!==void 0&&(t.memo=i)}clean(){this.eventStore.clean(),this.timeoutStore.clean()}}function TG([e,t],n){const r=Math.abs(e),i=Math.abs(t);if(r>i&&r>n)return"x";if(i>r&&i>n)return"y"}class PG extends k5{constructor(...t){super(...t),In(this,"aliasKey","xy")}reset(){super.reset(),this.state.axis=void 0}init(){this.state.offset=[0,0],this.state.lastOffset=[0,0]}computeOffset(){this.state.offset=vn.add(this.state.lastOffset,this.state.movement)}computeMovement(){this.state.movement=vn.sub(this.state.offset,this.state.lastOffset)}axisIntent(t){const n=this.state,r=this.config;if(!n.axis&&t){const i=typeof r.axisThreshold=="object"?r.axisThreshold[bG(t)]:r.axisThreshold;n.axis=TG(n._movement,i)}n._blocked=(r.lockDirection||!!r.axis)&&!n.axis||!!r.axis&&r.axis!==n.axis}restrictToAxis(t){if(this.config.axis||this.config.lockDirection)switch(this.state.axis){case"x":t[1]=0;break;case"y":t[0]=0;break}}}const IG=e=>e,Qk=.15,T5={enabled(e=!0){return e},eventOptions(e,t,n){return Mt(Mt({},n.shared.eventOptions),e)},preventDefault(e=!1){return e},triggerAllEvents(e=!1){return e},rubberband(e=0){switch(e){case!0:return[Qk,Qk];case!1:return[0,0];default:return vn.toVector(e)}},from(e){if(typeof e=="function")return e;if(e!=null)return vn.toVector(e)},transform(e,t,n){const r=e||n.shared.transform;return this.hasCustomTransform=!!r,r||IG},threshold(e){return vn.toVector(e,0)}},$G=0,Rh=Mt(Mt({},T5),{},{axis(e,t,{axis:n}){if(this.lockDirection=n==="lock",!this.lockDirection)return n},axisThreshold(e=$G){return e},bounds(e={}){if(typeof e=="function")return o=>Rh.bounds(e(o));if("current"in e)return()=>e.current;if(typeof HTMLElement=="function"&&e instanceof HTMLElement)return e;const{left:t=-1/0,right:n=1/0,top:r=-1/0,bottom:i=1/0}=e;return[[t,n],[r,i]]}}),Dh=typeof window<"u"&&window.document&&window.document.createElement;function P5(){return Dh&&"ontouchstart"in window}function AG(){return P5()||Dh&&window.navigator.maxTouchPoints>1}function MG(){return Dh&&"onpointerdown"in window}function OG(){return Dh&&"exitPointerLock"in window.document}function LG(){try{return"constructor"in GestureEvent}catch{return!1}}const Jr={isBrowser:Dh,gesture:LG(),touch:P5(),touchscreen:AG(),pointer:MG(),pointerLock:OG()},BG=250,RG=180,DG=.5,FG=50,NG=250,jG=10,Jk={mouse:0,touch:0,pen:8};Mt(Mt({},Rh),{},{device(e,t,{pointer:{touch:n=!1,lock:r=!1,mouse:i=!1}={}}){return this.pointerLock=r&&Jr.pointerLock,Jr.touch&&n?"touch":this.pointerLock?"mouse":Jr.pointer&&!i?"pointer":Jr.touch?"touch":"mouse"},preventScrollAxis(e,t,{preventScroll:n}){if(this.preventScrollDelay=typeof n=="number"?n:n||n===void 0&&e?BG:void 0,!(!Jr.touchscreen||n===!1))return e||(n!==void 0?"y":void 0)},pointerCapture(e,t,{pointer:{capture:n=!0,buttons:r=1,keys:i=!0}={}}){return this.pointerButtons=r,this.keys=i,!this.pointerLock&&this.device==="pointer"&&n},threshold(e,t,{filterTaps:n=!1,tapsThreshold:r=3,axis:i=void 0}){const o=vn.toVector(e,n?r:i?1:0);return this.filterTaps=n,this.tapsThreshold=r,o},swipe({velocity:e=DG,distance:t=FG,duration:n=NG}={}){return{velocity:this.transform(vn.toVector(e)),distance:this.transform(vn.toVector(t)),duration:n}},delay(e=0){switch(e){case!0:return RG;case!1:return 0;default:return e}},axisThreshold(e){return e?Mt(Mt({},Jk),e):Jk},keyboardDisplacement(e=jG){return e}});function I5(e){const[t,n]=e.overflow,[r,i]=e._delta,[o,s]=e._direction;(t<0&&r>0&&o<0||t>0&&r<0&&o>0)&&(e._movement[0]=e._movementBound[0]),(n<0&&i>0&&s<0||n>0&&i<0&&s>0)&&(e._movement[1]=e._movementBound[1])}const zG=30,UG=100;class WG extends k5{constructor(...t){super(...t),In(this,"ingKey","pinching"),In(this,"aliasKey","da")}init(){this.state.offset=[1,0],this.state.lastOffset=[1,0],this.state._pointerEvents=new Map}reset(){super.reset();const t=this.state;t._touchIds=[],t.canceled=!1,t.cancel=this.cancel.bind(this),t.turns=0}computeOffset(){const{type:t,movement:n,lastOffset:r}=this.state;t==="wheel"?this.state.offset=vn.add(n,r):this.state.offset=[(1+n[0])*r[0],n[1]+r[1]]}computeMovement(){const{offset:t,lastOffset:n}=this.state;this.state.movement=[t[0]/n[0],t[1]-n[1]]}axisIntent(){const t=this.state,[n,r]=t._movement;if(!t.axis){const i=Math.abs(n)*zG-Math.abs(r);i<0?t.axis="angle":i>0&&(t.axis="scale")}}restrictToAxis(t){this.config.lockDirection&&(this.state.axis==="scale"?t[1]=0:this.state.axis==="angle"&&(t[0]=0))}cancel(){const t=this.state;t.canceled||setTimeout(()=>{t.canceled=!0,t._active=!1,this.compute(),this.emit()},0)}touchStart(t){this.ctrl.setEventIds(t);const n=this.state,r=this.ctrl.touchIds;if(n._active&&n._touchIds.every(o=>r.has(o))||r.size<2)return;this.start(t),n._touchIds=Array.from(r).slice(0,2);const i=qk(t,n._touchIds);i&&this.pinchStart(t,i)}pointerStart(t){if(t.buttons!=null&&t.buttons%2!==1)return;this.ctrl.setEventIds(t),t.target.setPointerCapture(t.pointerId);const n=this.state,r=n._pointerEvents,i=this.ctrl.pointerIds;if(n._active&&Array.from(r.keys()).every(s=>i.has(s))||(r.size<2&&r.set(t.pointerId,t),n._pointerEvents.size<2))return;this.start(t);const o=vb(...Array.from(r.values()));o&&this.pinchStart(t,o)}pinchStart(t,n){const r=this.state;r.origin=n.origin,this.computeValues([n.distance,n.angle]),this.computeInitial(),this.compute(t),this.emit()}touchMove(t){if(!this.state._active)return;const n=qk(t,this.state._touchIds);n&&this.pinchMove(t,n)}pointerMove(t){const n=this.state._pointerEvents;if(n.has(t.pointerId)&&n.set(t.pointerId,t),!this.state._active)return;const r=vb(...Array.from(n.values()));r&&this.pinchMove(t,r)}pinchMove(t,n){const r=this.state,i=r._values[1],o=n.angle-i;let s=0;Math.abs(o)>270&&(s+=Math.sign(o)),this.computeValues([n.distance,n.angle-360*s]),r.origin=n.origin,r.turns=s,r._movement=[r._values[0]/r._initial[0]-1,r._values[1]-r._initial[1]],this.compute(t),this.emit()}touchEnd(t){this.ctrl.setEventIds(t),this.state._active&&this.state._touchIds.some(n=>!this.ctrl.touchIds.has(n))&&(this.state._active=!1,this.compute(t),this.emit())}pointerEnd(t){const n=this.state;this.ctrl.setEventIds(t);try{t.target.releasePointerCapture(t.pointerId)}catch{}n._pointerEvents.has(t.pointerId)&&n._pointerEvents.delete(t.pointerId),n._active&&n._pointerEvents.size<2&&(n._active=!1,this.compute(t),this.emit())}gestureStart(t){t.cancelable&&t.preventDefault();const n=this.state;n._active||(this.start(t),this.computeValues([t.scale,t.rotation]),n.origin=[t.clientX,t.clientY],this.compute(t),this.emit())}gestureMove(t){if(t.cancelable&&t.preventDefault(),!this.state._active)return;const n=this.state;this.computeValues([t.scale,t.rotation]),n.origin=[t.clientX,t.clientY];const r=n._movement;n._movement=[t.scale-1,t.rotation],n._delta=vn.sub(n._movement,r),this.compute(t),this.emit()}gestureEnd(t){this.state._active&&(this.state._active=!1,this.compute(t),this.emit())}wheel(t){const n=this.config.modifierKey;n&&(Array.isArray(n)?!n.find(r=>t[r]):!t[n])||(this.state._active?this.wheelChange(t):this.wheelStart(t),this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this)))}wheelStart(t){this.start(t),this.wheelChange(t)}wheelChange(t){"uv"in t||t.cancelable&&t.preventDefault();const r=this.state;r._delta=[-E5(t)[1]/UG*r.offset[0],0],vn.addTo(r._movement,r._delta),I5(r),this.state.origin=[t.clientX,t.clientY],this.compute(t),this.emit()}wheelEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(t){const n=this.config.device;n&&(t(n,"start",this[n+"Start"].bind(this)),t(n,"change",this[n+"Move"].bind(this)),t(n,"end",this[n+"End"].bind(this)),t(n,"cancel",this[n+"End"].bind(this)),t("lostPointerCapture","",this[n+"End"].bind(this))),this.config.pinchOnWheel&&t("wheel","",this.wheel.bind(this),{passive:!1})}}const HG=Mt(Mt({},T5),{},{device(e,t,{shared:n,pointer:{touch:r=!1}={}}){if(n.target&&!Jr.touch&&Jr.gesture)return"gesture";if(Jr.touch&&r)return"touch";if(Jr.touchscreen){if(Jr.pointer)return"pointer";if(Jr.touch)return"touch"}},bounds(e,t,{scaleBounds:n={},angleBounds:r={}}){const i=s=>{const a=Zk(lm(n,s),{min:-1/0,max:1/0});return[a.min,a.max]},o=s=>{const a=Zk(lm(r,s),{min:-1/0,max:1/0});return[a.min,a.max]};return typeof n!="function"&&typeof r!="function"?[i(),o()]:s=>[i(s),o(s)]},threshold(e,t,n){return this.lockDirection=n.axis==="lock",vn.toVector(e,this.lockDirection?[.1,3]:0)},modifierKey(e){return e===void 0?"ctrlKey":e},pinchOnWheel(e=!0){return e}});Mt(Mt({},Rh),{},{mouseOnly:(e=!0)=>e});class KG extends PG{constructor(...t){super(...t),In(this,"ingKey","wheeling")}wheel(t){this.state._active||this.start(t),this.wheelChange(t),this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this))}wheelChange(t){const n=this.state;n._delta=E5(t),vn.addTo(n._movement,n._delta),I5(n),this.compute(t),this.emit()}wheelEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(t){t("wheel","",this.wheel.bind(this))}}const VG=Rh;Mt(Mt({},Rh),{},{mouseOnly:(e=!0)=>e});const u_=new Map,xb=new Map;function YG(e){u_.set(e.key,e.engine),xb.set(e.key,e.resolver)}const qG={key:"pinch",engine:WG,resolver:HG},GG={key:"wheel",engine:KG,resolver:VG};function XG(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,o;for(o=0;o<r.length;o++)i=r[o],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function ZG(e,t){if(e==null)return{};var n=XG(e,t),r,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)r=o[i],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}const QG={target(e){if(e)return()=>"current"in e?e.current:e},enabled(e=!0){return e},window(e=Jr.isBrowser?window:void 0){return e},eventOptions({passive:e=!0,capture:t=!1}={}){return{passive:e,capture:t}},transform(e){return e}},JG=["target","eventOptions","window","enabled","transform"];function jp(e={},t){const n={};for(const[r,i]of Object.entries(t))switch(typeof i){case"function":n[r]=i.call(n,e[r],r,e);break;case"object":n[r]=jp(e[r],i);break;case"boolean":i&&(n[r]=e[r]);break}return n}function eX(e,t,n={}){const r=e,{target:i,eventOptions:o,window:s,enabled:a,transform:l}=r,c=ZG(r,JG);if(n.shared=jp({target:i,eventOptions:o,window:s,enabled:a,transform:l},QG),t){const u=xb.get(t);n[t]=jp(Mt({shared:n.shared},c),u)}else for(const u in c){const d=xb.get(u);d&&(n[u]=jp(Mt({shared:n.shared},c[u]),d))}return n}class $5{constructor(t,n){In(this,"_listeners",new Set),this._ctrl=t,this._gestureKey=n}add(t,n,r,i,o){const s=this._listeners,a=xG(n,r),l=this._gestureKey?this._ctrl.config[this._gestureKey].eventOptions:{},c=Mt(Mt({},l),o);t.addEventListener(a,i,c);const u=()=>{t.removeEventListener(a,i,c),s.delete(u)};return s.add(u),u}clean(){this._listeners.forEach(t=>t()),this._listeners.clear()}}class tX{constructor(){In(this,"_timeouts",new Map)}add(t,n,r=140,...i){this.remove(t),this._timeouts.set(t,window.setTimeout(n,r,...i))}remove(t){const n=this._timeouts.get(t);n&&window.clearTimeout(n)}clean(){this._timeouts.forEach(t=>void window.clearTimeout(t)),this._timeouts.clear()}}class nX{constructor(t){In(this,"gestures",new Set),In(this,"_targetEventStore",new $5(this)),In(this,"gestureEventStores",{}),In(this,"gestureTimeoutStores",{}),In(this,"handlers",{}),In(this,"config",{}),In(this,"pointerIds",new Set),In(this,"touchIds",new Set),In(this,"state",{shared:{shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1}}),rX(this,t)}setEventIds(t){if(C5(t))return this.touchIds=new Set(SG(t)),this.touchIds;if("pointerId"in t)return t.type==="pointerup"||t.type==="pointercancel"?this.pointerIds.delete(t.pointerId):t.type==="pointerdown"&&this.pointerIds.add(t.pointerId),this.pointerIds}applyHandlers(t,n){this.handlers=t,this.nativeHandlers=n}applyConfig(t,n){this.config=eX(t,n,this.config)}clean(){this._targetEventStore.clean();for(const t of this.gestures)this.gestureEventStores[t].clean(),this.gestureTimeoutStores[t].clean()}effect(){return this.config.shared.target&&this.bind(),()=>this._targetEventStore.clean()}bind(...t){const n=this.config.shared,r={};let i;if(!(n.target&&(i=n.target(),!i))){if(n.enabled){for(const s of this.gestures){const a=this.config[s],l=eT(r,a.eventOptions,!!i);if(a.enabled){const c=u_.get(s);new c(this,t,s).bind(l)}}const o=eT(r,n.eventOptions,!!i);for(const s in this.nativeHandlers)o(s,"",a=>this.nativeHandlers[s](Mt(Mt({},this.state.shared),{},{event:a,args:t})),void 0,!0)}for(const o in r)r[o]=EG(...r[o]);if(!i)return r;for(const o in r){const{device:s,capture:a,passive:l}=vG(o);this._targetEventStore.add(i,s,"",r[o],{capture:a,passive:l})}}}}function Il(e,t){e.gestures.add(t),e.gestureEventStores[t]=new $5(e,t),e.gestureTimeoutStores[t]=new tX}function rX(e,t){t.drag&&Il(e,"drag"),t.wheel&&Il(e,"wheel"),t.scroll&&Il(e,"scroll"),t.move&&Il(e,"move"),t.pinch&&Il(e,"pinch"),t.hover&&Il(e,"hover")}const eT=(e,t,n)=>(r,i,o,s={},a=!1)=>{var l,c;const u=(l=s.capture)!==null&&l!==void 0?l:t.capture,d=(c=s.passive)!==null&&c!==void 0?c:t.passive;let h=a?r:mG(r,i,u);n&&d&&(h+="Passive"),e[h]=e[h]||[],e[h].push(o)},iX=/^on(Drag|Wheel|Scroll|Move|Pinch|Hover)/;function oX(e){const t={},n={},r=new Set;for(let i in e)iX.test(i)?(r.add(RegExp.lastMatch),n[i]=e[i]):t[i]=e[i];return[n,t,r]}function $l(e,t,n,r,i,o){if(!e.has(n)||!u_.has(r))return;const s=n+"Start",a=n+"End",l=c=>{let u;return c.first&&s in t&&t[s](c),n in t&&(u=t[n](c)),c.last&&a in t&&t[a](c),u};i[r]=l,o[r]=o[r]||{}}function sX(e,t){const[n,r,i]=oX(e),o={};return $l(i,n,"onDrag","drag",o,t),$l(i,n,"onWheel","wheel",o,t),$l(i,n,"onScroll","scroll",o,t),$l(i,n,"onPinch","pinch",o,t),$l(i,n,"onMove","move",o,t),$l(i,n,"onHover","hover",o,t),{handlers:o,config:t,nativeHandlers:r}}function aX(e,t={},n,r){const i=ke.useMemo(()=>new nX(e),[]);if(i.applyHandlers(e,r),i.applyConfig(t,n),ke.useEffect(i.effect.bind(i)),ke.useEffect(()=>i.clean.bind(i),[]),t.target===void 0)return i.bind.bind(i)}function lX(e){return e.forEach(YG),function(n,r){const{handlers:i,nativeHandlers:o,config:s}=sX(n,r||{});return aX(i,s,void 0,o)}}var A5="Expected a function",tT=0/0,cX="[object Symbol]",uX=/^\s+|\s+$/g,dX=/^[-+]0x[0-9a-f]+$/i,hX=/^0b[01]+$/i,fX=/^0o[0-7]+$/i,pX=parseInt,gX=typeof Ln=="object"&&Ln&&Ln.Object===Object&&Ln,mX=typeof self=="object"&&self&&self.Object===Object&&self,yX=gX||mX||Function("return this")(),vX=Object.prototype,xX=vX.toString,bX=Math.max,wX=Math.min,Mv=function(){return yX.Date.now()};function SX(e,t,n){var r,i,o,s,a,l,c=0,u=!1,d=!1,h=!0;if(typeof e!="function")throw new TypeError(A5);t=nT(t)||0,cm(n)&&(u=!!n.leading,d="maxWait"in n,o=d?bX(nT(n.maxWait)||0,t):o,h="trailing"in n?!!n.trailing:h);function f(P){var I=r,$=i;return r=i=void 0,c=P,s=e.apply($,I),s}function p(P){return c=P,a=setTimeout(x,t),u?f(P):s}function g(P){var I=P-l,$=P-c,L=t-I;return d?wX(L,o-$):L}function y(P){var I=P-l,$=P-c;return l===void 0||I>=t||I<0||d&&$>=o}function x(){var P=Mv();if(y(P))return w(P);a=setTimeout(x,g(P))}function w(P){return a=void 0,h&&r?f(P):(r=i=void 0,s)}function _(){a!==void 0&&clearTimeout(a),c=0,r=l=i=a=void 0}function S(){return a===void 0?s:w(Mv())}function T(){var P=Mv(),I=y(P);if(r=arguments,i=this,l=P,I){if(a===void 0)return p(l);if(d)return a=setTimeout(x,t),f(l)}return a===void 0&&(a=setTimeout(x,t)),s}return T.cancel=_,T.flush=S,T}function _X(e,t,n){var r=!0,i=!0;if(typeof e!="function")throw new TypeError(A5);return cm(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),SX(e,t,{leading:r,maxWait:t,trailing:i})}function cm(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function CX(e){return!!e&&typeof e=="object"}function EX(e){return typeof e=="symbol"||CX(e)&&xX.call(e)==cX}function nT(e){if(typeof e=="number")return e;if(EX(e))return tT;if(cm(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=cm(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=e.replace(uX,"");var n=hX.test(e);return n||fX.test(e)?pX(e.slice(2),n?2:8):dX.test(e)?tT:+e}var kX=_X;const M5=rl(kX),rT=10,TX=/Mac|iPod|iPhone|iPad/.test(typeof window>"u"?"node":window.navigator.platform);function O5(e){let{deltaY:t,deltaX:n}=e,r=0;if(e.ctrlKey||e.altKey||e.metaKey){const i=Math.sign(e.deltaY),o=Math.abs(e.deltaY);let s=t;o>rT&&(s=rT*i),r=s/100}else e.shiftKey&&!TX&&(n=t,t=0);return{x:-n,y:-t,z:-r}}const PX=lX([GG,qG]);let Al;const IX=e=>Al===void 0?(Al=e,!1):e-Al>120&&e-Al<160?(Al=e,!0):(Al=e,!1);function $X(e){const t=re(),n=b.useMemo(()=>{let r=null;const i=({event:g})=>{if(!t.isFocused||(r=null,IX(Date.now())))return;if(t.editingId){const w=t.getShapeById(t.editingId);if(w&&t.getShapeUtil(w).canScroll(w)){const S=t.getPageBoundsById(t.editingId);if(S!=null&&S.containsPoint(t.inputs.currentPagePoint))return}}Xe(g);const y=O5(g);if(y.x===0&&y.y===0)return;const x={type:"wheel",name:"wheel",delta:y,shiftKey:g.shiftKey,altKey:g.altKey,ctrlKey:g.metaKey||g.ctrlKey};t.dispatch(x)};let o=1,s=1,a=1,l=0;const c=new E,u=new E,d=g=>{const y=e.current;r=null;const{event:x,origin:w,da:_}=g;x instanceof WheelEvent||(x.target===y||y!=null&&y.contains(x.target))&&(u.x=w[0],u.y=w[1],c.x=w[0],c.y=w[1],o=_[0],s=t.zoomLevel,t.dispatch({type:"pinch",name:"pinch_start",point:{x:w[0],y:w[1],z:t.zoomLevel},delta:{x:0,y:0},shiftKey:x.shiftKey,altKey:x.altKey,ctrlKey:x.metaKey||x.ctrlKey}))},h=M5(g=>{if(r===null){const y=Math.abs(l-o),x=E.Dist(c,u);g==="gesture"&&y||g==="touch"&&y>16?r="zooming":x>16&&(r="panning")}},32);return{onWheel:i,onPinchStart:d,onPinchEnd:g=>{const y=e.current,{event:x,origin:w,offset:_}=g;if(x instanceof WheelEvent||!(x.target===y||y!=null&&y.contains(x.target)))return;const S=_[0];r=null,requestAnimationFrame(()=>{t.dispatch({type:"pinch",name:"pinch_end",point:{x:w[0],y:w[1],z:S},delta:{x:w[0],y:w[1]},shiftKey:x.shiftKey,altKey:x.altKey,ctrlKey:x.metaKey||x.ctrlKey})})},onPinch:g=>{const y=e.current,{event:x,origin:w,offset:_,da:S}=g;if(x instanceof WheelEvent||!(x.target===y||y!=null&&y.contains(x.target)))return;const T=!("touches"in x);l=S[0],(T||l>64)&&(a=_[0]);const P=w[0]-u.x,I=w[1]-u.y;switch(u.x=w[0],u.y=w[1],h(T?"gesture":"touch"),r){case"zooming":{t.dispatch({type:"pinch",name:"pinch",point:{x:w[0],y:w[1],z:a},delta:{x:P,y:I},shiftKey:x.shiftKey,altKey:x.altKey,ctrlKey:x.metaKey||x.ctrlKey});break}case"panning":{t.dispatch({type:"pinch",name:"pinch",point:{x:w[0],y:w[1],z:s},delta:{x:P,y:I},shiftKey:x.shiftKey,altKey:x.altKey,ctrlKey:x.metaKey||x.ctrlKey});break}}}}},[t,e]);PX(n,{target:e,eventOptions:{passive:!1},pinch:{from:()=>[t.zoomLevel,0],scaleBounds:()=>({from:t.zoomLevel,max:8,min:.05})}})}function Iu(e,t,n){const r=e.getShapeById(t),o=e.getShapeUtil(r).handles(r);return{shape:r,handle:o.find(s=>s.id===n)}}function AX(e,t){const n=re();return b.useMemo(()=>{const r=u=>{if(u.isKilled)return;const d=am(u.currentTarget);Lh(d,u);const{shape:h,handle:f}=Iu(n,e,t);f&&n.dispatch({type:"pointer",target:"handle",handle:f,shape:h,name:"pointer_down",...en(u,n.getContainer())})};let i,o;return{onPointerDown:r,onPointerMove:u=>{if(u.isKilled||u.clientX===i&&u.clientY===o)return;i=u.clientX,o=u.clientY;const{shape:d,handle:h}=Iu(n,e,t);h&&n.dispatch({type:"pointer",target:"handle",handle:h,shape:d,name:"pointer_move",...en(u,n.getContainer())})},onPointerUp:u=>{if(u.isKilled)return;const d=am(u.currentTarget);Bh(d,u);const{shape:h,handle:f}=Iu(n,e,t);f&&n.dispatch({type:"pointer",target:"handle",handle:f,shape:h,name:"pointer_up",...en(u,n.getContainer())})},onPointerEnter:u=>{if(u.isKilled)return;const{shape:d,handle:h}=Iu(n,e,t);h&&n.dispatch({type:"pointer",target:"handle",handle:h,shape:d,name:"pointer_enter",...en(u,n.getContainer())})},onPointerLeave:u=>{if(u.isKilled)return;const{shape:d,handle:h}=Iu(n,e,t);h&&n.dispatch({type:"pointer",target:"handle",handle:h,shape:d,name:"pointer_leave",...en(u,n.getContainer())})}}},[n,e,t])}const qu=8,iT=(e,t,n)=>new Promise((r,i)=>{const o=qu*t*e,s=document.createElement("canvas");s.width=o,s.height=o;const a=s.getContext("2d");if(!a)return;a.fillStyle=n?"#212529":"#f8f9fa",a.fillRect(0,0,o,o),a.globalCompositeOperation="destination-out",a.lineCap="round",a.lineWidth=1.25*t*e;const l=8/12,c=u=>u*t*e;a.beginPath(),a.moveTo(c(l*1),c(l*3)),a.lineTo(c(l*3),c(l*1)),a.moveTo(c(l*5),c(l*7)),a.lineTo(c(l*7),c(l*5)),a.moveTo(c(l*9),c(l*11)),a.lineTo(c(l*11),c(l*9)),a.stroke(),s.toBlob(u=>{!u||nn.throwToBlob.value?i():r(u)})}),oT=(e,t)=>{const n=document.createElement("canvas");n.width=e[0],n.height=e[1];const r=n.getContext("2d");return r?(t(r),n.toDataURL()):""},MX=()=>{const e=[];for(let t=1;t<=Math.ceil(Cs);t++){const n=oT([1,1],i=>{i.fillStyle="#e8e8e8",i.fillRect(0,0,1,1)}),r=oT([1,1],i=>{i.fillStyle="#2c3036",i.fillRect(0,0,1,1)});e.push({zoom:t,url:n,darkMode:!1}),e.push({zoom:t,url:r,darkMode:!0})}return e},OX=()=>{const t=re().devicePixelRatio,[n,r]=b.useState(!1),i=b.useMemo(()=>MX(),[]),[o,s]=b.useState(i);return b.useEffect(()=>{const l=[];for(let u=1;u<=Math.ceil(Cs);u++)l.push(iT(t,u,!1).then(d=>({zoom:u,url:URL.createObjectURL(d),darkMode:!1}))),l.push(iT(t,u,!0).then(d=>({zoom:u,url:URL.createObjectURL(d),darkMode:!0})));let c=!1;return Promise.all(l).then(u=>{c||(s(u),r(!0))}),()=>{c=!0,r(!1)}},[t]),{context:m.jsx(m.Fragment,{children:o.map(l=>{const c=l.zoom+(l.darkMode?"_dark":"_light");return m.jsx("pattern",{id:om[c],width:qu,height:qu,patternUnits:"userSpaceOnUse",children:m.jsx("image",{href:l.url,width:qu,height:qu})},c)})}),isReady:n}},Ur=8/12;function LX(e){const t=document.createElement("div");return t.innerHTML=`
		<svg>
			<defs>
				<mask id="hash_pattern_mask">
					<rect x="0" y="0" width="8" height="8" fill="white" />
					<g
						strokeLinecap="round"
						stroke="black"
					>
						<line x1="${Ur*1}" y1="${Ur*3}" x2="${Ur*3}" y2="${Ur*1}" />
						<line x1="${Ur*5}" y1="${Ur*7}" x2="${Ur*7}" y2="${Ur*5}" />
						<line x1="${Ur*9}" y1="${Ur*11}" x2="${Ur*11}" y2="${Ur*9}" />
					</g>
				</mask>
				<pattern
					id="hash_pattern"
					width="8"
					height="8"
					patternUnits="userSpaceOnUse"
				>
					<rect x="0" y="0" width="8" height="8" fill="${e}" mask="url(#hash_pattern_mask)" />
				</pattern>
			</defs>
		</svg>
	`,t.querySelectorAll("defs > *")}function Na(e,t,n=ri){b.useEffect(()=>{const r=new Ah(e,t);return r.attach(),r.execute(),()=>{r.detach()}},n)}function BX(){const e=re(),t=tr();b.useLayoutEffect(()=>{const n=M5(()=>{e.updateViewportScreenBounds()},200,{trailing:!0}),r=new ResizeObserver(i=>{i[0].contentRect&&n()});return t&&r.observe(t),n(),()=>{r.disconnect()}},[e,t])}function RX(){const e=re(),t=b.useMemo(()=>e.store.query.records("instance_presence",()=>({userId:{neq:e.user.id}})),[e]),n=kV("userIds",()=>c5(t.value.map(r=>r.userId)).sort(),{isEqual:(r,i)=>{var o;return r.join(",")===((o=i.join)==null?void 0:o.call(i,","))}},[t]);return ye(n)}function L5(e){const t=re(),n=b.useMemo(()=>t.store.query.records("instance_presence",()=>({userId:{eq:e}})),[t,e]);return ye(`latestPresence:${e}`,()=>n.value.slice().sort((i,o)=>o.lastActivityTimestamp-i.lastActivityTimestamp)[0],[])??null}const DX=Ke(function(){const t=RX();return m.jsx(m.Fragment,{children:t.map(n=>m.jsx(FX,{userId:n},n))})}),FX=Ke(function({userId:t}){const n=re(),{viewportPageBounds:r,zoomLevel:i}=n,{CollaboratorBrush:o,CollaboratorScribble:s,CollaboratorCursor:a,CollaboratorHint:l,CollaboratorShapeIndicator:c}=di(),u=L5(t);if(!u||u.currentPageId!==n.currentPageId)return null;const{brush:d,scribble:h,selectedIds:f,userName:p,cursor:g,color:y}=u,x=!(g.x<r.minX-12/i||g.y<r.minY-16/i||g.x>r.maxX-12/i||g.y>r.maxY-16/i);return m.jsxs(m.Fragment,{children:[d&&o?m.jsx(o,{className:"tl-collaborator__brush",brush:d,color:y,opacity:.1},t+"_brush"):null,x&&a?m.jsx(a,{className:"tl-collaborator__cursor",point:g,color:y,zoom:i,name:p!=="New User"?p:null},t+"_cursor"):l?m.jsx(l,{className:"tl-collaborator__cursor-hint",point:g,color:y,zoom:i,viewport:r},t+"_cursor_hint"):null,h&&s?m.jsx(s,{className:"tl-collaborator__scribble",scribble:h,color:y,zoom:i,opacity:h.color==="laser"?.5:.1},t+"_scribble"):null,c&&f.map(w=>m.jsx(c,{className:"tl-collaborator__shape-indicator",id:w,color:y,opacity:.5},t+"_"+w))]})}),NX=Ke(function(){const t=re(),n=b.useMemo(()=>({onPointerDown:h=>{if(h.isKilled)return;Lh(h.currentTarget,h);const f={type:"pointer",target:"selection",name:"pointer_down",...en(h,t.getContainer())};t.dispatch(f)},onPointerMove:h=>{if(h.isKilled)return;const f={type:"pointer",target:"selection",name:"pointer_move",...en(h,t.getContainer())};t.dispatch(f)},onPointerUp:h=>{if(h.isKilled)return;Bh(h.currentTarget,h);const f={type:"pointer",target:"selection",name:"pointer_up",...en(h,t.getContainer())};t.dispatch(f)},onPointerEnter:h=>{if(h.isKilled)return;const f={type:"pointer",target:"selection",name:"pointer_enter",...en(h,t.getContainer())};t.dispatch(f)},onPointerLeave:h=>{if(h.isKilled)return;const f={type:"pointer",target:"selection",name:"pointer_leave",...en(h,t.getContainer())};t.dispatch(f)}}),[t]),{selectionBounds:r,selectedIds:i}=t;if(!r)return null;const o=t.isInAny("select.idle","select.brushing","select.scribble_brushing","select.pointing_shape","select.pointing_selection","text.resizing");if(i.length===1){const a=t.getShapeById(i[0]);if(!a||t.getShapeUtil(a).hideSelectionBoundsBg(a))return null}const s=ie.toCssString(ie.Compose(ie.Translate(r.minX,r.minY),ie.Rotate(t.selectionRotation)));return m.jsx("div",{className:"tl-selection__bg",draggable:!1,style:{transform:s,width:Y(Math.max(1,r.width)),height:Y(Math.max(1,r.height)),pointerEvents:o?"all":"none",opacity:o?1:0},...n})}),jX='<path d="m12 24.4219v-16.015l11.591 11.619h-6.781l-.411.124z" fill="white"/><path d="m21.0845 25.0962-3.605 1.535-4.682-11.089 3.686-1.553z" fill="white"/><path d="m19.751 24.4155-1.844.774-3.1-7.374 1.841-.775z" fill="black"/><path d="m13 10.814v11.188l2.969-2.866.428-.139h4.768z" fill="black"/>',zX='<path d="m13.3315 21.3799c-.284-.359-.629-1.093-1.243-1.984-.348-.504-1.211-1.453-1.468-1.935-.223-.426-.199-.617-.146-.97.094-.628.738-1.117 1.425-1.051.519.049.959.392 1.355.716.239.195.533.574.71.788.163.196.203.277.377.509.23.307.302.459.214.121-.071-.496-.187-1.343-.355-2.092-.128-.568-.159-.657-.281-1.093-.129-.464-.195-.789-.316-1.281-.084-.348-.235-1.059-.276-1.459-.057-.547-.087-1.439.264-1.849.275-.321.906-.418 1.297-.22.512.259.803 1.003.936 1.3.239.534.387 1.151.516 1.961.164 1.031.466 2.462.476 2.763.024-.369-.068-1.146-.004-1.5.058-.321.328-.694.666-.795.286-.085.621-.116.916-.055.313.064.643.288.766.499.362.624.369 1.899.384 1.831.086-.376.071-1.229.284-1.584.14-.234.497-.445.687-.479.294-.052.655-.068.964-.008.249.049.586.345.677.487.218.344.342 1.317.379 1.658.015.141.074-.392.293-.736.406-.639 1.843-.763 1.898.639.025.654.02.624.02 1.064 0 .517-.012.828-.04 1.202-.031.4-.117 1.304-.242 1.742-.086.301-.371.978-.652 1.384 0 0-1.074 1.25-1.191 1.813-.118.562-.079.566-.102.965-.023.398.121.922.121.922s-.802.104-1.234.035c-.391-.063-.875-.841-1-1.079-.172-.328-.539-.265-.682-.023-.225.383-.709 1.07-1.051 1.113-.668.084-2.054.031-3.139.02 0 0 .185-1.011-.227-1.358-.305-.259-.83-.784-1.144-1.06z" fill="white"/><g stroke="black" stroke-linecap="round" stroke-width=".75"><path d="m13.3315 21.3799c-.284-.359-.629-1.093-1.243-1.984-.348-.504-1.211-1.453-1.468-1.935-.223-.426-.199-.617-.146-.97.094-.628.738-1.117 1.425-1.051.519.049.959.392 1.355.716.239.195.533.574.71.788.163.196.203.277.377.509.23.307.302.459.214.121-.071-.496-.187-1.343-.355-2.092-.128-.568-.159-.657-.281-1.093-.129-.464-.195-.789-.316-1.281-.084-.348-.235-1.059-.276-1.459-.057-.547-.087-1.439.264-1.849.275-.321.906-.418 1.297-.22.512.259.803 1.003.936 1.3.239.534.387 1.151.516 1.961.164 1.031.466 2.462.476 2.763.024-.369-.068-1.146-.004-1.5.058-.321.328-.694.666-.795.286-.085.621-.116.916-.055.313.064.643.288.766.499.362.624.369 1.899.384 1.831.086-.376.071-1.229.284-1.584.14-.234.497-.445.687-.479.294-.052.655-.068.964-.008.249.049.586.345.677.487.218.344.342 1.317.379 1.658.015.141.074-.392.293-.736.406-.639 1.843-.763 1.898.639.025.654.02.624.02 1.064 0 .517-.012.828-.04 1.202-.031.4-.117 1.304-.242 1.742-.086.301-.371.978-.652 1.384 0 0-1.074 1.25-1.191 1.813-.118.562-.079.566-.102.965-.023.398.121.922.121.922s-.802.104-1.234.035c-.391-.063-.875-.841-1-1.079-.172-.328-.539-.265-.682-.023-.225.383-.709 1.07-1.051 1.113-.668.084-2.054.031-3.139.02 0 0 .185-1.011-.227-1.358-.305-.259-.83-.784-1.144-1.06z" stroke-linejoin="round"/><path d="m21.5664 21.7344v-3.459"/><path d="m19.5508 21.7461-.016-3.473"/><path d="m17.5547 18.3047.021 3.426"/></g>',UX='<path d="m25 16h-6.01v-6h-2.98v6h-6.01v3h6.01v6h2.98v-6h6.01z" fill="white"/><path d="m23.9902 17.0103h-6v-6.01h-.98v6.01h-6v.98h6v6.01h.98v-6.01h6z" fill="%23231f1f"/>',WX='<path d="m19 14h1v1h-1zm1 6h-1v-1h1zm-5-5h-1v-1h1zm0 5h-1v-1h1zm2-10.987-7.985 7.988 5.222 5.221 2.763 2.763 7.984-7.985z" fill="white"/><g fill="black"><path d="m23.5664 16.9971-2.557-2.809v1.829h-4.009-4.001v-1.829l-2.571 2.809 2.572 2.808-.001-1.808h4.001 4.009l-.001 1.808z"/><path d="m17.9873 17h.013v-4.001l1.807.001-2.807-2.571-2.809 2.57h1.809v4.001h.008v4.002l-1.828-.001 2.807 2.577 2.805-2.576h-1.805z"/></g>',sT="<path d='m19.7432 17.0869-4.072 4.068 2.829 2.828-8.473-.013-.013-8.47 2.841 2.842 4.075-4.068 1.414-1.415-2.844-2.842h8.486v8.484l-2.83-2.827z' fill='%23fff'/><path d='m18.6826 16.7334-4.427 4.424 1.828 1.828-5.056-.016-.014-5.054 1.842 1.841 4.428-4.422 2.474-2.475-1.844-1.843h5.073v5.071l-1.83-1.828z' fill='%23000'/>",aT="<path d='m9 17.9907v.005l5.997 5.996.001-3.999h1.999 2.02v4l5.98-6.001-5.98-5.999.001 4.019-2.021.002h-2l.001-4.022zm1.411.003 3.587-3.588-.001 2.587h3.5 2.521v-2.585l3.565 3.586-3.564 3.585-.001-2.585h-2.521l-3.499-.001-.001 2.586z' fill='%23fff'/><path d='m17.4971 18.9932h2.521v2.586l3.565-3.586-3.565-3.585v2.605h-2.521-3.5v-2.607l-3.586 3.587 3.586 3.586v-2.587z' fill='%23000'/>",Wf='<path d="M22.4789 9.45728L25.9935 12.9942L22.4789 16.5283V14.1032C18.126 14.1502 14.6071 17.6737 14.5675 22.0283H17.05L13.513 25.543L9.97889 22.0283H12.5674C12.6071 16.5691 17.0214 12.1503 22.4789 12.1031L22.4789 9.45728Z" fill="black"/><path fill-rule="evenodd" clip-rule="evenodd" d="M21.4789 7.03223L27.4035 12.9945L21.4789 18.9521V15.1868C18.4798 15.6549 16.1113 18.0273 15.649 21.0284H19.475L13.5128 26.953L7.55519 21.0284H11.6189C12.1243 15.8155 16.2679 11.6677 21.4789 11.1559L21.4789 7.03223ZM22.4789 12.1031C17.0214 12.1503 12.6071 16.5691 12.5674 22.0284H9.97889L13.513 25.543L17.05 22.0284H14.5675C14.5705 21.6896 14.5947 21.3558 14.6386 21.0284C15.1157 17.4741 17.9266 14.6592 21.4789 14.1761C21.8063 14.1316 22.1401 14.1069 22.4789 14.1032V16.5284L25.9935 12.9942L22.4789 9.45729L22.4789 12.1031Z" fill="white"/>',HX='<path fill="white" d="M7.94 0a5.25 5.25 0 0 0-3.47 1.17A5.27 5.27 0 0 0 1 0H0v3h1c1.41 0 1.85.7 2 1v3.94H2v3h1v3c-.13.3-.57 1-2 1H0v3h1a5.27 5.27 0 0 0 3.47-1.17c.98.8 2.21 1.21 3.47 1.17h1v-3h-1c-1.41 0-1.85-.7-2-1v-3H7v-3H6V4c.13-.3.57-1 2-1h1V0H7.94z"/><path fill="black" d="M7.94 2V1a4 4 0 0 0-3.47 1.64A4 4 0 0 0 1 1v1c1.3-.17 2.56.6 3 1.84v5.1H3v1h1v4.16c-.45 1.24-1.7 2-3 1.84v1a4.05 4.05 0 0 0 3.47-1.63 4.05 4.05 0 0 0 3.47 1.63v-1A2.82 2.82 0 0 1 5 14.1V9.93h1v-1H5V3.85A2.81 2.81 0 0 1 7.94 2z"/>',KX="<path d='m13.5732 12.0361c.48-.178 1.427-.069 1.677.473.213.462.396 1.241.406 1.075.024-.369-.024-1.167.137-1.584.117-.304.347-.59.686-.691.285-.086.62-.116.916-.055.313.064.642.287.765.499.362.623.368 1.899.385 1.831.064-.272.07-1.229.283-1.584.141-.235.497-.445.687-.479.294-.052.656-.068.964-.008.249.049.586.344.677.487.219.344.342 1.316.379 1.658.016.141.074-.393.293-.736.406-.639 1.844-.763 1.898.639.026.654.02.624.02 1.064 0 .516-.012.828-.04 1.202-.03.399-.116 1.304-.241 1.742-.086.301-.371.978-.653 1.384 0 0-1.074 1.25-1.191 1.812-.117.563-.078.567-.102.965-.023.399.121.923.121.923s-.801.104-1.234.034c-.391-.062-.875-.84-1-1.078-.172-.328-.539-.265-.682-.023-.224.383-.709 1.07-1.05 1.113-.669.084-2.055.03-3.14.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.283-.36-1.002-.929-1.243-1.985-.213-.936-.192-1.395.037-1.77.232-.381.67-.589.854-.625.208-.042.692-.039.875.062.223.123.313.159.488.391.23.307.312.456.213.121-.076-.262-.322-.595-.434-.97-.109-.361-.401-.943-.38-1.526.008-.221.103-.771.832-1.042' fill='white'/><g stroke='black' stroke-width='.75'><path d='m13.5732 12.0361c.48-.178 1.427-.069 1.677.473.213.462.396 1.241.406 1.075.024-.369-.024-1.167.137-1.584.117-.304.347-.59.686-.691.285-.086.62-.116.916-.055.313.064.642.287.765.499.362.623.368 1.899.385 1.831.064-.272.07-1.229.283-1.584.141-.235.497-.445.687-.479.294-.052.656-.068.964-.008.249.049.586.344.677.487.219.344.342 1.316.379 1.658.016.141.074-.393.293-.736.406-.639 1.844-.763 1.898.639.026.654.02.624.02 1.064 0 .516-.012.828-.04 1.202-.03.399-.116 1.304-.241 1.742-.086.301-.371.978-.653 1.384 0 0-1.074 1.25-1.191 1.812-.117.563-.078.567-.102.965-.023.399.121.923.121.923s-.801.104-1.234.034c-.391-.062-.875-.84-1-1.078-.172-.328-.539-.265-.682-.023-.224.383-.709 1.07-1.05 1.113-.669.084-2.055.03-3.14.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.283-.36-1.002-.929-1.243-1.985-.213-.936-.192-1.395.037-1.77.232-.381.67-.589.854-.625.208-.042.692-.039.875.062.223.123.313.159.488.391.23.307.312.456.213.121-.076-.262-.322-.595-.434-.97-.109-.361-.401-.943-.38-1.526.008-.221.103-.771.832-1.042z' stroke-linejoin='round'/><path d='m20.5664 19.7344v-3.459' stroke-linecap='round'/><path d='m18.5508 19.7461-.016-3.473' stroke-linecap='round'/><path d='m16.5547 16.3047.021 3.426' stroke-linecap='round'/></g>",VX='<path d="m13.5557 17.5742c-.098-.375-.196-.847-.406-1.552-.167-.557-.342-.859-.47-1.233-.155-.455-.303-.721-.496-1.181-.139-.329-.364-1.048-.457-1.44-.119-.509.033-.924.244-1.206.253-.339.962-.49 1.357-.351.371.13.744.512.916.788.288.46.357.632.717 1.542.393.992.564 1.918.611 2.231l.085.452c-.001-.04-.043-1.122-.044-1.162-.035-1.029-.06-1.823-.038-2.939.002-.126.064-.587.084-.715.078-.5.305-.8.673-.979.412-.201.926-.215 1.401-.017.423.173.626.55.687 1.022.014.109.094.987.093 1.107-.013 1.025.006 1.641.015 2.174.004.231.003 1.625.017 1.469.061-.656.094-3.189.344-3.942.144-.433.405-.746.794-.929.431-.203 1.113-.07 1.404.243.285.305.446.692.482 1.153.032.405-.019.897-.02 1.245 0 .867-.021 1.324-.037 2.121-.001.038-.015.298.023.182.094-.28.188-.542.266-.745.049-.125.241-.614.359-.859.114-.234.211-.369.415-.688.2-.313.415-.448.668-.561.54-.235 1.109.112 1.301.591.086.215.009.713-.028 1.105-.061.647-.254 1.306-.352 1.648-.128.447-.274 1.235-.34 1.601-.072.394-.234 1.382-.359 1.82-.086.301-.371.978-.652 1.384 0 0-1.074 1.25-1.192 1.812-.117.563-.078.567-.101.965-.024.399.121.923.121.923s-.802.104-1.234.034c-.391-.062-.875-.841-1-1.078-.172-.328-.539-.265-.682-.023-.225.383-.709 1.07-1.051 1.113-.668.084-2.054.03-3.139.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.284-.36-.629-1.093-1.243-1.985-.348-.504-1.027-1.085-1.284-1.579-.223-.425-.331-.954-.19-1.325.225-.594.675-.897 1.362-.832.519.05.848.206 1.238.537.225.19.573.534.75.748.163.195.203.276.377.509.23.307.302.459.214.121" fill="white"/><g stroke="black" stroke-linecap="round" stroke-width=".75"><path d="m13.5557 17.5742c-.098-.375-.196-.847-.406-1.552-.167-.557-.342-.859-.47-1.233-.155-.455-.303-.721-.496-1.181-.139-.329-.364-1.048-.457-1.44-.119-.509.033-.924.244-1.206.253-.339.962-.49 1.357-.351.371.13.744.512.916.788.288.46.357.632.717 1.542.393.992.564 1.918.611 2.231l.085.452c-.001-.04-.043-1.122-.044-1.162-.035-1.029-.06-1.823-.038-2.939.002-.126.064-.587.084-.715.078-.5.305-.8.673-.979.412-.201.926-.215 1.401-.017.423.173.626.55.687 1.022.014.109.094.987.093 1.107-.013 1.025.006 1.641.015 2.174.004.231.003 1.625.017 1.469.061-.656.094-3.189.344-3.942.144-.433.405-.746.794-.929.431-.203 1.113-.07 1.404.243.285.305.446.692.482 1.153.032.405-.019.897-.02 1.245 0 .867-.021 1.324-.037 2.121-.001.038-.015.298.023.182.094-.28.188-.542.266-.745.049-.125.241-.614.359-.859.114-.234.211-.369.415-.688.2-.313.415-.448.668-.561.54-.235 1.109.112 1.301.591.086.215.009.713-.028 1.105-.061.647-.254 1.306-.352 1.648-.128.447-.274 1.235-.34 1.601-.072.394-.234 1.382-.359 1.82-.086.301-.371.978-.652 1.384 0 0-1.074 1.25-1.192 1.812-.117.563-.078.567-.101.965-.024.399.121.923.121.923s-.802.104-1.234.034c-.391-.062-.875-.841-1-1.078-.172-.328-.539-.265-.682-.023-.225.383-.709 1.07-1.051 1.113-.668.084-2.054.03-3.139.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.284-.36-.629-1.093-1.243-1.985-.348-.504-1.027-1.085-1.284-1.579-.223-.425-.331-.954-.19-1.325.225-.594.675-.897 1.362-.832.519.05.848.206 1.238.537.225.19.573.534.75.748.163.195.203.276.377.509.23.307.302.459.214.121" stroke-linejoin="round"/><path d="m20.5664 21.7344v-3.459"/><path d="m18.5508 21.7461-.016-3.473"/><path d="m16.5547 18.3047.021 3.426"/></g>',YX='<path d="m20.5 15c0 3.038-2.462 5.5-5.5 5.5s-5.5-2.462-5.5-5.5 2.462-5.5 5.5-5.5 5.5 2.462 5.5 5.5" fill="white"/><path d="m20.5 15c0 3.038-2.462 5.5-5.5 5.5s-5.5-2.462-5.5-5.5 2.462-5.5 5.5-5.5 5.5 2.462 5.5 5.5z" stroke="black"/><g fill="black"><path d="m18 14h-2v-2h-2v2h-2v1.98h2v2.02h2v-2.02h2z"/><path d="m23.5859 25 1.414-1.414-5.449-5.449-1.414 1.414z"/></g>',qX='<path d="m20.5 15c0 3.038-2.462 5.5-5.5 5.5s-5.5-2.462-5.5-5.5 2.462-5.5 5.5-5.5 5.5 2.462 5.5 5.5" fill="white"/><path d="m20.5 15c0 3.038-2.462 5.5-5.5 5.5s-5.5-2.462-5.5-5.5 2.462-5.5 5.5-5.5 5.5 2.462 5.5 5.5z" stroke="black"/><g fill="black"><path d="m18 16h-5.98v-1.98h5.98z"/><path d="m23.5859 25 1.414-1.414-5.449-5.449-1.414 1.414z"/></g>';function hn(e,t,n,r,i,o=16,s=16){const a=(-n-t)*(Et/180),l=Math.sin(a),c=Math.cos(a),u=1*c-1*l,d=1*l+1*c;return`url("data:image/svg+xml,<svg height='32' width='32' viewBox='0 0 32 32' xmlns='http://www.w3.org/2000/svg' style='color: ${i};'><defs><filter id='shadow' y='-40%' x='-40%' width='180px' height='180%' color-interpolation-filters='sRGB'><feDropShadow dx='${u}' dy='${d}' stdDeviation='1.2' flood-opacity='.5'/></filter></defs><g fill='none' transform='rotate(${t+n} 16 16)${r?" scale(-1,-1) translate(0, -32)":""}' filter='url(%23shadow)'>`+e.replaceAll('"',"'")+`</g></svg>") ${o} ${s}, pointer`}const GX={none:()=>"none",default:(e,t,n)=>hn(jX,e,0,t,n,12,8),pointer:(e,t,n)=>hn(zX,e,0,t,n,14,10),cross:(e,t,n)=>hn(UX,e,0,t,n),move:(e,t,n)=>hn(WX,e,0,t,n),grab:(e,t,n)=>hn(VX,e,0,t,n),grabbing:(e,t,n)=>hn(KX,e,0,t,n),text:(e,t,n)=>hn(HX,e,0,t,n,4,10),"ew-resize":(e,t,n)=>hn(aT,e,0,t,n),"ns-resize":(e,t,n)=>hn(aT,e,90,t,n),"nesw-resize":(e,t,n)=>hn(sT,e,0,t,n),"nwse-resize":(e,t,n)=>hn(sT,e,90,t,n),"nwse-rotate":(e,t,n)=>hn(Wf,e,0,t,n),"nesw-rotate":(e,t,n)=>hn(Wf,e,90,t,n),"senw-rotate":(e,t,n)=>hn(Wf,e,180,t,n),"swne-rotate":(e,t,n)=>hn(Wf,e,270,t,n),"zoom-in":(e,t,n)=>hn(YX,e,0,t,n),"zoom-out":(e,t,n)=>hn(qX,e,0,t,n)};function _r(e,t=0,n="black"){return GX[e](OV(t),!1,n)}const XX=["default","pointer","cross","move","grab","grabbing","text"];function ZX(){const e=re(),t=tr();Na("useCursor",()=>{const{type:n,rotation:r,color:i}=e.cursor;if(XX.includes(n)){t.style.setProperty("--tl-cursor",`var(--tl-cursor-${n})`);return}t.style.setProperty("--tl-cursor",_r(n,r,i))},[e,t])}function Wi(e){const t=re();return b.useMemo(function(){const i=c=>{if(c.isKilled||c.button!==0)return;const u=am(c.currentTarget);function d(){u.removeEventListener("pointerup",d),Bh(u,c)}Lh(u,c),u.addEventListener("pointerup",d),t.dispatch({name:"pointer_down",type:"pointer",target:"selection",handle:e,...en(c,t.getContainer())}),c.stopPropagation()};let o,s;function a(c){c.isKilled||c.button===0&&(c.clientX===o&&c.clientY===s||(o=c.clientX,s=c.clientY,t.dispatch({name:"pointer_move",type:"pointer",target:"selection",handle:e,...en(c,t.getContainer())})))}return{onPointerDown:i,onPointerMove:a,onPointerUp:c=>{c.isKilled||c.button===0&&t.dispatch({name:"pointer_up",type:"pointer",target:"selection",handle:e,...en(c,t.getContainer())})}}},[t,e])}function QX({size:e,width:t,height:n,hideAlternateHandles:r}){const i=Y(e/3),o=i/2;return m.jsxs("svg",{className:"tl-overlays__item",children:[m.jsx("polyline",{className:"tl-corner-crop-handle",points:`
						${Y(0-o)},${Y(e)} 
						${Y(0-o)},${Y(0-o)} 
						${Y(e)},${Y(0-o)}`,strokeWidth:i,"data-testid":"selection.crop.top_left","aria-label":"top_left handle"}),m.jsx("line",{className:Me("tl-corner-crop-edge-handle",{"tl-hidden":r}),x1:Y(t/2-e),y1:Y(0-o),x2:Y(t/2+e),y2:Y(0-o),strokeWidth:i,"data-testid":"selection.crop.top","aria-label":"top handle"}),m.jsx("polyline",{className:Me("tl-corner-crop-handle",{"tl-hidden":r}),points:`
						${Y(t-e)},${Y(0-o)} 
						${Y(t+o)},${Y(0-o)} 
						${Y(t+o)},${Y(e)}`,strokeWidth:i,"data-testid":"selection.crop.top_right","aria-label":"top_right handle"}),m.jsx("line",{className:Me("tl-corner-crop-edge-handle",{"tl-hidden":r}),x1:Y(t+o),y1:Y(n/2-e),x2:Y(t+o),y2:Y(n/2+e),strokeWidth:i,"data-testid":"selection.crop.right","aria-label":"right handle"}),m.jsx("polyline",{className:"tl-corner-crop-handle",points:`
						${Y(t+o)},${Y(n-e)} 
						${Y(t+o)},${Y(n+o)}
						${Y(t-e)},${Y(n+o)}`,strokeWidth:i,"data-testid":"selection.crop.bottom_right","aria-label":"bottom_right handle"}),m.jsx("line",{className:Me("tl-corner-crop-edge-handle",{"tl-hidden":r}),x1:Y(t/2-e),y1:Y(n+o),x2:Y(t/2+e),y2:Y(n+o),strokeWidth:i,"data-testid":"selection.crop.bottom","aria-label":"bottom handle"}),m.jsx("polyline",{className:Me("tl-corner-crop-handle",{"tl-hidden":r}),points:`
						${Y(0+e)},${Y(n+o)} 
						${Y(0-o)},${Y(n+o)}
						${Y(0-o)},${Y(n-e)}`,strokeWidth:i,"data-testid":"selection.crop.bottom_left","aria-label":"bottom_left handle"}),m.jsx("line",{className:Me("tl-corner-crop-edge-handle",{"tl-hidden":r}),x1:Y(0-o),y1:Y(n/2-e),x2:Y(0-o),y2:Y(n/2+e),strokeWidth:i,"data-testid":"selection.crop.left","aria-label":"left handle"})]})}const JX=typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().indexOf("firefox")>-1,eZ=Ke(function(){var Rt;const t=re(),n=b.useRef(null),r=t.isReadOnly,i=Wi("top"),o=Wi("right"),s=Wi("bottom"),a=Wi("left"),l=Wi("top_left"),c=Wi("top_right"),u=Wi("bottom_right"),d=Wi("bottom_left"),h=!t.isMenuOpen&&t.cursor.type==="default",f=t.isCoarsePointer;let p=t.selectionBounds;const g=t.selectedShapes,y=g.length===1?g[0]:null,x=y&&t.isShapeOrAncestorLocked(y),w=y?t.getShapeUtil(y).expandSelectionOutlinePx(y):0;if(ky(n,p==null?void 0:p.x,p==null?void 0:p.y,1,t.selectionRotation,{x:-w,y:-w}),!p)return null;p=p.clone().expandBy(w);const _=t.zoomLevel,S=t.selectionRotation,T=t.isChangingStyle,P=Math.max(1,p.width),I=Math.max(1,p.height),$=8/_,L=P<$*2,R=I<$*2,K=P<$*4,Q=I<$*4,j=P<$*5,B=I<$*5,z=f?1.75:1,q=6/_*z,U=(K?q/2:q)*(z*.75),D=(Q?q/2:q)*(z*.75),F=(y?!t.getShapeUtil(y).hideSelectionBoundsFg(y):!0)&&!T;let J=F&&t.isInAny("select.idle","select.brushing","select.scribble_brushing","select.pointing_canvas","select.pointing_selection","select.pointing_shape","select.crop.idle","select.crop.pointing_crop","select.pointing_resize_handle","select.pointing_crop_handle","select.editing_shape")||F&&t.isIn("select.resizing")&&y&&g[0].type==="text";JX&&J&&((Rt=t.onlySelectedShape)==null?void 0:Rt.type)==="embed"&&(J=!1);const Z=t.isInAny("select.pointing_crop_handle","select.crop.idle","select.crop.pointing_crop")&&!T&&!r,ne=t.isInAny("select.idle","select.pointing_selection","select.pointing_shape","select.crop.idle")&&!T&&!r,de=!f&&!(L||R)&&(ne||Z)&&(y?!t.getShapeUtil(y).hideRotateHandle(y):!0)&&!x,Ce=f&&(!K||!Q)&&(ne||Z)&&(y?!t.getShapeUtil(y).hideRotateHandle(y):!0)&&!x,he=ne&&(y?t.getShapeUtil(y).canResize(y)&&!t.getShapeUtil(y).hideResizeHandles(y):!0)&&!Z&&!x,je=L||R,$e=L&&R,Ee=j||B,Ie=he||Z,Fe=!de,ct=!ne||!Ce,mt=!ne||!Ie,Wt=!ne||!Ie||je,_t=!ne||!Ie||je,jn=!ne||!Ie||$e&&!Z;let Sn=f;Sn&&g.every(rn=>t.getShapeUtil(rn).isAspectRatioLocked(rn))&&(Sn=!1);let Zt=!0;Z?Zt=Ee:he&&(Zt=je||$e||Sn);const _n=Math.min(24/_,I-D*3),Cn=ne&&f&&(y==null?void 0:y.type)==="text"&&_n*_>=4;return m.jsxs("svg",{ref:n,className:"tl-overlays__item tl-selection__fg","data-testid":"selection-foreground",children:[J&&m.jsx("rect",{className:Me("tl-selection__fg__outline"),width:Y(P),height:Y(I)}),m.jsx(Hf,{"data-testid":"selection.rotate.top-left",cx:0,cy:0,targetSize:q,corner:"top_left_rotate",cursor:h?_r("nwse-rotate",S):void 0,isHidden:Fe}),m.jsx(Hf,{"data-testid":"selection.rotate.top-right",cx:P+q*3,cy:0,targetSize:q,corner:"top_right_rotate",cursor:h?_r("nesw-rotate",S):void 0,isHidden:Fe}),m.jsx(Hf,{"data-testid":"selection.rotate.bottom-left",cx:0,cy:I+q*3,targetSize:q,corner:"bottom_left_rotate",cursor:h?_r("swne-rotate",S):void 0,isHidden:Fe}),m.jsx(Hf,{"data-testid":"selection.rotate.bottom-right",cx:P+q*3,cy:I+q*3,targetSize:q,corner:"bottom_right_rotate",cursor:h?_r("senw-rotate",S):void 0,isHidden:Fe})," ",m.jsx(nZ,{"data-testid":"selection.rotate.mobile",cx:K?-q*1.5:P/2,cy:K?I/2:-q*1.5,size:$,isHidden:ct}),m.jsx("rect",{className:Me("tl-transparent",{"tl-hidden":Zt}),"data-testid":"selection.resize.top","aria-label":"top target",pointerEvents:"all",x:0,y:Y(0-(Q?D*2:D)),width:Y(Math.max(1,P)),height:Y(Math.max(1,D*2)),style:h?{cursor:_r("ns-resize",S)}:void 0,...i}),m.jsx("rect",{className:Me("tl-transparent",{"tl-hidden":Zt}),"data-testid":"selection.resize.right","aria-label":"right target",pointerEvents:"all",x:Y(P-(K?0:U)),y:0,height:Y(Math.max(1,I)),width:Y(Math.max(1,U*2)),style:h?{cursor:_r("ew-resize",S)}:void 0,...o}),m.jsx("rect",{className:Me("tl-transparent",{"tl-hidden":Zt}),"data-testid":"selection.resize.bottom","aria-label":"bottom target",pointerEvents:"all",x:0,y:Y(I-(Q?0:D)),width:Y(Math.max(1,P)),height:Y(Math.max(1,D*2)),style:h?{cursor:_r("ns-resize",S)}:void 0,...s}),m.jsx("rect",{className:Me("tl-transparent",{"tl-hidden":Zt}),"data-testid":"selection.resize.left","aria-label":"left target",pointerEvents:"all",x:Y(0-(K?U*2:U)),y:0,height:Y(Math.max(1,I)),width:Y(Math.max(1,U*2)),style:h?{cursor:_r("ew-resize",S)}:void 0,...a}),m.jsx("rect",{className:Me("tl-transparent",{"tl-hidden":mt}),"data-testid":"selection.target.top-left","aria-label":"top-left target",pointerEvents:"all",x:Y(0-(K?U*2:U*1.5)),y:Y(0-(Q?D*2:D*1.5)),width:Y(U*3),height:Y(D*3),style:h?{cursor:_r("nwse-resize",S)}:void 0,...l}),m.jsx("rect",{className:Me("tl-transparent",{"tl-hidden":Wt}),"data-testid":"selection.target.top-right","aria-label":"top-right target",pointerEvents:"all",x:Y(P-(K?0:U*1.5)),y:Y(0-(Q?D*2:D*1.5)),width:Y(U*3),height:Y(D*3),style:h?{cursor:_r("nesw-resize",S)}:void 0,...c}),m.jsx("rect",{className:Me("tl-transparent",{"tl-hidden":jn}),"data-testid":"selection.target.bottom-right","aria-label":"bottom-right target",pointerEvents:"all",x:Y(P-(K?U:U*1.5)),y:Y(I-(Q?D:D*1.5)),width:Y(U*3),height:Y(D*3),style:h?{cursor:_r("nwse-resize",S)}:void 0,...u}),m.jsx("rect",{className:Me("tl-transparent",{"tl-hidden":_t}),"data-testid":"selection.target.bottom-left","aria-label":"bottom-left target",pointerEvents:"all",x:Y(0-(K?U*3:U*1.5)),y:Y(I-(Q?0:D*1.5)),width:Y(U*3),height:Y(D*3),style:h?{cursor:_r("nesw-resize",S)}:void 0,...d}),he&&m.jsxs(m.Fragment,{children:[m.jsx("rect",{"data-testid":"selection.resize.top-left",className:Me("tl-corner-handle",{"tl-hidden":mt}),"aria-label":"top_left handle",x:Y(0-$/2),y:Y(0-$/2),width:Y($),height:Y($)}),m.jsx("rect",{"data-testid":"selection.resize.top-right",className:Me("tl-corner-handle",{"tl-hidden":Wt}),"aria-label":"top_right handle",x:Y(P-$/2),y:Y(0-$/2),width:Y($),height:Y($)}),m.jsx("rect",{"data-testid":"selection.resize.bottom-right",className:Me("tl-corner-handle",{"tl-hidden":jn}),"aria-label":"bottom_right handle",x:Y(P-$/2),y:Y(I-$/2),width:Y($),height:Y($)}),m.jsx("rect",{"data-testid":"selection.resize.bottom-left",className:Me("tl-corner-handle",{"tl-hidden":_t}),"aria-label":"bottom_left handle",x:Y(0-$/2),y:Y(I-$/2),width:Y($),height:Y($)})]}),Cn&&m.jsxs(m.Fragment,{children:[m.jsx("rect",{"data-testid":"selection.text-resize.left.handle",className:"tl-text-handle","aria-label":"bottom_left handle",x:Y(0-$/4),y:Y(I/2-_n/2),rx:$/4,width:Y($/2),height:Y(_n)}),m.jsx("rect",{"data-testid":"selection.text-resize.right.handle",className:"tl-text-handle","aria-label":"bottom_left handle",rx:$/4,x:Y(P-$/4),y:Y(I/2-_n/2),width:Y($/2),height:Y(_n)})]}),Z&&m.jsx(QX,{size:$,width:P,height:I,hideAlternateHandles:Ee})]})}),Hf=function({cx:t,cy:n,targetSize:r,corner:i,cursor:o,isHidden:s,"data-testid":a}){const l=Wi(i);return m.jsx("rect",{className:Me("tl-transparent","tl-rotate-corner",{"tl-hidden":s}),"data-testid":a,"aria-label":`${i} target`,pointerEvents:"all",x:Y(t-r*3),y:Y(n-r*3),width:Y(Math.max(1,r*3)),height:Y(Math.max(1,r*3)),cursor:o,...l})},tZ=Math.sqrt(Math.PI),nZ=function({cx:t,cy:n,size:r,isHidden:i,"data-testid":o}){const s=Wi("mobile_rotate");return m.jsxs("g",{children:[m.jsx("circle",{"data-testid":o,pointerEvents:"all",className:Me("tl-transparent","tl-mobile-rotate__bg",{"tl-hidden":i}),cx:t,cy:n,...s}),m.jsx("circle",{className:Me("tl-mobile-rotate__fg",{"tl-hidden":i}),cx:t,cy:n,r:r/tZ})]})},$u=(e,t,n)=>r=>{if(n!=="pointer_move"&&e.pageState.editingId===t&&(r.isKilled=!0),r.isKilled)return;switch(n){case"pointer_down":{if(r.button!==0&&r.button!==1&&r.button!==2)return;Lh(r.currentTarget,r);break}case"pointer_up":{Bh(r.currentTarget,r);break}}const i=e.getShapeById(t);if(!i){console.error("Shape not found",t);return}e.dispatch({type:"pointer",target:"shape",shape:i,name:n,...en(r,e.getContainer())})};function rZ(e){const t=re();return ke.useMemo(()=>{function n(l){l.isKilled=!0,Xe(l)}function r(l){l.isKilled=!0,Xe(l)}const i=$u(t,e,"pointer_move");let o,s;function a(l){if(!l.isKilled&&!(l.clientX===o&&l.clientY===s))return o=l.clientX,s=l.clientY,i(l)}return{onPointerDown:$u(t,e,"pointer_down"),onPointerUp:$u(t,e,"pointer_up"),onPointerEnter:$u(t,e,"pointer_enter"),onPointerLeave:$u(t,e,"pointer_leave"),onPointerMove:a,onTouchStart:n,onTouchEnd:r}},[t,e])}const lT=Ke(function({id:t,index:n,backgroundIndex:r,opacity:i,isCulled:o}){const s=re(),{ShapeErrorFallback:a}=di(),l=rZ(t),c=b.useRef(null),u=b.useRef(null),d=b.useCallback((p,g)=>{var y,x;(y=c.current)==null||y.style.setProperty(p,g),(x=u.current)==null||x.style.setProperty(p,g)},[]);Na("set shape container transform position",()=>{const p=s.getShapeById(t),g=s.getPageTransformById(t);if(!p||!g)return null;const y=ie.toCssString(g);d("transform",y)},[s,d]),Na("set shape container clip path / color",()=>{const p=s.getShapeById(t);if(!p)return null;const g=s.getClipPathById(t);d("clip-path",g??"none"),"color"in p.props&&d("color",s.getCssColor(p.props.color))},[s,d]),Na("set shape height and width",()=>{const p=s.getShapeById(t);if(!p)return null;const y=s.getShapeUtil(p).bounds(p);d("width",Math.ceil(y.width)+"px"),d("height",Math.ceil(y.height)+"px")},[s]),b.useLayoutEffect(()=>{var p,g;d("opacity",i+""),(p=c.current)==null||p.style.setProperty("z-index",n+""),(g=u.current)==null||g.style.setProperty("z-index",r+"")},[i,n,r,d]);const h=s.getShapeById(t);if(!h)return null;const f=s.getShapeUtil(h);return m.jsxs(m.Fragment,{children:[f.renderBackground&&m.jsx("div",{ref:u,className:"tl-shape tl-shape-background","data-shape-type":h.type,draggable:!1,children:!o&&m.jsx(qd,{fallback:a?p=>m.jsx(a,{error:p}):null,onError:p=>s.annotateError(p,{origin:"react.shape",willCrashApp:!1}),children:m.jsx(oZ,{shape:h,util:f})})}),m.jsx("div",{ref:c,className:"tl-shape","data-shape-type":h.type,draggable:!1,onPointerDown:l.onPointerDown,onPointerMove:l.onPointerMove,onPointerUp:l.onPointerUp,onPointerEnter:l.onPointerEnter,onPointerLeave:l.onPointerLeave,children:o&&f.canUnmount(h)?m.jsx(sZ,{shape:h,util:f}):m.jsx(qd,{fallback:a?p=>m.jsx(a,{error:p}):null,onError:p=>s.annotateError(p,{origin:"react.shape",willCrashApp:!1}),children:m.jsx(iZ,{shape:h,util:f})})})]})}),iZ=b.memo(function({shape:t,util:n}){return Sy("InnerShape:"+n.type,()=>n.render(t))},(e,t)=>e.shape.props===t.shape.props),oZ=b.memo(function({shape:t,util:n}){return Sy("InnerShape:"+n.type,()=>{var r;return(r=n.renderBackground)==null?void 0:r.call(n,t)})},(e,t)=>e.shape.props===t.shape.props),sZ=b.memo(function({shape:t,util:n}){const r=n.bounds(t);return m.jsx("div",{className:"tl-shape__culled",style:{transform:`translate(${r.minX}px, ${r.minY}px)`,width:r.width,height:r.height}})},()=>!0),B5=Ke(function({onDropOverride:t}){const n=re(),{Background:r,SvgDefs:i}=di(),o=b.useRef(null),s=b.useRef(null);BX(),Wq(),zq(),$X(o),cG(o),Na("position layers",()=>{const u=s.current;if(!u)return;const{x:d,y:h,z:f}=n.camera,p=f>=1?lb(f,[1,8],[.125,.5],!0):lb(f,[.1,1],[-2,.125],!0);u.style.setProperty("transform",`scale(${Y(f)}) translate(${Y(d+p)}px,${Y(h+p)}px)`)},[n]);const{context:a,isReady:l}=OX(),c=jq();return t&&(c.onDrop=t(c.onDrop)),b.useEffect(()=>{if(l&&n.isSafari){const u=s.current;u&&requestAnimationFrame(()=>{u.style.display="none",requestAnimationFrame(()=>{u.style.display=""})})}},[n,l]),b.useEffect(()=>{var u;(u=o.current)==null||u.focus()},[]),m.jsxs("div",{ref:o,draggable:!1,className:"tl-canvas","data-testid":"canvas",...c,children:[r&&m.jsx(r,{}),m.jsx(aZ,{}),m.jsx(_Z,{}),m.jsxs("div",{ref:s,className:"tl-html-layer",draggable:!1,children:[m.jsx("svg",{className:"tl-svg-context",children:m.jsxs("defs",{children:[a,cT&&m.jsx(cT,{}),m.jsx(xZ,{}),m.jsx(bZ,{}),m.jsx(wZ,{}),i&&m.jsx(i,{})]})}),m.jsx(NX,{}),m.jsx("div",{className:"tl-shapes",children:m.jsx(gZ,{})}),m.jsxs("div",{className:"tl-overlays",children:[m.jsx(fZ,{}),m.jsx(cZ,{}),m.jsx(lZ,{}),m.jsx(uZ,{}),m.jsx(mZ,{}),m.jsx(yZ,{}),m.jsx(vZ,{}),m.jsx(dZ,{}),m.jsx(eZ,{}),m.jsx(DX,{})]})]})]})}),aZ=Ke(function(){const t=re(),{Grid:n}=di(),{x:r,y:i,z:o}=t.camera,s=t.isGridMode;return n&&s?m.jsx(n,{x:r,y:i,z:o,size:t.gridSize}):null}),lZ=Ke(function(){const t=re(),n=t.scribble,r=t.zoomLevel,{Scribble:i}=di();return i&&n?m.jsx(i,{className:"tl-user-scribble",scribble:n,zoom:r}):null}),cZ=Ke(function(){const t=re(),{brush:n}=t,{Brush:r}=di();return r&&n&&t.isIn("select.brushing")?m.jsx(r,{className:"tl-user-brush",brush:n}):null}),uZ=Ke(function(){const t=re(),{zoomBrush:n}=t,{ZoomBrush:r}=di();return r&&n&&t.isIn("zoom")?m.jsx(r,{className:"tl-user-brush",brush:n}):null}),dZ=Ke(function(){const t=re(),{snaps:{lines:n},zoomLevel:r}=t,{SnapLine:i}=di();return i&&n.length>0?m.jsx(m.Fragment,{children:n.map(o=>m.jsx(i,{className:"tl-user-snapline",line:o,zoom:r},o.id))}):null}),hZ=48,fZ=Ke(function(){var u;const t=re(),n=t.zoomLevel,r=t.isChangingStyle,i=t.onlySelectedShape,o=t.isInAny("select.idle","select.pointing_handle")&&!r&&!t.isReadOnly;if(!(i&&o))return null;const s=t.getShapeUtil(i),a=(u=s.handles)==null?void 0:u.call(s,i);if(!a)return null;const l=t.getPageTransform(i);if(!l)return null;const c=[];for(let d=0,h=a[d];d<a.length;d++,h=a[d]){if(h.type!=="vertex"){const f=a[d-1],p=a[d+1];if(f&&p&&Math.hypot(f.y-p.y,f.x-p.x)<hZ/n)continue}c.push(h)}return c.sort(d=>d.type==="vertex"?1:-1),m.jsx("svg",{className:"tl-user-handles tl-overlays__item",children:m.jsx("g",{transform:ie.toCssString(l),children:c.map(d=>m.jsx(pZ,{shapeId:i.id,handle:d},d.id))})})}),pZ=({shapeId:e,handle:t})=>{const n=AX(e,t.id),{Handle:r}=di();return r?m.jsx("g",{"aria-label":"handle",transform:`translate(${t.x}, ${t.y})`,...n,children:m.jsx(r,{shapeId:e,handle:t})}):null},gZ=Ke(function(){const t=re(),{renderingShapes:n}=t;return nn.debugSvg.value?m.jsx(m.Fragment,{children:n.map(i=>m.jsxs(b.Fragment,{children:[m.jsx(lT,{...i}),m.jsx(SZ,{id:i.id})]},i.id+"_fragment"))}):m.jsx(m.Fragment,{children:n.map(i=>m.jsx(lT,{...i},i.id+"_shape"))})}),mZ=Ke(function(){const t=re();return t.isInAny("select.idle","select.brushing","select.scribble_brushing","select.pointing_shape","select.pointing_selection","select.pointing_handle")&&!t.isChangingStyle?m.jsx(m.Fragment,{children:t.selectedIds.map(r=>m.jsx(Py,{className:"tl-user-indicator__selected",id:r},r+"_indicator"))}):null}),yZ=function(){const t=re(),n=ye("hovered id and should display",()=>t.isInAny("select.idle","select.editing_shape")?t.pageState.hoveredId:null,[t]);return n?m.jsx(Py,{className:"tl-user-indicator__hovered",id:n}):null},vZ=Ke(function(){const t=re(),n=qg(t.hintingIds);return n.length?m.jsx(m.Fragment,{children:n.map(r=>m.jsx(Py,{className:"tl-user-indicator__hint",id:r},r+"_hinting"))}):null});function cT(){return m.jsxs("g",{id:"cursor",children:[m.jsxs("g",{fill:"rgba(0,0,0,.2)",transform:"translate(-11,-11)",children:[m.jsx("path",{d:"m12 24.4219v-16.015l11.591 11.619h-6.781l-.411.124z"}),m.jsx("path",{d:"m21.0845 25.0962-3.605 1.535-4.682-11.089 3.686-1.553z"})]}),m.jsxs("g",{fill:"white",transform:"translate(-12,-12)",children:[m.jsx("path",{d:"m12 24.4219v-16.015l11.591 11.619h-6.781l-.411.124z"}),m.jsx("path",{d:"m21.0845 25.0962-3.605 1.535-4.682-11.089 3.686-1.553z"})]}),m.jsxs("g",{fill:"currentColor",transform:"translate(-12,-12)",children:[m.jsx("path",{d:"m19.751 24.4155-1.844.774-3.1-7.374 1.841-.775z"}),m.jsx("path",{d:"m13 10.814v11.188l2.969-2.866.428-.139h4.768z"})]})]})}function xZ(){return m.jsx("path",{id:"cursor_hint",fill:"currentColor",d:"M -2,-5 2,0 -2,5 Z"})}function bZ(){return m.jsx("marker",{id:"arrowhead-dot",className:"tl-arrow-hint",refX:"3.0",refY:"3.0",orient:"0",children:m.jsx("circle",{cx:"3",cy:"3",r:"2",strokeDasharray:"100%"})})}function wZ(){return m.jsxs("marker",{id:"arrowhead-cross",className:"tl-arrow-hint",refX:"3.0",refY:"3.0",orient:"auto",children:[m.jsx("line",{x1:"1.5",y1:"1.5",x2:"4.5",y2:"4.5",strokeDasharray:"100%"}),m.jsx("line",{x1:"1.5",y1:"4.5",x2:"4.5",y2:"1.5",strokeDasharray:"100%"})]})}const SZ=Ke(function({id:t}){const n=re(),r=n.getShapeById(t),[i,o]=b.useState(""),s=(r==null?void 0:r.parentId)===n.currentPageId;return b.useEffect(()=>{if(!s)return;let a=null;const l=my("shape to svg",async()=>{const c=Math.random();a=c;const u=n.getPageBoundsById(t),d=await n.getSvg([t],{padding:0});d&&u&&a===c&&(d.style.setProperty("overflow","visible"),d.setAttribute("preserveAspectRatio","xMidYMin slice"),d.style.setProperty("transform",`translate(${u.x}px, ${u.y+u.h+12}px)`),d.style.setProperty("border","1px solid black"),o(d==null?void 0:d.outerHTML))});return()=>{a=null,l()}},[n,t,s]),s?m.jsx("div",{style:{paddingTop:12,position:"absolute"},children:m.jsx("div",{style:{display:"flex"},dangerouslySetInnerHTML:{__html:i}})}):null}),_Z=Ke(()=>{const e=nn.logMessages.value;return m.jsx("div",{className:"debug__ui-logger",children:e.map((t,n)=>{const r=typeof t=="string"?t:JSON.stringify(t);return m.jsx("div",{className:"debug__ui-logger__line",children:r},n)})})}),CZ="https://github.com/tldraw/tldraw/issues/new";function EZ(){}const R5=({error:e,editor:t})=>{const n=b.useRef(null),[r,i]=b.useState(!1),[o,s]=b.useState(!1),[a,l]=b.useState(!1),c=e instanceof Error?e.message:String(e),u=e instanceof Error?e.stack:null,d=ye("isDarkMode",()=>{try{if(t)return t.isDarkMode}catch{}return null},[t]),[h,f]=b.useState(null);b.useLayoutEffect(()=>{var S;d!==null&&f(d);let w=(S=n.current)==null?void 0:S.parentElement,_=!1;for(;w;){if(w.classList.contains("tl-theme__dark")||w.classList.contains("tl-theme__light")){_=!0;break}w=w.parentElement}if(_){f(null);return}f(window.matchMedia("(prefetl-color-scheme: dark)").matches)},[d]),b.useEffect(()=>{if(o){const w=setTimeout(()=>{s(!1)},2e3);return()=>clearTimeout(w)}},[o]);const p=()=>{const w=document.createElement("textarea");w.value=u??c,document.body.appendChild(w),w.select(),document.execCommand("copy"),w.remove(),s(!0)},g=()=>{TV()},y=async()=>{ZM()},x=new URL(CZ);return x.searchParams.set("title",c),x.searchParams.set("labels","bug"),x.searchParams.set("body",`Hey, I ran into an error while using tldraw:

\`\`\`js
${u??c}
\`\`\`

My browser: ${navigator.userAgent}`),m.jsxs("div",{ref:n,className:Me("tl-container tl-error-boundary",h===null?"":h?"tl-theme__dark":"tl-theme__light"),children:[m.jsx("div",{className:"tl-error-boundary__overlay"}),t&&m.jsx(w5,{onError:EZ,fallback:()=>null,children:m.jsx(YS.Provider,{value:t,children:m.jsx("div",{className:"tl-overlay tl-error-boundary__canvas",children:m.jsx(B5,{})})})}),m.jsx("div",{className:Me("tl-modal","tl-error-boundary__content",{"tl-error-boundary__content__expanded":r&&!a}),children:a?m.jsxs(m.Fragment,{children:[m.jsx("h2",{children:"Are you sure?"}),m.jsx("p",{children:"Resetting your data will delete your drawing and cannot be undone."}),m.jsxs("div",{className:"tl-error-boundary__content__actions",children:[m.jsx("button",{onClick:()=>l(!1),children:"Cancel"}),m.jsx("button",{className:"tl-error-boundary__reset",onClick:y,children:"Reset data"})]})]}):m.jsxs(m.Fragment,{children:[m.jsx("h2",{children:"Something's gone wrong."}),m.jsxs("p",{children:["Sorry, we encountered an error. Please refresh the page to continue. If you keep seeing this error, you can ",m.jsx("a",{href:x.toString(),children:"create a GitHub issue"})," or"," ",m.jsx("a",{href:"https://discord.gg/Cq6cPsTfNy",children:"ask for help on Discord"}),"."]}),r&&m.jsxs("div",{className:"tl-error-boundary__content__error",children:[m.jsx("pre",{children:m.jsx("code",{children:u??c})}),m.jsx("button",{onClick:p,children:o?"Copied!":"Copy"})]}),m.jsxs("div",{className:"tl-error-boundary__content__actions",children:[m.jsx("button",{onClick:()=>i(!r),children:r?"Hide details":"Show details"}),m.jsxs("div",{className:"tl-error-boundary__content__actions__group",children:[m.jsx("button",{className:"tl-error-boundary__reset",onClick:()=>l(!0),children:"Reset data"}),m.jsx("button",{className:"tl-error-boundary__refresh",onClick:g,children:"Refresh Page"})]})]})]})})]})};var D5={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function i(l,c,u){this.fn=l,this.context=c,this.once=u||!1}function o(l,c,u,d,h){if(typeof u!="function")throw new TypeError("The listener must be a function");var f=new i(u,d||l,h),p=n?n+c:c;return l._events[p]?l._events[p].fn?l._events[p]=[l._events[p],f]:l._events[p].push(f):(l._events[p]=f,l._eventsCount++),l}function s(l,c){--l._eventsCount===0?l._events=new r:delete l._events[c]}function a(){this._events=new r,this._eventsCount=0}a.prototype.eventNames=function(){var c=[],u,d;if(this._eventsCount===0)return c;for(d in u=this._events)t.call(u,d)&&c.push(n?d.slice(1):d);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(u)):c},a.prototype.listeners=function(c){var u=n?n+c:c,d=this._events[u];if(!d)return[];if(d.fn)return[d.fn];for(var h=0,f=d.length,p=new Array(f);h<f;h++)p[h]=d[h].fn;return p},a.prototype.listenerCount=function(c){var u=n?n+c:c,d=this._events[u];return d?d.fn?1:d.length:0},a.prototype.emit=function(c,u,d,h,f,p){var g=n?n+c:c;if(!this._events[g])return!1;var y=this._events[g],x=arguments.length,w,_;if(y.fn){switch(y.once&&this.removeListener(c,y.fn,void 0,!0),x){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,u),!0;case 3:return y.fn.call(y.context,u,d),!0;case 4:return y.fn.call(y.context,u,d,h),!0;case 5:return y.fn.call(y.context,u,d,h,f),!0;case 6:return y.fn.call(y.context,u,d,h,f,p),!0}for(_=1,w=new Array(x-1);_<x;_++)w[_-1]=arguments[_];y.fn.apply(y.context,w)}else{var S=y.length,T;for(_=0;_<S;_++)switch(y[_].once&&this.removeListener(c,y[_].fn,void 0,!0),x){case 1:y[_].fn.call(y[_].context);break;case 2:y[_].fn.call(y[_].context,u);break;case 3:y[_].fn.call(y[_].context,u,d);break;case 4:y[_].fn.call(y[_].context,u,d,h);break;default:if(!w)for(T=1,w=new Array(x-1);T<x;T++)w[T-1]=arguments[T];y[_].fn.apply(y[_].context,w)}}return!0},a.prototype.on=function(c,u,d){return o(this,c,u,d,!1)},a.prototype.once=function(c,u,d){return o(this,c,u,d,!0)},a.prototype.removeListener=function(c,u,d,h){var f=n?n+c:c;if(!this._events[f])return this;if(!u)return s(this,f),this;var p=this._events[f];if(p.fn)p.fn===u&&(!h||p.once)&&(!d||p.context===d)&&s(this,f);else{for(var g=0,y=[],x=p.length;g<x;g++)(p[g].fn!==u||h&&!p[g].once||d&&p[g].context!==d)&&y.push(p[g]);y.length?this._events[f]=y.length===1?y[0]:y:s(this,f)}return this},a.prototype.removeAllListeners=function(c){var u;return c?(u=n?n+c:c,this._events[u]&&s(this,u)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,e.exports=a})(D5);var kZ=D5.exports;function At(){return $h()}function TZ(e,t){var i;let n=e;const r=new Set(t);for(;r.has(n);)n=(i=/^.*(\d+)$/.exec(n))!=null&&i[1]?n.replace(/(\d+)(?=\D?)$/,o=>(+o+1).toString()):`${n} 1`;return n}const F5="TLDRAW_USER_DATA_v3",N5=Ne({id:We,name:We,locale:We,color:We,isDarkMode:ot,animationSpeed:Be,isSnapMode:ot}),Ov={AddAnimationSpeed:1,AddIsSnapMode:2},um=Qe({currentVersion:Ov.AddIsSnapMode,migrators:{[Ov.AddAnimationSpeed]:{up:e=>({...e,animationSpeed:1}),down:({animationSpeed:e,...t})=>t},[Ov.AddIsSnapMode]:{up:e=>({...e,isSnapMode:!1}),down:({isSnapMode:e,...t})=>t}}}),uT=["#FF802B","#EC5E41","#F2555A","#F04F88","#E34BA9","#BD54C6","#9D5BD2","#7B66DC","#02B1CC","#11B3A3","#39B178","#55B467"];function PZ(){return uT[Math.floor(Math.random()*uT.length)]}function Kf(){return{id:At(),locale:typeof window<"u"?bV():"en",name:"New User",color:PZ(),isDarkMode:!1,animationSpeed:1,isSnapMode:!1}}function j5(e){if(e===null||typeof e!="object"||!("version"in e)||!("user"in e)||typeof e.version!="number")return Kf();const t=DS({value:e.user,fromVersion:e.version,toVersion:um.currentVersion??0,migrations:um});if(t.type==="error")return Kf();try{N5.validate(t.value)}catch{return Kf()}return t.value}function IZ(){var t;const e=typeof window>"u"?null:JSON.parse(((t=window==null?void 0:window.localStorage)==null?void 0:t.getItem(F5))||"null")??null;return j5(e)}const Fh=jt("globalUserData",IZ());function $Z(){typeof window<"u"&&window.localStorage&&window.localStorage.setItem(F5,JSON.stringify({version:um.currentVersion,user:Fh.value}))}function AZ(e){N5.validate(e),Fh.set(e),$Z(),OZ()}const MZ=typeof process<"u"&&!1,gc=typeof BroadcastChannel<"u"&&!MZ?new BroadcastChannel("tldraw-user-sync"):null;gc==null||gc.addEventListener("message",e=>{const t=e.data;(t==null?void 0:t.type)===U5&&(t==null?void 0:t.origin)!==z5&&Fh.set(j5(t.data))});const z5=At(),U5="tldraw-user-preferences-change";function OZ(){gc==null||gc.postMessage({type:U5,origin:z5,data:{user:Fh.value,version:um.currentVersion}})}function LZ(){return Fh.value}function BZ(e={}){return{derivePresenceState:e.derivePresenceState??(()=>ce("presence",()=>null)),userPreferences:e.userPreferences??ce("userPreferences",()=>LZ()),setUserPreferences:e.setUserPreferences??AZ}}function kr({children:e,className:t="",...n}){return m.jsx("svg",{...n,className:`tl-svg-container ${t}`,children:e})}class Zc{constructor(){v(this,"items",new WeakMap)}get(t,n){return this.items.has(t)||this.items.set(t,n(t)),this.items.get(t)}access(t){return this.items.get(t)}set(t,n){this.items.set(t,n)}has(t){return this.items.has(t)}invalidate(t){this.items.delete(t)}bust(){this.items=new WeakMap}}var RZ=Object.defineProperty,DZ=Object.getOwnPropertyDescriptor,d_=(e,t,n,r)=>{for(var i=r>1?void 0:r?DZ(t,n):t,o=e.length-1,s;o>=0;o--)(s=e[o])&&(i=(r?s(t,n,i):s(i))||i);return r&&i&&RZ(t,n,i),i};const FZ=new Zc,NZ=new Zc;class hi{constructor(t,n){v(this,"canScroll",()=>!1);v(this,"canUnmount",()=>!0);v(this,"canBind",(t,n)=>!0);v(this,"canEdit",()=>!1);v(this,"canResize",()=>!0);v(this,"canCrop",()=>!1);v(this,"getEditingBounds",t=>this.bounds(t));v(this,"isClosed",()=>!0);v(this,"hideResizeHandles",()=>!1);v(this,"hideRotateHandle",()=>!1);v(this,"hideSelectionBoundsBg",()=>!1);v(this,"hideSelectionBoundsFg",()=>!1);v(this,"isAspectRatioLocked",()=>!1);v(this,"onBeforeCreate");v(this,"onBeforeUpdate");v(this,"onDragShapesOver");v(this,"onDragShapesOut");v(this,"onDropShapesOver");v(this,"onResizeStart");v(this,"onResize");v(this,"onResizeEnd");v(this,"onTranslateStart");v(this,"onTranslate");v(this,"onTranslateEnd");v(this,"onRotateStart");v(this,"onRotate");v(this,"onRotateEnd");v(this,"onHandleChange");v(this,"onBindingChange");v(this,"onChildrenChange");v(this,"onDoubleClickHandle");v(this,"onDoubleClickEdge");v(this,"onDoubleClick");v(this,"onClick");v(this,"onEditEnd");this.editor=t,this.type=n}get handlesCache(){return this.editor.store.createComputedCache("handles:"+this.type,t=>this.getHandles(t))}handles(t){return this.getHandles?this.handlesCache.get(t.id)??ri:ri}get boundsCache(){return this.editor.store.createComputedCache("bounds:"+this.type,t=>this.getBounds(t))}bounds(t){const n=this.boundsCache.get(t.id)??new me;return n.width===0||n.height===0?new me(n.x,n.y,Math.max(n.width,1),Math.max(n.height,1)):n}transform(t){return NZ.get(t,n=>ie.Compose(ie.Translate(n.x,n.y),ie.Rotate(n.rotation)))}point(t){return FZ.get(t,n=>({x:n.x,y:n.y}))}get outlineCache(){return this.editor.store.createComputedCache("outline:"+this.type,t=>this.getOutline(t))}outline(t){return this.outlineCache.get(t.id)??ri}snapPoints(t){return this.bounds(t).snapPoints}center(t){return this.getCenter(t)}canReceiveNewChildrenOfType(t,n){return!1}canDropShapes(t,n){return!1}hitTestPoint(t,n){return this.bounds(t).containsPoint(n)}hitTestLineSegment(t,n,r){const i=this.outline(t);for(let o=0;o<i.length;o++){const s=i[o],a=i[(o+1)%i.length];if(to(n,r,s,a))return!0}return!1}expandSelectionOutlinePx(t){return 0}providesBackgroundForChildren(t){return!1}}v(hi,"type");d_([ce],hi.prototype,"handlesCache",1);d_([ce],hi.prototype,"boundsCache",1);d_([ce],hi.prototype,"outlineCache",1);function W5(e,t){return e.match(/^\s*$/)?t:e}function jZ(e){return e.replace(/\s/g," ")}function Iy(e,t,n){const{padding:r=0}=n,i=document.createElementNS("http://www.w3.org/2000/svg","text");if(i.setAttribute("font-size",n.fontSize+"px"),i.setAttribute("font-family",n.fontFamily),i.setAttribute("font-style",n.fontStyle),i.setAttribute("font-weight",n.fontWeight),i.setAttribute("line-height",n.lineHeight*n.fontSize+"px"),i.setAttribute("dominant-baseline","mathematical"),i.setAttribute("alignment-baseline","mathematical"),t.length===0)return i;const o=me.From(t[0].box);for(const{box:c}of t)o.union(c);const s=r+(n.offsetX??0),a=(n.offsetY??0)+n.fontSize/2+(n.verticalTextAlign==="start"?r:n.verticalTextAlign==="end"?n.height-r-o.height:(Math.ceil(n.height)-o.height)/2);let l=null;for(const{text:c,box:u}of t){if(l!==null&&u.y>l){const p=document.createElementNS("http://www.w3.org/2000/svg","tspan");p.setAttribute("alignment-baseline","mathematical"),p.setAttribute("x",s+"px"),p.setAttribute("y",u.y+a+"px"),p.textContent=`
`,i.appendChild(p)}const h=document.createElementNS("http://www.w3.org/2000/svg","tspan");h.setAttribute("alignment-baseline","mathematical"),h.setAttribute("x",u.x+s+"px"),h.setAttribute("y",u.y+a+"px");const f=jZ(c);h.textContent=f,i.appendChild(h),l=u.y}return n.stroke&&n.strokeWidth&&(i.setAttribute("stroke",n.stroke),i.setAttribute("stroke-width",n.strokeWidth+"px")),n.fill&&i.setAttribute("fill",n.fill),i}function Gn(e,t,n={}){const{closed:r=!1,snap:i=1,start:o="outset",end:s="outset",lengthRatio:a=2,style:l="dashed"}=n;let c=0,u=0,d=1,h=0,f=0;switch(l){case"dashed":{d=1,c=Math.min(t*a,e/4);break}case"dotted":{d=100,c=t/d;break}default:return{strokeDasharray:"none",strokeDashoffset:"none"}}return r||(o==="outset"?(e+=c/2,f+=c/2):o==="skip"&&(e-=c,f-=c),s==="outset"?e+=c/2:s==="skip"&&(e-=c)),u=Math.floor(e/c/(2*d)),u-=u%i,u<3&&l==="dashed"?e/t<5?(c=e,u=1,h=0):(c=e*.333,h=e*.333):(u=Math.max(u,3),c=e/u/(2*d),r?(f=c/2,h=(e-u*c)/u):h=(e-u*c)/Math.max(1,u-1)),{strokeDasharray:[c,h].join(" "),strokeDashoffset:f.toString()}}const an=b.memo(function({d:t,color:n,fill:r}){switch(r){case"none":return m.jsx("path",{className:"tl-hitarea-stroke",fill:"none",d:t});case"solid":return m.jsx("path",{className:"tl-hitarea-fill-solid",fill:`var(--palette-${n}-semi)`,d:t});case"semi":return m.jsx("path",{className:"tl-hitarea-fill-solid",fill:"var(--palette-solid)",d:t});case"pattern":return m.jsx(zZ,{color:n,fill:r,d:t})}}),zZ=function({d:t,color:n}){const r=re(),i=ye("zoomLevel",()=>r.zoomLevel,[r]),o=ye("isDarkMode",()=>r.isDarkMode,[r]),s=Math.ceil(i),a=r.zoomLevel<=.18;return m.jsxs(m.Fragment,{children:[m.jsx("path",{className:"tl-hitarea-fill-solid",fill:`var(--palette-${n}-pattern)`,d:t}),m.jsx("path",{fill:a?`var(--palette-${n}-semi)`:`url(#${om[s+(o?"_dark":"_light")]})`,d:t})]})};function ao({d:e,color:t,fill:n,colors:r}){if(n==="none")return;if(n==="pattern"){const o=document.createElementNS("http://www.w3.org/2000/svg","g"),s=document.createElementNS("http://www.w3.org/2000/svg","path");s.setAttribute("d",e),s.setAttribute("fill",r.pattern[t]);const a=document.createElementNS("http://www.w3.org/2000/svg","path");return a.setAttribute("d",e),a.setAttribute("fill","url(#hash_pattern)"),o.appendChild(s),o.appendChild(a),o}const i=document.createElementNS("http://www.w3.org/2000/svg","path");switch(i.setAttribute("d",e),n){case"semi":{i.setAttribute("fill",r.solid);break}case"solid":{i.setAttribute("fill",r.semi[t]);break}}return i}function ua(e,t){if(t){const n=document.createElementNS("http://www.w3.org/2000/svg","g");return n.appendChild(t),n.appendChild(e),n}else return e}function UZ(e,t,n){const r=t==="end"?e.end.point:e.start.point,i=t==="end"?e.start.point:e.end.point,o=e.isStraight?E.Dist(i,r):Math.abs(e.bodyArc.length),s=Math.max(Math.min(o/5,n*3),n);let a;if(e.isStraight)a=E.Nudge(r,i,s);else{const l=VV(r,s,e.handleArc.center,e.handleArc.radius);a=t==="end"?e.handleArc.sweepFlag?l[0]:l[1]:e.handleArc.sweepFlag?l[1]:l[0]}return{point:r,int:a}}function WZ({point:e,int:t}){const n=E.RotWith(t,e,Et/6),r=E.RotWith(t,e,-Et/6);return`M ${n.x} ${n.y} L ${e.x} ${e.y} L ${r.x} ${r.y}`}function HZ({point:e,int:t}){const n=E.RotWith(t,e,Et/6),r=E.RotWith(t,e,-Et/6);return`M ${n.x} ${n.y} L ${e.x} ${e.y} L ${r.x} ${r.y} Z`}function KZ({point:e,int:t}){const n=E.Sub(t,e).div(2),r=E.Add(e,E.Rot(n,tt)),i=E.Sub(e,E.Rot(n,tt));return`M ${r.x} ${r.y} L ${t.x} ${t.y} L ${i.x} ${i.y} Z`}function VZ({point:e,int:t}){const n=E.Lrp(e,t,.45),r=E.Dist(n,e);return`M ${n.x-r},${n.y}
  a ${r},${r} 0 1,0 ${r*2},0
  a ${r},${r} 0 1,0 -${r*2},0 `}function YZ({point:e,int:t}){const n=E.Lrp(e,t,.75),r=E.RotWith(n,e,Et/4),i=E.RotWith(n,e,-Et/4),o=E.Lrp(r,i,.5);return o.add(E.Sub(o,e)),`M ${o.x} ${o.y} L ${r.x} ${r.y} ${e.x} ${e.y} L ${i.x} ${i.y} Z`}function qZ({int:e,point:t}){const n=E.Lrp(t,e,.85),r=E.Sub(n,t).div(2),i=E.Add(t,E.Rot(r,tt)),o=E.Sub(t,E.Rot(r,tt)),s=E.Add(n,E.Rot(r,tt)),a=E.Sub(n,E.Rot(r,tt));return`M ${i.x} ${i.y} L ${s.x} ${s.y} L ${a.x} ${a.y} L ${o.x} ${o.y} Z`}function GZ({int:e,point:t}){const n=E.Sub(e,t).div(2),r=E.Add(t,E.Rot(n,tt)),i=E.Sub(t,E.Rot(n,tt));return`M ${r.x} ${r.y} L ${i.x} ${i.y}`}function Ml(e,t,n){const r=t==="end"?e.end.arrowhead:e.start.arrowhead;if(r==="none")return;const i=UZ(e,t,n);if(i){switch(r){case"bar":return GZ(i);case"square":return qZ(i);case"diamond":return YZ(i);case"dot":return VZ(i);case"inverted":return KZ(i);case"arrow":return WZ(i);case"triangle":return HZ(i)}return""}}function Gu(e){return Math.abs(e.props.bend)<8}function dm(e,t){if(t.type==="point")return;const n=e.getShapeById(t.boundShapeId),r=e.getShapeUtil(n),i=e.getPageTransform(n);return{shape:n,util:r,transform:i,isExact:t.isExact,didIntersect:!1}}function dT(e,t,n){if(n.type==="point")return E.From(n);const r=e.getShapeById(n.boundShapeId);if(r){const{point:i,size:o}=e.getBounds(r),s=E.Add(i,E.MulV(n.normalizedAnchor,o)),a=ie.applyToPoint(e.getPageTransform(r),s);return ie.applyToPoint(ie.Inverse(t),a)}else return console.error("Expected a bound shape!"),new E(0,0)}function Ei(e,t){const n=e.getPageTransform(t),r=dT(e,n,t.props.start),i=dT(e,n,t.props.end);return{start:r,end:i}}function Gd(e,t){const{start:n,end:r,arrowheadStart:i,arrowheadEnd:o}=t.props,s=Ei(e,t),a=s.start.clone(),l=s.end.clone(),c=E.Med(a,l),u=E.Sub(l,a).uni(),d=dm(e,n),h=dm(e,r),f=e.getPageTransform(t);hT(l,s.start,f,h),hT(a,s.end,f,d);let p=Ma;const g=d&&h&&d.shape===h.shape;d&&h&&!g&&!d.isExact&&!h.isExact&&(h.didIntersect&&!d.didIntersect?d.util.isClosed(d.shape)&&a.setTo(E.Nudge(l,a,p)):h.didIntersect||h.util.isClosed(h.shape)&&l.setTo(E.Nudge(a,l,p)));const y=E.Sub(l,a).uni(),x=!E.Equals(y,u);if(!g){if(d&&i!=="none"&&!d.isExact){const _=sm+e.getStrokeWidth(t.props.size)/2+("size"in d.shape.props?e.getStrokeWidth(d.shape.props.size)/2:0);p-=_,a.nudge(l,_*(x?-1:1))}if(h&&o!=="none"&&!h.isExact){const _=sm+e.getStrokeWidth(t.props.size)/2+("size"in h.shape.props?e.getStrokeWidth(h.shape.props.size)/2:0);p-=_,l.nudge(a,_*(x?-1:1))}}d&&h&&(x?l.setTo(E.Add(a,y.mul(-p))):E.Dist(a,l)<Ma/2&&l.setTo(E.Add(a,y.mul(Ma/2)))),x?c.setTo(E.Med(s.start,s.end)):c.setTo(E.Med(a,l));const w=E.Dist(a,l);return{isStraight:!0,start:{handle:s.start,point:a,arrowhead:t.props.arrowheadStart},end:{handle:s.end,point:l,arrowhead:t.props.arrowheadEnd},middle:c,isValid:w>0,length:w}}function hT(e,t,n,r){if(r===void 0||r.isExact)return;const i=ie.applyToPoint(n,t),o=ie.applyToPoint(n,e),s=ie.applyToPoint(ie.Inverse(r.transform),i),a=ie.applyToPoint(ie.Inverse(r.transform),o),l=r.util.isClosed(r.shape),u=(l?KV:JS)(s,a,r.util.outline(r.shape));let d;if(u!==null&&(d=u.sort((p,g)=>E.Dist(p,s)-E.Dist(g,s))[0]??(l?void 0:a)),d===void 0)return;const h=ie.applyToPoint(r.transform,d),f=ie.applyToPoint(ie.Inverse(n),h);e.setTo(f),r.didIntersect=!0}function XZ(e){return H5(e.start.handle,e.end.handle)}function Lv(e){return H5(e.start.point,e.end.point)}function H5(e,t){return`M${e.x},${e.y}L${t.x},${t.y}`}function bb(e,t,n=0){const{arrowheadEnd:r,arrowheadStart:i}=t.props,o=t.props.bend+n;if(Math.abs(o)>Math.abs(t.props.bend*iq))return Gd(e,t);const s=Ei(e,t),a=E.Med(s.start,s.end),l=E.Sub(s.end,s.start).uni(),c=E.Add(a,l.per().mul(-o)),u=dm(e,t.props.start),d=dm(e,t.props.end),h=s.start.clone(),f=s.end.clone(),p=c.clone(),g=fT(h,f,p);if(g.length===0||g.size===0||!$k(g.length)||!$k(g.size))return Gd(e,t);const y=e.getPageTransform(t);if(u&&!u.isExact){const T=ie.applyToPoint(y,h),P=ie.applyToPoint(y,f),I=ie.applyToPoint(y,g.center),$=ie.Inverse(u.transform),L=ie.applyToPoint($,T),R=ie.applyToPoint($,P),K=ie.applyToPoint($,I),Q=u.util.isClosed(u.shape),j=Q?Ak:Mk;let B,z=j(K,g.radius,u.util.outline(u.shape));if(z){z=z.filter(F=>+E.Clockwise(L,F,R)===g.sweepFlag);const q=E.Angle(g.center,c),U=E.Angle(g.center,s.start),D=ya(q,U,.5);z.sort((F,J)=>Math.abs(Ps(D,K.angle(F)))-Math.abs(Ps(D,K.angle(J)))),B=z[0]??(Q?void 0:L)}else B=Q?void 0:L;if(B&&(h.setTo(e.getPointInShapeSpace(t,ie.applyToPoint(u.transform,B))),u.didIntersect=!0,i!=="none")){const q=sm+e.getStrokeWidth(t.props.size)/2+("size"in u.shape.props?e.getStrokeWidth(u.shape.props.size)/2:0);h.setTo(Sa(g.center.x,g.center.y,g.radius,ya(E.Angle(g.center,h),E.Angle(g.center,c),q/Math.abs(zf(g.center,g.radius,h,c)))))}}if(d&&!d.isExact){const T=ie.applyToPoint(y,h),P=ie.applyToPoint(y,f),I=ie.applyToPoint(y,g.center),$=ie.Inverse(d.transform),L=ie.applyToPoint($,T),R=ie.applyToPoint($,P),K=ie.applyToPoint($,I),Q=d.util.isClosed(d.shape),j=Q?Ak:Mk,B=E.Angle(g.center,c),z=E.Angle(g.center,s.end),q=ya(B,z,.5);let U,D=j(K,g.radius,d.util.outline(d.shape));if(D?(D=D.filter(F=>+E.Clockwise(L,F,R)===g.sweepFlag),D.sort((F,J)=>Math.abs(Ps(q,K.angle(F)))-Math.abs(Ps(q,K.angle(J)))),U=D[0]??(Q?void 0:R)):U=Q?void 0:R,U&&(f.setTo(e.getPointInShapeSpace(t,ie.applyToPoint(d.transform,U))),d.didIntersect=!0,r!=="none")){let F=sm+e.getStrokeWidth(t.props.size)/2+("size"in d.shape.props?e.getStrokeWidth(d.shape.props.size)/2:0);E.Dist(h,f)<Ma&&(F*=-2),f.setTo(Sa(g.center.x,g.center.y,g.radius,ya(E.Angle(g.center,f),E.Angle(g.center,c),F/Math.abs(zf(g.center,g.radius,f,c)))))}}if(Math.abs(zf(g.center,g.radius,h,f))<Ma/2&&(h.setTo(s.start),f.setTo(s.end)),u&&d&&u.shape!==d.shape&&!u.isExact&&!d.isExact){const T=E.Angle(g.center,h),P=E.Angle(g.center,f),I=g.sweepFlag?Ma:-Ma,$=zf(g.center,g.radius,f,h),{center:{x:L,y:R},radius:K}=g;u&&!u.didIntersect&&h.setTo(Sa(L,R,K,ya(T,P,I/$))),d&&!d.didIntersect&&f.setTo(Sa(L,R,K,ya(T,P,-I/$)))}let w=ya(E.Angle(g.center,h),E.Angle(g.center,f),.5),_=Sa(g.center.x,g.center.y,g.radius,w);+E.Clockwise(h,_,f)!==g.sweepFlag&&(w+=Et,_=Sa(g.center.x,g.center.y,g.radius,w)),p.setTo(_);const S=fT(h,f,p);return{isStraight:!1,start:{point:h,handle:s.start,arrowhead:t.props.arrowheadStart},end:{point:f,handle:s.end,arrowhead:t.props.arrowheadEnd},middle:p,handleArc:g,bodyArc:S,isValid:S.length!==0&&isFinite(S.center.x)&&isFinite(S.center.y)}}function ZZ(e){const{start:t,end:n,handleArc:{radius:r,largeArcFlag:i,sweepFlag:o}}=e;return`M${t.handle.x},${t.handle.y} A${r} ${r} 0 ${i} ${o} ${n.handle.x},${n.handle.y}`}function Bv(e){const{start:t,end:n,bodyArc:{radius:r,largeArcFlag:i,sweepFlag:o}}=e;return`M${t.point.x},${t.point.y} A${r} ${r} 0 ${i} ${o} ${n.point.x},${n.point.y}`}function fT(e,t,n){const r=-2*(e.x*(t.y-n.y)-e.y*(t.x-n.x)+t.x*n.y-n.x*t.y),i={x:((e.x*e.x+e.y*e.y)*(n.y-t.y)+(t.x*t.x+t.y*t.y)*(e.y-n.y)+(n.x*n.x+n.y*n.y)*(t.y-e.y))/r,y:((e.x*e.x+e.y*e.y)*(t.x-n.x)+(t.x*t.x+t.y*t.y)*(n.x-e.x)+(n.x*n.x+n.y*n.y)*(e.x-t.x))/r},o=E.Dist(i,e),s=+E.Clockwise(e,n,t),a=Math.hypot(e.y-t.y,e.x-t.x),l=Math.hypot(t.y-n.y,t.x-n.x),c=Math.hypot(n.y-e.y,n.x-e.x),u=Math.acos((l*l+c*c-a*a)/(2*l*c))*2,d=+(Et>u),h=(kt-u)*(s?1:-1),f=h*o;return{center:i,radius:o,size:h,length:f,largeArcFlag:d,sweepFlag:s}}const nc="  ",Wn=class Wn{static insertTextFirefox(t,n){t.setRangeText(n,t.selectionStart||0,t.selectionEnd||0,"end"),t.dispatchEvent(new InputEvent("input",{data:n,inputType:"insertText",isComposing:!1}))}static insert(t,n){const r=t.ownerDocument,i=r.activeElement;i!==t&&t.focus(),r.execCommand("insertText",!1,n)||Wn.insertTextFirefox(t,n),i===r.body?t.blur():i instanceof HTMLElement&&i!==t&&i.focus()}static set(t,n){t.select(),Wn.insert(t,n)}static getSelection(t){const{selectionStart:n,selectionEnd:r}=t;return t.value.slice(n||void 0,r||void 0)}static wrapSelection(t,n,r){const{selectionStart:i,selectionEnd:o}=t,s=Wn.getSelection(t);Wn.insert(t,n+s+(r??n)),t.selectionStart=(i||0)+n.length,t.selectionEnd=(o||0)+n.length}static replace(t,n,r){let i=0;t.value.replace(n,(...o)=>{const s=i+o[o.length-2],a=o[0].length;t.selectionStart=s,t.selectionEnd=s+a;const l=typeof r=="string"?r:r(...o);return Wn.insert(t,l),t.selectionStart=s,i+=l.length-a,l})}static findLineEnd(t,n){const r=t.lastIndexOf(`
`,n-1)+1;return t.charAt(r)!=="	"?n:r+1}static indent(t){var a;const{selectionStart:n,selectionEnd:r,value:i}=t,o=i.slice(n,r),s=(a=/\n/g.exec(o))==null?void 0:a.length;if(s&&s>0){const l=i.lastIndexOf(`
`,n-1)+1,c=t.value.slice(l,r-1),u=c.replace(/^|\n/g,`$&${nc}`),d=u.length-c.length;t.setSelectionRange(l,r-1),Wn.insert(t,u),t.setSelectionRange(n+1,r+d)}else Wn.insert(t,nc)}static unindent(t){const{selectionStart:n,selectionEnd:r,value:i}=t,o=i.lastIndexOf(`
`,n-1)+1,s=Wn.findLineEnd(i,r),a=t.value.slice(o,s),l=a.replace(/(^|\n)(\t| {1,2})/g,"$1"),c=a.length-l.length;t.setSelectionRange(o,s),Wn.insert(t,l);const u=/\t| {1,2}/.exec(i.slice(o,n)),d=u?u[0].length:0,h=n-d;t.setSelectionRange(n-d,Math.max(h,r-c))}static indentCE(t){var l;const n=window.getSelection(),r=t.innerText,i=Vf(t)??0,o=Vf(t)??0,s=r.slice(i,o),a=(l=/\n/g.exec(s))==null?void 0:l.length;if(a&&a>0){const c=r.lastIndexOf(`
`,i-1)+1,u=r.slice(c,o-1),h=u.replace(/^|\n/g,`$&${nc}`).length-u.length;n&&n.setBaseAndExtent(t,i+1,t,o+h)}else{const c=window.getSelection();t.innerText=r.slice(0,i)+nc+r.slice(i),c==null||c.setBaseAndExtent(t,i+1,t,i+2)}}static unindentCE(t){const n=window.getSelection(),r=t.innerText,i=Vf(t)??0,o=Vf(t)??0,s=r.lastIndexOf(`
`,i-1)+1,a=Wn.findLineEnd(r,o),l=r.slice(s,a),c=l.replace(/(^|\n)(\t| {1,2})/g,"$1"),u=l.length-c.length;if(n){n.setBaseAndExtent(t,s,t,a);const d=/\t| {1,2}/.exec(r.slice(s,i)),h=d?d[0].length:0,f=i-h;n.setBaseAndExtent(t,i-h,t,Math.max(f,o-u))}}static normalizeText(t){return t.replace(Wn.fixNewLines,`
`)}static normalizeTextForDom(t){return t.replace(Wn.fixNewLines,`
`).split(`
`).map(n=>n||" ").join(`
`)}};v(Wn,"fixNewLines",/\r?\n|\r/g);let Us=Wn;function Vf(e){if(typeof window.getSelection>"u")return;const t=window.getSelection();if(!t)return;let n=0;if(t.rangeCount!==0){const r=t.getRangeAt(0),i=r.cloneRange();i.selectNodeContents(e),i.setEnd(r.endContainer,r.endOffset),n=i.toString().length}return n}function h_(e,t,n){const r=re(),i=b.useRef(null),o=ye("isEditing",()=>r.pageState.editingId===e,[r,e]),s=b.useRef(!1),a=b.useRef(),l=ye("is editable hovering",()=>{if(t==="text"&&r.isIn("text")&&r.hoveredId===e)return!0;if(r.isIn("select.editing_shape")){const{editingShape:p}=r;return p?r.hoveredId===e&&p.type===t&&r.getShapeUtil(p).canEdit(p):!1}return!1},[t,e]),c=b.useCallback(()=>{l||requestAnimationFrame(()=>{const p=i.current;if(!p)return;const g=r.getShapeById(e);g&&(p.value=g.props.text,p.value.length&&!s.current&&p.select(),s.current=!1)})},[r,e,l]),u=b.useCallback(()=>{const p=a.current;requestAnimationFrame(()=>{var y;const g=i.current;if(r.isIn("select.editing_shape")&&g)if(p)if(!p.length)g.focus();else{s.current=!0,g.focus();const x=window.getSelection();x&&p.forEach(w=>x.addRange(w))}else g.focus();else(y=window.getSelection())==null||y.removeAllRanges(),r.complete()})},[r]),d=b.useCallback(p=>{switch((p.ctrlKey||p.metaKey)&&Qi(p),p.key){case"Enter":{(p.ctrlKey||p.metaKey)&&r.complete();break}case"Tab":{Xe(p),p.shiftKey?Us.unindent(p.currentTarget):Us.indent(p.currentTarget);break}}},[r]),h=b.useCallback(p=>{let g=Us.normalizeText(p.currentTarget.value);const y=g.replace(/\t/g,nc);if(y!==g){const x=p.currentTarget.selectionStart;p.currentTarget.value=y,p.currentTarget.selectionStart=x+(y.length-g.length),p.currentTarget.selectionEnd=x+(y.length-g.length),g=y}r.updateShapes([{id:e,type:t,props:{text:g}}])},[r,e,t]),f=n.trim().length===0;return b.useEffect(()=>{if(i.current){let g=function(){var x,w;const y=(x=window.getSelection)==null?void 0:x.call(window);if(y&&y.type!=="None"){const _=[];if(y)for(let S=0;S<y.rangeCount;S++)_.push((w=y.getRangeAt)==null?void 0:w.call(y,S));a.current=_}};return document.addEventListener("selectionchange",g),()=>{document.removeEventListener("selectionchange",g)}}}),{rInput:i,isEditing:o,isEditableFromHover:l,handleFocus:c,handleBlur:u,handleKeyDown:d,handleChange:h,isEmpty:f}}const QZ=b.memo(function({id:t,text:n,size:r,font:i,position:o,width:s,labelColor:a}){const{rInput:l,isEditing:c,handleFocus:u,handleBlur:d,handleKeyDown:h,handleChange:f,isEmpty:p}=h_(t,"arrow",n);return!c&&p?null:m.jsx("div",{className:"tl-arrow-label","data-font":i,"data-align":"center","data-hastext":!p,"data-isediting":c,style:{textAlign:"center",fontSize:bs[r],lineHeight:bs[r]*yn.lineHeight+"px",transform:`translate(${o.x}px, ${o.y}px)`,color:a},children:m.jsxs("div",{className:"tl-arrow-label__inner",children:[m.jsx("p",{style:{width:s||"9px"},children:n?Us.normalizeTextForDom(n):" "}),c&&m.jsx("textarea",{ref:l,className:"tl-text tl-text-input",name:"text",tabIndex:-1,autoComplete:"false",autoCapitalize:"false",autoCorrect:"false",autoSave:"false",autoFocus:!0,placeholder:"",spellCheck:"true",wrap:"off",dir:"auto",datatype:"wysiwyg",defaultValue:n,onFocus:u,onChange:f,onKeyDown:h,onBlur:d,onContextMenu:Qi})]})})});var JZ=Object.defineProperty,eQ=Object.getOwnPropertyDescriptor,K5=(e,t,n,r)=>{for(var i=r>1?void 0:r?eQ(t,n):t,o=e.length-1,s;o>=0;o--)(s=e[o])&&(i=(r?s(t,n,i):s(i))||i);return r&&i&&JZ(t,n,i),i};let tQ=0;class Qt extends hi{constructor(){super(...arguments);v(this,"canEdit",()=>!0);v(this,"canBind",()=>!1);v(this,"isClosed",()=>!1);v(this,"hideResizeHandles",()=>!0);v(this,"hideRotateHandle",()=>!0);v(this,"hideSelectionBoundsFg",()=>!0);v(this,"hideSelectionBoundsBg",()=>!0);v(this,"onHandleChange",(n,{handle:r,isPrecise:i})=>{const o=pr(n);switch(r.id){case"start":case"end":{const s=this.editor.getPageTransformById(o.id),a=ie.applyToPoint(s,r);if(this.editor.inputs.ctrlKey)o.props[r.id]={type:"point",x:r.x,y:r.y};else{const l=Kn(this.editor.sortedShapesArray.filter(c=>{if(c.id===n.id)return;const u=this.editor.getShapeUtil(c);if(!u.canBind(c))return;const d=this.editor.getPageMaskById(c.id);if(d&&!ai(a,d))return;const h=this.editor.getPointInShapeSpace(c,a);return u.isClosed(c)?ai(h,u.outline(c)):u.hitTestPoint(c,h)}));if(l){const c=this.editor.getBounds(l),u=this.editor.getPointInShapeSpace(l,a),d=o.props[r.id],h=n.props.start.type==="binding"&&n.props.start.boundShapeId,f=n.props.end.type==="binding"&&n.props.end.boundShapeId;let p=i||(h||f)&&h===f||!this.editor.getShapeUtil(l).isClosed(o);(d.type==="point"||d.type==="binding"&&l.id!==d.boundShapeId)&&(p=this.editor.inputs.pointerVelocity.len()<.5),p&&(p=E.Dist(u,c.center)>Math.max(4,Math.min(Math.min(c.width,c.height)*.15,16))/this.editor.zoomLevel),o.props[r.id]={type:"binding",boundShapeId:l.id,normalizedAnchor:p?{x:(u.x-c.minX)/c.width,y:(u.y-c.minY)/c.height}:{x:.5,y:.5},isExact:this.editor.inputs.altKey}}else o.props[r.id]={type:"point",x:r.x,y:r.y}}break}case"middle":{const{start:s,end:a}=Ei(this.editor,o),l=E.Sub(a,s),c=E.Per(l),u=E.Med(a,s),d=E.Sub(u,c),h=E.Add(u,c),f=E.NearestPointOnLineSegment(d,h,r,!1);let p=E.Dist(f,u);E.Clockwise(f,a,u)&&(p*=-1),o.props.bend=p;break}}return o});v(this,"onTranslateStart",n=>{let r=n.props.start.type==="binding"?n.props.start.boundShapeId:null,i=n.props.end.type==="binding"?n.props.end.boundShapeId:null;if(r&&this.editor.isWithinSelection(r)||i&&this.editor.isWithinSelection(i))return;r=null,i=null;const{start:o,end:s}=Ei(this.editor,n);return{id:n.id,type:n.type,props:{...n.props,start:{type:"point",x:o.x,y:o.y},end:{type:"point",x:s.x,y:s.y}}}});v(this,"onResize",(n,r)=>{const{scaleX:i,scaleY:o}=r,s=Ei(this.editor,n),{start:a,end:l}=pr(n.props);let{bend:c}=n.props;a.type==="point"&&(a.x=s.start.x*i,a.y=s.start.y*o),l.type==="point"&&(l.x=s.end.x*i,l.y=s.end.y*o);const u=Math.abs(i),d=Math.abs(o);return i<0&&o>=0?(c!==0&&(c*=-1,c*=Math.max(u,d)),a.type==="binding"&&(a.normalizedAnchor.x=1-a.normalizedAnchor.x),l.type==="binding"&&(l.normalizedAnchor.x=1-l.normalizedAnchor.x)):i>=0&&o<0?(c!==0&&(c*=-1,c*=Math.max(u,d)),a.type==="binding"&&(a.normalizedAnchor.y=1-a.normalizedAnchor.y),l.type==="binding"&&(l.normalizedAnchor.y=1-l.normalizedAnchor.y)):i>=0&&o>=0?c!==0&&(c*=Math.max(u,d)):i<0&&o<0&&(c!==0&&(c*=Math.max(u,d)),a.type==="binding"&&(a.normalizedAnchor.x=1-a.normalizedAnchor.x,a.normalizedAnchor.y=1-a.normalizedAnchor.y),l.type==="binding"&&(l.normalizedAnchor.x=1-l.normalizedAnchor.x,l.normalizedAnchor.y=1-l.normalizedAnchor.y)),{props:{start:a,end:l,bend:c}}});v(this,"onDoubleClickHandle",(n,r)=>{switch(r.id){case"start":return{id:n.id,type:n.type,props:{...n.props,arrowheadStart:n.props.arrowheadStart==="none"?"arrow":"none"}};case"end":return{id:n.id,type:n.type,props:{...n.props,arrowheadEnd:n.props.arrowheadEnd==="none"?"arrow":"none"}}}});v(this,"getEditingBounds",n=>this.getLabelBounds(n)??new me);v(this,"onEditEnd",n=>{const{id:r,type:i,props:{text:o}}=n;o.trimEnd()!==n.props.text&&this.editor.updateShapes([{id:r,type:i,props:{text:o.trimEnd()}}])})}defaultProps(){return{dash:"draw",size:"m",fill:"none",color:"black",labelColor:"black",bend:0,start:{type:"point",x:0,y:0},end:{type:"point",x:0,y:0},arrowheadStart:"none",arrowheadEnd:"arrow",text:"",font:"draw"}}getCenter(n){return this.bounds(n).center}getBounds(n){return me.FromPoints(this.getOutlineWithoutLabel(n))}getOutlineWithoutLabel(n){const r=this.getArrowInfo(n);if(!r)return[];if(r.isStraight)return r.isValid?[r.start.point,r.end.point]:[new E(0,0),new E(1,1)];if(!r.isValid)return[new E(0,0),new E(1,1)];const i=Math.max(5,Math.ceil(Math.abs(r.bodyArc.length)/16));if(i<=0&&!isFinite(i))return[new E(0,0),new E(1,1)];const o=Array(i),s=E.Angle(r.bodyArc.center,r.start.point),a=E.Angle(r.bodyArc.center,r.end.point),l=r.bodyArc.sweepFlag?a:s,c=r.bodyArc.sweepFlag?s:a,u=r.bodyArc.largeArcFlag?-$V(l,c):Ps(l,c),d=Math.max(1,r.bodyArc.radius);for(let h=0;h<i;h++){const f=h/(i-1),p=l+u*f,g=Sa(r.bodyArc.center.x,r.bodyArc.center.y,d,p);o[h]=g}return o}getOutline(n){const r=this.getOutlineWithoutLabel(n),i=this.getLabelBounds(n);if(!i)return r;const o=i.sides,s=[0,1,2,3];let a=r[0],l=!1;const c=[a];for(let u=1;u<r.length;u++){const d=r[u];if(!l){const h=wM(s.filter(f=>to(o[f][0],o[f][1],a,d)),f=>E.DistanceToLineSegment(o[f][0],o[f][1],a));if(h!==void 0){const f=E.NearestPointOnLineSegment(o[h][0],o[h][1],a);c.push(f);for(let p=0;p<4;p++){const g=(h+p)%4;c.push(o[g][1])}c.push(f),l=!0}}c.push(d),a=d}return c}snapPoints(n){return ri}get infoCache(){return this.editor.store.createComputedCache("arrow infoCache",n=>Gu(n)?Gd(this.editor,n):bb(this.editor,n))}getArrowInfo(n){return this.infoCache.get(n.id)}getHandles(n){const r=this.infoCache.get(n.id);return[{id:"start",type:"vertex",index:"a0",x:r.start.handle.x,y:r.start.handle.y,canBind:!0},{id:"middle",type:"vertex",index:"a2",x:r.middle.x,y:r.middle.y,canBind:!1},{id:"end",type:"vertex",index:"a3",x:r.end.handle.x,y:r.end.handle.y,canBind:!0}]}hitTestPoint(n,r){const i=this.outline(n),o=this.editor.zoomLevel,s=this.editor.getStrokeWidth(n.props.size)/o;for(let a=0;a<i.length-1;a++){const l=i[a],c=i[a+1];if(E.DistanceToLineSegment(l,c,r)<s)return!0}return!1}hitTestLineSegment(n,r,i){const o=this.outline(n);for(let s=0;s<o.length-1;s++){const a=o[s],l=o[s+1];if(to(r,i,a,l))return!0}return!1}render(n){const r=this.editor.onlySelectedShape,i=this.editor.isInAny("select.idle","select.pointing_handle","select.dragging_handle","arrow.dragging")&&!this.editor.isReadOnly,o=this.getArrowInfo(n),s=this.bounds(n),a=this.getLabelBounds(n),l=b.useMemo(()=>this.editor.isSafari?tQ+=1:0,[n]);if(!(o!=null&&o.isValid))return null;const c=this.editor.getStrokeWidth(n.props.size),u=o.start.arrowhead&&Ml(o,"start",c),d=o.end.arrowhead&&Ml(o,"end",c),h=o.isStraight?Lv(o):Bv(o);let f=null;if(r===n&&i){const{strokeDasharray:T,strokeDashoffset:P}=Gn(o.isStraight?E.Dist(o.start.handle,o.end.handle):Math.abs(o.handleArc.length),2,{end:"skip",start:"skip",lengthRatio:2.5});f=n.props.start.type==="binding"||n.props.end.type==="binding"?m.jsx("path",{className:"tl-arrow-hint",d:o.isStraight?XZ(o):ZZ(o),strokeDasharray:T,strokeDashoffset:P,strokeWidth:2,markerStart:n.props.start.type==="binding"?n.props.start.isExact?"":mT(n.props.start.normalizedAnchor)?"url(#arrowhead-cross)":"url(#arrowhead-dot)":"",markerEnd:n.props.end.type==="binding"?n.props.end.isExact?"":mT(n.props.end.normalizedAnchor)?"url(#arrowhead-cross)":"url(#arrowhead-dot)":"",opacity:.16}):null}const{strokeDasharray:p,strokeDashoffset:g}=Gn(o.isStraight?o.length:Math.abs(o.bodyArc.length),c,{style:n.props.dash}),y=!(o.start.arrowhead==="none"||o.start.arrowhead==="arrow"),x=!(o.end.arrowhead==="none"||o.end.arrowhead==="arrow"),w=y||x||a,_=(n.id+"_clip_"+l).replace(":","_");return m.jsxs(m.Fragment,{children:[m.jsxs(kr,{id:n.id,style:{minWidth:50,minHeight:50},children:[w&&m.jsx("defs",{children:m.jsxs("mask",{id:_,children:[m.jsx("rect",{x:Y(-100+s.minX),y:Y(-100+s.minY),width:Y(s.width+200),height:Y(s.height+200),fill:"white"}),a&&m.jsx("rect",{x:Y(a.x),y:Y(a.y),width:Y(a.w),height:Y(a.h),fill:"black",rx:4,ry:4}),u&&y&&m.jsx("path",{d:u,fill:o.start.arrowhead==="arrow"?"none":"black",stroke:"none"}),d&&x&&m.jsx("path",{d,fill:o.end.arrowhead==="arrow"?"none":"black",stroke:"none"})]})}),m.jsxs("g",{fill:"none",stroke:"currentColor",strokeWidth:c,strokeLinejoin:"round",strokeLinecap:"round",pointerEvents:"none",children:[f,m.jsxs("g",{...w?{mask:`url(#${_})`}:void 0,children:[w&&m.jsx("rect",{x:Y(s.minX-100),y:Y(s.minY-100),width:Y(s.width+200),height:Y(s.height+200),opacity:0}),m.jsx("path",{d:h,strokeDasharray:p,strokeDashoffset:g})]}),u&&y&&n.props.fill!=="none"&&m.jsx(an,{d:u,color:n.props.color,fill:n.props.fill}),d&&x&&n.props.fill!=="none"&&m.jsx(an,{d,color:n.props.color,fill:n.props.fill}),u&&m.jsx("path",{d:u}),d&&m.jsx("path",{d})]}),m.jsx("path",{d:h,className:"tl-hitarea-stroke"})]}),m.jsx(QZ,{id:n.id,text:n.props.text,font:n.props.font,size:n.props.size,position:o.middle,width:(a==null?void 0:a.w)??0,labelColor:this.editor.getCssColor(n.props.labelColor)})]})}indicator(n){const{start:r,end:i}=Ei(this.editor,n),o=this.getArrowInfo(n),s=this.bounds(n),a=this.getLabelBounds(n);if(!o||E.Equals(r,i))return null;const l=this.editor.getStrokeWidth(n.props.size),c=o.start.arrowhead&&Ml(o,"start",l),u=o.end.arrowhead&&Ml(o,"end",l),d=o.isStraight?Lv(o):Bv(o),h=c&&o.start.arrowhead!=="arrow"||u&&o.end.arrowhead!=="arrow"||a!==null,f=(n.id+"_clip").replace(":","_");return m.jsxs("g",{children:[h&&m.jsx("defs",{children:m.jsxs("mask",{id:f,children:[m.jsx("rect",{x:s.minX-100,y:s.minY-100,width:s.w+200,height:s.h+200,fill:"white"}),a&&m.jsx("rect",{x:a.x,y:a.y,width:a.w,height:a.h,fill:"black",rx:4,ry:4}),c&&m.jsx("path",{d:c,fill:o.start.arrowhead==="arrow"?"none":"black",stroke:"none"}),u&&m.jsx("path",{d:u,fill:o.end.arrowhead==="arrow"?"none":"black",stroke:"none"})]})}),m.jsxs("g",{...h?{mask:`url(#${f})`}:void 0,children:[h&&m.jsx("rect",{x:s.minX-100,y:s.minY-100,width:s.width+200,height:s.height+200,opacity:0}),m.jsx("path",{d})]}),c&&m.jsx("path",{d:c}),u&&m.jsx("path",{d:u}),a&&m.jsx("rect",{x:a.x,y:a.y,width:a.w,height:a.h,rx:4,ry:4})]})}get labelBoundsCache(){return this.editor.store.createComputedCache("labelBoundsCache",n=>{const r=this.getArrowInfo(n),i=this.bounds(n),{text:o,font:s,size:a}=n.props;if(!r||!o.trim())return null;const{w:l,h:c}=this.editor.textMeasure.measureText(o,{...yn,fontFamily:Mo[s],fontSize:bs[a],width:"fit-content"});let u=l,d=c;if(i.width>i.height){u=Math.max(Math.min(l,64),Math.min(i.width-64,l));const{w:h,h:f}=this.editor.textMeasure.measureText(o,{...yn,fontFamily:Mo[s],fontSize:bs[a],width:u+"px"});u=h,d=f}if(u>16*bs[a]){u=16*bs[a];const{w:h,h:f}=this.editor.textMeasure.measureText(o,{...yn,fontFamily:Mo[s],fontSize:bs[a],width:u+"px"});u=h,d=f}return new me(r.middle.x-(u+8)/2,r.middle.y-(d+8)/2,u+8,d+8)})}getLabelBounds(n){return this.labelBoundsCache.get(n.id)||null}toSvg(n,r,i){const o=i.fill[n.props.color],s=this.getArrowInfo(n),a=this.editor.getStrokeWidth(n.props.size),l=document.createElementNS("http://www.w3.org/2000/svg","g");if(!s)return l;const c=s.start.arrowhead&&Ml(s,"start",a),u=s.end.arrowhead&&Ml(s,"end",a),d=this.bounds(n),h=this.getLabelBounds(n),f=(n.id+"_clip").replace(":","_");if(c||u||h){const _=document.createElementNS("http://www.w3.org/2000/svg","defs"),S=document.createElementNS("http://www.w3.org/2000/svg","mask");S.id=f;const T=document.createElementNS("http://www.w3.org/2000/svg","rect");if(T.setAttribute("x",d.minX-100+""),T.setAttribute("y",d.minY-100+""),T.setAttribute("width",d.width+200+""),T.setAttribute("height",d.height+200+""),T.setAttribute("fill","white"),S.appendChild(T),c&&S.appendChild(pT(c,s.start.arrowhead)),u&&S.appendChild(pT(u,s.end.arrowhead)),h){const P=document.createElementNS("http://www.w3.org/2000/svg","rect");P.setAttribute("x",h.x+""),P.setAttribute("y",h.y+""),P.setAttribute("width",h.w+""),P.setAttribute("height",h.h+""),P.setAttribute("fill","black"),S.appendChild(P)}_.appendChild(S),l.appendChild(_)}const p=document.createElementNS("http://www.w3.org/2000/svg","g");p.setAttribute("mask",`url(#${f})`),l.appendChild(p);const g=document.createElementNS("http://www.w3.org/2000/svg","rect");g.setAttribute("x","-100"),g.setAttribute("y","-100"),g.setAttribute("width",d.width+200+""),g.setAttribute("height",d.height+200+""),g.setAttribute("fill","transparent"),g.setAttribute("stroke","none"),p.appendChild(g);const y=nQ(s.isStraight?Lv(s):Bv(s),o,a),{strokeDasharray:x,strokeDashoffset:w}=Gn(s.isStraight?s.length:Math.abs(s.bodyArc.length),a,{style:n.props.dash});if(y.setAttribute("stroke-dasharray",x),y.setAttribute("stroke-dashoffset",w),p.appendChild(y),c&&l.appendChild(gT(c,n.props.color,a,n.props.arrowheadStart==="arrow"?"none":n.props.fill,i)),u&&l.appendChild(gT(u,n.props.color,a,n.props.arrowheadEnd==="arrow"?"none":n.props.fill,i)),h){const _={fontSize:bs[n.props.size],lineHeight:yn.lineHeight,fontFamily:r,padding:0,textAlign:"middle",width:h.w-8,verticalTextAlign:"middle",height:h.h,fontStyle:"normal",fontWeight:"normal",overflow:"wrap"},S=Iy(this.editor,this.editor.textMeasure.measureTextSpans(n.props.text,_),_);S.setAttribute("fill",i.fill[n.props.labelColor]),Array.from(S.children).forEach(I=>{const $=parseFloat(I.getAttribute("x")||"0"),L=parseFloat(I.getAttribute("y")||"0");I.setAttribute("x",$+4+h.x+"px"),I.setAttribute("y",L+h.y+"px")});const P=S.cloneNode(!0);P.setAttribute("stroke-width","2"),P.setAttribute("fill",i.background),P.setAttribute("stroke",i.background),l.appendChild(P),l.appendChild(S)}return l}}v(Qt,"type","arrow");K5([ce],Qt.prototype,"infoCache",1);K5([ce],Qt.prototype,"labelBoundsCache",1);function pT(e,t){const n=document.createElementNS("http://www.w3.org/2000/svg","path");return n.setAttribute("d",e),n.setAttribute("fill",t==="arrow"?"none":"black"),n.setAttribute("stroke","none"),n}function nQ(e,t,n){const r=document.createElementNS("http://www.w3.org/2000/svg","path");return r.setAttribute("d",e),r.setAttribute("fill","none"),r.setAttribute("stroke",t),r.setAttribute("stroke-width",n+""),r}function gT(e,t,n,r,i){const o=document.createElementNS("http://www.w3.org/2000/svg","path");o.setAttribute("d",e),o.setAttribute("fill","none"),o.setAttribute("stroke",i.fill[t]),o.setAttribute("stroke-width",n+"");const s=ao({d:e,fill:r,color:t,colors:i});if(s){const a=document.createElementNS("http://www.w3.org/2000/svg","g");return a.appendChild(s),a.appendChild(o),a}else return o}function mT(e){return e.x!==.5||e.y!==.5}function Ic({children:e,className:t="",...n}){return m.jsx("div",{...n,className:`tl-html-container ${t}`,children:e})}const V5=(e,t,n={})=>{const{newPoint:r,handle:i,scaleX:o,scaleY:s}=t,{minWidth:a=1,maxWidth:l=1/0,minHeight:c=1,maxHeight:u=1/0}=n;let d=e.props.w*o,h=e.props.h*s;const f=new E(0,0);if(d>0){if(d<a){switch(i){case"top_left":case"left":case"bottom_left":{f.x=d-a;break}case"top":case"bottom":{f.x=(d-a)/2;break}default:f.x=0}d=a}}else if(f.x=d,d=-d,d<a){switch(i){case"top_left":case"left":case"bottom_left":{f.x=-d;break}default:f.x=-a}d=a}if(h>0){if(h<c){switch(i){case"top_left":case"top":case"top_right":{f.y=h-c;break}case"right":case"left":{f.y=(h-c)/2;break}default:f.y=0}h=c}}else if(f.y=h,h=-h,h<c){switch(i){case"top_left":case"top":case"top_right":{f.y=-h;break}default:f.y=-c}h=c}const{x:p,y:g}=f.rot(e.rotation).add(r);return{x:p,y:g,props:{w:Math.min(l,d),h:Math.min(u,h)}}};class Qc extends hi{constructor(){super(...arguments);v(this,"onResize",(n,r)=>V5(n,r))}getBounds(n){return new me(0,0,n.props.w,n.props.h)}getCenter(n){return new E(n.props.w/2,n.props.h/2)}getOutline(n){return this.bounds(n).corners}hitTestPoint(n,r){return ai(r,this.outline(n))}hitTestLineSegment(n,r,i){const o=this.outline(n);for(let s=0;s<o.length;s++){const a=o[s],l=o[(s+1)%o.length];if(to(r,i,a,l))return!0}return!1}}const yT="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='30' height='30' fill='none'%3E%3Cpath stroke='%23000' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M13 5H7a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6M19 5h6m0 0v6m0-6L13 17'/%3E%3C/svg%3E";function Nh({url:e,zoomLevel:t}){return m.jsx("a",{className:Me("tl-hyperlink-button",{"tl-hyperlink-button__hidden":t<.5}),href:e,target:"_blank",rel:"noopener noreferrer",onPointerDown:Qi,onPointerUp:Qi,title:e,draggable:!1,children:m.jsx("div",{className:"tl-hyperlink-button__icon",style:{mask:`url("${yT}") center 100% / 100% no-repeat`,WebkitMask:`url("${yT}") center 100% / 100% no-repeat`}})})}class Jc extends Qc{constructor(){super(...arguments);v(this,"canResize",()=>!1);v(this,"hideSelectionBoundsBg",()=>!0);v(this,"hideSelectionBoundsFg",()=>!0);v(this,"onBeforeCreate",n=>{this.updateBookmarkAsset(n)});v(this,"onBeforeUpdate",(n,r)=>{n.props.url!==r.props.url&&this.updateBookmarkAsset(r)});v(this,"updateBookmarkAsset",CM(n=>{const{url:r}=n.props,i=Oh.createId(OS(r)),o=this.editor.getAssetById(i);o?n.props.assetId!==o.id&&this.editor.updateShapes([{id:n.id,type:n.type,props:{assetId:i}}]):this.editor.onCreateBookmarkFromUrl&&this.editor.onCreateBookmarkFromUrl(r).then(s=>{if(!s){this.editor.updateShapes([{id:n.id,type:n.type,props:{assetId:void 0}}]);return}this.editor.batch(()=>{this.editor.createAssets([{id:i,typeName:"asset",type:"bookmark",props:{src:r,description:s.description,image:s.image,title:s.title}}]).updateShapes([{id:n.id,type:n.type,props:{assetId:i}}])})})},500))}defaultProps(){return{url:"",w:u5,h:d5,assetId:null}}render(n){const r=n.props.assetId?this.editor.getAssetById(n.props.assetId):null,i=this.editor.getPageRotation(n),o=this.getHumanReadableAddress(n);return m.jsx(Ic,{children:m.jsxs("div",{className:"tl-bookmark__container tl-hitarea-stroke",style:{boxShadow:c_(i,i_)},children:[m.jsxs("div",{className:"tl-bookmark__image_container",children:[r!=null&&r.props.image?m.jsx("img",{className:"tl-bookmark__image",draggable:!1,src:r==null?void 0:r.props.image,alt:(r==null?void 0:r.props.title)||""}):m.jsx("div",{className:"tl-bookmark__placeholder"}),m.jsx(Nh,{url:n.props.url,zoomLevel:this.editor.zoomLevel})]}),m.jsxs("div",{className:"tl-bookmark__copy_container",children:[(r==null?void 0:r.props.title)&&m.jsx("h2",{className:"tl-bookmark__heading",children:$v((r==null?void 0:r.props.title)||"",54)}),(r==null?void 0:r.props.description)&&m.jsx("p",{className:"tl-bookmark__description",children:$v((r==null?void 0:r.props.description)||"",128)}),m.jsx("a",{className:"tl-bookmark__link",href:n.props.url||"",target:"_blank",rel:"noopener noreferrer",onPointerDown:Qi,onPointerUp:Qi,onClick:Qi,children:$v(o,45)})]})]})})}indicator(n){return m.jsx("rect",{width:Y(n.props.w),height:Y(n.props.h),rx:"8",ry:"8"})}getHumanReadableAddress(n){try{const r=new URL(n.props.url),i=r.pathname.replace(/\/*$/,"");return`${r.hostname}${i}`}catch{return n.props.url}}}v(Jc,"type","bookmark");function Xa(){const e=re();return ye("zoom",()=>e.zoomLevel<.35,[e])}const Y5=e=>e*.65+IV(e*Et/2)*.35,rQ=e=>({size:1+e,thinning:.5,streamline:.62+(1+e)/8*.06,smoothing:.62,easing:Bn.easeOutSine,simulatePressure:!0}),iQ=e=>({size:1+e*1.2,thinning:.62,streamline:.62,smoothing:.62,simulatePressure:!1,easing:Y5}),vT=e=>({size:1+e,thinning:0,streamline:.62+(1+e)/8*.06,smoothing:.62,simulatePressure:!1,easing:Bn.linear});function q5({strokeWidth:e,showAsComplete:t,isPen:n}){return{size:1+e,thinning:.1,streamline:.5,smoothing:.5,simulatePressure:!n,easing:n?Y5:Bn.easeOutSine,last:t}}function Rv(e,t,n,r){return{...r?vT(t):e.dash==="draw"?e.isPen?iQ(t):rQ(t):vT(t),last:e.isComplete||n}}function Oa(e){const t=[];for(const n of e)if(n.type==="free"||n.points.length<2)t.push(...n.points.map(E.Cast));else{const r=Math.max(4,Math.floor(E.Dist(n.points[0],n.points[1])/16));t.push(...E.PointsBetween(n.points[0],n.points[1],r))}return t}function xT(e,t){return{draw:"none",solid:"none",dotted:`0.1 ${t*2}`,dashed:`${t*2} ${t*2}`}[e.props.dash]}class f_ extends hi{constructor(){super(...arguments);v(this,"hideResizeHandles",n=>Yf(n));v(this,"hideRotateHandle",n=>Yf(n));v(this,"hideSelectionBoundsBg",n=>Yf(n));v(this,"hideSelectionBoundsFg",n=>Yf(n));v(this,"isClosed",n=>n.props.isClosed);v(this,"onResize",(n,r)=>{const{scaleX:i,scaleY:o}=r,s=[];for(const a of n.props.segments)s.push({...a,points:a.points.map(({x:l,y:c,z:u})=>({x:nm(i*l),y:nm(o*c),z:u}))});return{props:{segments:s}}})}defaultProps(){return{segments:[],color:"black",fill:"none",dash:"draw",size:"m",isComplete:!1,isClosed:!1,isPen:!1}}getBounds(n){return me.FromPoints(this.outline(n))}getOutline(n){return Oa(n.props.segments)}getCenter(n){return this.bounds(n).center}hitTestPoint(n,r){const i=this.outline(n),o=this.editor.zoomLevel,s=this.editor.getStrokeWidth(n.props.size)/o;if(n.props.segments.length===1&&n.props.segments[0].points.length<4&&n.props.segments[0].points.some(a=>E.Dist(r,a)<s*1.5))return!0;if(this.isClosed(n))return ai(r,i);if(this.bounds(n).containsPoint(r))for(let a=0;a<i.length;a++){const l=i[a],c=i[(a+1)%i.length];if(E.DistanceToLineSegment(l,c,r)<s)return!0}return!1}hitTestLineSegment(n,r,i){const o=this.outline(n);if(n.props.segments.length===1&&n.props.segments[0].points.length<4){const s=this.editor.zoomLevel,a=this.editor.getStrokeWidth(n.props.size)/s;if(n.props.segments[0].points.some(l=>E.DistanceToLineSegment(r,i,l)<a*1.5))return!0}if(this.isClosed(n))for(let s=0;s<o.length;s++){const a=o[s],l=o[(s+1)%o.length];if(to(r,i,a,l))return!0}else for(let s=0;s<o.length-1;s++){const a=o[s],l=o[s+1];if(to(r,i,a,l))return!0}return!1}render(n){var d;const r=Xa(),i=this.editor.getStrokeWidth(n.props.size),o=Oa(n.props.segments),s=n.props.isComplete||((d=Kn(n.props.segments))==null?void 0:d.type)==="straight";let a=i;!r&&!n.props.isPen&&n.props.dash==="draw"&&o.length===1&&(a+=fc(n.id)()*(i/6));const l=Rv(n.props,a,s,r),c=zs(o,l),u=c.length>1?Fa(c,n.props.isClosed):Dv(o[0],a);if(!r&&n.props.dash==="draw"||c.length<2){Ud(c,l);const h=zd(c,l);return m.jsxs(kr,{id:n.id,children:[m.jsx(an,{fill:n.props.isClosed?n.props.fill:"none",color:n.props.color,d:u}),m.jsx("path",{d:Yd(h,!0),strokeLinecap:"round",fill:"currentColor"})]})}return m.jsxs(kr,{id:n.id,children:[m.jsx(an,{color:n.props.color,fill:n.props.isClosed?n.props.fill:"none",d:u}),m.jsx("path",{d:u,strokeLinecap:"round",fill:"none",stroke:"currentColor",strokeWidth:i,strokeDasharray:xT(n,i),strokeDashoffset:"0"})]})}indicator(n){var d;const r=Xa(),i=this.editor.getStrokeWidth(n.props.size),o=Oa(n.props.segments);let s=i;!r&&!n.props.isPen&&n.props.dash==="draw"&&o.length===1&&(s+=fc(n.id)()*(i/6));const a=n.props.isComplete||((d=Kn(n.props.segments))==null?void 0:d.type)==="straight",l=Rv(n.props,s,a,!0),c=zs(o,l),u=c.length>1?Fa(c,n.props.isClosed):Dv(o[0],s);return m.jsx("path",{d:u})}toSvg(n,r,i){var g;const{color:o}=n.props,s=this.editor.getStrokeWidth(n.props.size),a=Oa(n.props.segments),l=n.props.isComplete||((g=Kn(n.props.segments))==null?void 0:g.type)==="straight";let c=s;!n.props.isPen&&n.props.dash==="draw"&&a.length===1&&(c+=fc(n.id)()*(s/6));const u=Rv(n.props,c,l,!1),d=zs(a,u),h=d.length>1?Fa(d,n.props.isClosed):Dv(a[0],c);let f;if(n.props.dash==="draw"||d.length<2){Ud(d,u);const y=zd(d,u),x=document.createElementNS("http://www.w3.org/2000/svg","path");x.setAttribute("d",Yd(y,!0)),x.setAttribute("fill",i.fill[o]),x.setAttribute("stroke-linecap","round"),f=x}else{const y=document.createElementNS("http://www.w3.org/2000/svg","path");y.setAttribute("d",h),y.setAttribute("stroke",i.fill[o]),y.setAttribute("fill","none"),y.setAttribute("stroke-linecap","round"),y.setAttribute("stroke-width",s.toString()),y.setAttribute("stroke-dasharray",xT(n,s)),y.setAttribute("stroke-dashoffset","0"),f=y}const p=ao({fill:n.props.isClosed?n.props.fill:"none",d:h,color:n.props.color,colors:i});if(p){const y=document.createElementNS("http://www.w3.org/2000/svg","g");return y.appendChild(p),y.appendChild(f),y}return f}expandSelectionOutlinePx(n){const r=n.props.dash==="draw"?1.6:1;return this.editor.getStrokeWidth(n.props.size)*r/2}}v(f_,"type","draw");function Dv(e,t){const n=(t+1)*.5;return`M ${e.x} ${e.y} m -${n}, 0 a ${n},${n} 0 1,0 ${n*2},0 a ${n},${n} 0 1,0 -${n*2},0`}function Yf(e){return e.props.segments.length===1&&e.props.segments[0].points.length<2}function p_(e){const t=re();return ye("isEditing",()=>t.editingId===e,[t,e])}function oQ(e){if(typeof e!="string")throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function sQ(e){const t=new URL(e).host.replace("www.","");for(const n of Pc)if(G5(n.hostnames,t)){const r=n.fromEmbedUrl(e);if(r)return{definition:n,url:r,embedUrl:e}}}const aQ=e=>e.split("*").map(t=>oQ(t)).join(".+"),G5=(e,t)=>!!e.find(n=>{const r=new RegExp(aQ(n));return t.match(r)});function lQ(e){const t=new URL(e).host.replace("www.","");for(const n of Pc)if(G5(n.hostnames,t)){const r=n.toEmbedUrl(e);if(r)return{definition:n,embedUrl:r,url:e}}}function X5(e){return lQ(e)??sQ(e)}function $s(e){try{return X5(e)}catch(t){console.error(t)}}const cQ=e=>Object.entries(e).filter(([t,n])=>n).map(([t])=>t).join(" ");class $c extends Qc{constructor(){super(...arguments);v(this,"canUnmount",()=>!1);v(this,"canResize",n=>{var i;const r=$s(n.props.url);return!!((i=r==null?void 0:r.definition)!=null&&i.doesResize)});v(this,"hideSelectionBoundsBg",n=>!this.canResize(n));v(this,"hideSelectionBoundsFg",n=>!this.canResize(n));v(this,"canEdit",()=>!0);v(this,"isAspectRatioLocked",n=>{const r=$s(n.props.url);return(r==null?void 0:r.definition.isAspectRatioLocked)??!1});v(this,"onResize",(n,r)=>{const i=this.isAspectRatioLocked(n),o=$s(n.props.url);let s=(o==null?void 0:o.definition.minWidth)??200,a=(o==null?void 0:o.definition.minHeight)??200;if(i){const l=n.props.w/n.props.h;l>1?s*=l:a/=l}return V5(n,r,{minWidth:s,minHeight:a})})}defaultProps(){return{w:300,h:300,url:"",doesResize:!0}}render(n){const{w:r,h:i,url:o}=n.props,s=p_(n.id),a=b.useMemo(()=>X5(o),[o]),l=ye("is hovering",()=>{const{editingId:h,hoveredId:f}=this.editor.pageState;if(h&&f!==h){const p=this.editor.getShapeById(h);if(p&&p.type==="embed")return!0}return!1},[]),c=this.editor.getPageRotation(n),u=s||l;if((a==null?void 0:a.definition.type)==="github_gist"){const h=a.url.split("/").pop();if(h)return m.jsx(Ic,{className:"tl-embed-container",id:n.id,children:m.jsx(uQ,{id:h,width:Y(r),height:Y(i),isInteractive:u,pageRotation:c})})}const d=cQ({...qM,...(a==null?void 0:a.definition.overridePermissions)??{}});return m.jsx(Ic,{className:"tl-embed-container",id:n.id,children:a!=null&&a.definition?m.jsx("iframe",{className:`tl-embed tl-embed-${n.id}`,sandbox:d,src:a.embedUrl,width:Y(r),height:Y(i),draggable:!1,frameBorder:"0",referrerPolicy:"no-referrer-when-downgrade",style:{border:0,pointerEvents:u?"auto":"none",zIndex:u?"":"-1",boxShadow:c_(c,i_),borderRadius:(a==null?void 0:a.definition.overrideOutlineRadius)??8,background:a==null?void 0:a.definition.backgroundColor}}):m.jsx("g",{transform:`translate(${(r-38)/2}, ${(i-38)/2})`,children:m.jsx(Ty,{})})})}indicator(n){const r=b.useMemo(()=>$s(n.props.url),[n.props.url]);return m.jsx("rect",{width:Y(n.props.w),height:Y(n.props.h),rx:(r==null?void 0:r.definition.overrideOutlineRadius)??8,ry:(r==null?void 0:r.definition.overrideOutlineRadius)??8})}}v($c,"type","embed");function uQ({id:e,file:t,isInteractive:n,width:r,height:i,style:o,pageRotation:s}){const a=b.useRef(null),l=t?`?file=${t}`:"",c=`https://gist.github.com/${e}.js${l}`;return m.jsx("iframe",{ref:a,className:"tl-embed",draggable:!1,width:Y(r),height:Y(i),frameBorder:"0",scrolling:"no",seamless:!0,referrerPolicy:"no-referrer-when-downgrade",style:{...o,pointerEvents:n?"all":"none",zIndex:n?"":"-1",boxShadow:c_(s,i_)},srcDoc:`
			<html>
				<head>
					<base target="_blank">
				</head>
				<body>
					<script src=${c}><\/script>
					<style type="text/css">
						* { margin: 0px; }
						table { height: 100%; background-color: red; }
						.gist { background-color: none; height: 100%;  }
						.gist .gist-file { height: calc(100vh - 2px); padding: 0px; display: grid; grid-template-rows: 1fr auto; }
					</style>
				</body>
			</html>`})}const dQ=b.forwardRef(({id:e,name:t,isEditing:n},r)=>{const i=re(),o=b.useCallback(l=>{l.key==="Enter"&&(l.stopPropagation(),l.currentTarget.blur(),i.setEditingId(null))},[i]),s=b.useCallback(l=>{const c=i.getShapeById(e);if(!c)return;const u=c.props.name,d=l.currentTarget.value.trim();u!==d&&i.updateShapes([{id:e,type:"frame",props:{name:d}}],!0)},[e,i]),a=b.useCallback(l=>{const c=i.getShapeById(e);if(!c)return;const u=c.props.name,d=l.currentTarget.value;u!==d&&i.updateShapes([{id:e,type:"frame",props:{name:d}}],!0)},[e,i]);return m.jsxs("div",{className:`tl-frame-label ${n?"tl-frame-label__editing":""}`,children:[m.jsx("input",{className:"tl-frame-name-input",ref:r,style:{display:n?void 0:"none"},value:t,autoFocus:!0,onKeyDown:o,onBlur:s,onChange:a}),W5(t,"Frame")+String.fromCharCode(8203)]})}),hQ=function({id:t,name:n,width:r,height:i}){const o=re(),s=GS(o.getPageRotationById(t)),a=p_(t),l=b.useRef(null);b.useEffect(()=>{const f=l.current;f&&a&&(f.focus(),f.select(),requestAnimationFrame(()=>{document.activeElement!==f&&(f.focus(),f.select())}))},[l,a]);const u=((s+Math.PI/4)*(2/Math.PI)+4)%4,d=["top","left","bottom","right"][Math.floor(u)];let h;switch(d){case"top":h="";break;case"right":h=`translate(${Y(r)}px, 0px) rotate(90deg)`;break;case"bottom":h=`translate(${Y(r)}px, ${Y(i)}px) rotate(180deg)`;break;case"left":h=`translate(0px, ${Y(i)}px) rotate(270deg)`;break}return m.jsx("div",{className:"tl-frame-heading",style:{overflow:a?"visible":"hidden",maxWidth:`calc(var(--tl-zoom) * ${Math.ceil(d==="top"||d==="bottom"?r:i)}px + var(--space-5))`,bottom:Math.ceil(i),transform:`${h} scale(var(--tl-scale)) translateX(calc(-1 * var(--space-3))`},children:m.jsx("div",{className:"tl-frame-heading-hit-area",children:m.jsx(dQ,{ref:l,id:t,name:n,isEditing:a})})})};class mc extends Qc{constructor(){super(...arguments);v(this,"canBind",()=>!0);v(this,"canEdit",()=>!0);v(this,"canReceiveNewChildrenOfType",(n,r)=>!n.isLocked);v(this,"canDropShapes",(n,r)=>!n.isLocked);v(this,"onDragShapesOver",(n,r)=>r.every(i=>i.parentId===n.id)?{shouldHint:!1}:(this.editor.reparentShapesById(r.map(i=>i.id),n.id),{shouldHint:!0}));v(this,"onDragShapesOut",(n,r)=>{const i=this.editor.getShapeById(n.parentId);(i==null?void 0:i.type)==="group"?this.editor.reparentShapesById(r.map(s=>s.id),i.id):this.editor.reparentShapesById(r.map(s=>s.id),this.editor.currentPageId)});v(this,"onResizeEnd",n=>{const r=this.editor.getPageBounds(n),i=this.editor.getSortedChildIds(n.id),o=[];for(const s of i){const a=this.editor.getPageBoundsById(s);r.includes(a)||o.push(s)}o.length>0&&this.editor.reparentShapesById(o,this.editor.currentPageId)})}defaultProps(){return{w:160*2,h:90*2,name:""}}render(n){const r=this.bounds(n);return m.jsxs(m.Fragment,{children:[m.jsxs(kr,{children:[m.jsx("rect",{className:"tl-hitarea-stroke",width:r.width,height:r.height}),m.jsx("rect",{className:"tl-frame__body",width:r.width,height:r.height,fill:"none"})]}),m.jsx(hQ,{id:n.id,name:n.props.name,width:r.width,height:r.height})]})}toSvg(n,r,i){const o=document.createElementNS("http://www.w3.org/2000/svg","g"),s=document.createElementNS("http://www.w3.org/2000/svg","rect");s.setAttribute("width",n.props.w.toString()),s.setAttribute("height",n.props.h.toString()),s.setAttribute("fill",i.solid),s.setAttribute("stroke",i.fill.black),s.setAttribute("stroke-width","1"),s.setAttribute("rx","1"),s.setAttribute("ry","1"),o.appendChild(s);const c=((GS(this.editor.getPageRotationById(n.id))+Math.PI/4)*(2/Math.PI)+4)%4,u=["top","left","bottom","right"][Math.floor(c)];let d;switch(u){case"top":d="";break;case"right":d=`translate(${Y(n.props.w)}px, 0px) rotate(90deg)`;break;case"bottom":d=`translate(${Y(n.props.w)}px, ${Y(n.props.h)}px) rotate(180deg)`;break;case"left":d=`translate(0px, ${Y(n.props.h)}px) rotate(270deg)`;break;default:d=""}const h={fontSize:12,fontFamily:"Inter, sans-serif",textAlign:"start",width:n.props.w,height:32,padding:0,lineHeight:1,fontStyle:"normal",fontWeight:"normal",overflow:"truncate-ellipsis",verticalTextAlign:"middle"},f=this.editor.textMeasure.measureTextSpans(W5(n.props.name,"Frame")+String.fromCharCode(8203),h),p=f[0],g=Kn(f),y=g.box.w+g.box.x-p.box.x,x=Iy(this.editor,f,{offsetY:-h.height-2,...h});x.style.setProperty("transform",d);const w=document.createElementNS("http://www.w3.org/2000/svg","rect");return w.setAttribute("x","-8px"),w.setAttribute("y",-h.height-4+"px"),w.setAttribute("width",y+16+"px"),w.setAttribute("height",`${h.height}px`),w.setAttribute("rx","4px"),w.setAttribute("ry","4px"),w.setAttribute("fill",i.background),o.appendChild(w),o.appendChild(x),o}indicator(n){const r=this.bounds(n);return m.jsx("rect",{width:Y(r.width),height:Y(r.height),className:"tl-frame-indicator"})}providesBackgroundForChildren(){return!0}}v(mc,"type","frame");function fQ(e,t,n,r){if((e==="start-legacy"||e==="end-legacy")&&n.length!==0){const i=me.From(n[0].box);for(const{box:o}of n)i.union(o);if(e==="start-legacy")return(r-2*t-i.width)/2;if(e==="end-legacy")return-(r-2*t-i.width)/2}}function pQ(e){return e==="start-legacy"||e==="middle-legacy"||e==="end-legacy"}function Z5({bounds:e,editor:t,font:n,shape:r}){const o={fontSize:Da[r.props.size],fontFamily:n,textAlign:r.props.align,verticalTextAlign:r.props.verticalAlign,width:Math.ceil(e.width),height:Math.ceil(e.height),padding:16,lineHeight:yn.lineHeight,fontStyle:"normal",fontWeight:"normal",overflow:"wrap",offsetX:0},s=t.textMeasure.measureTextSpans(r.props.text,o),a=fQ(r.props.align,16,s,e.width);return a&&(o.offsetX=a),Iy(t,s,o)}const Q5=ke.memo(function({id:t,type:n,text:r,size:i,labelColor:o,font:s,align:a,verticalAlign:l,wrap:c}){const{rInput:u,isEmpty:d,isEditing:h,isEditableFromHover:f,handleFocus:p,handleChange:g,handleKeyDown:y,handleBlur:x}=h_(t,n,r),w=h||f,_=Us.normalizeTextForDom(r),S=_.trim().length>0,T=pQ(a);return m.jsx("div",{className:"tl-text-label","data-font":s,"data-align":a,"data-hastext":!d,"data-isediting":h,"data-textwrap":!!c,style:S||w?{justifyContent:a==="middle"||T?"center":a,alignItems:l==="middle"?"center":l}:void 0,children:m.jsxs("div",{className:"tl-text-label__inner",style:{fontSize:Da[i],lineHeight:Da[i]*yn.lineHeight+"px",minHeight:d?Da[i]*yn.lineHeight+32:0,minWidth:d?33:0,color:o},children:[m.jsx("div",{className:"tl-text tl-text-content",dir:"ltr",children:_}),w?m.jsx("textarea",{ref:u,className:"tl-text tl-text-input",name:"text",tabIndex:-1,autoComplete:"false",autoCapitalize:"false",autoCorrect:"false",autoSave:"false",autoFocus:h,placeholder:"",spellCheck:"true",wrap:"off",dir:"auto",datatype:"wysiwyg",defaultValue:r,onFocus:p,onChange:g,onKeyDown:y,onBlur:x,onContextMenu:Qi}):null]})})}),gQ=b.memo(function({w:t,h:n,strokeWidth:r,dash:i,color:o,fill:s}){const a=t/2,l=n/2,c=Math.max(0,a-r/2),u=Math.max(0,l-r/2),d=jd(c,u),{strokeDasharray:h,strokeDashoffset:f}=Gn(d<64?d*2:d,r,{style:i,snap:4,closed:!0}),p=`M${a-c},${l}a${c},${u},0,1,1,${c*2},0a${c},${u},0,1,1,-${c*2},0`;return m.jsxs(m.Fragment,{children:[m.jsx(an,{d:p,color:o,fill:s}),m.jsx("path",{d:p,strokeWidth:r,width:Y(t),height:Y(n),fill:"none",stroke:"currentColor",strokeDasharray:h,strokeDashoffset:f,pointerEvents:"all"})]})});function mQ({w:e,h:t,strokeWidth:n,dash:r,color:i,colors:o,fill:s}){const a=e/2,l=t/2,c=Math.max(0,a-n/2),u=Math.max(0,l-n/2),d=jd(c,u),{strokeDasharray:h,strokeDashoffset:f}=Gn(d<64?d*2:d,n,{style:r,snap:4,closed:!0}),p=`M${a-c},${l}a${c},${u},0,1,1,${c*2},0a${c},${u},0,1,1,-${c*2},0`,g=document.createElementNS("http://www.w3.org/2000/svg","path");g.setAttribute("d",p),g.setAttribute("stroke-width",n.toString()),g.setAttribute("width",e.toString()),g.setAttribute("height",t.toString()),g.setAttribute("fill","none"),g.setAttribute("stroke",o.fill[i]),g.setAttribute("stroke-dasharray",h),g.setAttribute("stroke-dashoffset",f);const y=ao({d:p,fill:s,color:i,colors:o});return ua(g,y)}function J5(e,t){if(t>e){const r=e/2;return`
    M0,${r}
    a${r},${r},0,1,1,${r*2},0
    L${e},${t-r}
    a${r},${r},0,1,1,-${r*2},0
    Z`}const n=t/2;return`
    M${n},0
    L${e-n},0
    a${n},${n},0,1,1,0,${n*2}
    L${n},${t}
    a${n},${n},0,1,1,0,${-n*2}
    Z`}function e6(e,t){if(e>t){const r=t/2;return jd(r,r)+(e-r*2)*2}const n=e/2;return jd(n,n)+(t-n*2)*2}const yQ=b.memo(function({w:t,h:n,strokeWidth:r,dash:i,color:o,fill:s}){const a=J5(t,n),l=e6(t,n),{strokeDasharray:c,strokeDashoffset:u}=Gn(l<64?l*2:l,r,{style:i,snap:4,start:"outset",end:"outset",closed:!0});return m.jsxs(m.Fragment,{children:[m.jsx(an,{d:a,color:o,fill:s}),m.jsx("path",{d:a,strokeWidth:r,width:Y(t),height:Y(n),fill:"none",stroke:"currentColor",strokeDasharray:c,strokeDashoffset:u,pointerEvents:"all"})]})});function bT({w:e,h:t,strokeWidth:n,dash:r,color:i,colors:o,fill:s}){const a=J5(e,t),l=e6(e,t),{strokeDasharray:c,strokeDashoffset:u}=Gn(l<64?l*2:l,n,{style:r,snap:4,closed:!0}),d=document.createElementNS("http://www.w3.org/2000/svg","path");d.setAttribute("d",a),d.setAttribute("stroke-width",n.toString()),d.setAttribute("width",e.toString()),d.setAttribute("height",t.toString()),d.setAttribute("fill","none"),d.setAttribute("stroke",o.fill[i]),d.setAttribute("stroke-dasharray",c),d.setAttribute("stroke-dashoffset",u);const h=ao({d:a,fill:s,color:i,colors:o});return ua(d,h)}const vQ=b.memo(function({dash:t,fill:n,color:r,strokeWidth:i,outline:o,lines:s}){const a="M"+o[0]+"L"+o.slice(1)+"Z";return m.jsxs(m.Fragment,{children:[m.jsx(an,{d:a,fill:n,color:r}),s&&s.map((l,c)=>m.jsx("path",{className:"tl-hitarea-stroke",fill:"none",d:`M${l[0].x},${l[0].y}L${l[1].x},${l[1].y}`},`line_bg_${c}`)),m.jsxs("g",{strokeWidth:i,stroke:"currentColor",fill:"none",pointerEvents:"all",children:[Array.from(Array(o.length)).map((l,c)=>{const u=o[c],d=o[(c+1)%o.length],h=E.Dist(u,d),{strokeDasharray:f,strokeDashoffset:p}=Gn(h,i,{style:t,start:"outset",end:"outset"});return m.jsx("line",{x1:u.x,y1:u.y,x2:d.x,y2:d.y,strokeDasharray:f,strokeDashoffset:p},c)}),s&&s.map(([l,c],u)=>{const d=E.Dist(l,c),{strokeDasharray:h,strokeDashoffset:f}=Gn(d,i,{style:t,start:"skip",end:"outset",snap:t==="dotted"?4:void 0});return m.jsx("path",{d:`M${l.x},${l.y}L${c.x},${c.y}`,stroke:"currentColor",strokeWidth:i,fill:"none",strokeDasharray:h,strokeDashoffset:f},`line_fg_${u}`)})]})]})});function xQ({dash:e,fill:t,color:n,colors:r,strokeWidth:i,outline:o,lines:s}){const a=document.createElementNS("http://www.w3.org/2000/svg","g");if(a.setAttribute("stroke-width",i.toString()),a.setAttribute("stroke",r.fill[n]),a.setAttribute("fill","none"),Array.from(Array(o.length)).forEach((c,u)=>{const d=o[u],h=o[(u+1)%o.length],f=E.Dist(d,h),{strokeDasharray:p,strokeDashoffset:g}=Gn(f,i,{style:e}),y=document.createElementNS("http://www.w3.org/2000/svg","line");y.setAttribute("x1",d.x.toString()),y.setAttribute("y1",d.y.toString()),y.setAttribute("x2",h.x.toString()),y.setAttribute("y2",h.y.toString()),y.setAttribute("stroke-dasharray",p.toString()),y.setAttribute("stroke-dashoffset",g.toString()),a.appendChild(y)}),s)for(const[c,u]of s){const d=E.Dist(c,u),{strokeDasharray:h,strokeDashoffset:f}=Gn(d,i,{style:e,start:"skip",end:"skip",snap:e==="dotted"?4:2}),p=document.createElementNS("http://www.w3.org/2000/svg","line");p.setAttribute("x1",c.x.toString()),p.setAttribute("y1",c.y.toString()),p.setAttribute("x2",u.x.toString()),p.setAttribute("y2",u.y.toString()),p.setAttribute("stroke-dasharray",h.toString()),p.setAttribute("stroke-dashoffset",f.toString()),a.appendChild(p)}const l=ao({d:"M"+o[0]+"L"+o.slice(1)+"Z",fill:t,color:n,colors:r});return ua(a,l)}b.memo(function({id:t,w:n,h:r,strokeWidth:i,fill:o,color:s}){const a=g_(t,n,r,i),l=r6(t,n,r,i);return m.jsxs(m.Fragment,{children:[m.jsx(an,{d:a,color:s,fill:o}),m.jsx("path",{d:l,fill:"currentColor",strokeWidth:0,pointerEvents:"all"})]})});function bQ({id:e,w:t,h:n,strokeWidth:r,fill:i,color:o,colors:s}){const a=document.createElementNS("http://www.w3.org/2000/svg","path");a.setAttribute("d",r6(e,t,n,r)),a.setAttribute("fill",s.fill[o]);const l=ao({d:g_(e,t,n,r),fill:i,color:o,colors:s});return ua(a,l)}function t6(e){return{size:1+e,thinning:.25,end:{taper:e},start:{taper:e},streamline:0,smoothing:1,simulatePressure:!1}}function n6(e,t,n,r){const i=fc(e),o=t/2,s=n/2,a=jd(o,s),l=[],c=kt*i(),u=kt+tt/2+Math.abs(i())*tt,d=Math.max(16,a/10);for(let h=0;h<d;h++){const f=h/(d-1),p=c+f*u,g=Math.cos(p),y=Math.sin(p);l.push(new E(o*g+t*.5+.05*i(),s*y+n/2+.05*i(),Math.min(1,.5+Math.abs(.5-(i()>0?Bn.easeInOutSine(f):Bn.easeInExpo(f)))/2)))}return zs(l,t6(r))}function r6(e,t,n,r){const i=t6(r);return Yd(zd(Ud(n6(e,t,n,r),i),i))}function g_(e,t,n,r){return Fa(n6(e,t,n,r))}const wQ=b.memo(function({id:t,outline:n,lines:r,fill:i,color:o,strokeWidth:s}){const a=Hd(t,n,s/3,s*2,2);let l=Wd(a);if(r)for(const[d,h]of r)l+=`M${d.x},${d.y}L${h.x},${h.y}`;const c=Hd(t,n,0,s*2,1),u=Wd(c);return m.jsxs(m.Fragment,{children:[m.jsx(an,{d:u,fill:i,color:o}),m.jsx("path",{d:l,stroke:"currentColor",strokeWidth:s,fill:"none"})]})});function SQ({id:e,outline:t,lines:n,fill:r,color:i,colors:o,strokeWidth:s}){const a=Hd(e,t,s/3,s*2,2);let l=Wd(a);if(n)for(const[f,p]of n)l+=`M${f.x},${f.y}L${p.x},${p.y}`;const c=Hd(e,t,0,s*2,1),u=Wd(c),d=document.createElementNS("http://www.w3.org/2000/svg","path");d.setAttribute("d",l),d.setAttribute("fill","none"),d.setAttribute("stroke",o.fill[i]),d.setAttribute("stroke-width",s.toString());const h=ao({d:u,fill:r,color:i,colors:o});return ua(d,h)}const wT=b.memo(function({w:t,h:n,strokeWidth:r,fill:i,color:o}){const s=t/2,a=n/2,l=Math.max(0,s),c=Math.max(0,a),u=`M${s-l},${a}a${l},${c},0,1,1,${l*2},0a${l},${c},0,1,1,-${l*2},0`;return m.jsxs(m.Fragment,{children:[m.jsx(an,{d:u,color:o,fill:i}),m.jsx("path",{d:u,stroke:`var(--palette-${o})`,strokeWidth:r,fill:"none"})]})});function _Q({w:e,h:t,strokeWidth:n,fill:r,color:i,colors:o}){const s=e/2,a=t/2,l=Math.max(0,s),c=Math.max(0,a),u=`M${s-l},${a}a${l},${c},0,1,1,${l*2},0a${l},${c},0,1,1,-${l*2},0`,d=document.createElementNS("http://www.w3.org/2000/svg","path");d.setAttribute("d",u),d.setAttribute("stroke-width",n.toString()),d.setAttribute("width",e.toString()),d.setAttribute("height",t.toString()),d.setAttribute("fill","none"),d.setAttribute("stroke",o.fill[i]);const h=ao({d:u,fill:r,color:i,colors:o});return ua(d,h)}const ST=b.memo(function({w:t,h:n,strokeWidth:r,fill:i,color:o}){const s=m_(t,n);return m.jsxs(m.Fragment,{children:[m.jsx(an,{d:s,color:o,fill:i}),m.jsx("path",{d:s,stroke:`var(--palette-${o})`,strokeWidth:r,fill:"none"})]})});function CQ({w:e,h:t,strokeWidth:n,fill:r,color:i,colors:o}){const s=m_(e,t),a=document.createElementNS("http://www.w3.org/2000/svg","path");a.setAttribute("d",s),a.setAttribute("stroke-width",n.toString()),a.setAttribute("width",e.toString()),a.setAttribute("height",t.toString()),a.setAttribute("fill","none"),a.setAttribute("stroke",o.fill[i]);const l=ao({d:s,fill:r,color:i,colors:o});return ua(a,l)}function m_(e,t){let n;if(t>e){const r=e/2;n=`
    M0,${r}
    a${r},${r},0,1,1,${r*2},0
    L${e},${t-r}
    a${r},${r},0,1,1,-${r*2},0
    Z`}else{const r=t/2;n=`
    M${r},0
    L${e-r},0
    a${r},${r},0,1,1,0,${r*2}
    L${r},${t}
    a${r},${r},0,1,1,0,${-r*2}
    Z`}return n}const EQ=b.memo(function({outline:t,lines:n,fill:r,color:i,strokeWidth:o}){let s="M"+t[0]+"L"+t.slice(1)+"Z";if(n)for(const[a,l]of n)s+=`M${a.x},${a.y}L${l.x},${l.y}`;return m.jsxs(m.Fragment,{children:[m.jsx(an,{d:s,fill:r,color:i}),m.jsx("path",{d:s,stroke:`var(--palette-${i}`,strokeWidth:o,fill:"none"})]})});function kQ({outline:e,lines:t,fill:n,color:r,strokeWidth:i,colors:o}){const s="M"+e[0]+"L"+e.slice(1)+"Z",a=s;let l=s;if(t)for(const[d,h]of t)l+=`M${d.x},${d.y}L${h.x},${h.y}`;const c=document.createElementNS("http://www.w3.org/2000/svg","path");c.setAttribute("d",l),c.setAttribute("stroke-width",i.toString()),c.setAttribute("stroke",o.fill[r]),c.setAttribute("fill","none");const u=ao({d:a,fill:n,color:r,colors:o});return ua(c,u)}const Fv=16,Wr=17*3;class y_ extends Qc{constructor(){super(...arguments);v(this,"canEdit",()=>!0);v(this,"onEditEnd",n=>{const{id:r,type:i,props:{text:o}}=n;o.trimEnd()!==n.props.text&&this.editor.updateShapes([{id:r,type:i,props:{text:o.trimEnd()}}])});v(this,"onResize",(n,{initialBounds:r,handle:i,newPoint:o,scaleX:s,scaleY:a})=>{let l=r.width*s,c=r.height*a,u=0,d=0;if(n.props.text.trim()){let g=Math.max(Math.abs(l),Wr),y=Math.max(Math.abs(c),Wr);g<Wr&&y===Wr&&(g=Wr),g===Wr&&y<Wr&&(y=Wr);const x=Nv(this.editor,{...n,props:{...n.props,w:g,h:y}}),w=Math.max(Math.abs(l),x.w)*Math.sign(l),_=Math.max(Math.abs(c),x.h)*Math.sign(c);u=Math.abs(w)-Math.abs(l),d=Math.abs(_)-Math.abs(c),l=w,c=_}const h=new E(0,0);s<0&&(h.x+=l),(i==="left"||i==="top_left"||i==="bottom_left")&&(h.x+=s<0?u:-u),a<0&&(h.y+=c),(i==="top"||i==="top_left"||i==="top_right")&&(h.y+=a<0?d:-d);const{x:f,y:p}=h.rot(n.rotation).add(o);return{x:f,y:p,props:{w:Math.max(Math.abs(l),1),h:Math.max(Math.abs(c),1),growY:0}}});v(this,"onBeforeCreate",n=>{if(!n.props.text)return n.props.growY?{...n,props:{...n.props,growY:0}}:void 0;const r=n.props.h,i=Nv(this.editor,n).h;let o=null;if(i>r?o=i-r:n.props.growY&&(o=0),o!==null)return{...n,props:{...n.props,growY:o}}});v(this,"onBeforeUpdate",(n,r)=>{const i=n.props.text.trimEnd(),o=r.props.text.trimEnd();if(i===o&&n.props.font===r.props.font&&n.props.size===r.props.size)return;if(i&&!o)return{...r,props:{...r.props,growY:0}};const s=n.props.w,a=n.props.h,l=Nv(this.editor,r),c=l.w,u=l.h;if(!i&&o&&o.length===1){let h=Math.max(s,c),f=Math.max(a,u);return n.props.w<Wr&&n.props.h<Wr&&(h=Math.max(h,Wr),f=Math.max(f,Wr),h=Math.max(h,f),f=Math.max(h,f)),{...r,props:{...r.props,w:h,h:f,growY:0}}}let d=null;if(u>a?d=u-a:n.props.growY&&(d=0),d!==null)return{...r,props:{...r.props,growY:d,w:Math.max(r.props.w,c)}};if(c>n.props.w)return{...r,props:{...r.props,w:c}}});v(this,"onDoubleClick",n=>{if(this.editor.inputs.altKey)switch(n.props.geo){case"rectangle":return{...n,props:{geo:"check-box"}};case"check-box":return{...n,props:{geo:"rectangle"}}}})}defaultProps(){return{w:100,h:100,geo:"rectangle",color:"black",labelColor:"black",fill:"none",dash:"draw",size:"m",font:"draw",text:"",align:"middle",verticalAlign:"middle",growY:0,url:""}}hitTestLineSegment(n,r,i){const o=this.outline(n);for(let a=0;a<o.length;a++){const l=o[a],c=o[(a+1)%o.length];if(to(r,i,l,c))return!0}const s=Au(n.props,0);if(s!==void 0){for(const[a,l]of s)if(to(r,i,a,l))return!0}return!1}hitTestPoint(n,r){const i=this.outline(n);if(n.props.fill==="none"){const o=this.editor.zoomLevel,s=this.editor.getStrokeWidth(n.props.size)/o;for(let l=0;l<i.length;l++){const c=i[l],u=i[(l+1)%i.length];if(E.DistanceToLineSegment(c,u,r)<s)return!0}const a=Au(n.props,1);if(a!==void 0){for(const[l,c]of a)if(E.DistanceToLineSegment(l,c,r)<s)return!0}return!1}return ai(r,i)}getBounds(n){return new me(0,0,n.props.w,n.props.h+n.props.growY)}getCenter(n){return new E(n.props.w/2,(n.props.h+n.props.growY)/2)}getOutline(n){const r=Math.max(1,n.props.w),i=Math.max(1,n.props.h+n.props.growY),o=r/2,s=i/2;switch(n.props.geo){case"triangle":return[new E(o,0),new E(r,i),new E(0,i)];case"diamond":return[new E(o,0),new E(r,s),new E(o,i),new E(0,s)];case"pentagon":return Cv(r,i,5);case"hexagon":return Cv(r,i,6);case"octagon":return Cv(r,i,8);case"ellipse":{const a=Math.pow(o-s,2)/Math.pow(o+s,2),l=Et*(o+s)*(1+3*a/(10+Math.sqrt(4-3*a)));let c=Math.max(4,Math.ceil(l/10));c=Math.ceil(c/4)*4;const u=kt/c,d=Math.cos(u),h=Math.sin(u);let f=0,p=1,g=0,y=1;const x=Array(c);for(let w=0;w<c;w++)x[w]=new E(o+o*p,s+s*f),g=h*p+d*f,y=d*p-h*f,f=g,p=y;return x}case"oval":{const l=Array(20);if(i>r)for(let c=0;c<10;c++){const u=-Et+Et*c/8,d=Et*c/(10-2);l[c]=new E(o+o*Math.cos(u),o+o*Math.sin(u)),l[c+10]=new E(o+o*Math.cos(d),i-o+o*Math.sin(d))}else for(let c=0;c<10;c++){const u=-tt+Et*c/8,d=tt+Et*-c/(10-2);l[c]=new E(r-s+s*Math.cos(u),i-s+s*Math.sin(u)),l[c+10]=new E(s-s*Math.cos(d),i-s+s*Math.sin(d))}return l}case"star":{const l=kt/5/2,c=Math.floor(5/4)*2,u=5*2-c,d=0,h=Math.floor(5/2)*2,f=Math.cos(-tt+c*l)*r/2,p=Math.cos(-tt+u*l)*r/2,g=Math.sin(-tt+d*l)*i/2,y=Math.sin(-tt+h*l)*i/2,x=r-Math.abs(f-p),w=i-Math.abs(y-g),_=r/2+p-(r/2-f),S=i/2+g-(i/2-y),T=1,P=(r-_)/2,I=(i-S)/2,$=(r+x)/2,L=(i+w)/2,R=$*T/2,K=L*T/2;return Array.from(Array(5*2)).map((Q,j)=>{const B=-tt+j*l;return new E(P+(j%2?R:$)*Math.cos(B),I+(j%2?K:L)*Math.sin(B))})}case"rhombus":{const a=Math.min(r*.38,i*.38);return[new E(a,0),new E(r,0),new E(r-a,i),new E(0,i)]}case"rhombus-2":{const a=Math.min(r*.38,i*.38);return[new E(0,0),new E(r-a,0),new E(r,i),new E(a,i)]}case"trapezoid":{const a=Math.min(r*.38,i*.38);return[new E(a,0),new E(r-a,0),new E(r,i),new E(0,i)]}case"arrow-right":{const a=Math.min(r,i)*.38,l=i*.16;return[new E(0,l),new E(r-a,l),new E(r-a,0),new E(r,i/2),new E(r-a,i),new E(r-a,i-l),new E(0,i-l)]}case"arrow-left":{const a=Math.min(r,i)*.38,l=i*.16;return[new E(a,0),new E(a,l),new E(r,l),new E(r,i-l),new E(a,i-l),new E(a,i),new E(0,i/2)]}case"arrow-up":{const a=r*.16,l=Math.min(r,i)*.38;return[new E(r/2,0),new E(r,l),new E(r-a,l),new E(r-a,i),new E(a,i),new E(a,l),new E(0,l)]}case"arrow-down":{const a=r*.16,l=Math.min(r,i)*.38;return[new E(a,0),new E(r-a,0),new E(r-a,i-l),new E(r,i-l),new E(r/2,i),new E(0,i-l),new E(a,i-l)]}case"check-box":case"x-box":case"rectangle":return[new E(0,0),new E(r,0),new E(r,i),new E(0,i)]}}render(n){const{id:r,type:i,props:o}=n,s=Xa(),a=this.editor.getStrokeWidth(o.size),{w:l,color:c,labelColor:u,fill:d,dash:h,growY:f,font:p,align:g,verticalAlign:y,size:x,text:w}=o,_=()=>{const S=o.h+f;switch(o.geo){case"ellipse":{if(h==="solid"||h==="draw"&&s)return m.jsx(wT,{strokeWidth:a,w:l,h:S,color:c,fill:d});if(h==="dashed"||h==="dotted")return m.jsx(gQ,{id:r,strokeWidth:a,w:l,h:S,dash:h==="dashed"?h:x==="s"&&s?"dashed":h,color:c,fill:d});if(h==="draw")return m.jsx(wT,{strokeWidth:a,w:l,h:S,color:c,fill:d});break}case"oval":{if(h==="solid"||h==="draw"&&s)return m.jsx(ST,{strokeWidth:a,w:l,h:S,color:c,fill:d});if(h==="dashed"||h==="dotted")return m.jsx(yQ,{id:r,strokeWidth:a,w:l,h:S,dash:h==="dashed"?h:x==="s"&&s?"dashed":h,color:c,fill:d});if(h==="draw")return m.jsx(ST,{strokeWidth:a,w:l,h:S,color:c,fill:d});break}default:{const T=this.outline(n),P=Au(n.props,a);if(h==="solid"||h==="draw"&&s)return m.jsx(EQ,{fill:d,color:c,strokeWidth:a,outline:T,lines:P});if(h==="dashed"||h==="dotted")return m.jsx(vQ,{dash:h==="dashed"?h:x==="s"&&s?"dashed":h,fill:d,color:c,strokeWidth:a,outline:T,lines:P});if(h==="draw")return m.jsx(wQ,{id:r,fill:d,color:c,strokeWidth:a,outline:T,lines:P})}}};return m.jsxs(m.Fragment,{children:[m.jsx(kr,{id:r,children:_()}),m.jsx(Q5,{id:r,type:i,font:p,fill:d,size:x,align:g,verticalAlign:y,text:w,labelColor:this.editor.getCssColor(u),wrap:!0}),"url"in n.props&&n.props.url&&m.jsx(Nh,{url:n.props.url,zoomLevel:this.editor.zoomLevel})]})}indicator(n){const{id:r,props:i}=n,{w:o,h:s,growY:a,size:l}=i,c=Xa(),u=this.editor.getStrokeWidth(l);switch(i.geo){case"ellipse":return i.dash==="draw"&&!c?m.jsx("path",{d:g_(r,o,s+a,u)}):m.jsx("ellipse",{cx:o/2,cy:(s+a)/2,rx:o/2,ry:(s+a)/2});case"oval":return m.jsx("path",{d:m_(o,s+a)});default:{const d=this.outline(n);let h;if(i.dash==="draw"&&!c){const p=Hd(r,d,0,u*2,1);h=Wd(p)}else h="M"+d[0]+"L"+d.slice(1)+"Z";const f=Au(n.props,u);if(f)for(const[p,g]of f)h+=`M${p.x},${p.y}L${g.x},${g.y}`;return m.jsx("path",{d:h})}}}toSvg(n,r,i){const{id:o,props:s}=n,a=this.editor.getStrokeWidth(s.size);let l;switch(s.geo){case"ellipse":{switch(s.dash){case"draw":l=bQ({id:o,w:s.w,h:s.h,color:s.color,fill:s.fill,strokeWidth:a,colors:i});break;case"solid":l=_Q({strokeWidth:a,w:s.w,h:s.h,color:s.color,fill:s.fill,colors:i});break;default:l=mQ({id:o,strokeWidth:a,w:s.w,h:s.h,dash:s.dash,color:s.color,fill:s.fill,colors:i});break}break}case"oval":{switch(s.dash){case"draw":l=bT({id:o,strokeWidth:a,w:s.w,h:s.h,dash:s.dash,color:s.color,fill:s.fill,colors:i});break;case"solid":l=CQ({strokeWidth:a,w:s.w,h:s.h,color:s.color,fill:s.fill,colors:i});break;default:l=bT({id:o,strokeWidth:a,w:s.w,h:s.h,dash:s.dash,color:s.color,fill:s.fill,colors:i})}break}default:{const c=this.outline(n),u=Au(n.props,a);switch(s.dash){case"draw":l=SQ({id:o,fill:s.fill,color:s.color,strokeWidth:a,outline:c,lines:u,colors:i});break;case"solid":l=kQ({fill:s.fill,color:s.color,strokeWidth:a,outline:c,lines:u,colors:i});break;default:l=xQ({dash:s.dash,fill:s.fill,color:s.color,strokeWidth:a,outline:c,lines:u,colors:i});break}break}}if(s.text){const c=this.bounds(n),u=Z5({editor:this.editor,shape:n,font:r,bounds:c}),d=u.cloneNode(!0);d.setAttribute("fill",i.fill[n.props.labelColor]),d.setAttribute("stroke","none");const h=u.cloneNode(!0);h.setAttribute("stroke-width","2"),h.setAttribute("fill",i.background),h.setAttribute("stroke",i.background);const f=document.createElementNS("http://www.w3.org/2000/svg","g");if(f.append(h),f.append(d),l.nodeName==="g")return l.appendChild(f),l;{const p=document.createElementNS("http://www.w3.org/2000/svg","g");return p.appendChild(l),p.appendChild(f),p}}return l}}v(y_,"type","geo");function Nv(e,t){const n=t.props.text.trimEnd();if(!n)return{w:0,h:0};const r=e.textMeasure.measureText("w",{...yn,fontFamily:Mo[t.props.font],fontSize:Da[t.props.size],width:"fit-content",maxWidth:"100px"}),i={s:2,m:3.5,l:5,xl:10},o=e.textMeasure.measureText(n,{...yn,fontFamily:Mo[t.props.font],fontSize:Da[t.props.size],width:"fit-content",minWidth:r.w+"px",maxWidth:Math.max(0,Math.ceil(r.w+i[t.props.size]),Math.ceil(t.props.w-Fv*2))+"px"});return{w:o.w+Fv*2,h:o.h+Fv*2}}function Au(e,t){switch(e.geo){case"x-box":return TQ(e.w,e.h,t,e.dash);case"check-box":return PQ(e.w,e.h);default:return}}function TQ(e,t,n,r){const i=r==="draw"?.62:0;return r==="dashed"?[[new E(0,0),new E(e/2,t/2)],[new E(e,t),new E(e/2,t/2)],[new E(0,t),new E(e/2,t/2)],[new E(e,0),new E(e/2,t/2)]]:[[new E(n*i,n*i),new E(e-n*i,t-n*i)],[new E(n*i,t-n*i),new E(e-n*i,n*i)]]}function PQ(e,t){const n=Math.min(e,t)*.82,r=(e-n)/2,i=(t-n)/2;return[[new E(r+n*.25,i+n*.52),new E(r+n*.45,i+n*.82)],[new E(r+n*.45,i+n*.82),new E(r+n*.82,i+n*.22)]]}function _T({bounds:e,zoomLevel:t,className:n}){return m.jsx("g",{className:n,pointerEvents:"none",strokeLinecap:"round",strokeLinejoin:"round",children:e.sides.map((r,i)=>{const{strokeDasharray:o,strokeDashoffset:s}=Gn(r[0].dist(r[1]),1/t,{style:"dashed",lengthRatio:4});return m.jsx("line",{x1:r[0].x,y1:r[0].y,x2:r[1].x,y2:r[1].y,strokeDasharray:o,strokeDashoffset:s},i)})})}class dd extends hi{constructor(){super(...arguments);v(this,"type","group");v(this,"hideSelectionBoundsBg",()=>!1);v(this,"hideSelectionBoundsFg",()=>!0);v(this,"canBind",()=>!1);v(this,"onChildrenChange",n=>{const r=this.editor.getSortedChildIds(n.id);if(r.length===0){this.editor.pageState.focusLayerId===n.id&&this.editor.popFocusLayer(),this.editor.deleteShapes([n.id]);return}else if(r.length===1){this.editor.pageState.focusLayerId===n.id&&this.editor.popFocusLayer(),this.editor.reparentShapesById(r,n.parentId),this.editor.deleteShapes([n.id]);return}})}defaultProps(){return{}}getBounds(n){const r=this.editor.getSortedChildIds(n.id);if(r.length===0)return new me;const i=r.flatMap(o=>{const s=this.editor.getShapeById(o);return this.editor.getOutlineById(o).map(a=>ie.applyToPoint(this.editor.getTransform(s),a))});return me.FromPoints(i)}getCenter(n){return this.bounds(n).center}getOutline(n){return this.bounds(n).corners}render(n){const{erasingIdsSet:r,pageState:{hintingIds:i,focusLayerId:o},zoomLevel:s}=this.editor,a=r.has(n.id),l=i.length>0&&i.some(u=>{var d;return u!==n.id&&((d=this.editor.getShapeById(u))==null?void 0:d.type)==="group"});if(!a&&(n.id!==o||l))return null;const c=this.bounds(n);return m.jsx(kr,{id:n.id,children:m.jsx(_T,{className:"tl-group",bounds:c,zoomLevel:s})})}indicator(n){const{camera:{z:r}}=this.editor,i=this.bounds(n);return m.jsx(_T,{className:"",bounds:i,zoomLevel:r})}}v(dd,"type","group");const CT=.35,ET=.82;class v_ extends hi{constructor(){super(...arguments);v(this,"hideResizeHandles",n=>qf(n));v(this,"hideRotateHandle",n=>qf(n));v(this,"hideSelectionBoundsBg",n=>qf(n));v(this,"hideSelectionBoundsFg",n=>qf(n));v(this,"onResize",(n,r)=>{const{scaleX:i,scaleY:o}=r,s=[];for(const a of n.props.segments)s.push({...a,points:a.points.map(({x:l,y:c,z:u})=>({x:i*l,y:o*c,z:u}))});return{props:{segments:s}}})}defaultProps(){return{segments:[],color:"black",size:"m",isComplete:!1,isPen:!1}}getBounds(n){return me.FromPoints(this.outline(n))}getOutline(n){return Oa(n.props.segments)}getCenter(n){return this.bounds(n).center}hitTestPoint(n,r){const i=this.outline(n),o=this.editor.zoomLevel,s=ps(n)/o;if(n.props.segments.length===1&&n.props.segments[0].points.length<4&&n.props.segments[0].points.some(a=>E.Dist(r,a)<s*1.5))return!0;if(this.bounds(n).containsPoint(r))for(let a=0;a<i.length;a++){const l=i[a],c=i[(a+1)%i.length];if(E.DistanceToLineSegment(l,c,r)<s)return!0}return!1}hitTestLineSegment(n,r,i){const o=this.outline(n);if(n.props.segments.length===1&&n.props.segments[0].points.length<4){const s=this.editor.zoomLevel,a=ps(n)/s;if(n.props.segments[0].points.some(l=>E.DistanceToLineSegment(r,i,l)<a*1.5))return!0}for(let s=0;s<o.length-1;s++){const a=o[s],l=o[s+1];if(to(r,i,a,l))return!0}return!1}render(n){return m.jsx(kT,{strokeWidth:ps(n),shape:n,opacity:CT})}renderBackground(n){return m.jsx(kT,{strokeWidth:ps(n),shape:n,opacity:ET})}indicator(n){var d;const r=Xa(),i=ps(n),o=Oa(n.props.segments);let s=i;!r&&!n.props.isPen&&o.length===1&&(s+=fc(n.id)()*(i/6));const a=n.props.isComplete||((d=Kn(n.props.segments))==null?void 0:d.type)==="straight",l=q5({strokeWidth:i,showAsComplete:a,isPen:n.props.isPen}),c=zs(o,l);let u;return c.length<2?u=$Q(o[0],s):u=Fa(c,!1),m.jsx("path",{d:u})}expandSelectionOutlinePx(n){return ps(n)/2}toSvg(n,r,i){return TT(ps(n),n,CT,i)}toBackgroundSvg(n,r,i){return TT(ps(n),n,ET,i)}}v(v_,"type","highlight");function IQ(e){return`M ${e.x} ${e.y} m -${.1}, 0 a ${.1},${.1} 0 1,0 ${.1*2},0 a ${.1},${.1} 0 1,0 -${.1*2},0`}function $Q(e,t){const n=t/2;return`M ${e.x} ${e.y} m -${n}, 0 a ${n},${n} 0 1,0 ${n*2},0 a ${n},${n} 0 1,0 -${n*2},0`}function i6(e,t,n){var c;const r=Oa(e.props.segments),i=e.props.isComplete||((c=Kn(e.props.segments))==null?void 0:c.type)==="straight";let o=t;!n&&!e.props.isPen&&r.length===1&&(o+=fc(e.id)()*(t/6));const s=q5({strokeWidth:o,showAsComplete:i,isPen:e.props.isPen}),a=zs(r,s);return{solidStrokePath:a.length>1?Fa(a,!1):IQ(r[0]),sw:o}}function kT({strokeWidth:e,shape:t,opacity:n}){const r=Xa(),{solidStrokePath:i,sw:o}=i6(t,e,r);return m.jsx(kr,{id:t.id,style:{opacity:n},children:m.jsx("path",{d:i,strokeLinecap:"round",fill:"none",pointerEvents:"all",stroke:`var(--palette-${t.props.color}-highlight)`,strokeWidth:o})})}function TT(e,t,n,r){const{solidStrokePath:i,sw:o}=i6(t,e,!1),s=document.createElementNS("http://www.w3.org/2000/svg","path");return s.setAttribute("d",i),s.setAttribute("fill","none"),s.setAttribute("stroke",r.highlight[t.props.color]),s.setAttribute("stroke-width",`${o}`),s.setAttribute("opacity",`${n}`),s}function ps(e){return Is[e.props.size]*1.12}function qf(e){return e.props.segments.length===1&&e.props.segments[0].points.length<2}function PT(e){const t=re();return ye("isCropping",()=>t.croppingId===e,[t,e])}const AQ=async e=>new Promise((t,n)=>{const r=new Image;r.onload=()=>t(r),r.onerror=()=>n(new Error("Failed to load image")),r.crossOrigin="anonymous",r.src=e}),MQ=async e=>{const t=await AQ(e),n=document.createElement("canvas");n.width=t.width,n.height=t.height;const r=n.getContext("2d");if(r)return r.drawImage(t,0,0),n.toDataURL()};async function OQ(e){const n=await(await fetch(e)).blob();return new Promise((r,i)=>{const o=new FileReader;o.onloadend=()=>r(o.result),o.onerror=i,o.readAsDataURL(n)})}class x_ extends Qc{constructor(){super(...arguments);v(this,"isAspectRatioLocked",()=>!0);v(this,"canCrop",()=>!0);v(this,"onDoubleClick",n=>{const r=n.props.assetId?this.editor.getAssetById(n.props.assetId):void 0;!r||!(r.props.src&&"mimeType"in r.props&&r.props.mimeType==="image/gif")||this.editor.updateShapes([{type:"image",id:n.id,props:{playing:!n.props.playing}}])});v(this,"onDoubleClickEdge",n=>{const r=n.props;if(!r||this.editor.croppingId!==n.id)return;const i=pr(r.crop)||{topLeft:{x:0,y:0},bottomRight:{x:1,y:1}},o=1/(i.bottomRight.x-i.topLeft.x)*n.props.w,s=1/(i.bottomRight.y-i.topLeft.y)*n.props.h,a=new E(i.topLeft.x*o,i.topLeft.y*s).rot(n.rotation),l={id:n.id,type:n.type,x:n.x-a.x,y:n.y-a.y,props:{crop:{topLeft:{x:0,y:0},bottomRight:{x:1,y:1}},w:o,h:s}};this.editor.updateShapes([l])})}defaultProps(){return{w:100,h:100,assetId:null,playing:!0,url:"",crop:null}}render(n){var p,g;const r=IT(n),i=PT(n.id),o=x5(),[s,a]=b.useState(""),{w:l,h:c}=n.props,u=n.props.assetId?this.editor.getAssetById(n.props.assetId):void 0;if((u==null?void 0:u.type)==="bookmark")throw Error("Bookmark assets can't be rendered as images");const h=ye("onlySelectedShape",()=>{var y;return n.id===((y=this.editor.onlySelectedShape)==null?void 0:y.id)},[this.editor])&&i&&this.editor.isInAny("select.crop","select.cropping","select.pointing_crop_handle"),f=o&&(((p=u==null?void 0:u.props.mimeType)==null?void 0:p.includes("video"))||((g=u==null?void 0:u.props.mimeType)==null?void 0:g.includes("gif")));return b.useEffect(()=>{if(u!=null&&u.props.src&&"mimeType"in u.props&&(u==null?void 0:u.props.mimeType)==="image/gif"){let y=!1;return(async()=>{const w=await MQ(u.props.src);y||w&&a(w)})(),()=>{y=!0}}},[o,u==null?void 0:u.props]),m.jsxs(m.Fragment,{children:[(u==null?void 0:u.props.src)&&h&&m.jsx("div",{style:r,children:m.jsx("div",{className:`tl-image tl-image-${n.id}-crop`,style:{opacity:.1,backgroundImage:`url(${!n.props.playing||f?s:u.props.src})`},draggable:!1})}),m.jsx(Ic,{id:n.id,style:{overflow:"hidden"},children:m.jsxs("div",{className:"tl-image-container",style:r,children:[u!=null&&u.props.src?m.jsx("div",{className:`tl-image tl-image-${n.id}`,style:{backgroundImage:`url(${!n.props.playing||f?s:u.props.src})`},draggable:!1}):m.jsx("g",{transform:`translate(${(l-38)/2}, ${(c-38)/2})`,children:m.jsx(Ty,{})}),(u==null?void 0:u.props.isAnimated)&&!n.props.playing&&m.jsx("div",{className:"tl-image__tg",children:"GIF"})]})}),"url"in n.props&&n.props.url&&m.jsx(Nh,{url:n.props.url,zoomLevel:this.editor.zoomLevel})]})}indicator(n){return PT(n.id)?null:m.jsx("rect",{width:Y(n.props.w),height:Y(n.props.h)})}async toSvg(n){const r=document.createElementNS("http://www.w3.org/2000/svg","g"),i=n.props.assetId?this.editor.getAssetById(n.props.assetId):null;let o=(i==null?void 0:i.props.src)||"";o&&o.startsWith("http")&&(o=await OQ(o)||"");const s=document.createElementNS("http://www.w3.org/2000/svg","image");s.setAttributeNS("http://www.w3.org/1999/xlink","href",o);const a=IT(n),l=n.props.crop;if(a&&l){const{transform:c,width:u,height:d}=a,h=[new E(l.topLeft.x*u,l.topLeft.y*d),new E(l.bottomRight.x*u,l.topLeft.y*d),new E(l.bottomRight.x*u,l.bottomRight.y*d),new E(l.topLeft.x*u,l.bottomRight.y*d)],f=document.createElementNS("http://www.w3.org/2000/svg","g");f.style.clipPath=`polygon(${h.map(p=>`${p.x}px ${p.y}px`).join(",")})`,s.setAttribute("width",u.toString()),s.setAttribute("height",d.toString()),s.style.transform=c,f.appendChild(s),r.appendChild(f)}else s.setAttribute("width",n.props.w.toString()),s.setAttribute("height",n.props.h.toString()),r.appendChild(s);return r}}v(x_,"type","image");function IT(e){const t=e.props.crop,n=t==null?void 0:t.topLeft;if(!n)return;const r=1/(t.bottomRight.x-t.topLeft.x)*e.props.w,i=1/(t.bottomRight.y-t.topLeft.y)*e.props.h,o=-n.x*r,s=-n.y*i;return{transform:`translate(${o}px, ${s}px)`,width:r,height:i}}function o6(e){const{segments:t}=e,n=[];for(let r=0,i=t.length;r<i;r++){const s=t[r].lut,a=s.length-1;r>0?n.push(E.Lrp(s[0],s[1],.25)):n.push(s[0]);for(let l=1;l<a;l++)n.push(s[l]);r<i-1?n.push(E.Lrp(s[a-1],s[a],.75)):n.push(s[a])}return n}function s6(e){return{size:e,thinning:.4,streamline:0,smoothing:.5,simulatePressure:!0,last:!0}}function a6(e,t,n){const r=o6(t),i=s6(n);return zs(r,i)}function LQ(e,t,n){const r=s6(n);return zd(Ud(a6(e,t,n),r),r)}function l6(e,t,n){const r=LQ(e,t,n);return Yd(r)}function BQ(e,t,n){if(e.props.dash==="draw"){const r=a6(e,t,n);return Fa(r)}return t.path}function RQ({shape:e,strokeWidth:t,spline:n,color:r}){const i=l6(e,n,t),o=document.createElementNS("http://www.w3.org/2000/svg","path");return o.setAttribute("stroke-width","0"),o.setAttribute("stroke","none"),o.setAttribute("fill",r),o.setAttribute("d",i),o}function DQ({dash:e,strokeWidth:t,spline:n,color:r}){const{segments:i}=n,o=document.createElementNS("http://www.w3.org/2000/svg","g");return o.setAttribute("stroke",r),o.setAttribute("stroke-width",t.toString()),i.forEach((s,a)=>{const l=document.createElementNS("http://www.w3.org/2000/svg","path"),{strokeDasharray:c,strokeDashoffset:u}=Gn(s.length,t,{style:e,start:a>0?"outset":"none",end:a<i.length-1?"outset":"none"});l.setAttribute("stroke-dasharray",c.toString()),l.setAttribute("stroke-dashoffset",u.toString()),l.setAttribute("d",s.path),l.setAttribute("fill","none"),o.appendChild(l)}),o}function FQ({strokeWidth:e,spline:t,color:n}){const{path:r}=t,i=document.createElementNS("http://www.w3.org/2000/svg","path");return i.setAttribute("stroke-width",e.toString()),i.setAttribute("stroke",n),i.setAttribute("fill","none"),i.setAttribute("d",r),i}function NQ(e,t,n,r){switch(e.props.dash){case"draw":return RQ({shape:e,strokeWidth:r,spline:t,color:n});case"solid":return FQ({strokeWidth:r,spline:t,color:n});default:return DQ({strokeWidth:r,spline:t,dash:e.props.dash,color:n})}}const jQ=new Zc,zQ=new Zc;class b_ extends hi{constructor(){super(...arguments);v(this,"hideResizeHandles",()=>!0);v(this,"hideRotateHandle",()=>!0);v(this,"hideSelectionBoundsBg",()=>!0);v(this,"hideSelectionBoundsFg",()=>!0);v(this,"isClosed",()=>!1);v(this,"onResize",(n,r)=>{const{scaleX:i,scaleY:o}=r,s=pr(n.props.handles);return Object.values(n.props.handles).forEach(({id:a,x:l,y:c})=>{s[a].x=l*i,s[a].y=c*o}),{props:{handles:s}}});v(this,"onHandleChange",(n,{handle:r})=>{const i=pr(n);switch(r.id){case"start":case"end":{i.props.handles[r.id]={...i.props.handles[r.id],x:r.x,y:r.y};break}default:{const o="handle:"+r.index,s=n.props.handles[o];s?i.props.handles[o]={...s,x:r.x,y:r.y}:i.props.handles[o]={id:o,type:"vertex",canBind:!1,index:r.index,x:r.x,y:r.y};break}}return i})}defaultProps(){return{dash:"draw",size:"m",color:"black",spline:"line",handles:{start:{id:"start",type:"vertex",canBind:!1,index:"a1",x:0,y:0},end:{id:"end",type:"vertex",canBind:!1,index:"a2",x:0,y:0}}}}getBounds(n){return _a(n).bounds}getCenter(n){return this.bounds(n).center}getHandles(n){return zQ.get(n.props,()=>{const r=n.props.handles,i=_a(n),o=Object.values(r).sort(ir),s=o.slice();for(let a=0;a<i.segments.length;a++){const c=i.segments[a].getPoint(.5),u=ld(o[a].index,o[a+1].index);s.push({id:`mid-${a}`,type:"create",index:u,x:c.x,y:c.y})}return s.sort(ir)})}getOutline(n){return o6(_a(n))}hitTestPoint(n,r){const i=this.editor.zoomLevel,o=this.editor.getStrokeWidth(n.props.size)/i;return BV(r,this.outline(n),o)}hitTestLineSegment(n,r,i){return JS(r,i,this.outline(n))!==null}render(n){const r=Xa(),i=_a(n),o=this.editor.getStrokeWidth(n.props.size),{dash:s,color:a}=n.props;if(n.props.spline==="line"){if(s==="solid"){const l=i.points,c="M"+l[0]+"L"+l.slice(1);return m.jsxs(kr,{id:n.id,children:[m.jsx(an,{d:c,fill:"none",color:a}),m.jsx("path",{d:c,stroke:"currentColor",strokeWidth:o,fill:"none"})]})}if(s==="dashed"||s==="dotted"){const l=i.points,c="M"+l[0]+"L"+l.slice(1);return m.jsxs(kr,{id:n.id,children:[m.jsx(an,{d:c,fill:"none",color:a}),m.jsx("g",{stroke:"currentColor",strokeWidth:o,children:i.segments.map((u,d)=>{const{strokeDasharray:h,strokeDashoffset:f}=Gn(u.length,o,{style:s,start:d>0?"outset":"none",end:d<i.segments.length-1?"outset":"none"});return m.jsx("path",{strokeDasharray:h,strokeDashoffset:f,d:u.path,fill:"none"},d)})})]})}if(s==="draw"){const l=i.points,[c,u]=Ok(n.id,l,o);return m.jsxs(kr,{id:n.id,children:[m.jsx(an,{d:c,fill:"none",color:a}),m.jsx("path",{d:u,stroke:"currentColor",strokeWidth:o,fill:"none"})]})}}if(n.props.spline==="cubic"){const l=i.path;if(s==="solid"||s==="draw"&&r)return m.jsxs(kr,{id:n.id,children:[m.jsx(an,{d:l,fill:"none",color:a}),m.jsx("path",{strokeWidth:o,stroke:"currentColor",fill:"none",d:l})]});if(s==="dashed"||s==="dotted")return m.jsxs(kr,{id:n.id,children:[m.jsx(an,{d:l,fill:"none",color:a}),m.jsx("g",{stroke:"currentColor",strokeWidth:o,children:i.segments.map((c,u)=>{const{strokeDasharray:d,strokeDashoffset:h}=Gn(c.length,o,{style:s,start:u>0?"outset":"none",end:u<i.segments.length-1?"outset":"none"});return m.jsx("path",{strokeDasharray:d,strokeDashoffset:h,d:c.path,fill:"none"},u)})})]});if(s==="draw")return m.jsxs(kr,{id:n.id,children:[m.jsx(an,{d:l,fill:"none",color:a}),m.jsx("path",{d:l6(n,i,o),strokeWidth:1,stroke:"currentColor",fill:"currentColor"})]})}}indicator(n){const r=this.editor.getStrokeWidth(n.props.size),i=_a(n),{dash:o}=n.props;let s;if(n.props.spline==="line"){const a=i.points;if(o==="solid"||o==="dotted"||o==="dashed")s="M"+a[0]+"L"+a.slice(1);else{const[l]=Ok(n.id,a,r);s=l}}else s=BQ(n,i,r);return m.jsx("path",{d:s})}toSvg(n,r,i){const{color:o,size:s}=n.props,a=i.fill[o],l=_a(n);return NQ(n,l,a,this.editor.getStrokeWidth(s))}}v(b_,"type","line");function _a(e){return jQ.get(e.props,()=>{const{spline:t,handles:n}=e.props,r=Object.values(n).sort(ir).map(E.From);switch(t){case"cubic":return new XS(r,r.length===2?2:1.2,20);case"line":return new ZS(r)}})}const Hi=200;class w_ extends hi{constructor(){super(...arguments);v(this,"canEdit",()=>!0);v(this,"hideResizeHandles",()=>!0);v(this,"hideSelectionBoundsBg",()=>!0);v(this,"hideSelectionBoundsFg",()=>!0);v(this,"onBeforeCreate",n=>$T(this.editor,n,n.props.growY));v(this,"onBeforeUpdate",(n,r)=>{if(!(n.props.text===r.props.text&&n.props.font===r.props.font&&n.props.size===r.props.size))return $T(this.editor,r,n.props.growY)});v(this,"onEditEnd",n=>{const{id:r,type:i,props:{text:o}}=n;o.trimEnd()!==n.props.text&&this.editor.updateShapes([{id:r,type:i,props:{text:o.trimEnd()}}])})}defaultProps(){return{color:"black",size:"m",text:"",font:"draw",align:"middle",verticalAlign:"middle",growY:0,url:""}}getHeight(n){return Hi+n.props.growY}getBounds(n){const r=this.getHeight(n);return new me(0,0,Hi,r)}getOutline(n){return this.bounds(n).corners}getCenter(n){return new E(Hi/2,this.getHeight(n)/2)}render(n){const{id:r,type:i,props:{color:o,font:s,size:a,align:l,text:c,verticalAlign:u}}=n,d=o==="black"?"yellow":o;return m.jsxs(m.Fragment,{children:[m.jsx("div",{style:{position:"absolute",width:Hi,height:this.getHeight(n)},children:m.jsxs("div",{className:"tl-note__container tl-hitarea-fill",style:{color:`var(--palette-${d})`,backgroundColor:`var(--palette-${d})`},children:[m.jsx("div",{className:"tl-note__scrim"}),m.jsx(Q5,{id:r,type:i,font:s,size:a,align:l,verticalAlign:u,text:c,labelColor:"inherit",wrap:!0})]})}),"url"in n.props&&n.props.url&&m.jsx(Nh,{url:n.props.url,zoomLevel:this.editor.zoomLevel})]})}indicator(n){return m.jsx("rect",{rx:"7",width:Y(Hi),height:Y(this.getHeight(n))})}toSvg(n,r,i){const o=this.bounds(n),s=document.createElementNS("http://www.w3.org/2000/svg","g"),a=n.props.color==="black"?"yellow":n.props.color,l=document.createElementNS("http://www.w3.org/2000/svg","rect");l.setAttribute("rx","10"),l.setAttribute("width",Hi.toString()),l.setAttribute("height",o.height.toString()),l.setAttribute("fill",i.fill[a]),l.setAttribute("stroke",i.fill[a]),l.setAttribute("stroke-width","1"),s.appendChild(l);const c=document.createElementNS("http://www.w3.org/2000/svg","rect");c.setAttribute("rx","10"),c.setAttribute("width",Hi.toString()),c.setAttribute("height",o.height.toString()),c.setAttribute("fill",i.background),c.setAttribute("opacity",".28"),s.appendChild(c);const u=Z5({editor:this.editor,shape:n,font:r,bounds:o});return u.setAttribute("fill",i.text),u.setAttribute("stroke","none"),s.appendChild(u),s}}v(w_,"type","note");function $T(e,t,n=0){const o=e.textMeasure.measureText(t.props.text,{...yn,fontFamily:Mo[t.props.font],fontSize:Da[t.props.size],width:Hi-34+"px"}).h+17*2;let s=null;if(o>Hi?s=o-Hi:n&&(s=0),s!==null)return{...t,props:{...t.props,growY:s}}}function UQ(e,{initialBounds:t,scaleX:n,scaleY:r,newPoint:i}){const o=Math.max(.01,Math.min(Math.abs(n),Math.abs(r))),s=new E(0,0);n<0&&(s.x=-(t.width*o)),r<0&&(s.y=-(t.height*o));const{x:a,y:l}=E.Add(i,s.rot(e.rotation));return{x:a,y:l,props:{scale:o*e.props.scale}}}const WQ=new Zc;class cl extends hi{constructor(){super(...arguments);v(this,"canEdit",()=>!0);v(this,"isAspectRatioLocked",()=>!0);v(this,"onResize",(n,r)=>{const{initialBounds:i,initialShape:o,scaleX:s,handle:a}=r;if(r.mode==="scale_shape"||a!=="right"&&a!=="left")return UQ(n,r);{const l=i.width;let c=l*s;const u=new E(0,0);c=Math.max(1,Math.abs(c)),a==="left"?(u.x=l-c,s<0&&(u.x+=c)):s<0&&(u.x-=c);const{x:d,y:h}=u.rot(n.rotation).add(o);return{x:d,y:h,props:{w:c/o.props.scale,autoSize:!1}}}});v(this,"onBeforeCreate",n=>{if(!n.props.autoSize||n.props.text.trim())return;const r=this.getMinDimensions(n);return{...n,x:n.x-r.width/2,y:n.y-r.height/2}});v(this,"onEditEnd",n=>{const{id:r,type:i,props:{text:o}}=n,s=n.props.text.trimEnd();s.length===0?this.editor.deleteShapes([n.id]):s!==n.props.text&&this.editor.updateShapes([{id:r,type:i,props:{text:o.trimEnd()}}])});v(this,"onBeforeUpdate",(n,r)=>{if(!r.props.autoSize)return;const i=n.props.size!==r.props.size||n.props.align!==r.props.align||n.props.font!==r.props.font||n.props.scale!==1&&r.props.scale===1,o=n.props.text!==r.props.text;if(!i&&!o)return;const s=this.getMinDimensions(n),a=AT(this.editor,r.props),l=s.width*n.props.scale,c=s.height*n.props.scale,u=a.width*r.props.scale,d=a.height*r.props.scale;let h;switch(r.props.align){case"middle":{h=new E((u-l)/2,o?0:(d-c)/2);break}case"end":{h=new E(u-l,o?0:(d-c)/2);break}default:{if(o)break;h=new E(0,(d-c)/2);break}}if(h){h.rot(r.rotation);const{x:f,y:p}=r;return{...r,x:f-h.x,y:p-h.y,props:{...r.props,w:u}}}else return{...r,props:{...r.props,w:u}}});v(this,"onDoubleClickEdge",n=>{if(!n.props.autoSize)return{id:n.id,type:n.type,props:{autoSize:!0}};if(n.props.scale!==1)return{id:n.id,type:n.type,props:{scale:1}}})}defaultProps(){return{color:"black",size:"m",w:8,text:"",font:"draw",align:"middle",autoSize:!0,scale:1}}getMinDimensions(n){return WQ.get(n.props,r=>AT(this.editor,r))}getBounds(n){const{scale:r}=n.props,{width:i,height:o}=this.getMinDimensions(n);return new me(0,0,i*r,o*r)}getOutline(n){const r=this.bounds(n);return[new E(0,0),new E(r.width,0),new E(r.width,r.height),new E(0,r.height)]}getCenter(n){const r=this.bounds(n);return new E(r.width/2,r.height/2)}render(n){const{id:r,type:i,props:{text:o}}=n,{width:s,height:a}=this.getMinDimensions(n),{rInput:l,isEmpty:c,isEditing:u,isEditableFromHover:d,handleFocus:h,handleChange:f,handleKeyDown:p,handleBlur:g}=h_(r,i,o);return m.jsx(Ic,{id:n.id,children:m.jsxs("div",{className:"tl-text-shape__wrapper tl-text-shadow","data-font":n.props.font,"data-align":n.props.align,"data-hastext":!c,"data-isediting":u||d,"data-textwrap":!0,style:{fontSize:Is[n.props.size],lineHeight:Is[n.props.size]*yn.lineHeight+"px",transform:`scale(${n.props.scale})`,transformOrigin:"top left",width:Math.max(1,s),height:Math.max(Is[n.props.size]*yn.lineHeight,a)},children:[m.jsx("div",{className:"tl-text tl-text-content",dir:"ltr",children:o}),u||d?m.jsx("textarea",{ref:l,className:"tl-text tl-text-input",name:"text",tabIndex:-1,autoComplete:"false",autoCapitalize:"false",autoCorrect:"false",autoSave:"false",autoFocus:u,placeholder:"",spellCheck:"true",wrap:"off",dir:"ltr",datatype:"wysiwyg",defaultValue:o,onFocus:h,onChange:f,onKeyDown:p,onBlur:g,onTouchEnd:Qi,onContextMenu:Qi}):null]})})}indicator(n){const r=this.bounds(n);return m.jsx("rect",{width:Y(r.width),height:Y(r.height)})}toSvg(n,r,i){const o=this.bounds(n),s=n.props.text,a=o.width/(n.props.scale??1),l=o.height/(n.props.scale??1),c={fontSize:Is[n.props.size],fontFamily:r,textAlign:n.props.align,verticalTextAlign:"middle",width:a,height:l,padding:0,lineHeight:yn.lineHeight,fontStyle:"normal",fontWeight:"normal",overflow:"wrap"},u=i.fill[n.props.color],d=document.createElementNS("http://www.w3.org/2000/svg","g"),h=Iy(this.editor,this.editor.textMeasure.measureTextSpans(s,c),{...c,stroke:i.background,strokeWidth:2,fill:i.background,padding:0}),f=h.cloneNode(!0);return f.setAttribute("fill",u),f.setAttribute("stroke","none"),d.append(h),d.append(f),d}}v(cl,"type","text");function AT(e,t){const{font:n,text:r,autoSize:i,size:o,w:s}=t,a=16,l=Is[o],c=i?"fit-content":Math.floor(Math.max(a,s))+"px",u=e.textMeasure.measureText(r,{...yn,fontFamily:Mo[n],fontSize:l,width:c});return i&&(u.w+=1),{width:Math.max(a,u.w),height:Math.max(l,u.h)}}class c6 extends Qc{constructor(){super(...arguments);v(this,"canEdit",()=>!0);v(this,"isAspectRatioLocked",()=>!0)}defaultProps(){return{w:100,h:100,assetId:null,time:0,playing:!0,url:""}}render(n){return m.jsx(KQ,{shape:n,videoUtil:this})}indicator(n){return m.jsx("rect",{width:Y(n.props.w),height:Y(n.props.h)})}toSvg(n){const r=document.createElementNS("http://www.w3.org/2000/svg","g"),i=document.createElementNS("http://www.w3.org/2000/svg","image");return i.setAttributeNS("http://www.w3.org/1999/xlink","href",HQ(n.id)),i.setAttribute("width",n.props.w.toString()),i.setAttribute("height",n.props.h.toString()),r.appendChild(i),r}}v(c6,"type","video");function HQ(e){const t=e.split(":")[1],n=document.querySelector(`.tl-video-shape-${t}`);if(n){const r=document.createElement("canvas");return r.width=n.videoWidth,r.height=n.videoHeight,r.getContext("2d").drawImage(n,0,0),r.toDataURL("image/png")}else throw new Error("Video with id "+t+" not found")}const KQ=Ke(function(t){const{shape:n,videoUtil:r}=t,i=r.editor.getBounds(n).w*r.editor.zoomLevel>=110,o=n.props.assetId?r.editor.getAssetById(n.props.assetId):null,{w:s,h:a,time:l,playing:c}=n.props,u=p_(n.id),d=x5(),h=b.useRef(null),f=b.useCallback(_=>{const S=_.currentTarget;r.editor.updateShapes([{type:"video",id:n.id,props:{playing:!0,time:S.currentTime}}])},[n.id,r.editor]),p=b.useCallback(_=>{const S=_.currentTarget;r.editor.updateShapes([{type:"video",id:n.id,props:{playing:!1,time:S.currentTime}}])},[n.id,r.editor]),g=b.useCallback(_=>{const S=_.currentTarget;u&&r.editor.updateShapes([{type:"video",id:n.id,props:{time:S.currentTime}}])},[u,n.id,r.editor]),[y,x]=b.useState(!1),w=b.useCallback(_=>{const S=_.currentTarget;l!==S.currentTime&&(S.currentTime=l),c||S.pause(),x(!0)},[c,l]);return b.useEffect(()=>{const _=h.current;_&&y&&!u&&l!==_.currentTime&&(_.currentTime=l)},[u,y,l]),b.useEffect(()=>{if(d){const _=h.current;_.pause(),_.currentTime=0}},[h,d]),m.jsxs(m.Fragment,{children:[m.jsx(Ic,{id:n.id,children:m.jsx("div",{className:"tl-counter-scaled",children:o!=null&&o.props.src?m.jsx("video",{ref:h,className:`tl-video tl-video-shape-${n.id.split(":")[1]} tl-hitarea-stroke`,width:"100%",height:"100%",draggable:!1,playsInline:!0,autoPlay:!0,muted:!0,loop:!0,disableRemotePlayback:!0,disablePictureInPicture:!0,controls:u&&i,onPlay:f,onPause:p,onTimeUpdate:g,onLoadedData:w,hidden:!y,children:m.jsx("source",{src:o.props.src})}):m.jsx("g",{transform:`translate(${(s-38)/2}, ${(a-38)/2})`,children:m.jsx(Ty,{})})})}),"url"in n.props&&n.props.url&&m.jsx(Nh,{url:n.props.url,zoomLevel:r.editor.zoomLevel})]})}),VQ={group:{util:dd},embed:{util:$c},bookmark:{util:Jc},image:{util:x_},video:{util:c6},text:{util:cl}},YQ={draw:{util:f_},geo:{util:y_},line:{util:b_},note:{util:w_},frame:{util:mc},arrow:{util:Qt},highlight:{util:v_}},qQ={wheel:"onWheel",pointer_enter:"onPointerEnter",pointer_leave:"onPointerLeave",pointer_down:"onPointerDown",pointer_move:"onPointerMove",pointer_up:"onPointerUp",right_click:"onRightClick",middle_click:"onMiddleClick",key_down:"onKeyDown",key_up:"onKeyUp",key_repeat:"onKeyRepeat",cancel:"onCancel",complete:"onComplete",interrupt:"onInterrupt",double_click:"onDoubleClick",triple_click:"onTripleClick",quadruple_click:"onQuadrupleClick"};class ve{constructor(t,n){v(this,"path");v(this,"id");v(this,"current");v(this,"type");v(this,"styles",[]);v(this,"shapeType");v(this,"initial");v(this,"children");v(this,"parent");v(this,"isActive",!1);v(this,"onWheel");v(this,"onPointerEnter");v(this,"onPointerLeave");v(this,"onPointerDown");v(this,"onPointerMove");v(this,"onPointerUp");v(this,"onDoubleClick");v(this,"onTripleClick");v(this,"onQuadrupleClick");v(this,"onRightClick");v(this,"onMiddleClick");v(this,"onKeyDown");v(this,"onKeyUp");v(this,"onKeyRepeat");v(this,"onCancel");v(this,"onComplete");v(this,"onInterrupt");v(this,"onEnter");v(this,"onExit");this.editor=t;const{id:r,children:i,initial:o}=this.constructor;this.id=r,this.current=jt("toolState"+this.id,void 0),this.path=ce("toolPath"+this.id,()=>{const s=this.current.value;return this.id+(s?`.${s.path.value}`:"")}),this.parent=n??{},this.parent?i&&o?(this.type="branch",this.initial=o,this.children=Object.fromEntries(i().map(s=>[s.id,new s(this.editor,this)])),this.current.set(this.children[this.initial])):this.type="leaf":(this.type="root",i&&o&&(this.initial=o,this.children=Object.fromEntries(i().map(s=>[s.id,new s(this.editor,this)])),this.current.set(this.children[this.initial])))}transition(t,n){var o;const r=t.split(".");let i=this;for(let s=0;s<r.length;s++){const a=r[s],l=i.current.value,c=(o=i.children)==null?void 0:o[a];if(!c)throw Error(`${i.id} - no child state exists with the id ${a}.`);if((l==null?void 0:l.id)!==c.id&&(l==null||l.exit(n,a),i.current.set(c),c.enter(n,(l==null?void 0:l.id)||"initial"),!c.isActive))break;i=c}return this}handleEvent(t){var i;const n=qQ[t.name],r=this.current.value;(i=this[n])==null||i.call(this,t),this.current.value===r&&this.isActive&&(r==null||r.handleEvent(t))}enter(t,n){var r;if(this.isActive=!0,(r=this.onEnter)==null||r.call(this,t,n),this.children&&this.initial&&this.isActive){const i=this.children[this.initial];this.current.set(i),i.enter(t,n)}}exit(t,n){var r,i;this.isActive=!1,(r=this.onExit)==null||r.call(this,t,n),this.isActive||(i=this.current.value)==null||i.exit(t,n)}}v(ve,"id"),v(ve,"initial"),v(ve,"children");var O1;let GQ=(O1=class extends ve{constructor(){super(...arguments);v(this,"onPointerDown",n=>{this.parent.transition("pointing",n)});v(this,"onEnter",()=>{this.editor.setCursor({type:"cross"})});v(this,"onCancel",()=>{this.editor.setSelectedTool("select")})}},v(O1,"id","idle"),O1);var L1;let XQ=(L1=class extends ve{constructor(){super(...arguments);v(this,"shape");v(this,"preciseTimeout",-1);v(this,"didTimeout",!1);v(this,"onEnter",()=>{var l,c,u;const{inputs:{currentPagePoint:n}}=this.editor;this.didTimeout=!1;const r=this.parent.shapeType;this.editor.mark("creating");const i=gt();this.editor.createShapes([{id:i,type:r,x:n.x,y:n.y}]);const o=this.editor.getShapeUtil(Qt),s=this.editor.getShapeById(i);if(!s)return;const a=(l=o.handles)==null?void 0:l.call(o,s);if(a){const d=this.editor.getPointInShapeSpace(s,n),h=(c=o.onHandleChange)==null?void 0:c.call(o,s,{handle:{...a[0],x:d.x,y:d.y},isPrecise:!0});if(h){const f=(u=h.props)==null?void 0:u.start;(f==null?void 0:f.type)==="binding"&&this.editor.setHintingIds([f.boundShapeId]),this.editor.updateShapes([h],!0)}}this.editor.select(i),this.shape=this.editor.getShapeById(i),this.startPreciseTimeout()});v(this,"onExit",()=>{this.clearPreciseTimeout()});v(this,"onPointerMove",()=>{var n,r;if(this.shape&&this.editor.inputs.isDragging){const i=this.editor.getShapeUtil(this.shape),o=(n=i.handles)==null?void 0:n.call(i,this.shape);if(!o)throw this.editor.bailToMark("creating"),Error("No handles found");if(!this.didTimeout){const s=this.editor.getShapeUtil(Qt),a=this.editor.getShapeById(this.shape.id);if(!a)return;const l=s.handles(a);if(l){const{x:c,y:u}=this.editor.getPointInShapeSpace(a,this.editor.inputs.originPagePoint),d=(r=s.onHandleChange)==null?void 0:r.call(s,a,{handle:{...l[0],x:c,y:u},isPrecise:!1});d&&this.editor.updateShapes([d],!0)}}this.editor.setSelectedTool("select.dragging_handle",{shape:this.shape,handle:o.find(s=>s.id==="end"),isCreating:!0,onInteractionEnd:"arrow"})}});v(this,"onPointerUp",()=>{this.cancel()});v(this,"onCancel",()=>{this.cancel()});v(this,"onComplete",()=>{this.cancel()});v(this,"onInterrupt",()=>{this.cancel()})}startPreciseTimeout(){this.preciseTimeout=window.setTimeout(()=>{this.isActive&&this.shape&&(this.didTimeout=!0)},300)}clearPreciseTimeout(){clearTimeout(this.preciseTimeout)}cancel(){this.editor.bailToMark("creating"),this.editor.setHintingIds([]),this.parent.transition("idle",{})}},v(L1,"id","pointing"),L1);class zp extends ve{constructor(){super(...arguments);v(this,"shapeType","arrow");v(this,"styles",["color","dash","size","arrowheadStart","arrowheadEnd","font","fill"])}}v(zp,"id","arrow"),v(zp,"initial","idle"),v(zp,"children",()=>[GQ,XQ]);class S_ extends ve{constructor(){super(...arguments);v(this,"info",{});v(this,"initialShape");v(this,"shapeType",this.parent.id==="highlight"?"highlight":"draw");v(this,"util",this.shapeType==="highlight"?this.editor.getShapeUtil(v_):this.editor.getShapeUtil(f_));v(this,"isPen",!1);v(this,"segmentMode","free");v(this,"didJustShiftClickToExtendPreviousShapeLine",!1);v(this,"pagePointWhereCurrentSegmentChanged",{});v(this,"pagePointWhereNextSegmentChanged",null);v(this,"lastRecordedPoint",{});v(this,"mergeNextPoint",!1);v(this,"currentLineLength",0);v(this,"canDraw",!1);v(this,"onEnter",n=>{this.info=n,this.canDraw=!this.editor.isMenuOpen,this.lastRecordedPoint=this.editor.inputs.currentPagePoint.clone(),this.canDraw&&this.startShape()});v(this,"onPointerMove",()=>{const{editor:{inputs:n}}=this;this.isPen!==n.isPen&&this.cancel(),!this.canDraw&&n.isDragging&&(this.startShape(),this.canDraw=!0),this.canDraw&&(n.isPen?E.Dist(n.currentPagePoint,this.lastRecordedPoint)>=1/this.editor.zoomLevel?(this.lastRecordedPoint=n.currentPagePoint.clone(),this.mergeNextPoint=!1):this.mergeNextPoint=!0:this.mergeNextPoint=!1,this.updateShapes())});v(this,"onKeyDown",n=>{if(n.key==="Shift")switch(this.segmentMode){case"free":{this.segmentMode="starting_straight",this.pagePointWhereNextSegmentChanged=this.editor.inputs.currentPagePoint.clone();break}case"starting_free":this.segmentMode="starting_straight"}this.updateShapes()});v(this,"onKeyUp",n=>{if(n.key==="Shift")switch(this.editor.snaps.clear(),this.segmentMode){case"straight":{this.segmentMode="starting_free",this.pagePointWhereNextSegmentChanged=this.editor.inputs.currentPagePoint.clone();break}case"starting_straight":{this.pagePointWhereNextSegmentChanged=null,this.segmentMode="free";break}}this.updateShapes()});v(this,"onExit",()=>{this.editor.snaps.clear(),this.pagePointWhereCurrentSegmentChanged=this.editor.inputs.currentPagePoint.clone()});v(this,"onPointerUp",()=>{this.complete()});v(this,"onCancel",()=>{this.cancel()});v(this,"onComplete",()=>{this.complete()});v(this,"onInterrupt",()=>{this.editor.inputs.isDragging||(this.editor.bail(),this.cancel())})}canClose(){return this.shapeType!=="highlight"}getIsClosed(n,r){if(!this.canClose())return!1;const i=this.editor.getStrokeWidth(r),o=n[0].points[0],s=n[n.length-1],a=s.points[s.points.length-1];return o!==a&&this.currentLineLength>i*4&&E.Dist(o,a)<i*2}startShape(){const{inputs:{originPagePoint:n,isPen:r}}=this.editor;this.editor.mark("draw create start"),this.isPen=r;const i=this.isPen?this.info.point.z*1.25:.5;if(this.segmentMode=this.editor.inputs.shiftKey?"straight":"free",this.didJustShiftClickToExtendPreviousShapeLine=!1,this.lastRecordedPoint=n.clone(),this.initialShape){const s=this.editor.getShapeById(this.initialShape.id);if(s&&this.segmentMode==="straight"){this.didJustShiftClickToExtendPreviousShapeLine=!0;const a=Kn(s.props.segments);if(!a)throw Error("Expected a previous segment!");const l=Kn(a.points);if(!l)throw Error("Expected a previous point!");const{x:c,y:u}=this.editor.getPointInShapeSpace(s,n).toFixed(),d=this.isPen?this.info.point.z*1.25:.5,h={type:this.segmentMode,points:[{x:l.x,y:l.y,z:+d.toFixed(2)},{x:c,y:u,z:+d.toFixed(2)}]},f=ie.applyToPoint(this.editor.getPageTransformById(s.id),l);this.pagePointWhereCurrentSegmentChanged=f,this.pagePointWhereNextSegmentChanged=null;const p=[...s.props.segments,h];this.currentLineLength=this.getLineLength(p),this.editor.updateShapes([{id:s.id,type:this.shapeType,props:{segments:p,isClosed:this.canClose()?this.getIsClosed(p,s.props.size):void 0}}]);return}}this.pagePointWhereCurrentSegmentChanged=n.clone();const o=gt();this.editor.createShapes([{id:o,type:this.shapeType,x:n.x,y:n.y,props:{isPen:this.isPen,segments:[{type:this.segmentMode,points:[{x:0,y:0,z:+i.toFixed(2)}]}]}}]),this.currentLineLength=0,this.initialShape=this.editor.getShapeById(o)}updateShapes(){const{inputs:n}=this.editor,{initialShape:r}=this;if(!r)return;const{id:i,props:{size:o}}=r,s=this.editor.getShapeById(i);if(!s)return;const{segments:a}=s.props,{x:l,y:c,z:u}=this.editor.getPointInShapeSpace(s,n.currentPagePoint).toFixed(),d={x:l,y:c,z:this.isPen?+(u*1.25).toFixed(2):.5};switch(this.segmentMode){case"starting_straight":{const{pagePointWhereNextSegmentChanged:h}=this;if(h===null)throw Error("We should have a point where the segment changed");if(E.Dist(h,n.currentPagePoint)>Vd){this.pagePointWhereCurrentSegmentChanged=this.pagePointWhereNextSegmentChanged.clone(),this.pagePointWhereNextSegmentChanged=null,this.segmentMode="straight";const p=Kn(a);if(!p)throw Error("Expected a previous segment!");const g=Kn(p.points);if(!g)throw Error("Expected a previous last point!");let y;const x=this.editor.getPointInShapeSpace(s,this.pagePointWhereCurrentSegmentChanged).toFixed().toJson();if(p.type==="straight"){this.currentLineLength+=E.Dist(g,x),y={type:"straight",points:[{...g},x]};const w=this.editor.getPageTransform(s);this.pagePointWhereCurrentSegmentChanged=ie.applyToPoint(w,g)}else y={type:"straight",points:[x,d]};this.editor.updateShapes([{id:i,type:this.shapeType,props:{segments:[...a,y],isClosed:this.canClose()?this.getIsClosed(a,o):void 0}}],!0)}break}case"starting_free":{const{pagePointWhereNextSegmentChanged:h}=this;if(h===null)throw Error("We should have a point where the segment changed");if(E.Dist(h,n.currentPagePoint)>Vd){this.pagePointWhereCurrentSegmentChanged=this.pagePointWhereNextSegmentChanged.clone(),this.pagePointWhereNextSegmentChanged=null,this.segmentMode="free";const p=a.slice(),g=p[p.length-1],y=Kn(g.points);if(!y)throw Error("No previous point!");const x={type:"free",points:[...E.PointsBetween(y,d,6).map(_=>_.toFixed().toJson())]},w=[...p,x];this.currentLineLength=this.getLineLength(w),this.editor.updateShapes([{id:i,type:this.shapeType,props:{segments:w,isClosed:this.canClose()?this.getIsClosed(w,o):void 0}}],!0)}break}case"straight":{const h=a.slice(),f=h[h.length-1],{pagePointWhereCurrentSegmentChanged:p}=this,{currentPagePoint:g,ctrlKey:y}=this.editor.inputs;if(!p)throw Error("We should have a point where the segment changed");let x,w=!1;this.didJustShiftClickToExtendPreviousShapeLine?this.editor.inputs.isDragging&&(w=!y,this.didJustShiftClickToExtendPreviousShapeLine=!1):w=!y;let _=this.editor.getPointInShapeSpace(s,g).toFixed().toJson(),S=!1,T;if((this.editor.isSnapMode?!y:y)&&h.length>2){let I,$=8/this.editor.zoomLevel;for(let L=0,R=a.length-2;L<R;L++){const K=a[L];if(!K)break;if(K.type==="free")continue;const Q=K.points[0],j=Kn(K.points);if(!(Q&&j))continue;const B=E.NearestPointOnLineSegment(Q,j,_),z=E.Dist(B,_);if(z<$){I=B.toFixed().toJson(),$=z,T=K;break}}I&&(S=!0,_=I)}if(S&&T){const I=this.editor.getPageTransform(s),$=T.points[0],L=Kn(T.points);if(!L)throw Error("Expected a last point!");const R=ie.applyToPoint(I,$),K=ie.applyToPoint(I,L),Q=ie.applyToPoint(I,_);this.editor.snaps.setLines([{id:At(),type:"points",points:[R,Q,K]}])}else{if(this.editor.snaps.clear(),w){const I=E.Angle(p,g),L=tm(I,24)-I;x=E.RotWith(g,p,L)}else x=g;_=this.editor.getPointInShapeSpace(s,x).toFixed().toJson()}this.currentLineLength+=E.Dist(f.points[0],_),h[h.length-1]={...f,type:"straight",points:[f.points[0],_]},this.editor.updateShapes([{id:i,type:this.shapeType,props:{segments:h,isClosed:this.canClose()?this.getIsClosed(a,o):void 0}}],!0);break}case"free":{const h=a.slice(),f=h[h.length-1],p=[...f.points];if(p.length&&this.mergeNextPoint){const{z:g}=p[p.length-1];p[p.length-1]={x:d.x,y:d.y,z:g?Math.max(g,d.z):d.z}}else this.currentLineLength+=E.Dist(p[p.length-1],d),p.push(d);if(h[h.length-1]={...f,points:p},this.currentLineLength=this.getLineLength(h),this.editor.updateShapes([{id:i,type:this.shapeType,props:{segments:h,isClosed:this.canClose()?this.getIsClosed(a,o):void 0}}],!0),p.length>500){this.editor.updateShapes([{id:i,type:this.shapeType,props:{isComplete:!0}}]);const{currentPagePoint:g}=this.editor.inputs,y=gt();this.editor.createShapes([{id:y,type:this.shapeType,x:nm(g.x),y:nm(g.y),props:{isPen:this.isPen,segments:[{type:"free",points:[{x:0,y:0,z:this.isPen?+(u*1.25).toFixed():.5}]}]}}]),this.initialShape=Ao(this.editor.getShapeById(y)),this.mergeNextPoint=!1,this.lastRecordedPoint=this.editor.inputs.currentPagePoint.clone(),this.currentLineLength=0}break}}}getLineLength(n){let r=0;for(const i of n)for(let o=0;o<i.points.length-1;o++){const s=i.points[o],a=i.points[o+1];r+=E.Sub(a,s).len2()}return Math.sqrt(r)}complete(){if(!this.canDraw){this.cancel();return}const{initialShape:n}=this;n&&(this.editor.updateShapes([{id:n.id,type:n.type,props:{isComplete:!0}}]),this.parent.transition("idle",{}))}cancel(){this.parent.transition("idle",this.info)}}v(S_,"id","drawing");var B1;let u6=(B1=class extends ve{constructor(){super(...arguments);v(this,"onPointerDown",n=>{this.parent.transition("drawing",n)});v(this,"onEnter",()=>{this.editor.setCursor({type:"cross"})});v(this,"onCancel",()=>{this.editor.setSelectedTool("select")})}},v(B1,"id","idle"),B1);class Up extends ve{constructor(){super(...arguments);v(this,"styles",["color","dash","fill","size"]);v(this,"shapeType","draw");v(this,"onExit",()=>{const n=this.children.drawing;n.initialShape=void 0})}}v(Up,"id","draw"),v(Up,"initial","idle"),v(Up,"children",()=>[u6,S_]);class __{constructor(t){v(this,"state");v(this,"points");v(this,"size");v(this,"color");v(this,"opacity");v(this,"delay");v(this,"timeoutMs",0);v(this,"delayRemaining",0);v(this,"onUpdate");v(this,"onComplete");v(this,"prev",null);v(this,"next",null);v(this,"resume",()=>{this.state="active"});v(this,"pause",()=>{this.state="starting"});v(this,"stop",()=>{this.delayRemaining=Math.min(this.delayRemaining,200),this.state="stopping"});v(this,"addPoint",(t,n)=>{const{prev:r}=this,i={x:t,y:n,z:.5};r&&E.Dist(r,i)<1||(this.next=i)});v(this,"tick",t=>{this.timeoutMs+=t,this.delayRemaining>0&&(this.delayRemaining=Math.max(0,this.delayRemaining-t)),this.timeoutMs>=16&&(this.timeoutMs=0);const{timeoutMs:n,state:r,prev:i,next:o,points:s}=this;switch(r){case"active":{o&&o!==i?(this.prev=o,s.push(o),this.delayRemaining===0&&s.length>8&&s.shift(),this.updateScribble()):n===0&&(s.length>1?(s.shift(),this.updateScribble()):this.delayRemaining=this.delay);break}case"stopping":{if(this.delayRemaining===0&&n===0){if(s.length===1){this.state="paused",this.onComplete();return}this.size*=.9,s.shift(),this.updateScribble()}break}}});const{size:n=20,color:r="accent",opacity:i=.8,delay:o=0,onComplete:s,onUpdate:a}=t;this.onUpdate=a,this.onComplete=s,this.size=n,this.color=r,this.delay=o,this.opacity=i,this.points=[],this.state="starting",this.prev=null,this.next=null,this.delayRemaining=this.delay,this.resume()}getScribble(){return{state:this.state,size:this.size,color:this.color,opacity:this.opacity,delay:this.delay,points:[...this.points]}}updateScribble(){this.onUpdate(this.getScribble())}}class d6 extends ve{constructor(){super(...arguments);v(this,"info",{});v(this,"scribble",{});v(this,"markId","");v(this,"excludedShapeIds",new Set);v(this,"onEnter",n=>{this.markId=this.editor.mark("erase scribble begin"),this.info=n;const{originPagePoint:r}=this.editor.inputs;this.excludedShapeIds=new Set(this.editor.shapesArray.filter(i=>this.editor.isShapeOrAncestorLocked(i)||(i.type==="group"||i.type==="frame")&&this.editor.isPointInShape(r,i)).map(i=>i.id)),this.startScribble(),this.update()});v(this,"startScribble",()=>{var n;this.scribble.tick&&this.editor.off("tick",(n=this.scribble)==null?void 0:n.tick),this.scribble=new __({onUpdate:this.onScribbleUpdate,onComplete:this.onScribbleComplete,color:"muted-1",size:12}),this.editor.on("tick",this.scribble.tick)});v(this,"pushPointToScribble",()=>{const{x:n,y:r}=this.editor.inputs.currentPagePoint;this.scribble.addPoint(n,r)});v(this,"onScribbleUpdate",n=>{this.editor.setScribble(n)});v(this,"onScribbleComplete",()=>{this.editor.off("tick",this.scribble.tick),this.editor.setScribble(null)});v(this,"onExit",()=>{this.scribble.stop()});v(this,"onPointerMove",()=>{this.update()});v(this,"onPointerUp",()=>{this.complete()});v(this,"onCancel",()=>{this.cancel()});v(this,"onComplete",()=>{this.complete()})}update(){const{shapesArray:n,erasingIdsSet:r,inputs:{currentPagePoint:i,previousPagePoint:o}}=this.editor,{excludedShapeIds:s}=this;this.pushPointToScribble();const a=new Set(r);for(const l of n){if(l.type==="group")continue;const c=this.editor.getPageMaskById(l.id);if(c&&!ai(i,c))continue;const u=this.editor.getShapeUtil(l),d=this.editor.getPointInShapeSpace(l,o),h=this.editor.getPointInShapeSpace(l,i);u.hitTestLineSegment(l,d,h)&&a.add(this.editor.getOutermostSelectableShape(l).id)}this.editor.setErasingIds([...a].filter(l=>!s.has(l)))}complete(){this.editor.deleteShapes(this.editor.pageState.erasingIds),this.editor.setErasingIds([]),this.parent.transition("idle",{})}cancel(){this.editor.setErasingIds([]),this.editor.bailToMark(this.markId),this.parent.transition("idle",this.info)}}v(d6,"id","erasing");var R1;let ZQ=(R1=class extends ve{constructor(){super(...arguments);v(this,"onPointerDown",n=>{this.parent.transition("pointing",n)})}},v(R1,"id","idle"),R1);var D1;let QQ=(D1=class extends ve{constructor(){super(...arguments);v(this,"onEnter",()=>{const{inputs:n}=this.editor,r=new Set,i=r.size;for(const o of[...this.editor.sortedShapesArray].reverse())if(this.editor.isPointInShape(n.currentPagePoint,o)){if(o.type==="group")continue;const s=this.editor.getOutermostSelectableShape(o);if(s.type==="frame"&&r.size>i)break;r.add(s.id)}this.editor.setErasingIds([...r])});v(this,"onPointerMove",n=>{this.editor.inputs.isDragging&&this.parent.transition("erasing",n)});v(this,"onPointerUp",()=>{this.complete()});v(this,"onCancel",()=>{this.cancel()});v(this,"onComplete",()=>{this.complete()});v(this,"onInterrupt",()=>{this.cancel()})}complete(){const{erasingIds:n}=this.editor;n.length&&(this.editor.mark("erase end"),this.editor.deleteShapes(n)),this.editor.setErasingIds([]),this.parent.transition("idle",{})}cancel(){this.editor.setErasingIds([]),this.parent.transition("idle",{})}},v(D1,"id","pointing"),D1);class Wp extends ve{constructor(){super(...arguments);v(this,"onEnter",()=>{this.editor.setCursor({type:"cross"})})}}v(Wp,"id","eraser"),v(Wp,"initial","idle"),v(Wp,"children",()=>[ZQ,QQ,d6]);var F1;let JQ=(F1=class extends ve{constructor(){super(...arguments);v(this,"onPointerDown",n=>{this.parent.transition("pointing",n)});v(this,"onEnter",()=>{this.editor.setCursor({type:"cross"})});v(this,"onCancel",()=>{this.editor.setSelectedTool("select")})}},v(F1,"id","idle"),F1);var N1;let eJ=(N1=class extends ve{constructor(){super(...arguments);v(this,"markId","creating");v(this,"wasFocusedOnEnter",!1);v(this,"onEnter",()=>{const{isMenuOpen:n}=this.editor;this.wasFocusedOnEnter=!n});v(this,"onPointerMove",n=>{if(this.editor.inputs.isDragging){const{originPagePoint:r}=this.editor.inputs,i=this.parent.shapeType,o=gt();this.editor.mark(this.markId),this.editor.createShapes([{id:o,type:i,x:r.x,y:r.y,props:{w:1,h:1}}]),this.editor.setSelectedIds([o]),this.editor.setSelectedTool("select.resizing",{...n,target:"selection",handle:"bottom_right",isCreating:!0,creationCursorOffset:{x:1,y:1},onInteractionEnd:this.parent.id})}});v(this,"onPointerUp",()=>{this.complete()});v(this,"onCancel",()=>{this.cancel()});v(this,"onComplete",()=>{this.complete()});v(this,"onInterrupt",()=>{this.cancel()})}complete(){const{originPagePoint:n}=this.editor.inputs;if(!this.wasFocusedOnEnter)return;this.editor.mark(this.markId);const r=this.parent.shapeType,i=gt();this.editor.mark(this.markId),this.editor.createShapes([{id:i,type:r,x:n.x,y:n.y}]);const o=this.editor.getShapeById(i),{w:s,h:a}=this.editor.getShapeUtil(o).defaultProps(),l=this.editor.getDeltaInParentSpace(o,new E(s/2,a/2));this.editor.updateShapes([{id:i,type:r,x:o.x-l.x,y:o.y-l.y}]),this.editor.setSelectedIds([i]),this.editor.instanceState.isToolLocked?this.parent.transition("idle",{}):this.editor.setSelectedTool("select.idle")}cancel(){this.parent.transition("idle",{})}},v(N1,"id","pointing"),N1);class Hp extends ve{}v(Hp,"id","box"),v(Hp,"initial","idle"),v(Hp,"children",()=>[JQ,eJ]);class wb extends Hp{constructor(){super(...arguments);v(this,"shapeType","frame")}}v(wb,"id","frame"),v(wb,"initial","idle");var j1;let tJ=(j1=class extends ve{constructor(){super(...arguments);v(this,"onPointerDown",n=>{this.parent.transition("pointing",n)});v(this,"onEnter",()=>{this.editor.setCursor({type:"cross"})});v(this,"onKeyUp",n=>{if(n.key==="Enter"){const r=this.editor.onlySelectedShape;r&&r.type==="geo"&&(this.editor.mark("editing shape"),this.editor.setEditingId(r.id),this.editor.setSelectedTool("select.editing_shape",{...n,target:"shape",shape:r}))}});v(this,"onCancel",()=>{this.editor.setSelectedTool("select")})}},v(j1,"id","idle"),j1);var z1;let nJ=(z1=class extends ve{constructor(){super(...arguments);v(this,"onPointerMove",n=>{if(this.editor.inputs.isDragging){const{originPagePoint:r}=this.editor.inputs,i=gt();this.editor.mark("creating"),this.editor.createShapes([{id:i,type:"geo",x:r.x,y:r.y,props:{w:1,h:1,geo:this.editor.instanceState.propsForNextShape.geo}}]),this.editor.select(i),this.editor.setSelectedTool("select.resizing",{...n,target:"selection",handle:"bottom_right",isCreating:!0,creationCursorOffset:{x:1,y:1},onInteractionEnd:"geo"})}});v(this,"onPointerUp",()=>{this.complete()});v(this,"onCancel",()=>{this.cancel()});v(this,"onComplete",()=>{this.complete()});v(this,"onInterrupt",()=>{this.cancel()})}complete(){const{originPagePoint:n}=this.editor.inputs,r=gt();this.editor.mark("creating"),this.editor.createShapes([{id:r,type:"geo",x:n.x,y:n.y,props:{geo:this.editor.instanceState.propsForNextShape.geo,w:1,h:1}}]);const i=this.editor.getShapeById(r);if(!i)return;const o=i.props.geo==="star"?LV(5,200,200):new me(0,0,200,200),s=this.editor.getDeltaInParentSpace(i,o.center);this.editor.select(r),this.editor.updateShapes([{id:i.id,type:"geo",x:i.x-s.x,y:i.y-s.y,props:{geo:this.editor.instanceState.propsForNextShape.geo,w:o.width,h:o.height}}]),this.editor.instanceState.isToolLocked?this.parent.transition("idle",{}):this.editor.setSelectedTool("select",{})}cancel(){this.parent.transition("idle",{})}},v(z1,"id","pointing"),z1);class Kp extends ve{constructor(){super(...arguments);v(this,"styles",["color","dash","fill","size","geo","font","align","verticalAlign"]);v(this,"shapeType","geo")}}v(Kp,"id","geo"),v(Kp,"initial","idle"),v(Kp,"children",()=>[tJ,nJ]);class h6 extends ve{constructor(){super(...arguments);v(this,"onEnter",()=>{this.update()});v(this,"onPointerMove",()=>{this.update()});v(this,"onPointerUp",()=>{this.complete()});v(this,"onCancel",()=>{this.complete()});v(this,"onComplete",()=>{this.complete()})}update(){const{currentScreenPoint:n,previousScreenPoint:r}=this.editor.inputs,i=E.Sub(n,r);(Math.abs(i.x)>0||Math.abs(i.y)>0)&&this.editor.pan(i.x,i.y)}complete(){this.editor.slideCamera({speed:Math.min(2,this.editor.inputs.pointerVelocity.len()),direction:this.editor.inputs.pointerVelocity,friction:Np}),this.parent.transition("idle",{})}}v(h6,"id","dragging");var U1;let rJ=(U1=class extends ve{constructor(){super(...arguments);v(this,"onEnter",()=>{this.editor.setCursor({type:"grab"})});v(this,"onPointerDown",n=>{this.parent.transition("pointing",n)});v(this,"onCancel",()=>{this.editor.setSelectedTool("select")})}},v(U1,"id","idle"),U1);var W1;let iJ=(W1=class extends ve{constructor(){super(...arguments);v(this,"onEnter",()=>{this.editor.stopCameraAnimation(),this.editor.setCursor({type:"grabbing"})});v(this,"onPointerMove",n=>{this.editor.inputs.isDragging&&this.parent.transition("dragging",n)});v(this,"onPointerUp",()=>{this.complete()});v(this,"onCancel",()=>{this.complete()});v(this,"onComplete",()=>{this.complete()});v(this,"onInterrupt",()=>{this.complete()})}complete(){this.parent.transition("idle",{})}},v(W1,"id","pointing"),W1);class Vp extends ve{constructor(){super(...arguments);v(this,"styles",[]);v(this,"onDoubleClick",n=>{if(n.phase==="settle"){const{currentScreenPoint:r}=this.editor.inputs;this.editor.zoomIn(r,{duration:220,easing:Bn.easeOutQuint})}});v(this,"onTripleClick",n=>{if(n.phase==="settle"){const{currentScreenPoint:r}=this.editor.inputs;this.editor.zoomOut(r,{duration:320,easing:Bn.easeOutQuint})}});v(this,"onQuadrupleClick",n=>{if(n.phase==="settle"){const{zoomLevel:r,inputs:{currentScreenPoint:i}}=this.editor;r===1?this.editor.zoomToFit({duration:400,easing:Bn.easeOutQuint}):this.editor.resetZoom(i,{duration:320,easing:Bn.easeOutQuint})}})}}v(Vp,"id","hand"),v(Vp,"initial","idle"),v(Vp,"children",()=>[rJ,iJ,h6]);class Yp extends ve{constructor(){super(...arguments);v(this,"styles",["color","size"]);v(this,"shapeType","highlight");v(this,"onExit",()=>{const n=this.children.drawing;n.initialShape=void 0})}}v(Yp,"id","highlight"),v(Yp,"initial","idle"),v(Yp,"children",()=>[u6,S_]);var H1;let oJ=(H1=class extends ve{constructor(){super(...arguments);v(this,"onPointerDown",n=>{this.parent.transition("lasering",n)})}},v(H1,"id","idle"),H1);class f6 extends ve{constructor(){super(...arguments);v(this,"scribble",{});v(this,"onEnter",()=>{this.startScribble(),this.pushPointToScribble()});v(this,"onExit",()=>{this.editor.setErasingIds([]),this.scribble.stop()});v(this,"onPointerMove",()=>{this.pushPointToScribble()});v(this,"onPointerUp",()=>{this.complete()});v(this,"startScribble",()=>{var n;this.scribble.tick&&this.editor.off("tick",(n=this.scribble)==null?void 0:n.tick),this.scribble=new __({onUpdate:this.onScribbleUpdate,onComplete:this.onScribbleComplete,color:"laser",opacity:.7,size:4,delay:1200}),this.editor.on("tick",this.scribble.tick)});v(this,"pushPointToScribble",()=>{const{x:n,y:r}=this.editor.inputs.currentPagePoint;this.scribble.addPoint(n,r)});v(this,"onScribbleUpdate",n=>{this.editor.setScribble(n)});v(this,"onScribbleComplete",()=>{this.editor.off("tick",this.scribble.tick),this.editor.setScribble(null)});v(this,"onCancel",()=>{this.cancel()});v(this,"onComplete",()=>{this.complete()})}complete(){this.parent.transition("idle",{})}cancel(){this.parent.transition("idle",{})}}v(f6,"id","lasering");class qp extends ve{constructor(){super(...arguments);v(this,"onEnter",()=>{this.editor.setCursor({type:"cross"})})}}v(qp,"id","laser"),v(qp,"initial","idle"),v(qp,"children",()=>[oJ,f6]);var K1;let sJ=(K1=class extends ve{constructor(){super(...arguments);v(this,"shapeId","");v(this,"onEnter",n=>{this.shapeId=n.shapeId,this.editor.setCursor({type:"cross"})});v(this,"onPointerDown",()=>{this.parent.transition("pointing",{shapeId:this.shapeId})});v(this,"onCancel",()=>{this.editor.setSelectedTool("select")})}},v(K1,"id","idle"),K1);var V1;let aJ=(V1=class extends ve{constructor(){super(...arguments);v(this,"shape",{});v(this,"markPointId","");v(this,"onEnter",n=>{const{inputs:r}=this.editor,{currentPagePoint:i}=r;this.markPointId=this.editor.mark("creating");let o=!1;if(n.shapeId){const s=this.editor.getShapeById(n.shapeId);s&&(o=!0,this.shape=s)}if(r.shiftKey&&o){const a=this.editor.getShapeUtil(this.shape).handles(this.shape).filter(p=>p.type==="vertex").sort(ir),l=a[a.length-1],c=ie.applyToPoint(this.editor.getParentTransform(this.shape),new E(this.shape.x,this.shape.y));let u,d,h;a.length===2&&a[1].x===1&&a[1].y===1?(u=a[1].index,d=a[1].id,h={...a[1],x:i.x-c.x,y:i.y-c.y}):(u=Co(l.index),d="handle:"+u,h={x:i.x-c.x,y:i.y-c.y,index:u,canBind:!1,type:"vertex",id:d});const f=Ao(this.shape.props.handles);f[h.id]=h,this.editor.updateShapes([{id:this.shape.id,type:this.shape.type,props:{handles:f}}])}else{const s=gt();this.editor.createShapes([{id:s,type:this.parent.shapeType,x:i.x,y:i.y}]),this.editor.select(s),this.shape=this.editor.getShapeById(s)}});v(this,"onPointerMove",()=>{var n;if(this.shape&&this.editor.inputs.isDragging){const r=this.editor.getShapeUtil(this.shape),i=(n=r.handles)==null?void 0:n.call(r,this.shape);if(!i)throw this.editor.bailToMark("creating"),Error("No handles found");this.editor.setSelectedTool("select.dragging_handle",{shape:this.shape,isCreating:!0,handle:Kn(i),onInteractionEnd:"line"})}});v(this,"onPointerUp",()=>{this.complete()});v(this,"onCancel",()=>{this.cancel()});v(this,"onComplete",()=>{this.complete()});v(this,"onInterrupt",()=>{this.parent.transition("idle",{}),this.editor.bailToMark("creating"),this.editor.snaps.clear()})}complete(){this.parent.transition("idle",{shapeId:this.shape.id}),this.editor.snaps.clear()}cancel(){this.editor.bailToMark(this.markPointId),this.parent.transition("idle",{shapeId:this.shape.id}),this.editor.snaps.clear()}},v(V1,"id","pointing"),V1);class Gp extends ve{constructor(){super(...arguments);v(this,"shapeType","line");v(this,"styles",["color","dash","size","spline"])}}v(Gp,"id","line"),v(Gp,"initial","idle"),v(Gp,"children",()=>[sJ,aJ]);var Y1;let lJ=(Y1=class extends ve{constructor(){super(...arguments);v(this,"onPointerDown",n=>{this.parent.transition("pointing",n)});v(this,"onEnter",()=>{this.editor.setCursor({type:"cross"})});v(this,"onCancel",()=>{this.editor.setSelectedTool("select")})}},v(Y1,"id","idle"),Y1);var q1;let cJ=(q1=class extends ve{constructor(){super(...arguments);v(this,"dragged",!1);v(this,"info",{});v(this,"wasFocusedOnEnter",!1);v(this,"markPointId","creating");v(this,"onEnter",()=>{this.wasFocusedOnEnter=!this.editor.isMenuOpen});v(this,"onPointerMove",n=>{if(this.editor.inputs.isDragging){this.editor.mark(this.markPointId);const r=this.createShape();if(!r)return;this.editor.setSelectedTool("select.translating",{...n,target:"shape",shape:r,isCreating:!0,editAfterComplete:!0,onInteractionEnd:"note"})}});v(this,"onPointerUp",()=>{this.complete()});v(this,"onInterrupt",()=>{this.cancel()});v(this,"onComplete",()=>{this.complete()});v(this,"onCancel",()=>{this.cancel()})}complete(){if(!this.wasFocusedOnEnter)return;this.editor.mark(this.markPointId);const n=this.createShape();if(this.editor.instanceState.isToolLocked)this.parent.transition("idle",{});else{if(!n)return;this.editor.setEditingId(n.id),this.editor.setSelectedTool("select.editing_shape",{...this.info,target:"shape",shape:n})}}cancel(){this.editor.bailToMark(this.markPointId),this.parent.transition("idle",this.info)}createShape(){const{inputs:{originPagePoint:n}}=this.editor,r=gt();this.editor.createShapes([{id:r,type:"note",x:n.x,y:n.y}],!0);const i=this.editor.getShapeUtil(w_),o=this.editor.getShapeById(r),s=i.bounds(o);return this.editor.updateShapes([{id:r,type:"note",x:o.x-s.width/2,y:o.y-s.height/2}]),this.editor.getShapeById(r)}},v(q1,"id","pointing"),q1);class Xp extends ve{constructor(){super(...arguments);v(this,"styles",["color","size","align","verticalAlign","font"]);v(this,"shapeType","note")}}v(Xp,"id","note"),v(Xp,"initial","idle"),v(Xp,"children",()=>[lJ,cJ]);var G1;let uJ=(G1=class extends ve{constructor(){super(...arguments);v(this,"onPointerEnter",n=>{switch(n.target){case"canvas":break;case"shape":{const{selectedIds:r,focusLayerId:i}=this.editor,o=this.editor.getOutermostSelectableShape(n.shape,s=>!r.includes(s.id));o.id!==i&&o.type==="text"&&this.editor.setHoveredId(o.id);break}}});v(this,"onPointerLeave",n=>{switch(n.target){case"shape":{this.editor.setHoveredId(null);break}}});v(this,"onPointerDown",n=>{const{hoveredId:r}=this.editor;if(r){const i=this.editor.getShapeById(r);if(i.type==="text"){requestAnimationFrame(()=>{this.editor.setSelectedIds([i.id]),this.editor.setEditingId(i.id),this.editor.setSelectedTool("select.editing_shape",{...n,target:"shape",shape:i})});return}}this.parent.transition("pointing",n)});v(this,"onEnter",()=>{this.editor.setCursor({type:"cross"})});v(this,"onKeyDown",n=>{if(n.key==="Enter"){const r=this.editor.selectedShapes[0];r&&r.type==="geo"&&(this.editor.setSelectedTool("select"),this.editor.setEditingId(r.id),this.editor.root.current.value.transition("editing_shape",{...n,target:"shape",shape:r}))}});v(this,"onCancel",()=>{this.editor.setSelectedTool("select")})}},v(G1,"id","idle"),G1);var X1;let dJ=(X1=class extends ve{constructor(){super(...arguments);v(this,"shape");v(this,"onExit",()=>{this.editor.setHintingIds([])});v(this,"onPointerMove",n=>{if(this.editor.inputs.isDragging){const{inputs:{originPagePoint:r}}=this.editor,i=gt();if(this.editor.mark("creating"),this.editor.createShapes([{id:i,type:"text",x:r.x,y:r.y,props:{text:"",autoSize:!1,w:20}}]),this.editor.select(i),this.shape=this.editor.getShapeById(i),!this.shape)return;this.editor.setSelectedTool("select.resizing",{...n,target:"selection",handle:"right",isCreating:!0,creationCursorOffset:{x:1,y:1},editAfterComplete:!0,onInteractionEnd:"text"})}});v(this,"onPointerUp",()=>{this.complete()});v(this,"onComplete",()=>{this.cancel()});v(this,"onCancel",()=>{this.cancel()});v(this,"onInterrupt",()=>{this.cancel()})}complete(){var o;this.editor.mark("creating text shape");const n=gt(),{x:r,y:i}=this.editor.inputs.currentPagePoint;this.editor.createShapes([{id:n,type:"text",x:r,y:i,props:{text:"",autoSize:!0}}],!0),this.editor.setEditingId(n),this.editor.setSelectedTool("select"),(o=this.editor.root.current.value)==null||o.transition("editing_shape",{})}cancel(){this.parent.transition("idle",{}),this.editor.bailToMark("creating")}},v(X1,"id","pointing"),X1);class Zp extends ve{constructor(){super(...arguments);v(this,"styles",["color","font","align","size"]);v(this,"shapeType","text")}}v(Zp,"id","text"),v(Zp,"initial","idle"),v(Zp,"children",()=>[uJ,dJ]);const hJ=[Vp,Wp,qp,Up,Zp,Gp,zp,Kp,Xp,wb,Yp];function fJ(e,t){let n=null;for(const[r,i]of Object.entries(t))zM.has(r)&&(n||(n={...e}),n[r]=i);return n??e}function p6({editor:e}){const{selectionRotation:t,selectionPageCenter:n,inputs:{originPagePoint:r},selectedShapes:i}=e;return{selectionPageCenter:n,initialCursorAngle:n.angle(r),initialSelectionRotation:t,shapeSnapshots:i.map(o=>({shape:Ao(o),initialPagePoint:e.getPagePointById(o.id)}))}}function Qp({delta:e,editor:t,snapshot:n,stage:r}){const{selectionPageCenter:i,shapeSnapshots:o}=n;t.updateShapes(o.map(({shape:a,initialPagePoint:l})=>{const c=Vr(a.parentId)?t.getPageTransformById(a.parentId):ie.Identity(),u=E.RotWith(l,i,e),d=ie.applyToPoint(ie.Inverse(c),u),h=GS(a.rotation+e);return{id:a.id,type:a.type,x:d.x,y:d.y,rotation:h}}));const s=[];o.forEach(({shape:a})=>{var d,h,f;const l=t.getShapeById(a.id);if(!l)return;const c=t.getShapeUtil(a);if(r==="start"||r==="one-off"){const p=(d=c.onRotateStart)==null?void 0:d.call(c,a);p&&s.push(p)}const u=(h=c.onRotate)==null?void 0:h.call(c,a,l);if(u&&s.push(u),r==="end"||r==="one-off"){const p=(f=c.onRotateEnd)==null?void 0:f.call(c,a,l);p&&s.push(p)}}),s.length>0&&t.updateShapes(s)}function Gf(e){return e.type==="arrow"}const pJ=e=>{const t=e.query.filterHistory("shape"),n=e.query.records("shape",()=>({type:{eq:"arrow"}}));function r(){const i=n.value,o={};for(const s of i){const{start:a,end:l}=s.props;if(a.type==="binding"){const c=o[a.boundShapeId];c?c.push({arrowId:s.id,handleId:"start"}):o[a.boundShapeId]=[{arrowId:s.id,handleId:"start"}]}if(l.type==="binding"){const c=o[l.boundShapeId];c?c.push({arrowId:s.id,handleId:"end"}):o[l.boundShapeId]=[{arrowId:s.id,handleId:"end"}]}}return o}return ce("arrowBindingsIndex",(i,o)=>{if(pc(i))return r();const s=i,a=t.getDiffSince(o);if(a===Mr)return r();let l;function c(h){l||(l={...s}),l[h]?l[h]===s[h]&&(l[h]=[...l[h]]):l[h]=[]}function u(h,f,p){c(h),l[h]=l[h].filter(g=>g.arrowId!==f||g.handleId!==p),l[h].length===0&&delete l[h]}function d(h,f,p){c(h),l[h].push({arrowId:f,handleId:p})}for(const h of a){for(const f of Object.values(h.added))if(Gf(f)){const{start:p,end:g}=f.props;p.type==="binding"&&d(p.boundShapeId,f.id,"start"),g.type==="binding"&&d(g.boundShapeId,f.id,"end")}for(const[f,p]of Object.values(h.updated))if(!(!Gf(f)||!Gf(p)))for(const g of["start","end"]){const y=f.props[g],x=p.props[g];y.type==="binding"&&x.type==="point"?u(y.boundShapeId,f.id,g):y.type==="point"&&x.type==="binding"?d(x.boundShapeId,p.id,g):y.type==="binding"&&x.type==="binding"&&y.boundShapeId!==x.boundShapeId&&(u(y.boundShapeId,f.id,g),d(x.boundShapeId,p.id,g))}for(const f of Object.values(h.removed))if(Gf(f)){const{start:p,end:g}=f.props;p.type==="binding"&&u(p.boundShapeId,f.id,"start"),g.type==="binding"&&u(g.boundShapeId,f.id,"end")}}return l??s})},gJ=e=>{const t=e.query.ids("shape");function n(){const r={};return t.value.forEach(i=>{const o=e.get(i);r[o.parentId]||(r[o.parentId]=[]),r[o.parentId].push([i,o.index])}),Object.values(r).forEach(i=>i.sort((o,s)=>o[1]<s[1]?-1:1)),r}return ce("parentsToChildrenWithIndexes",(r,i)=>{if(pc(r))return n();const o=e.history.getDiffSince(i);if(o===Mr)return n();if(o.length===0)return r;let s=null;const a=u=>{s||(s={...r}),s[u]?s[u]===r[u]&&(s[u]=[...s[u]]):s[u]=[]},l=new Set;let c;for(let u=0,d=o.length;u<d;u++){c=o[u];for(const h of Object.values(c.added))Aa(h)&&(a(h.parentId),s[h.parentId].push([h.id,h.index]),l.add(s[h.parentId]));for(const[h,f]of Object.values(c.updated))if(Aa(f)&&Aa(h)){if(h.parentId!==f.parentId)a(h.parentId),a(f.parentId),s[h.parentId].splice(s[h.parentId].findIndex(p=>p[0]===f.id),1),s[f.parentId].push([f.id,f.index]),l.add(s[f.parentId]);else if(h.index!==f.index){a(f.parentId);const p=s[f.parentId].findIndex(g=>g[0]===f.id);s[f.parentId][p]=[f.id,f.index],l.add(s[f.parentId])}}for(const h of Object.values(c.removed))Aa(h)&&(a(h.parentId),s[h.parentId].splice(s[h.parentId].findIndex(f=>f[0]===h.id),1))}for(const u of l)u.sort((d,h)=>d[1]<h[1]?-1:1);return s??r})},jv=(e,t,n)=>{for(;!Un(n.parentId);){const r=e.get(n.parentId);if(!r)return!1;n=r}return n.parentId===t},mJ=(e,t)=>{const n=e.query.ids("shape");let r=null;function i(){const o=t();return r=o,new Set([...n.value].filter(s=>jv(e,o,e.get(s))))}return ce("_shapeIdsInCurrentPage",(o,s)=>{if(pc(o))return i();const a=t();if(a!==r)return i();const l=e.history.getDiffSince(s);if(l===Mr)return i();const c=new Fp(o);for(const d of l){for(const h of Object.values(d.added))Aa(h)&&jv(e,a,h)&&c.add(h.id);for(const[h,f]of Object.values(d.updated))Aa(f)&&(jv(e,a,f)?c.add(f.id):c.remove(f.id));for(const h of Object.keys(d.removed))Vr(h)&&c.remove(h)}const u=c.get();return u?Vu(u.value,u.diff):o})},g6={top:10,left:10,bottom:10,right:10};function m6(e){const t=e.getContainer(),n=t.querySelector('*[data-tldraw-area="active-drawing"]'),r={...g6,width:0,height:0};if(n&&t){const i=t.getBoundingClientRect(),o=n.getBoundingClientRect();r.top=o.top,r.left=o.left,r.bottom=i.height-o.bottom,r.right=i.width-o.right}return r.width=e.viewportScreenBounds.width-r.left-r.right,r.height=e.viewportScreenBounds.height-r.top-r.bottom,r}function yJ(e){const t=m6(e),n=e.zoomLevel;return t.left/=n,t.right/=n,t.top/=n,t.bottom/=n,t.width/=n,t.height/=n,t}class vJ{constructor(t){v(this,"offsets",jt("activeAreaOffsets",g6));v(this,"updateOffsets",()=>{const t=yJ(this.editor);this.offsets.set(t)});v(this,"dispose",()=>{window.addEventListener("resize",this.updateOffsets)});this.editor=t,window.addEventListener("resize",this.updateOffsets),this.editor.disposables.add(this.dispose)}}const xJ=12;class bJ{constructor(t){v(this,"state",jt("camera state","idle"));v(this,"timeoutRemaining",0);v(this,"decay",t=>{this.timeoutRemaining-=t,this.timeoutRemaining<=0&&(this.state.set("idle"),this.editor.off("tick",this.decay),this.editor.updateCullingBounds())});v(this,"tick",()=>{this.timeoutRemaining=xJ,this.state.__unsafe__getWithoutCapture()==="idle"&&(this.state.set("moving"),this.editor.on("tick",this.decay))});this.editor=t}}const wJ=40;class SJ{constructor(t){v(this,"_clickId","");v(this,"_clickTimeout");v(this,"_clickScreenPoint");v(this,"_previousScreenPoint");v(this,"_getClickTimeout",(t,n=At())=>{this._clickId=n,clearTimeout(this._clickTimeout),this._clickTimeout=setTimeout(()=>{if(this._clickState===t&&this._clickId===n){switch(this._clickState){case"pendingTriple":{this.editor.dispatch({...this.lastPointerInfo,type:"click",name:"double_click",phase:"settle"});break}case"pendingQuadruple":{this.editor.dispatch({...this.lastPointerInfo,type:"click",name:"triple_click",phase:"settle"});break}case"pendingOverflow":{this.editor.dispatch({...this.lastPointerInfo,type:"click",name:"quadruple_click",phase:"settle"});break}}this._clickState="idle"}},t==="idle"||t==="pendingDouble"?tq:nq)});v(this,"_clickState","idle");v(this,"lastPointerInfo",{});v(this,"transformPointerDownEvent",t=>{if(!this._clickState)return t;switch(this._clickScreenPoint=E.From(t.point),this._previousScreenPoint&&this._previousScreenPoint.dist(this._clickScreenPoint)>wJ&&(this._clickState="idle"),this._previousScreenPoint=this._clickScreenPoint,this.lastPointerInfo=t,this._clickState){case"idle":return this._clickState="pendingDouble",this._clickTimeout=this._getClickTimeout(this._clickState),t;case"pendingDouble":return this._clickState="pendingTriple",this._clickTimeout=this._getClickTimeout(this._clickState),{...t,type:"click",name:"double_click",phase:"down"};case"pendingTriple":return this._clickState="pendingQuadruple",this._clickTimeout=this._getClickTimeout(this._clickState),{...t,type:"click",name:"triple_click",phase:"down"};case"pendingQuadruple":return this._clickState="pendingOverflow",this._clickTimeout=this._getClickTimeout(this._clickState),{...t,type:"click",name:"quadruple_click",phase:"down"};case"pendingOverflow":return this._clickState="overflow",this._clickTimeout=this._getClickTimeout(this._clickState),t;default:return this._clickTimeout=this._getClickTimeout(this._clickState),t}});v(this,"transformPointerUpEvent",t=>{if(!this._clickState)return t;switch(this._clickScreenPoint=E.From(t.point),this._clickState){case"pendingTriple":return{...this.lastPointerInfo,type:"click",name:"double_click",phase:"up"};case"pendingQuadruple":return{...this.lastPointerInfo,type:"click",name:"triple_click",phase:"up"};case"pendingOverflow":return{...this.lastPointerInfo,type:"click",name:"quadruple_click",phase:"up"};default:return t}});v(this,"cancelDoubleClickTimeout",()=>{this._clickTimeout=clearTimeout(this._clickTimeout),this._clickState="idle"});v(this,"handleMove",()=>{this._clickState!=="idle"&&this._clickScreenPoint&&this._clickScreenPoint.dist(this.editor.inputs.currentScreenPoint)>(this.editor.isCoarsePointer?gb:Vd)&&this.cancelDoubleClickTimeout()});this.editor=t}get clickState(){return this._clickState}}class _J{constructor(t){v(this,"_currentMM");v(this,"dpr",jt("devicePixelRatio",typeof window>"u"?1:window.devicePixelRatio));v(this,"updateDevicePixelRatio",()=>{this.dpr.set(window.devicePixelRatio),this.rebind()});v(this,"dispose",()=>{var t;(t=this._currentMM)==null||t.removeEventListener("change",this.updateDevicePixelRatio)});this.editor=t,this.rebind(),this.editor.disposables.add(this.dispose)}rebind(){var t;this.dispose(),this._currentMM=this.getMedia(),(t=this._currentMM)==null||t.addEventListener("change",this.updateDevicePixelRatio)}getMedia(){if(window.matchMedia)return matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`)}}function va(e){if(e){let t=MT;for(;e.length;)t=t.push(e.pop());return t}return MT}class CJ{constructor(){v(this,"length",0);v(this,"head",null);v(this,"tail",this)}push(t){return new C_(t,this)}toArray(){return ri}[Symbol.iterator](){return{next(){return{value:void 0,done:!0}}}}}const MT=new CJ;class C_{constructor(t,n){v(this,"length");this.head=t,this.tail=n,this.length=n.length+1}push(t){return new C_(t,this)}toArray(){return Array.from(this)}[Symbol.iterator](){let t=this;return{next(){if(t.length){const n=t.head;return t=t.tail,{value:n,done:!1}}else return{value:void 0,done:!0}}}}}class EJ{constructor(t,n,r){v(this,"_undos",jt("HistoryManager.undos",va()));v(this,"_redos",jt("HistoryManager.redos",va()));v(this,"_batchDepth",0);v(this,"_commands",{});v(this,"createCommand",(t,n,r)=>{if(this._commands[t])throw new Error(`Duplicate command: ${t}`);this._commands[t]=r;const i=(...o)=>{if(!this._batchDepth)return this.batch(()=>i(...o)),this.ctx;const s=n(...o);if(!s)return this.ctx;const{data:a,ephemeral:l,squashing:c,preservesRedoStack:u}=s;if(this.ignoringUpdates((d,h)=>(r.do(a),{undos:d,redos:h})),!l){const d=this._undos.value.head;c&&d&&d.type==="command"&&d.name===t&&d.preservesRedoStack===u?this._undos.update(h=>h.tail.push({...d,id:At(),data:r.squash(d.data,a)})):this._undos.update(h=>h.push({type:"command",name:t,data:a,id:At(),preservesRedoStack:u})),s.preservesRedoStack||this._redos.set(va()),this.ctx.emit("change-history",{reason:"push"})}return this.ctx};return i});v(this,"batch",t=>{try{this._batchDepth++,this._batchDepth===1?Xr(()=>{var r,i;const n=(r=this._undos.value.head)==null?void 0:r.id;t(),n!==((i=this._undos.value.head)==null?void 0:i.id)&&this.onBatchComplete()}):t()}catch(n){throw this.annotateError(n),n}finally{this._batchDepth--}return this});v(this,"ignoringUpdates",t=>{let n=this._undos.value,r=this._redos.value;this._undos.set(va()),this._redos.set(va());try{({undos:n,redos:r}=Xr(()=>t(n,r)))}finally{this._undos.set(n),this._redos.set(r)}});v(this,"_undo",({pushToRedoStack:t,toMark:n=void 0})=>(this.ignoringUpdates((r,i)=>{var o;if(r.length===0)return{undos:r,redos:i};for(;((o=r.head)==null?void 0:o.type)==="STOP";){const s=r.head;if(r=r.tail,t&&(i=i.push(s)),s.id===n)return this.ctx.emit("change-history",t?{reason:"undo"}:{reason:"bail",markId:n}),{undos:r,redos:i}}if(r.length===0)return this.ctx.emit("change-history",t?{reason:"undo"}:{reason:"bail",markId:n}),{undos:r,redos:i};for(;r.head;){const s=r.head;if(r=r.tail,t&&(i=i.push(s)),s.type==="STOP"){if(s.onUndo&&(!n||s.id===n))return this.ctx.emit("change-history",t?{reason:"undo"}:{reason:"bail",markId:n}),{undos:r,redos:i}}else this._commands[s.name].undo(s.data)}return this.ctx.emit("change-history",t?{reason:"undo"}:{reason:"bail",markId:n}),{undos:r,redos:i}}),this));v(this,"undo",()=>(this._undo({pushToRedoStack:!0}),this));v(this,"redo",()=>(this.ignoringUpdates((t,n)=>{var r;if(n.length===0)return{undos:t,redos:n};for(;((r=n.head)==null?void 0:r.type)==="STOP";)t=t.push(n.head),n=n.tail;if(n.length===0)return this.ctx.emit("change-history",{reason:"redo"}),{undos:t,redos:n};for(;n.head;){const i=n.head;if(t=t.push(n.head),n=n.tail,i.type==="STOP"){if(i.onRedo)break}else{const o=this._commands[i.name];o.redo?o.redo(i.data):o.do(i.data)}}return this.ctx.emit("change-history",{reason:"redo"}),{undos:t,redos:n}}),this));v(this,"bail",()=>(this._undo({pushToRedoStack:!1}),this));v(this,"bailToMark",t=>(this._undo({pushToRedoStack:!1,toMark:t}),this));v(this,"mark",(t=At(),n=!0,r=!0)=>{const i=this._undos.value.head;return i&&i.type==="STOP"&&i.id===t&&i.onUndo===n&&i.onRedo===r?i.id:(this._undos.update(o=>o.push({type:"STOP",id:t,onUndo:n,onRedo:r})),this.ctx.emit("mark-history",{id:t}),t)});this.ctx=t,this.onBatchComplete=n,this.annotateError=r}get numUndos(){return this._undos.value.length}get numRedos(){return this._redos.value.length}clear(){this._undos.set(va()),this._redos.set(va())}}var kJ=Object.defineProperty,TJ=Object.getOwnPropertyDescriptor,$y=(e,t,n,r)=>{for(var i=r>1?void 0:r?TJ(t,n):t,o=e.length-1,s;o>=0;o--)(s=e[o])&&(i=(r?s(t,n,i):s(i))||i);return r&&i&&kJ(t,n,i),i};const Te=e=>Math.round(e*10**8)/10**8;function wo(e,t,n,r,i){const o=e.filter(a=>(r==="forward"?a.startNode.id===t:a.endNode.id===t)&&Te(a.length)===Te(n)&&wi(a.breadthIntersection[0],a.breadthIntersection[1],i[0],i[1]));if(o.length===0)return[];const s=new Set;for(const a of o){const l=r==="forward"?a.endNode.id:a.startNode.id;s.has(l)||(s.add(l),o.push(...wo(e,l,n,r,wi(a.breadthIntersection[0],a.breadthIntersection[1],i[0],i[1]))))}return o}function PJ(e){e.sort((t,n)=>n.gaps.length-t.gaps.length);for(let t=e.length-1;t>0;t--){const n=e[t];for(let r=t-1;r>=0;r--){const i=e[r];if(i.direction===n.direction&&n.gaps.every(o=>i.gaps.some(s=>Te(o.startEdge[0].x)===Te(s.startEdge[0].x)&&Te(o.startEdge[0].y)===Te(s.startEdge[0].y)&&Te(o.startEdge[1].x)===Te(s.startEdge[1].x)&&Te(o.startEdge[1].y)===Te(s.startEdge[1].y))&&i.gaps.some(s=>Te(o.endEdge[0].x)===Te(s.endEdge[0].x)&&Te(o.endEdge[0].y)===Te(s.endEdge[0].y)&&Te(o.endEdge[1].x)===Te(s.endEdge[1].x)&&Te(o.endEdge[1].y)===Te(s.endEdge[1].y)))){e.splice(t,1);break}}}}class jh{constructor(t){v(this,"_snapLines",jt("snapLines",void 0));this.editor=t}get lines(){return this._snapLines.value??ri}clear(){this.lines.length&&this._snapLines.set(void 0)}setLines(t){this._snapLines.set(t)}get snapPointsCache(){return this.editor.store.createComputedCache("snapPoints",t=>{const n=this.editor.getPageTransformById(t.id);return n?this.editor.getShapeUtil(t).snapPoints(t).map((o,s)=>{const{x:a,y:l}=ie.applyToPoint(n,o);return{x:a,y:l,id:`${t.id}:${s}`}}):void 0})}get snapThreshold(){return 8/this.editor.zoomLevel}get visibleShapesNotInSelection(){const t=this.editor.selectedIds,n=new Set,r=o=>{const s=this.editor.getSortedChildIds(o);for(const a of s){const l=this.editor.getShapeById(a);if(l&&l.type!=="arrow"&&!t.includes(a)&&this.editor.isShapeInViewport(l.id)){if(l.type==="group"){r(a);continue}n.add({id:l.id,pageBounds:this.editor.getPageBoundsById(l.id)}),l.type!=="frame"&&r(a)}}},i=this.editor.findCommonAncestor(Ae(t.map(o=>this.editor.getShapeById(o))),o=>o.type==="frame");return r(i??this.editor.currentPageId),n}get visibleSnapPointsNotInSelection(){const t=[];for(const n of this.visibleShapesNotInSelection){const r=this.snapPointsCache.get(n.id);r&&t.push(...r)}return t}get visibleGaps(){const t=[],n=[],r=[...this.visibleShapesNotInSelection].sort((o,s)=>o.pageBounds.minX-s.pageBounds.minX);for(let o=0;o<r.length;o++){const s=r[o];for(let a=o+1;a<r.length;a++){const l=r[a];s.pageBounds.maxX<l.pageBounds.minX&&Eu(s.pageBounds.minY,s.pageBounds.maxY,l.pageBounds.minY,l.pageBounds.maxY)&&t.push({startNode:s,endNode:l,startEdge:[new E(s.pageBounds.maxX,s.pageBounds.minY),new E(s.pageBounds.maxX,s.pageBounds.maxY)],endEdge:[new E(l.pageBounds.minX,l.pageBounds.minY),new E(l.pageBounds.minX,l.pageBounds.maxY)],length:l.pageBounds.minX-s.pageBounds.maxX,breadthIntersection:wi(s.pageBounds.minY,s.pageBounds.maxY,l.pageBounds.minY,l.pageBounds.maxY)})}}const i=r.slice(0).sort((o,s)=>o.pageBounds.minY-s.pageBounds.minY);for(let o=0;o<i.length;o++){const s=i[o];for(let a=o+1;a<i.length;a++){const l=i[a];s.pageBounds.maxY<l.pageBounds.minY&&Eu(s.pageBounds.minX,s.pageBounds.maxX,l.pageBounds.minX,l.pageBounds.maxX)&&n.push({startNode:s,endNode:l,startEdge:[new E(s.pageBounds.minX,s.pageBounds.maxY),new E(s.pageBounds.maxX,s.pageBounds.maxY)],endEdge:[new E(l.pageBounds.minX,l.pageBounds.minY),new E(l.pageBounds.maxX,l.pageBounds.minY)],length:l.pageBounds.minY-s.pageBounds.maxY,breadthIntersection:wi(s.pageBounds.minX,s.pageBounds.maxX,l.pageBounds.minX,l.pageBounds.maxX)})}}return{horizontal:t,vertical:n}}snapTranslate({lockedAxis:t,initialSelectionPageBounds:n,initialSelectionSnapPoints:r,dragDelta:i}){var y,x;const o=t==="x",s=t==="y",a=n.clone().translate(i),l=r.map(({x:w,y:_},S)=>({id:"selection:"+S,x:w+i.x,y:_+i.y})),c=this.visibleSnapPointsNotInSelection,u=[],d=[],h=new E(this.snapThreshold,this.snapThreshold);this.findPointSnaps({minOffset:h,nearestSnapsX:u,nearestSnapsY:d,otherNodeSnapPoints:c,selectionSnapPoints:l}),this.findGapSnaps({selectionPageBounds:a,nearestSnapsX:u,nearestSnapsY:d,minOffset:h});const f=new E(o?0:((y=u[0])==null?void 0:y.nudge)??0,s?0:((x=d[0])==null?void 0:x.nudge)??0);h.x=0,h.y=0,u.length=0,d.length=0,l.forEach(w=>{w.x+=f.x,w.y+=f.y}),a.translate(f),this.findPointSnaps({minOffset:h,nearestSnapsX:u,nearestSnapsY:d,otherNodeSnapPoints:c,selectionSnapPoints:l}),this.findGapSnaps({selectionPageBounds:a,nearestSnapsX:u,nearestSnapsY:d,minOffset:h});const p=this.getPointSnapLines({nearestSnapsX:u,nearestSnapsY:d}),g=this.getGapSnapLines({selectionPageBounds:a,nearestSnapsX:u,nearestSnapsY:d});return this._snapLines.set([...g,...p]),{nudge:f}}snapLineHandleTranslate({lineId:t,handleId:n,handlePoint:r}){const i=this.editor.getShapeById(t);if(!i)return{nudge:new E(0,0)};const s=this.editor.getShapeUtil(b_).handles(i).sort(ir);if(s.length<3)return{nudge:new E(0,0)};const a=s.findIndex(g=>g.id===n),c=s[a].type==="vertex"?a/2:(a+1)/2,u=_a(i),d=1,h=this.editor.getPageTransform(i),f=u.segments.slice(0,Math.max(0,c-d)).map(g=>ie.applyToPoints(h,g.lut)),p=u.segments.slice(c+d).map(g=>ie.applyToPoints(h,g.lut));return this.snapHandleTranslate({handlePoint:r,additionalOutlines:[...f,...p]})}snapHandleTranslate({handlePoint:t,additionalOutlines:n=[]}){var a,l;const r=this.visibleShapesNotInSelection,i=[];for(const c of r){const u=this.editor.getShapeById(c.id);if(u.type==="text"||u.type==="icon")continue;const d=pr(this.editor.getOutlineById(c.id));((l=(a=this.editor.getShapeUtil(u)).isClosed)==null?void 0:l.call(a,u))&&d.push(d[0]),i.push(ie.applyToPoints(this.editor.getPageTransformById(u.id),d))}let o=this.snapThreshold,s=null;for(const c of[...i,...n])for(let u=0;u<c.length-1;u++){const d=c[u],h=c[u+1],f=E.DistanceToLineSegment(d,h,t);isNaN(f)||f<o&&(o=f,s=E.NearestPointOnLineSegment(d,h,t))}if(s){const c=[];return c.push({id:At(),type:"points",points:[s]}),this._snapLines.set(c),{nudge:E.Sub(s,t)}}return{nudge:new E(0,0)}}snapResize({initialSelectionPageBounds:t,dragDelta:n,handle:r,isAspectRatioLocked:i,isResizingFromCenter:o}){var P,I;const{box:s,scaleX:a,scaleY:l}=me.Resize(t,r,o?n.x*2:n.x,o?n.y*2:n.y,i);let c=r;a<0&&(c=DV(c)),l<0&&(c=RV(c)),o&&(s.center=t.center);const u=c==="top"||c==="bottom",d=c==="left"||c==="right",h=OT(c,s),f=this.visibleSnapPointsNotInSelection,p=[],g=[],y=new E(this.snapThreshold,this.snapThreshold);this.findPointSnaps({minOffset:y,nearestSnapsX:p,nearestSnapsY:g,otherNodeSnapPoints:f,selectionSnapPoints:h});const x=new E(u?0:((P=p[0])==null?void 0:P.nudge)??0,d?0:((I=g[0])==null?void 0:I.nudge)??0);if(i&&FV(c)&&x.len()!==0){const $=p.length&&g.length?Math.abs(x.x)<Math.abs(x.y)?"x":"y":p.length?"x":"y",L=t.aspectRatio;$==="x"?(g.length=0,x.y=x.x/L,(c==="bottom_left"||c==="top_right")&&(x.y=-x.y)):(p.length=0,x.x=x.y*L,(c==="bottom_left"||c==="top_right")&&(x.x=-x.x))}const w=E.Add(n,x),{box:_}=me.Resize(t,r,o?w.x*2:w.x,o?w.y*2:w.y,i);o&&(_.center=t.center);const S=OT("any",_);p.length=0,g.length=0,y.x=0,y.y=0,this.findPointSnaps({minOffset:y,nearestSnapsX:p,nearestSnapsY:g,otherNodeSnapPoints:f,selectionSnapPoints:S});const T=this.getPointSnapLines({nearestSnapsX:p,nearestSnapsY:g});return this._snapLines.set([...T]),{nudge:x}}findPointSnaps({selectionSnapPoints:t,otherNodeSnapPoints:n,minOffset:r,nearestSnapsX:i,nearestSnapsY:o}){for(const s of t)for(const a of n){const l=E.Sub(s,a),c=Math.abs(l.x),u=Math.abs(l.y);Te(c)<=Te(r.x)&&(Te(c)<Te(r.x)&&(i.length=0),i.push({type:"points",points:{thisPoint:s,otherPoint:a},nudge:a.x-s.x}),r.x=c),Te(u)<=Te(r.y)&&(Te(u)<Te(r.y)&&(o.length=0),o.push({type:"points",points:{thisPoint:s,otherPoint:a},nudge:a.y-s.y}),r.y=u)}}findGapSnaps({selectionPageBounds:t,minOffset:n,nearestSnapsX:r,nearestSnapsY:i}){for(const o of this.visibleGaps.horizontal){if(!Eu(o.breadthIntersection[0],o.breadthIntersection[1],t.minY,t.maxY))continue;const a=o.startEdge[0].x+o.length/2-t.center.x;if(o.length>t.width&&Te(Math.abs(a))<=Te(n.x)){Te(Math.abs(a))<Te(n.x)&&(r.length=0),n.x=Math.abs(a);const g={type:"gap_center",gap:o,nudge:a},y=r.find(({type:w})=>w==="gap_center"),x=y&&wi(o.breadthIntersection[0],o.breadthIntersection[1],y.gap.breadthIntersection[0],y.gap.breadthIntersection[1]);y&&y.gap.length>o.length&&x?r[r.indexOf(y)]=g:(!y||!x)&&r.push(g)}const c=o.startNode.pageBounds.minX-o.length,u=t.maxX,d=c-u;Te(Math.abs(d))<=Te(n.x)&&(Te(Math.abs(d))<Te(n.x)&&(r.length=0),n.x=Math.abs(d),r.push({type:"gap_duplicate",gap:o,protrusionDirection:"left",nudge:d}));const h=o.endNode.pageBounds.maxX+o.length,f=t.minX,p=h-f;Te(Math.abs(p))<=Te(n.x)&&(Te(Math.abs(p))<Te(n.x)&&(r.length=0),n.x=Math.abs(p),r.push({type:"gap_duplicate",gap:o,protrusionDirection:"right",nudge:p}))}for(const o of this.visibleGaps.vertical){if(!Eu(o.breadthIntersection[0],o.breadthIntersection[1],t.minX,t.maxX))continue;const a=o.startEdge[0].y+o.length/2-t.center.y;if(o.length>t.height&&Te(Math.abs(a))<=Te(n.y)){Te(Math.abs(a))<Te(n.y)&&(i.length=0),n.y=Math.abs(a);const g={type:"gap_center",gap:o,nudge:a},y=i.find(({type:w})=>w==="gap_center"),x=y&&Eu(y.gap.breadthIntersection[0],y.gap.breadthIntersection[1],o.breadthIntersection[0],o.breadthIntersection[1]);y&&y.gap.length>o.length&&x?i[i.indexOf(y)]=g:(!y||!x)&&i.push(g);continue}const c=o.startNode.pageBounds.minY-o.length,u=t.maxY,d=c-u;Te(Math.abs(d))<=Te(n.y)&&(Te(Math.abs(d))<Te(n.y)&&(i.length=0),n.y=Math.abs(d),i.push({type:"gap_duplicate",gap:o,protrusionDirection:"top",nudge:d}));const h=o.endNode.pageBounds.maxY+o.length,f=t.minY,p=h-f;Te(Math.abs(p))<=Te(n.y)&&(Te(Math.abs(p))<Te(n.y)&&(i.length=0),n.y=Math.abs(p),i.push({type:"gap_duplicate",gap:o,protrusionDirection:"bottom",nudge:p}))}}getPointSnapLines({nearestSnapsX:t,nearestSnapsY:n}){const r={},i={},o=[];if(t.length>0){for(const s of t)if(s.type==="points"){const a=Te(s.points.otherPoint.x);r[a]||(r[a]=[]),r[a].push(s.points)}}if(n.length>0){for(const s of n)if(s.type==="points"){const a=Te(s.points.otherPoint.y);i[a]||(i[a]=[]),i[a].push(s.points)}}for(const[s,a]of Object.entries(r).concat(Object.entries(i)))o.push({id:At(),type:"points",points:qg(a.map(l=>E.From(l.otherPoint)).concat(a.map(l=>E.From(l.thisPoint))),(l,c)=>l.equals(c))});return o}getGapSnapLines({selectionPageBounds:t,nearestSnapsX:n,nearestSnapsY:r}){const i={top:t.sides[0],right:t.sides[1],bottom:[t.corners[3],t.corners[2]],left:[t.corners[0],t.corners[3]]},o=[];if(n.length>0)for(const s of n){if(s.type==="gap_center"){const a=(s.gap.length-t.width)/2,l=wi(s.gap.breadthIntersection[0],s.gap.breadthIntersection[1],t.minY,t.maxY);o.push({type:"gaps",direction:"horizontal",id:At(),gaps:[...wo(this.visibleGaps.horizontal,s.gap.startNode.id,a,"backward",l),{startEdge:s.gap.startEdge,endEdge:i.left},{startEdge:i.right,endEdge:s.gap.endEdge},...wo(this.visibleGaps.horizontal,s.gap.endNode.id,a,"forward",l)]})}if(s.type==="gap_duplicate"){const a=wi(s.gap.breadthIntersection[0],s.gap.breadthIntersection[1],t.minY,t.maxY);o.push({type:"gaps",direction:"horizontal",id:At(),gaps:s.protrusionDirection==="left"?[{startEdge:i.right,endEdge:[E.Add(s.gap.startEdge[0],{x:-s.gap.startNode.pageBounds.width,y:0}),E.Add(s.gap.startEdge[1],{x:-s.gap.startNode.pageBounds.width,y:0})]},{startEdge:s.gap.startEdge,endEdge:s.gap.endEdge},...wo(this.visibleGaps.horizontal,s.gap.endNode.id,s.gap.length,"forward",a)]:[...wo(this.visibleGaps.horizontal,s.gap.startNode.id,s.gap.length,"backward",a),{startEdge:s.gap.startEdge,endEdge:s.gap.endEdge},{startEdge:[E.Add(s.gap.endEdge[0],{x:s.gap.endNode.pageBounds.width,y:0}),E.Add(s.gap.endEdge[1],{x:s.gap.endNode.pageBounds.width,y:0})],endEdge:i.left}]})}}if(r.length>0)for(const s of r){if(s.type==="gap_center"){const a=(s.gap.length-t.height)/2,l=wi(s.gap.breadthIntersection[0],s.gap.breadthIntersection[1],t.minX,t.maxX);o.push({type:"gaps",direction:"vertical",id:At(),gaps:[...wo(this.visibleGaps.vertical,s.gap.startNode.id,a,"backward",l),{startEdge:s.gap.startEdge,endEdge:i.top},{startEdge:i.bottom,endEdge:s.gap.endEdge},...wo(this.visibleGaps.vertical,s.gap.endNode.id,a,"forward",l)]})}if(s.type==="gap_duplicate"){const a=wi(s.gap.breadthIntersection[0],s.gap.breadthIntersection[1],t.minX,t.maxX);o.push({type:"gaps",direction:"vertical",id:At(),gaps:s.protrusionDirection==="top"?[{startEdge:i.bottom,endEdge:[E.Add(s.gap.startEdge[0],{x:0,y:-s.gap.startNode.pageBounds.height}),E.Add(s.gap.startEdge[1],{x:0,y:-s.gap.startNode.pageBounds.height})]},{startEdge:s.gap.startEdge,endEdge:s.gap.endEdge},...wo(this.visibleGaps.vertical,s.gap.endNode.id,s.gap.length,"forward",a)]:[...wo(this.visibleGaps.vertical,s.gap.startNode.id,s.gap.length,"backward",a),{startEdge:s.gap.startEdge,endEdge:s.gap.endEdge},{startEdge:[E.Add(s.gap.endEdge[0],{x:0,y:s.gap.endNode.pageBounds.height}),E.Add(s.gap.endEdge[1],{x:0,y:s.gap.endNode.pageBounds.height})],endEdge:i.top}]})}}return PJ(o),o}}$y([ce],jh.prototype,"snapPointsCache",1);$y([ce],jh.prototype,"visibleShapesNotInSelection",1);$y([ce],jh.prototype,"visibleSnapPointsNotInSelection",1);$y([ce],jh.prototype,"visibleGaps",1);function OT(e,t){const{minX:n,maxX:r,minY:i,maxY:o}=t,s=[];switch(e){case"top":case"left":case"top_left":case"any":s.push({id:"top_left",handle:"top_left",x:n,y:i})}switch(e){case"top":case"right":case"top_right":case"any":s.push({id:"top_right",handle:"top_right",x:r,y:i})}switch(e){case"bottom":case"right":case"bottom_right":case"any":s.push({id:"bottom_right",handle:"bottom_right",x:r,y:o})}switch(e){case"bottom":case"left":case"bottom_left":case"any":s.push({id:"bottom_left",handle:"bottom_left",x:n,y:o})}return s}const IJ={start:"left","start-legacy":"left",middle:"center","middle-legacy":"center",end:"right","end-legacy":"right"},$J=/\s/;class AJ{constructor(t){v(this,"measureText",(t,n)=>{const r=this.getTextElement();r.setAttribute("dir","ltr"),r.style.setProperty("font-family",n.fontFamily),r.style.setProperty("font-style",n.fontStyle),r.style.setProperty("font-weight",n.fontWeight),r.style.setProperty("font-size",n.fontSize+"px"),r.style.setProperty("line-height",n.lineHeight*n.fontSize+"px"),r.style.setProperty("width",n.width),r.style.setProperty("min-width",n.minWidth??null),r.style.setProperty("max-width",n.maxWidth),r.style.setProperty("padding",n.padding),r.textContent=Us.normalizeTextForDom(t);const i=r.getBoundingClientRect();return{x:0,y:0,w:i.width,h:i.height}});this.editor=t}getTextElement(){const t=document.querySelector(".tl-text-measure");t==null||t.remove();const n=document.createElement("div");return this.editor.getContainer().appendChild(n),n.id=`__textMeasure_${At()}`,n.classList.add("tl-text"),n.classList.add("tl-text-measure"),n.tabIndex=-1,n}measureElementTextNodeSpans(t,{shouldTruncateToFirstLine:n=!1}={}){const r=[],i=t.getBoundingClientRect(),o=-i.left,s=-i.top,a=new Range,l=t.childNodes[0];let c=0,u=null,d=null,h=0,f=!1;for(const p of t.childNodes)if(p.nodeType===Node.TEXT_NODE)for(const g of p.textContent??""){a.setStart(l,c),a.setEnd(l,c+g.length);const y=a.getClientRects(),x=y[y.length-1],w=x.top+s,_=x.left+o,S=x.right+o,T=$J.test(g);if(T!==d||w!==h||!u){if(u){if(n&&w!==h){f=!0;break}r.push(u)}u={box:{x:_,y:w,w:x.width,h:x.height},text:g}}else u.box.w=S-u.box.x,u.text+=g;d=T,h=w,c+=g.length}return u&&r.push(u),{spans:r,didTruncate:f}}measureTextSpans(t,n){const r=n.overflow==="truncate-ellipsis"||n.overflow==="truncate-clip",i=this.getTextElement(),o=Math.ceil(n.width-n.padding*2);i.style.setProperty("width",`${o}px`),i.style.setProperty("height","min-content"),i.style.setProperty("dir","ltr"),i.style.setProperty("font-size",`${n.fontSize}px`),i.style.setProperty("font-family",n.fontFamily),i.style.setProperty("font-weight",n.fontWeight),i.style.setProperty("line-height",`${n.lineHeight*n.fontSize}px`),i.style.setProperty("text-align",IJ[n.textAlign]),r&&(i.style.setProperty("overflow-wrap","anywhere"),i.style.setProperty("word-break","break-all")),i.textContent=t;const{spans:s,didTruncate:a}=this.measureElementTextNodeSpans(i,{shouldTruncateToFirstLine:r});if(n.overflow==="truncate-ellipsis"&&a){i.textContent="…";const l=Math.ceil(this.measureElementTextNodeSpans(i).spans[0].box.w);i.style.setProperty("width",`${o-l}px`),i.textContent=t;const c=this.measureElementTextNodeSpans(i,{shouldTruncateToFirstLine:!0}).spans,u=c[c.length-1];return c.push({text:"…",box:{x:Math.min(u.box.x+u.box.w,n.width-n.padding-l),y:u.box.y,w:l,h:u.box.h}}),c}return i.remove(),s}}class MJ{constructor(t){v(this,"raf");v(this,"isPaused",!0);v(this,"last",0);v(this,"t",0);v(this,"start",()=>{this.isPaused=!1,cancelAnimationFrame(this.raf),this.raf=requestAnimationFrame(this.tick),this.last=Date.now()});v(this,"tick",()=>{if(this.isPaused)return;const t=Date.now(),n=t-this.last;if(this.last=t,this.t+=n,this.editor.emit("frame",n),this.t<16){this.raf=requestAnimationFrame(this.tick);return}this.t-=16,this.updatePointerVelocity(n),this.editor.emit("tick",n),this.raf=requestAnimationFrame(this.tick)});v(this,"dispose",()=>{this.isPaused=!0,cancelAnimationFrame(this.raf)});v(this,"prevPoint",new E);v(this,"updatePointerVelocity",t=>{const{prevPoint:n,editor:{inputs:{currentScreenPoint:r,pointerVelocity:i}}}=this;if(t===0)return;const o=E.Sub(r,n);this.prevPoint=r.clone();const s=o.len(),a=s?o.div(s):new E(0,0),l=i.clone().lrp(a.mul(s/t),.5);Math.abs(l.x)<.01&&(l.x=0),Math.abs(l.y)<.01&&(l.y=0),i.equals(l)||(this.editor.inputs.pointerVelocity=l)});this.editor=t,this.editor.disposables.add(this.dispose),this.start()}}class OJ{constructor(t){v(this,"updateUserPreferences",t=>{this.user.setUserPreferences({...this.user.userPreferences.value,...t})});this.user=t}get isDarkMode(){return this.user.userPreferences.value.isDarkMode}get animationSpeed(){return this.user.userPreferences.value.animationSpeed}get id(){return this.user.userPreferences.value.id}get name(){return this.user.userPreferences.value.name}get locale(){return this.user.userPreferences.value.locale}get color(){return this.user.userPreferences.value.color}get isSnapMode(){return this.user.userPreferences.value.isSnapMode}}class y6 extends ve{constructor(){super(...arguments);v(this,"info",{});v(this,"brush",new me);v(this,"initialSelectedIds",[]);v(this,"excludedShapeIds",new Set);v(this,"initialStartShape",null);v(this,"onEnter",n=>{const{altKey:r,currentPagePoint:i}=this.editor.inputs;if(r){this.parent.transition("scribble_brushing",n);return}this.excludedShapeIds=new Set(this.editor.shapesArray.filter(o=>o.type==="group"||this.editor.isShapeOrAncestorLocked(o)).map(o=>o.id)),this.info=n,this.initialSelectedIds=this.editor.selectedIds.slice(),this.initialStartShape=this.editor.getShapesAtPoint(i)[0],this.onPointerMove()});v(this,"onExit",()=>{this.initialSelectedIds=[],this.editor.setBrush(null)});v(this,"onPointerMove",()=>{this.hitTestShapes()});v(this,"onPointerUp",()=>{this.complete()});v(this,"onComplete",()=>{this.complete()});v(this,"onCancel",n=>{this.editor.setSelectedIds(this.initialSelectedIds,!0),this.parent.transition("idle",n)});v(this,"onKeyDown",n=>{this.editor.inputs.altKey?this.parent.transition("scribble_brushing",n):this.hitTestShapes()});v(this,"onKeyUp",()=>{this.hitTestShapes()});v(this,"onInterrupt",()=>{this.editor.setBrush(null)})}complete(){this.parent.transition("idle",{})}hitTestShapes(){const{currentPageId:n,shapesArray:r,inputs:{originPagePoint:i,currentPagePoint:o,shiftKey:s,ctrlKey:a}}=this.editor;this.brush.setTo(me.FromPoints([i,o]));const l=new Set(s?this.initialSelectedIds:[]);let c,u,d,h,f,p,g;const{corners:y}=this.brush,{excludedShapeIds:x}=this;e:for(let w=0,_=r.length;w<_;w++){if(d=r[w],x.has(d.id)||l.has(d.id)||(f=this.editor.getPageBounds(d),!f))continue e;if(this.brush.contains(f)){this.handleHit(d,o,n,l,y);continue e}if(a||d.type==="frame")continue e;if(this.brush.collides(f)){if(h=this.editor.getShapeUtil(d),p=this.editor.getPageTransform(d),!p)continue e;g=ie.applyToPoints(ie.Inverse(p),y);t:for(let S=0;S<g.length;S++)if(c=g[S],u=g[(S+1)%g.length],h.hitTestLineSegment(d,c,u)){this.handleHit(d,o,n,l,y);break t}}}this.editor.setBrush({...this.brush.toJson()}),this.editor.setSelectedIds(Array.from(l),!0)}handleHit(n,r,i,o,s){if(n.parentId===i){o.add(n.id);return}const a=this.editor.getOutermostSelectableShape(n),l=this.editor.getPageMaskById(a.id);l&&qV(l,s)!==null&&!ai(r,l)||o.add(a.id)}}v(y6,"id","brushing");function v6(e,t,n){if(!t)throw Error("Needs to translate a cropped shape!");const{crop:r}=t.props;if(!r)return;const i=e.inputs.shiftKey?Math.abs(n.x)<Math.abs(n.y)?"x":"y":null;i==="x"?n.x=0:i==="y"&&(n.y=0),n.rot(-t.rotation);const o=1/(r.bottomRight.x-r.topLeft.x)*t.props.w,s=1/(r.bottomRight.y-r.topLeft.y)*t.props.h,a=r.bottomRight.y-r.topLeft.y,l=r.bottomRight.x-r.topLeft.x,c=pr(r);return c.topLeft.x=Math.min(1-l,Math.max(0,c.topLeft.x-n.x/o)),c.topLeft.y=Math.min(1-a,Math.max(0,c.topLeft.y-n.y/s)),c.bottomRight.x=c.topLeft.x+l,c.bottomRight.y=c.topLeft.y+a,{id:t.id,type:t.type,props:{crop:c}}}var Z1;let LJ=(Z1=class extends ve{constructor(){super(...arguments);v(this,"onEnter",()=>{this.editor.setCursor({type:"default"});const{onlySelectedShape:n}=this.editor;this.editor.on("change-history",this.cleanupCroppingState),this.editor.mark("crop"),n&&this.editor.setCroppingId(n.id)});v(this,"onExit",()=>{this.editor.setCursor({type:"default"}),this.editor.off("change-history",this.cleanupCroppingState)});v(this,"onCancel",()=>{this.editor.setCroppingId(null),this.editor.setSelectedTool("select.idle",{})});v(this,"onPointerDown",n=>{var r;if(!this.editor.isMenuOpen){if(n.ctrlKey){this.editor.setCroppingId(null),this.editor.setSelectedTool("select.brushing",n);return}switch(n.target){case"canvas":{this.cancel();break}case"shape":{if(n.shape.id===this.editor.croppingId){this.editor.setSelectedTool("select.crop.pointing_crop",n);return}else(r=this.editor.getShapeUtil(n.shape))!=null&&r.canCrop(n.shape)?(this.editor.setCroppingId(n.shape.id),this.editor.setSelectedIds([n.shape.id]),this.editor.setSelectedTool("select.crop.pointing_crop",n)):this.cancel();break}case"selection":{switch(n.handle){case"mobile_rotate":case"top_left_rotate":case"top_right_rotate":case"bottom_left_rotate":case"bottom_right_rotate":{this.editor.setSelectedTool("select.pointing_rotate_handle",{...n,onInteractionEnd:"select.crop"});break}case"top":case"right":case"bottom":case"left":{this.editor.setSelectedTool("select.pointing_crop_handle",{...n,onInteractionEnd:"select.crop"});break}case"top_left":case"top_right":case"bottom_left":case"bottom_right":{this.editor.setSelectedTool("select.pointing_crop_handle",{...n,onInteractionEnd:"select.crop"});break}default:this.cancel()}break}}}});v(this,"onDoubleClick",n=>{var o;if(n.phase!=="up"||!this.editor.croppingId)return;const r=this.editor.getShapeById(this.editor.croppingId);if(!r)return;const i=this.editor.getShapeUtil(r);i&&n.target==="selection"&&((o=i.onDoubleClickEdge)==null||o.call(i,r))});v(this,"onKeyDown",()=>{this.nudgeCroppingImage(!1)});v(this,"onKeyRepeat",()=>{this.nudgeCroppingImage(!0)});v(this,"onKeyUp",n=>{switch(n.code){case"Enter":{this.editor.setCroppingId(null),this.editor.setSelectedTool("select.idle",{});break}}});v(this,"cleanupCroppingState",()=>{this.editor.croppingId||this.editor.setSelectedTool("select.idle",{})})}cancel(){this.editor.setCroppingId(null),this.editor.setSelectedTool("select.idle",{})}nudgeCroppingImage(n=!1){const{editor:{inputs:{keys:r}}}=this,i=r.has("ShiftLeft"),o=new E(0,0);if(r.has("ArrowLeft")&&(o.x+=1),r.has("ArrowRight")&&(o.x-=1),r.has("ArrowUp")&&(o.y+=1),r.has("ArrowDown")&&(o.y-=1),o.equals(new E(0,0)))return;i&&o.mul(10);const s=this.editor.getShapeById(this.editor.croppingId);if(!s)return;const a=v6(this.editor,s,o);a&&(n||this.editor.mark("translate crop"),this.editor.updateShapes([a]))}},v(Z1,"id","idle"),Z1);class x6 extends ve{constructor(){super(...arguments);v(this,"onCancel",()=>{this.editor.setSelectedTool("select.crop.idle",{})});v(this,"onPointerMove",n=>{this.editor.inputs.isDragging&&this.editor.setSelectedTool("select.crop.translating_crop",n)});v(this,"onPointerUp",n=>{this.editor.setSelectedTool("select.crop.idle",n)})}}v(x6,"id","pointing_crop");class b6 extends ve{constructor(){super(...arguments);v(this,"info",{});v(this,"markId","translating crop");v(this,"snapshot",{});v(this,"onEnter",n=>{this.info=n,this.snapshot=this.createSnapshot(),this.editor.mark(this.markId),this.editor.setCursor({type:"move"}),this.updateShapes()});v(this,"onExit",()=>{this.editor.setCursor({type:"default"})});v(this,"onPointerMove",()=>{this.updateShapes()});v(this,"onPointerUp",()=>{this.complete()});v(this,"onComplete",()=>{this.complete()});v(this,"onCancel",()=>{this.cancel()});v(this,"onKeyDown",n=>{switch(n.key){case"Alt":case"Shift":{this.updateShapes();return}}});v(this,"onKeyUp",n=>{switch(n.key){case"Enter":{this.complete();return}case"Alt":case"Shift":this.updateShapes()}})}complete(){this.updateShapes(),this.editor.setSelectedTool("select.crop.idle",this.info)}cancel(){this.editor.bailToMark(this.markId),this.editor.setSelectedTool("select.crop.idle",this.info)}createSnapshot(){return{shape:this.editor.onlySelectedShape}}updateShapes(){const n=this.snapshot.shape;if(!n)return;const{originPagePoint:r,currentPagePoint:i}=this.editor.inputs,o=i.clone().sub(r),s=v6(this.editor,n,o);s&&this.editor.updateShapes([s],!0)}}v(b6,"id","translating_crop");class Jp extends ve{}v(Jp,"id","crop"),v(Jp,"initial","idle"),v(Jp,"children",()=>[LJ,b6,x6]);const Ac={bottom:"ns-resize",top:"ns-resize",left:"ew-resize",right:"ew-resize",bottom_left:"nesw-resize",bottom_right:"nwse-resize",top_left:"nwse-resize",top_right:"nesw-resize",bottom_left_rotate:"swne-rotate",bottom_right_rotate:"senw-rotate",top_left_rotate:"nwse-rotate",top_right_rotate:"nesw-rotate",mobile_rotate:"grabbing"};class w6 extends ve{constructor(){super(...arguments);v(this,"info",{});v(this,"onEnter",n=>{this.info=n,this.updateCursor()});v(this,"onPointerMove",()=>{this.editor.inputs.isDragging&&this.parent.transition("resizing",this.info)});v(this,"onPointerUp",()=>{this.complete()});v(this,"onCancel",()=>{this.cancel()});v(this,"onComplete",()=>{this.cancel()});v(this,"onInterrupt",()=>{this.cancel()})}updateCursor(){const n=this.editor.selectedShapes,r=Ac[this.info.handle];this.editor.setCursor({type:r,rotation:n.length===1?n[0].rotation:0})}complete(){this.info.onInteractionEnd?this.editor.setSelectedTool(this.info.onInteractionEnd,{}):this.parent.transition("idle",{})}cancel(){this.info.onInteractionEnd?this.editor.setSelectedTool(this.info.onInteractionEnd,{}):this.parent.transition("idle",{})}}v(w6,"id","pointing_resize_handle");class S6 extends ve{constructor(){super(...arguments);v(this,"info",{});v(this,"markId","");v(this,"snapshot",{});v(this,"onEnter",n=>{this.info=n,this.markId=this.editor.mark("cropping"),this.snapshot=this.createSnapshot(),this.updateShapes()});v(this,"onPointerMove",()=>{this.updateShapes()});v(this,"onPointerUp",()=>{this.complete()});v(this,"onComplete",()=>{this.complete()});v(this,"onCancel",()=>{this.cancel()});v(this,"getDefaultCrop",()=>({topLeft:{x:0,y:0},bottomRight:{x:1,y:1}}))}updateCursor(){const n=this.editor.selectedShapes[0];if(!n)return;const r=Ac[this.info.handle];this.editor.setCursor({type:r,rotation:n.rotation})}updateShapes(){const{shape:n,cursorHandleOffset:r}=this.snapshot;if(!n||!this.editor.getShapeUtil(x_))return;const o=n.props,s=this.editor.inputs.currentPagePoint.clone().sub(r),a=this.editor.inputs.originPagePoint.clone().sub(r),l=s.clone().sub(a).rot(-n.rotation),c=o.crop??this.getDefaultCrop(),u=pr(c),d=new E(n.x,n.y),h=new E(0,0),f=1/(c.bottomRight.x-c.topLeft.x)*o.w,p=1/(c.bottomRight.y-c.topLeft.y)*o.h;let g=!1;switch(this.info.handle){case"top":case"top_left":case"top_right":{if(p<zr)break;g=!0,u.topLeft.y=u.topLeft.y+l.y/p,p*(u.bottomRight.y-u.topLeft.y)<zr?(u.topLeft.y=u.bottomRight.y-zr/p,h.y=(u.topLeft.y-c.topLeft.y)*p):u.topLeft.y<=0?(u.topLeft.y=0,h.y=(u.topLeft.y-c.topLeft.y)*p):h.y=l.y;break}case"bottom":case"bottom_left":case"bottom_right":{if(p<zr)break;g=!0,u.bottomRight.y=Math.min(1,u.bottomRight.y+l.y/p),p*(u.bottomRight.y-u.topLeft.y)<zr&&(u.bottomRight.y=u.topLeft.y+zr/p);break}}switch(this.info.handle){case"left":case"top_left":case"bottom_left":{if(f<zr)break;g=!0,u.topLeft.x=u.topLeft.x+l.x/f,f*(u.bottomRight.x-u.topLeft.x)<zr?(u.topLeft.x=u.bottomRight.x-zr/f,h.x=(u.topLeft.x-c.topLeft.x)*f):u.topLeft.x<=0?(u.topLeft.x=0,h.x=(u.topLeft.x-c.topLeft.x)*f):h.x=l.x;break}case"right":case"top_right":case"bottom_right":{if(f<zr)break;g=!0,u.bottomRight.x=Math.min(1,u.bottomRight.x+l.x/f),f*(u.bottomRight.x-u.topLeft.x)<zr&&(u.bottomRight.x=u.topLeft.x+zr/f);break}}if(!g)return;d.add(h.rot(n.rotation));const y={id:n.id,type:n.type,x:d.x,y:d.y,props:{crop:u,w:(u.bottomRight.x-u.topLeft.x)*f,h:(u.bottomRight.y-u.topLeft.y)*p}};this.editor.updateShapes([y],!0),this.updateCursor()}complete(){this.info.onInteractionEnd?this.editor.setSelectedTool(this.info.onInteractionEnd,this.info):(this.editor.setCroppingId(null),this.parent.transition("idle",{}))}cancel(){this.editor.bailToMark(this.markId),this.info.onInteractionEnd?this.editor.setSelectedTool(this.info.onInteractionEnd,this.info):(this.editor.setCroppingId(null),this.parent.transition("idle",{}))}createSnapshot(){const{selectionRotation:n,inputs:{originPagePoint:r}}=this.editor,i=this.editor.onlySelectedShape,o=this.editor.selectionBounds,s=E.RotWith(o.getHandlePoint(this.info.handle),o.point,n),a=E.Sub(r,s);return{shape:i,cursorHandleOffset:a}}}v(S6,"id","cropping");class _6 extends ve{constructor(){super(...arguments);v(this,"shapeId","");v(this,"initialHandle",{});v(this,"initialAdjacentHandle",null);v(this,"markId","");v(this,"initialPageTransform");v(this,"initialPageRotation");v(this,"info",{});v(this,"isPrecise",!1);v(this,"isPreciseId",null);v(this,"pointingId",null);v(this,"onEnter",n=>{const{shape:r,isCreating:i,handle:o}=n;this.info=n,this.shapeId=r.id,this.markId=i?"creating":this.editor.mark("dragging handle"),this.initialHandle=pr(o),this.initialPageTransform=this.editor.getPageTransform(r),this.initialPageRotation=this.editor.getPageRotation(r),this.editor.setCursor({type:i?"cross":"grabbing",rotation:0});const s=this.editor.getShapeUtil(r).handles(r).sort(ir),a=s.findIndex(c=>c.id===n.handle.id);this.initialAdjacentHandle=null;for(let c=a+1;c<s.length;c++){const u=s[c];if(u.type==="vertex"&&u.id!=="middle"&&u.id!==n.handle.id){this.initialAdjacentHandle=u;break}}if(!this.initialAdjacentHandle)for(let c=s.length-1;c>=0;c--){const u=s[c];if(u.type==="vertex"&&u.id!=="middle"&&u.id!==n.handle.id){this.initialAdjacentHandle=u;break}}const l=r.props[n.handle.id];this.isPrecise=!1,(l==null?void 0:l.type)==="binding"&&(this.editor.setHintingIds([l.boundShapeId]),this.isPrecise=!E.Equals(l.normalizedAnchor,{x:.5,y:.5}),this.isPrecise?this.isPreciseId=l.boundShapeId:this.resetExactTimeout()),this.update()});v(this,"exactTimeout",-1);v(this,"onPointerMove",()=>{this.update()});v(this,"onKeyDown",()=>{this.update()});v(this,"onKeyUp",()=>{this.update()});v(this,"onPointerUp",()=>{this.complete()});v(this,"onComplete",()=>{this.complete()});v(this,"onCancel",()=>{this.cancel()});v(this,"onExit",()=>{this.editor.setHintingIds([]),this.editor.snaps.clear(),this.editor.setCursor({type:"default"})})}resetExactTimeout(){this.exactTimeout!==-1&&this.clearExactTimeout(),this.exactTimeout=setTimeout(()=>{this.isActive&&!this.isPrecise&&(this.isPrecise=!0,this.isPreciseId=this.pointingId,this.update()),this.exactTimeout=-1},750)}clearExactTimeout(){this.exactTimeout!==-1&&(clearTimeout(this.exactTimeout),this.exactTimeout=-1)}complete(){this.editor.snaps.clear();const{onInteractionEnd:n}=this.info;if(this.editor.instanceState.isToolLocked&&n){this.editor.setSelectedTool(n,{shapeId:this.shapeId});return}this.parent.transition("idle",{})}cancel(){this.editor.bailToMark(this.markId),this.editor.snaps.clear();const{onInteractionEnd:n}=this.info;if(n){this.editor.setSelectedTool(n,{shapeId:this.shapeId});return}this.parent.transition("idle",{})}update(){var h;const{currentPagePoint:n,originPagePoint:r,shiftKey:i}=this.editor.inputs,o=this.editor.getShapeById(this.shapeId);if(!o)return;let s=E.Add(E.Rot(E.Sub(n,r),-this.initialPageRotation),this.initialHandle);if(i&&this.initialHandle.id!=="middle"){const{initialAdjacentHandle:f}=this;if(f){const p=E.Angle(f,s),y=tm(p,24)-p;s=E.RotWith(s,f,y)}}this.editor.snaps.clear();const{ctrlKey:a}=this.editor.inputs;if((this.editor.isSnapMode?!a:a)&&o.type==="line"){const f=ie.applyToPoint(this.editor.getPageTransformById(o.id),s),p=this.editor.snaps.snapLineHandleTranslate({lineId:o.id,handleId:this.initialHandle.id,handlePoint:f}),{nudge:g}=p;if(g.x||g.y){const y=this.editor.getDeltaInShapeSpace(o,g);s=E.Add(s,y)}}const c=this.editor.getShapeUtil(o),u=(h=c.onHandleChange)==null?void 0:h.call(c,o,{handle:{...this.initialHandle,x:s.x,y:s.y},isPrecise:this.isPrecise||this.editor.inputs.altKey}),d={...o,...u};if(this.initialHandle.canBind){const f=d.props[this.initialHandle.id];(f==null?void 0:f.type)==="binding"?this.editor.hintingIds[0]!==f.boundShapeId&&(this.editor.setHintingIds([f.boundShapeId]),this.pointingId=f.boundShapeId,this.isPrecise=this.editor.inputs.pointerVelocity.len()<.5||this.editor.inputs.altKey,this.isPreciseId=this.isPrecise?f.boundShapeId:null,this.resetExactTimeout()):this.editor.hintingIds.length>0&&(this.editor.setHintingIds([]),this.pointingId=null,this.isPrecise=!1,this.isPreciseId=null,this.resetExactTimeout())}u&&this.editor.updateShapes([d],!0)}}v(_6,"id","dragging_handle");class C6 extends ve{constructor(){super(...arguments);v(this,"onPointerEnter",n=>{switch(n.target){case"shape":{const{selectedIds:r,focusLayerId:i}=this.editor,o=this.editor.getOutermostSelectableShape(n.shape,s=>!r.includes(s.id));o.id!==i&&this.editor.setHoveredId(o.id);break}}});v(this,"onPointerLeave",n=>{switch(n.target){case"shape":{this.editor.setHoveredId(null);break}}});v(this,"onExit",()=>{var o;if(!this.editor.pageState.editingId)return;const{editingId:n}=this.editor.pageState;if(!n)return;this.editor.setEditingId(null);const r=this.editor.getShapeById(n),i=this.editor.getShapeUtil(r);(o=i.onEditEnd)==null||o.call(i,r)});v(this,"onPointerDown",n=>{var r,i,o,s;switch(n.target){case"shape":{const{shape:a}=n,{editingId:l}=this.editor.pageState;if(l){if(a.id===l)return;const c=this.editor.getShapeById(l);if(c){const u=this.editor.getShapeUtil(c);(r=u.onEditEnd)==null||r.call(u,c);const d=this.editor.getShapeUtil(a);if(a.type===c.type&&((i=d.canEdit)!=null&&i.call(d,a))&&!this.editor.isShapeOrAncestorLocked(a)){this.editor.setEditingId(a.id),this.editor.setHoveredId(a.id),this.editor.setSelectedIds([a.id]);return}}}}}this.parent.transition("idle",n),(s=(o=this.parent.current.value)==null?void 0:o.onPointerDown)==null||s.call(o,n)});v(this,"onComplete",n=>{this.parent.transition("idle",n)});v(this,"onCancel",n=>{this.parent.transition("idle",n)})}}v(C6,"id","editing_shape");var Q1;let BJ=(Q1=class extends ve{constructor(){super(...arguments);v(this,"isDarwin",window.navigator.userAgent.toLowerCase().indexOf("mac")>-1);v(this,"onPointerEnter",n=>{switch(n.target){case"canvas":break;case"shape":{const{selectedIds:r,focusLayerId:i}=this.editor,o=this.editor.getOutermostSelectableShape(n.shape,s=>!r.includes(s.id));if(o.id!==i&&this.editor.setHoveredId(o.id),nn.debugCursors.value){if(o.type!=="geo")break;const s=o.props.text;try{this.editor.setCursor({type:s})}catch{console.error(`Cursor type not recognized: '${s}'`),this.editor.setCursor({type:"default"})}}break}}});v(this,"onPointerLeave",n=>{switch(n.target){case"shape":{this.editor.setHoveredId(null);break}}});v(this,"onPointerDown",n=>{if(this.editor.isMenuOpen)return;const r=this.shouldEnterCropMode(n,!0);if(n.ctrlKey&&!r){if(n.target==="shape"&&this.isDarwin&&this.editor.inputs.keys.has("ControlLeft")&&!this.editor.isShapeOrAncestorLocked(n.shape)){this.parent.transition("pointing_shape",n);return}this.parent.transition("brushing",n);return}switch(n.target){case"canvas":{this.parent.transition("pointing_canvas",n);break}case"shape":{if(this.editor.isShapeOrAncestorLocked(n.shape))break;this.parent.transition("pointing_shape",n);break}case"handle":{if(this.editor.isReadOnly)break;this.editor.inputs.altKey?this.parent.transition("pointing_shape",n):this.parent.transition("pointing_handle",n);break}case"selection":{switch(n.handle){case"mobile_rotate":case"top_left_rotate":case"top_right_rotate":case"bottom_left_rotate":case"bottom_right_rotate":{this.parent.transition("pointing_rotate_handle",n);break}case"top":case"right":case"bottom":case"left":{r?this.parent.transition("pointing_crop_handle",n):this.parent.transition("pointing_resize_handle",n);break}case"top_left":case"top_right":case"bottom_left":case"bottom_right":{r?this.parent.transition("pointing_crop_handle",n):this.parent.transition("pointing_resize_handle",n);break}default:this.parent.transition("pointing_selection",n)}break}}});v(this,"onDoubleClick",n=>{var r,i,o,s;if(n.phase==="up")switch(n.target){case"canvas":{if(this.editor.isReadOnly)break;this.createTextShapeAtPoint(n);break}case"selection":{if(this.editor.isReadOnly)break;const{onlySelectedShape:a}=this.editor;if(a){const l=this.editor.getShapeUtil(a);if(n.handle==="right"||n.handle==="left"||n.handle==="top"||n.handle==="bottom"){const c=(r=l.onDoubleClickEdge)==null?void 0:r.call(l,a);if(c){this.editor.mark("double click edge"),this.editor.updateShapes([c]);return}}if(l.canCrop(a)&&!this.editor.isShapeOrAncestorLocked(a)){this.parent.transition("crop",n);return}this.shouldStartEditingShape(a)&&this.startEditingShape(a,n)}break}case"shape":{const{shape:a}=n,l=this.editor.getShapeUtil(a);if(a.type!=="video"&&a.type!=="embed"&&this.editor.isReadOnly)break;if(l.onDoubleClick){const c=(i=l.onDoubleClick)==null?void 0:i.call(l,a);if(c){this.editor.updateShapes([c]);return}else if(l.canCrop(a)&&!this.editor.isShapeOrAncestorLocked(a)){this.editor.mark("select and crop"),this.editor.select((o=n.shape)==null?void 0:o.id),this.parent.transition("crop",n);return}}this.shouldStartEditingShape(a)?this.startEditingShape(a,n):this.createTextShapeAtPoint(n);break}case"handle":{if(this.editor.isReadOnly)break;const{shape:a,handle:l}=n,c=this.editor.getShapeUtil(a),u=(s=c.onDoubleClickHandle)==null?void 0:s.call(c,a,l);u?this.editor.updateShapes([u]):this.shouldStartEditingShape(a)&&this.startEditingShape(a,n)}}});v(this,"onRightClick",n=>{switch(n.target){case"canvas":{this.editor.selectNone();break}case"shape":{const{selectedIds:r}=this.editor.pageState,{shape:i}=n,o=this.editor.getOutermostSelectableShape(i,s=>!this.editor.isSelected(s.id));r.includes(o.id)||(this.editor.mark("selecting shape"),this.editor.setSelectedIds([o.id]));break}}});v(this,"onEnter",()=>{this.editor.setHoveredId(null),this.editor.setCursor({type:"default"})});v(this,"onCancel",()=>{this.editor.focusLayerId!==this.editor.currentPageId&&this.editor.selectedIds.length>0?this.editor.popFocusLayer():(this.editor.mark("clearing selection"),this.editor.selectNone())});v(this,"onKeyDown",n=>{switch(n.code){case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"ArrowDown":{this.nudgeSelectedShapes(!1);break}}});v(this,"onKeyRepeat",n=>{switch(n.code){case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"ArrowDown":{this.nudgeSelectedShapes(!0);break}}});v(this,"onKeyUp",n=>{if(this.editor.isReadOnly)switch(n.code){case"Enter":{if(this.shouldStartEditingShape()&&this.editor.onlySelectedShape){this.startEditingShape(this.editor.onlySelectedShape,{...n,target:"shape",shape:this.editor.onlySelectedShape});return}break}}else switch(n.code){case"Enter":{const{selectedShapes:r}=this.editor;if(r.every(i=>i.type==="group")){this.editor.setSelectedIds(r.flatMap(i=>this.editor.getSortedChildIds(i.id)));return}if(this.shouldStartEditingShape()&&this.editor.onlySelectedShape){this.startEditingShape(this.editor.onlySelectedShape,{...n,target:"shape",shape:this.editor.onlySelectedShape});return}this.shouldEnterCropMode(n,!1)&&this.parent.transition("crop",n);break}}})}shouldStartEditingShape(n=this.editor.onlySelectedShape){return!n||this.editor.isShapeOrAncestorLocked(n)&&n.type!=="embed"?!1:this.editor.getShapeUtil(n).canEdit(n)}shouldEnterCropMode(n,r){const i=this.editor.onlySelectedShape;if(!i||this.editor.isShapeOrAncestorLocked(i))return!1;const o=this.editor.getShapeUtil(i);return r?o.canCrop(i)&&n.ctrlKey:o.canCrop(i)}startEditingShape(n,r){this.editor.isShapeOrAncestorLocked(n)&&n.type!=="embed"||(this.editor.mark("editing shape"),this.editor.setEditingId(n.id),this.parent.transition("editing_shape",r))}createTextShapeAtPoint(n){this.editor.mark("creating text shape");const r=gt(),{x:i,y:o}=this.editor.inputs.currentPagePoint;this.editor.createShapes([{id:r,type:"text",x:i,y:o,props:{text:"",autoSize:!0}}]);const s=this.editor.getShapeById(r);if(!s)return;const a=this.editor.getBounds(s);this.editor.updateShapes([{id:r,type:"text",x:s.x-a.width/2,y:s.y-a.height/2}]),this.editor.setEditingId(r),this.editor.select(r),this.parent.transition("editing_shape",n)}nudgeSelectedShapes(n=!1){const{editor:{inputs:{keys:r}}}=this,i=r.has("ShiftLeft"),o=new E(0,0);r.has("ArrowLeft")&&(o.x-=1),r.has("ArrowRight")&&(o.x+=1),r.has("ArrowUp")&&(o.y-=1),r.has("ArrowDown")&&(o.y+=1),!o.equals(new E(0,0))&&(n||this.editor.mark("nudge shapes"),this.editor.nudgeShapes(this.editor.selectedIds,o,i))}},v(Q1,"id","idle"),Q1);class E6 extends ve{constructor(){super(...arguments);v(this,"onEnter",()=>{const{inputs:n}=this.editor;n.shiftKey||this.editor.selectedIds.length>0&&(this.editor.mark("selecting none"),this.editor.selectNone())});v(this,"onPointerMove",n=>{this.editor.inputs.isDragging&&this.parent.transition("brushing",n)});v(this,"onPointerUp",()=>{this.complete()});v(this,"onComplete",()=>{this.complete()});v(this,"onInterrupt",()=>{this.parent.transition("idle",{})})}_clickWasInsideFocusedGroup(){const{focusLayerId:n,inputs:r}=this.editor;if(!Vr(n))return!1;const i=this.editor.getShapeById(n);if(!i)return!1;const o=this.editor.getPointInShapeSpace(i,r.currentPagePoint);return this.editor.getShapeUtil(i).hitTestPoint(i,o)}complete(){const{shiftKey:n}=this.editor.inputs;n||(this.editor.selectNone(),this._clickWasInsideFocusedGroup()||this.editor.setFocusLayer(null)),this.parent.transition("idle",{})}}v(E6,"id","pointing_canvas");class k6 extends ve{constructor(){super(...arguments);v(this,"info",{});v(this,"onEnter",n=>{this.info=n;const r=this.editor.selectedShapes[0];r&&(this.updateCursor(r),this.editor.setCroppingId(r.id))});v(this,"onPointerMove",()=>{this.editor.inputs.isDragging&&this.parent.transition("cropping",{...this.info,onInteractionEnd:this.info.onInteractionEnd})});v(this,"onPointerUp",()=>{this.info.onInteractionEnd?this.editor.setSelectedTool(this.info.onInteractionEnd,this.info):(this.editor.setCroppingId(null),this.parent.transition("idle",{}))});v(this,"onCancel",()=>{this.cancel()});v(this,"onComplete",()=>{this.cancel()});v(this,"onInterrupt",()=>{this.cancel()})}updateCursor(n){const r=Ac[this.info.handle];this.editor.setCursor({type:r,rotation:n.rotation})}cancel(){this.info.onInteractionEnd?this.editor.setSelectedTool(this.info.onInteractionEnd,this.info):(this.editor.setCroppingId(null),this.parent.transition("idle",{}))}}v(k6,"id","pointing_crop_handle");class T6 extends ve{constructor(){super(...arguments);v(this,"info",{});v(this,"onEnter",n=>{this.info=n;const r=n.shape.props[n.handle.id];(r==null?void 0:r.type)==="binding"&&this.editor.setHintingIds([r.boundShapeId]),this.editor.setCursor({type:"grabbing"})});v(this,"onExit",()=>{this.editor.setHintingIds([]),this.editor.setCursor({type:"default"})});v(this,"onPointerUp",()=>{this.parent.transition("idle",this.info)});v(this,"onPointerMove",()=>{this.editor.inputs.isDragging&&this.parent.transition("dragging_handle",this.info)});v(this,"onCancel",()=>{this.cancel()});v(this,"onComplete",()=>{this.cancel()});v(this,"onInterrupt",()=>{this.cancel()})}cancel(){this.parent.transition("idle",{})}}v(T6,"id","pointing_handle");class P6 extends ve{constructor(){super(...arguments);v(this,"info",{});v(this,"onEnter",n=>{this.info=n,this.updateCursor()});v(this,"onPointerMove",()=>{const{isDragging:n}=this.editor.inputs;n&&this.parent.transition("rotating",this.info)});v(this,"onPointerUp",()=>{this.complete()});v(this,"onCancel",()=>{this.cancel()});v(this,"onComplete",()=>{this.cancel()});v(this,"onInterrupt",()=>{this.cancel()})}updateCursor(){const{selectionRotation:n}=this.editor;this.editor.setCursor({type:Ac[this.info.handle],rotation:n})}complete(){this.info.onInteractionEnd?this.editor.setSelectedTool(this.info.onInteractionEnd,{}):this.parent.transition("idle",{})}cancel(){this.info.onInteractionEnd?this.editor.setSelectedTool(this.info.onInteractionEnd,{}):this.parent.transition("idle",{})}}v(P6,"id","pointing_rotate_handle");class I6 extends ve{constructor(){super(...arguments);v(this,"info",{});v(this,"onEnter",n=>{this.info=n});v(this,"onPointerUp",n=>{this.editor.selectNone(),this.parent.transition("idle",n)});v(this,"onPointerMove",n=>{if(this.editor.inputs.isDragging){if(this.editor.isReadOnly)return;this.parent.transition("translating",n)}});v(this,"onCancel",()=>{this.cancel()});v(this,"onComplete",()=>{this.cancel()});v(this,"onInterrupt",()=>{this.cancel()})}cancel(){this.parent.transition("idle",{})}}v(I6,"id","pointing_selection");class $6 extends ve{constructor(){super(...arguments);v(this,"eventTargetShape",{});v(this,"selectingShape",{});v(this,"didSelectOnEnter",!1);v(this,"onEnter",n=>{var s;if(this.eventTargetShape=n.shape,this.selectingShape=this.editor.getOutermostSelectableShape(n.shape),this.editor.getShapeUtil(n.shape).onClick||this.selectingShape.id===this.editor.focusLayerId){this.didSelectOnEnter=!1;return}const i=this.editor.isWithinSelection(this.selectingShape.id),o=this.editor.selectedIds.length>1&&((s=this.editor.selectionBounds)==null?void 0:s.containsPoint(this.editor.inputs.currentPagePoint));if(this.didSelectOnEnter=!i&&this.selectingShape.id!==this.editor.focusLayerId&&!o,this.didSelectOnEnter){const{inputs:a,selectedIds:l}=this.editor,c=this.editor.getParentShape(n.shape);c&&c.type==="group"&&this.editor.cancelDoubleClick(),a.shiftKey&&!a.altKey?l.includes(this.selectingShape.id)||(this.editor.mark("shift selecting shape"),this.editor.setSelectedIds([...l,this.selectingShape.id])):(this.editor.mark("selecting shape"),this.editor.setSelectedIds([this.selectingShape.id]))}});v(this,"onPointerUp",n=>{var i;const{shape:r}=n;if(r){const o=this.editor.getShapeUtil(r);if(o.onClick){const s=(i=o.onClick)==null?void 0:i.call(o,r);if(s){this.editor.updateShapes([s]),this.parent.transition("idle",n);return}}}if(!this.didSelectOnEnter&&this.selectingShape.id!==this.editor.focusLayerId){this.editor.mark("selecting shape (pointer up)");const o=this.editor.getOutermostSelectableShape(this.eventTargetShape,s=>!this.editor.isSelected(s.id));if(this.editor.selectedIds.includes(o.id))this.editor.setSelectedIds(this.editor.inputs.shiftKey?this.editor.selectedIds.filter(s=>s!==this.selectingShape.id):[this.selectingShape.id]);else if(this.editor.inputs.shiftKey){const s=this.editor.getAncestors(o);this.editor.setSelectedIds([...this.editor.selectedIds.filter(a=>!s.find(l=>l.id===a)),o.id])}else this.editor.setSelectedIds([o.id])}else this.selectingShape.id===this.editor.focusLayerId&&(this.editor.selectedIds.length>0?this.editor.setSelectedIds([]):this.editor.popFocusLayer());this.parent.transition("idle",n)});v(this,"onPointerMove",n=>{if(this.editor.inputs.isDragging){if(this.editor.isReadOnly)return;this.parent.transition("translating",n)}});v(this,"onCancel",()=>{this.cancel()});v(this,"onComplete",()=>{this.cancel()});v(this,"onInterrupt",()=>{this.cancel()})}cancel(){this.parent.transition("idle",{})}}v($6,"id","pointing_shape");class A6 extends ve{constructor(){super(...arguments);v(this,"info",{});v(this,"markId","");v(this,"creationCursorOffset",{x:0,y:0});v(this,"editAfterComplete",!1);v(this,"snapshot",{});v(this,"onEnter",n=>{const{isCreating:r=!1,editAfterComplete:i=!1,creationCursorOffset:o={x:0,y:0}}=n;this.info=n,this.editAfterComplete=i,this.creationCursorOffset=o,n.isCreating&&this.editor.setCursor({type:"cross",rotation:0}),this.snapshot=this._createSnapshot(),this.markId=r?"creating":this.editor.mark("starting resizing"),this.handleResizeStart(),this.updateShapes()});v(this,"onPointerMove",()=>{this.updateShapes()});v(this,"onKeyDown",()=>{this.updateShapes()});v(this,"onKeyUp",()=>{this.updateShapes()});v(this,"onPointerUp",()=>{this.complete()});v(this,"onComplete",()=>{this.complete()});v(this,"onCancel",()=>{this.cancel()});v(this,"onExit",()=>{this.editor.snaps.clear()});v(this,"_createSnapshot",()=>{const{selectedIds:n,selectionRotation:r,inputs:{originPagePoint:i}}=this.editor,o=this.editor.selectionBounds,s=E.RotWith(o.getHandlePoint(this.info.handle),o.point,r),a=E.Sub(i,s),l=new Map;n.forEach(u=>{const d=this.editor.getShapeById(u);if(d){if(l.set(d.id,this._createShapeSnapshot(d)),d.type==="frame"&&n.length===1)return;this.editor.visitDescendants(d.id,h=>{const f=this.editor.getShapeById(h);if(f&&(l.set(f.id,this._createShapeSnapshot(f)),f.type==="frame"))return!1})}});const c=![...l.values()].some(u=>!e5(u.pageRotation,r)||u.isAspectRatioLocked);return{shapeSnapshots:l,selectionBounds:o,cursorHandleOffset:a,selectionRotation:r,selectedIds:n,canShapesDeform:c,initialSelectionPageBounds:this.editor.selectedPageBounds}});v(this,"_createShapeSnapshot",n=>{const r=this.editor.getPageTransform(n),i=this.editor.getShapeUtil(n);return{shape:n,bounds:i.bounds(n),pageTransform:r,pageRotation:ie.Decompose(r).rotation,isAspectRatioLocked:i.isAspectRatioLocked(n)}})}cancel(){this.editor.bailToMark(this.markId),this.info.onInteractionEnd?this.editor.setSelectedTool(this.info.onInteractionEnd,{}):this.parent.transition("idle",{})}complete(){if(this.handleResizeEnd(),this.editAfterComplete&&this.editor.onlySelectedShape){this.editor.setEditingId(this.editor.onlySelectedShape.id),this.editor.setSelectedTool("select"),this.editor.root.current.value.transition("editing_shape",{});return}if(this.editor.instanceState.isToolLocked&&this.info.onInteractionEnd){this.editor.setSelectedTool(this.info.onInteractionEnd,{});return}this.parent.transition("idle",{})}handleResizeStart(){const{shapeSnapshots:n}=this.snapshot,r=[];n.forEach(({shape:i})=>{var a;const o=this.editor.getShapeUtil(i),s=(a=o.onResizeStart)==null?void 0:a.call(o,i);s&&r.push(s)}),r.length>0&&this.editor.updateShapes(r)}handleResizeEnd(){const{shapeSnapshots:n}=this.snapshot,r=[];n.forEach(({shape:i})=>{var l;const o=this.editor.getShapeById(i.id),s=this.editor.getShapeUtil(i),a=(l=s.onResizeEnd)==null?void 0:l.call(s,i,o);a&&r.push(a)}),r.length>0&&this.editor.updateShapes(r)}updateShapes(){const{altKey:n,shiftKey:r}=this.editor.inputs,{shapeSnapshots:i,selectionBounds:o,cursorHandleOffset:s,selectedIds:a,selectionRotation:l,canShapesDeform:c}=this.snapshot,u=r||!c,{ctrlKey:d}=this.editor.inputs,h=this.editor.inputs.currentPagePoint.clone().sub(s).sub(this.creationCursorOffset),f=this.editor.inputs.originPagePoint.clone().sub(s);this.editor.isGridMode&&!d&&h.snapToGrid(this.editor.gridSize);const p=this.info.handle,g=LT(p,Math.PI);if(this.editor.snaps.clear(),(this.editor.isSnapMode?!d:d)&&l%tt===0){const{nudge:I}=this.editor.snaps.snapResize({dragDelta:E.Sub(h,f),initialSelectionPageBounds:this.snapshot.initialSelectionPageBounds,handle:LT(p,l),isAspectRatioLocked:u,isResizingFromCenter:n});h.add(I)}const x=E.RotWith(n?o.center:o.getHandlePoint(g),o.point,l),w=E.Sub(h,x).rot(-l),_=E.Sub(f,x).rot(-l),S=E.DivV(w,_);Number.isFinite(S.x)||(S.x=1),Number.isFinite(S.y)||(S.y=1);const T=p==="top"||p==="bottom",P=p==="left"||p==="right";u?P?S.y=Math.abs(S.x):T?S.x=Math.abs(S.y):Math.abs(S.x)>Math.abs(S.y)?S.y=Math.abs(S.x)*(S.y<0?-1:1):S.x=Math.abs(S.y)*(S.x<0?-1:1):(T&&(S.x=1),P&&(S.y=1)),this.info.isCreating||this.updateCursor({dragHandle:p,isFlippedX:S.x<0,isFlippedY:S.y<0,rotation:l});for(const I of i.keys()){const $=i.get(I);this.editor.resizeShape(I,S,{initialBounds:$.bounds,dragHandle:p,initialPageTransform:$.pageTransform,initialShape:$.shape,mode:a.length===1&&I===a[0]?"resize_bounds":"scale_shape",scaleOrigin:x,scaleAxisRotation:l})}}updateCursor({dragHandle:n,isFlippedX:r,isFlippedY:i,rotation:o}){const s={...this.editor.cursor};switch(n){case"top_left":case"bottom_right":{s.type="nwse-resize",r!==i&&(s.type="nesw-resize");break}case"top_right":case"bottom_left":{s.type="nesw-resize",r!==i&&(s.type="nwse-resize");break}}s.rotation=o,this.editor.setCursor(s)}}v(A6,"id","resizing");const zv=["top","top_right","right","bottom_right","bottom","bottom_left","left","top_left"];function LT(e,t){t=t%kt;const n=Math.round(t/(Et/4)),r=zv.indexOf(e);return zv[(r+n)%zv.length]}class M6 extends ve{constructor(){super(...arguments);v(this,"snapshot",{});v(this,"info",{});v(this,"markId","");v(this,"onEnter",n=>{this.info=n,this.markId=this.editor.mark("rotate start"),this.snapshot=p6({editor:this.editor}),this.handleStart()});v(this,"onExit",()=>{this.editor.setCursor({type:"none"}),this.snapshot={}});v(this,"onPointerMove",()=>{this.update()});v(this,"onKeyDown",()=>{this.update()});v(this,"onKeyUp",()=>{this.update()});v(this,"onPointerUp",()=>{this.complete()});v(this,"onComplete",()=>{this.complete()});v(this,"onCancel",()=>{this.cancel()});v(this,"update",()=>{const n=this._getRotationFromPointerPosition({snapToNearestDegree:!1});Qp({editor:this.editor,delta:n,snapshot:this.snapshot,stage:"update"}),this.editor.setCursor({type:Ac[this.info.handle],rotation:n+this.snapshot.initialSelectionRotation})});v(this,"cancel",()=>{this.editor.bailToMark(this.markId),this.info.onInteractionEnd?this.editor.setSelectedTool(this.info.onInteractionEnd,this.info):this.parent.transition("idle",this.info)});v(this,"complete",()=>{Qp({editor:this.editor,delta:this._getRotationFromPointerPosition({snapToNearestDegree:!0}),snapshot:this.snapshot,stage:"end"}),this.info.onInteractionEnd?this.editor.setSelectedTool(this.info.onInteractionEnd,this.info):this.parent.transition("idle",this.info)})}handleStart(){const n=this._getRotationFromPointerPosition({snapToNearestDegree:!1});Qp({editor:this.editor,delta:this._getRotationFromPointerPosition({snapToNearestDegree:!1}),snapshot:this.snapshot,stage:"start"}),this.editor.setCursor({type:Ac[this.info.handle],rotation:n+this.snapshot.initialSelectionRotation})}_getRotationFromPointerPosition({snapToNearestDegree:n}){const{selectionPageCenter:r,inputs:{shiftKey:i,currentPagePoint:o}}=this.editor,{initialCursorAngle:s,initialSelectionRotation:a}=this.snapshot,l=r.angle(o)-s;let c=a+l;if(i)c=tm(c,24);else if(n&&(c=Math.round(c/Pk)*Pk,this.editor.isCoarsePointer)){const u=tm(c,4),d=QM(c,u);Math.abs(d)<MV(5)&&(c=u)}return c-a}}v(M6,"id","rotating");class O6 extends ve{constructor(){super(...arguments);v(this,"hits",new Set);v(this,"size",0);v(this,"scribble",{});v(this,"initialSelectedIds",new Set);v(this,"newlySelectedIds",new Set);v(this,"onEnter",()=>{this.initialSelectedIds=new Set(this.editor.inputs.shiftKey?this.editor.selectedIds:[]),this.newlySelectedIds=new Set,this.size=0,this.hits.clear(),this.startScribble(),this.updateBrushSelection(),requestAnimationFrame(()=>{this.editor.setBrush(null)})});v(this,"onExit",()=>{this.editor.setErasingIds([]),this.scribble.stop()});v(this,"onPointerMove",()=>{this.updateBrushSelection()});v(this,"onPointerUp",()=>{this.complete()});v(this,"onKeyDown",()=>{this.updateBrushSelection()});v(this,"onKeyUp",()=>{this.editor.inputs.altKey?this.updateBrushSelection():this.parent.transition("brushing",{})});v(this,"startScribble",()=>{var n;this.scribble.tick&&this.editor.off("tick",(n=this.scribble)==null?void 0:n.tick),this.scribble=new __({onUpdate:this.onScribbleUpdate,onComplete:this.onScribbleComplete,color:"selection-stroke",opacity:.32,size:12}),this.editor.on("tick",this.scribble.tick)});v(this,"pushPointToScribble",()=>{const{x:n,y:r}=this.editor.inputs.currentPagePoint;this.scribble.addPoint(n,r)});v(this,"onScribbleUpdate",n=>{this.editor.setScribble(n)});v(this,"onScribbleComplete",()=>{this.editor.off("tick",this.scribble.tick),this.editor.setScribble(null)});v(this,"onCancel",()=>{this.cancel()});v(this,"onComplete",()=>{this.complete()})}updateBrushSelection(){const{shapesArray:n,inputs:{originPagePoint:r,previousPagePoint:i,currentPagePoint:o}}=this.editor;this.pushPointToScribble();const s=n;let a,l;for(let c=0,u=s.length;c<u;c++)if(a=s[c],l=this.editor.getShapeUtil(a),!(a.type==="group"||this.newlySelectedIds.has(a.id)||a.type==="frame"&&l.hitTestPoint(a,this.editor.getPointInShapeSpace(a,r))||this.editor.isShapeOrAncestorLocked(a))&&l.hitTestLineSegment(a,this.editor.getPointInShapeSpace(a,i),this.editor.getPointInShapeSpace(a,o))){const d=this.editor.getOutermostSelectableShape(a),h=this.editor.getPageMaskById(d.id);if(h&&JS(i,o,h)!==null&&!ai(o,h))continue;this.newlySelectedIds.add(d.id)}this.editor.setSelectedIds([...new Set([...this.newlySelectedIds,...this.initialSelectedIds])],!0)}complete(){this.parent.transition("idle",{})}cancel(){this.editor.setSelectedIds([...this.initialSelectedIds],!0),this.parent.transition("idle",{})}}v(O6,"id","scribble_brushing");const BT=100;class RJ{constructor(t){v(this,"prevDroppingShapeId",null);v(this,"currDroppingShapeId",null);v(this,"droppingNodeTimer",null);v(this,"dispose",()=>{this.clear()});this.editor=t,t.disposables.add(this.dispose)}updateDroppingNode(t,n){var r;if(this.droppingNodeTimer===null){const{currentPagePoint:i}=this.editor.inputs;this.currDroppingShapeId=((r=this.editor.getDroppingShape(i,t))==null?void 0:r.id)??null,this.setDragTimer(t,BT*10,n)}else this.editor.inputs.pointerVelocity.len()>.5&&(clearInterval(this.droppingNodeTimer),this.setDragTimer(t,BT,n))}setDragTimer(t,n,r){this.droppingNodeTimer=setTimeout(()=>{this.editor.batch(()=>{this.handleDrag(t,r)}),this.droppingNodeTimer=null},n)}handleDrag(t,n){var l,c,u,d,h;const{currentPagePoint:r}=this.editor.inputs;t=Ae(t.map(f=>this.editor.getShapeById(f.id)));const i=((l=this.editor.getDroppingShape(r,t))==null?void 0:l.id)??null;i!==this.currDroppingShapeId&&(this.prevDroppingShapeId=this.currDroppingShapeId,this.currDroppingShapeId=i);const{prevDroppingShapeId:o}=this;if(i===o)return;const s=o&&this.editor.getShapeById(o),a=i&&this.editor.getShapeById(i);if(this.prevDroppingShapeId=this.currDroppingShapeId,s&&((u=(c=this.editor.getShapeUtil(s)).onDragShapesOut)==null||u.call(c,s,t)),a){const f=(h=(d=this.editor.getShapeUtil(a)).onDragShapesOver)==null?void 0:h.call(d,a,t);f&&f.shouldHint&&this.editor.setHintingIds([a.id])}else this.editor.setHintingIds([]);n==null||n()}dropShapes(t){var r,i;const{currDroppingShapeId:n}=this;if(this.handleDrag(t),n){const o=this.editor.getShapeById(n);if(!o)return;(i=(r=this.editor.getShapeUtil(o)).onDropShapesOver)==null||i.call(r,o,t)}}clear(){this.prevDroppingShapeId=null,this.currDroppingShapeId=null,this.droppingNodeTimer!==null&&clearInterval(this.droppingNodeTimer),this.droppingNodeTimer=null,this.editor.setHintingIds([])}}class L6 extends ve{constructor(){super(...arguments);v(this,"info",{});v(this,"selectionSnapshot",{});v(this,"snapshot",{});v(this,"markId","");v(this,"isCloning",!1);v(this,"isCreating",!1);v(this,"editAfterComplete",!1);v(this,"dragAndDropManager",new RJ(this.editor));v(this,"onEnter",n=>{const{isCreating:r=!1,editAfterComplete:i=!1}=n;this.info=n,this.isCreating=r,this.editAfterComplete=i,this.markId=r?"creating":this.editor.mark("translating"),this.handleEnter(n),this.editor.on("tick",this.updateParent)});v(this,"updateParent",()=>{const{snapshot:n}=this;this.dragAndDropManager.updateDroppingNode(n.movingShapes,this.updateParentTransforms)});v(this,"onExit",()=>{this.editor.off("tick",this.updateParent),this.selectionSnapshot={},this.snapshot={},this.editor.snaps.clear(),this.editor.setCursor({type:"default"}),this.dragAndDropManager.clear()});v(this,"onPointerMove",()=>{this.updateShapes()});v(this,"onKeyDown",()=>{if(this.editor.inputs.altKey&&!this.isCloning){this.startCloning();return}this.updateShapes()});v(this,"onKeyUp",()=>{if(!this.editor.inputs.altKey&&this.isCloning){this.stopCloning();return}this.updateShapes()});v(this,"onPointerUp",()=>{this.complete()});v(this,"onComplete",()=>{this.complete()});v(this,"onCancel",()=>{this.cancel()});v(this,"updateParentTransforms",()=>{const{editor:n,snapshot:{shapeSnapshots:r}}=this;r.forEach(i=>{const o=n.getShapeById(i.shape.id);if(!o)return null;const s=Un(o.parentId)?null:ie.Inverse(n.getPageTransformById(o.parentId));i.parentTransform=s})})}reset(){this.editor.bailToMark(this.markId)}startCloning(){this.isCreating||(this.isCloning=!0,this.reset(),this.markId=this.editor.mark("translating"),this.editor.duplicateShapes(),this.snapshot=RT(this.editor),this.handleStart(),this.updateShapes())}stopCloning(){this.isCloning=!1,this.snapshot=this.selectionSnapshot,this.reset(),this.markId=this.editor.mark("translating"),this.updateShapes()}complete(){if(this.updateShapes(),this.dragAndDropManager.dropShapes(this.snapshot.movingShapes),this.handleEnd(),this.editor.instanceState.isToolLocked&&this.info.onInteractionEnd)this.editor.setSelectedTool(this.info.onInteractionEnd);else if(this.editAfterComplete){const n=this.editor.onlySelectedShape;n&&(this.editor.setEditingId(n.id),this.editor.setSelectedTool("select"),this.editor.root.current.value.transition("editing_shape",{}))}else this.parent.transition("idle",{})}cancel(){this.reset(),this.info.onInteractionEnd?this.editor.setSelectedTool(this.info.onInteractionEnd):this.parent.transition("idle",this.info)}handleEnter(n){if(this.isCloning=!1,this.info=n,this.editor.setCursor({type:"move"}),this.selectionSnapshot=RT(this.editor),!this.isCreating&&this.editor.inputs.altKey){this.startCloning();return}this.snapshot=this.selectionSnapshot,this.handleStart(),this.updateShapes()}handleStart(){const{movingShapes:n}=this.snapshot,r=[];n.forEach(i=>{var a;const o=this.editor.getShapeUtil(i),s=(a=o.onTranslateStart)==null?void 0:a.call(o,i);s&&r.push(s)}),r.length>0&&this.editor.updateShapes(r)}handleEnd(){const{movingShapes:n}=this.snapshot,r=[];n.forEach(i=>{var l;const o=this.editor.getShapeById(i.id),s=this.editor.getShapeUtil(i),a=(l=s.onTranslateEnd)==null?void 0:l.call(s,i,o);a&&r.push(a)}),r.length>0&&this.editor.updateShapes(r)}handleChange(){const{movingShapes:n}=this.snapshot,r=[];n.forEach(i=>{var l;const o=this.editor.getShapeById(i.id),s=this.editor.getShapeUtil(i),a=(l=s.onTranslate)==null?void 0:l.call(s,i,o);a&&r.push(a)}),r.length>0&&this.editor.updateShapes(r)}updateShapes(){const{snapshot:n}=this;this.dragAndDropManager.updateDroppingNode(n.movingShapes,this.updateParentTransforms),DJ({editor:this.editor,shapeSnapshots:n.shapeSnapshots,averagePagePoint:n.averagePagePoint,initialSelectionPageBounds:n.initialPageBounds,initialSelectionSnapPoints:n.initialSnapPoints}),this.handleChange()}}v(L6,"id","translating");function RT(e){const t=[],n=[],r=Ae(e.selectedIds.map(i=>{const o=e.getShapeById(i);if(!o)return null;t.push(o);const s=e.getPagePointById(i);if(!s)return null;n.push(s);const a=ei.isId(o.parentId)?null:ie.Inverse(e.getPageTransformById(o.parentId));return{shape:o,pagePoint:s,parentTransform:a}}));return{averagePagePoint:E.Average(n),movingShapes:t,shapeSnapshots:r,initialPageBounds:e.selectedPageBounds,initialSnapPoints:e.selectedIds.length===1?e.snaps.snapPointsCache.get(e.selectedIds[0]):e.selectedPageBounds?e.selectedPageBounds.snapPoints.map((i,o)=>({id:"selection:"+o,x:i.x,y:i.y})):[]}}function DJ({editor:e,shapeSnapshots:t,averagePagePoint:n,initialSelectionPageBounds:r,initialSelectionSnapPoints:i}){const{inputs:o,isGridMode:s,gridSize:a}=e,l=E.Sub(o.currentPagePoint,o.originPagePoint),c=e.inputs.shiftKey?Math.abs(l.x)<Math.abs(l.y)?"x":"y":null;if(c==="x"?l.x=0:c==="y"&&(l.y=0),e.snaps.clear(),(e.isSnapMode?!o.ctrlKey:o.ctrlKey)&&e.inputs.pointerVelocity.len()<.5){const{nudge:f}=e.snaps.snapTranslate({dragDelta:l,initialSelectionPageBounds:r,lockedAxis:c,initialSelectionSnapPoints:i});l.add(f)}const d=E.Add(n,l);s&&!o.ctrlKey&&d.snapToGrid(a);const h=E.Sub(d,n);e.updateShapes(Ae(t.map(({shape:f,pagePoint:p,parentTransform:g})=>{const y=E.Add(p,h),x=g?ie.applyToPoint(g,y):y;return{id:f.id,type:f.type,x:x.x,y:x.y}})),!0)}class eg extends ve{constructor(){super(...arguments);v(this,"styles",["color","dash","fill","size"]);v(this,"onExit",()=>{this.editor.pageState.editingId&&this.editor.setEditingId(null)})}}v(eg,"id","select"),v(eg,"initial","idle"),v(eg,"children",()=>[Jp,S6,BJ,E6,$6,L6,y6,O6,k6,I6,w6,C6,A6,M6,P6,T6,_6]);class B6 extends ve{constructor(){super(...arguments);v(this,"info",{});v(this,"onEnter",n=>{this.info=n});v(this,"onPointerDown",()=>{this.parent.transition("pointing",this.info)})}}v(B6,"id","idle");class R6 extends ve{constructor(){super(...arguments);v(this,"info",{});v(this,"onEnter",n=>{this.info=n});v(this,"onPointerUp",()=>{this.complete()});v(this,"onPointerMove",()=>{this.editor.inputs.isDragging&&this.parent.transition("zoom_brushing",this.info)});v(this,"onCancel",()=>{this.cancel()})}complete(){const{currentScreenPoint:n}=this.editor.inputs;this.editor.inputs.altKey?this.editor.zoomOut(n,{duration:220}):this.editor.zoomIn(n,{duration:220}),this.parent.transition("idle",this.info)}cancel(){this.parent.transition("idle",this.info)}}v(R6,"id","pointing");class D6 extends ve{constructor(){super(...arguments);v(this,"info",{});v(this,"zoomBrush",new me);v(this,"onEnter",n=>{this.info=n,this.update()});v(this,"onExit",()=>{this.editor.setZoomBrush(null)});v(this,"onPointerMove",()=>{this.update()});v(this,"onPointerUp",()=>{this.complete()});v(this,"onCancel",()=>{this.cancel()})}update(){const{inputs:{originPagePoint:n,currentPagePoint:r}}=this.editor;this.zoomBrush.setTo(me.FromPoints([n,r])),this.editor.setZoomBrush(this.zoomBrush.toJson())}cancel(){this.parent.transition("idle",this.info)}complete(){const{zoomBrush:n}=this,r=8/this.editor.zoomLevel;if(n.width<r&&n.height<r){const i=this.editor.inputs.currentScreenPoint;this.editor.inputs.altKey?this.editor.zoomOut(i,{duration:220}):this.editor.zoomIn(i,{duration:220})}else{const i=this.editor.inputs.altKey?this.editor.zoomLevel/2:void 0;this.editor.zoomToBounds(n.x,n.y,n.width,n.height,i,{duration:220})}this.parent.transition("idle",this.info)}}v(D6,"id","zoom_brushing");class tg extends ve{constructor(){super(...arguments);v(this,"info",{});v(this,"onEnter",n=>{this.info=n,this.updateCursor()});v(this,"onExit",()=>{this.editor.setZoomBrush(null),this.editor.setCursor({type:"default"})});v(this,"onKeyDown",()=>{this.updateCursor()});v(this,"onKeyUp",n=>{this.updateCursor(),n.code==="KeyZ"&&this.complete()});v(this,"onInterrupt",()=>{this.complete()})}updateCursor(){this.editor.inputs.altKey?this.editor.setCursor({type:"zoom-out"}):this.editor.setCursor({type:"zoom-in"})}complete(){this.info.onInteractionEnd&&this.info.onInteractionEnd!=="select"?this.editor.setSelectedTool(this.info.onInteractionEnd,this.info):this.parent.transition("select",{})}}v(tg,"id","zoom"),v(tg,"initial","idle"),v(tg,"children",()=>[B6,D6,R6]);class ng extends ve{constructor(){super(...arguments);v(this,"onKeyDown",n=>{var r;switch(n.code){case"KeyZ":{if(!(n.shiftKey||n.ctrlKey)){const i=this.current.value;i&&((r=i.current.value)==null?void 0:r.id)==="idle"&&this.editor.setSelectedTool("zoom",{...n,onInteractionEnd:i.id})}break}}})}}v(ng,"id","root"),v(ng,"initial","select"),v(ng,"children",()=>[eg,tg]);var FJ=Object.defineProperty,NJ=Object.getOwnPropertyDescriptor,Re=(e,t,n,r)=>{for(var i=r>1?void 0:r?NJ(t,n):t,o=e.length-1,s;o>=0;o--)(s=e[o])&&(i=(r?s(t,n,i):s(i))||i);return r&&i&&FJ(t,n,i),i},J1;const F6=(J1=class extends kZ.EventEmitter{constructor({store:t,user:n,tools:r=hJ,shapes:i=YQ,getContainer:o}){var d;super();v(this,"store");v(this,"root");v(this,"_shapeIds");v(this,"disposables",new Set);v(this,"_dprManager",new _J(this));v(this,"_cameraManager",new bJ(this));v(this,"_activeAreaManager",new vJ(this));v(this,"_tickManager",new MJ(this));v(this,"_updateDepth",0);v(this,"snaps",new jh(this));v(this,"user");v(this,"isSafari");v(this,"isIos");v(this,"isChromeForIos");v(this,"_canMoveCamera",jt("can move camera",!0));v(this,"_isFocused",jt("_isFocused",!1));v(this,"getContainer");v(this,"_crashingError",null);v(this,"_openMenus",jt("open-menus",[]));v(this,"_isCoarsePointer",jt("isCoarsePointer",!1));v(this,"_isChangingStyle",jt("isChangingStyle",!1));v(this,"_isChangingStyleTimeout",-1);v(this,"_parentIdsToChildIds");v(this,"history",new EJ(this,()=>this._complete(),t=>{this.annotateError(t,{origin:"history.batch",willCrashApp:!0}),this.crash(t)}));v(this,"shapeUtils");v(this,"_childIdsCache",new Zc);v(this,"_selectionSharedProps",ce("_selectionSharedProps",()=>{const{selectedShapes:t}=this,n={};for(let r=0,i=t.length;r<i;r++)this._extractSharedProps(t[r],n);return n}));v(this,"_prevProps",{});v(this,"_invalidParents",new Set);v(this,"_isReadOnly",jt("isReadOnly",!1));v(this,"_isPenMode",jt("isPenMode",!1));v(this,"_touchEventsRemainingBeforeExitingPenMode",0);v(this,"_cullingBounds",jt("culling viewport",new me));v(this,"_cullingBoundsExpanded",jt("culling viewport expanded",new me));v(this,"_setFocusLayer",this.history.createCommand("setFocusLayer",t=>t===null&&!this.canUndo?void 0:{data:{prev:this.pageState.focusLayerId,next:t},preservesRedoStack:!0,squashing:!0},{do:({next:t})=>{this.store.update(this.pageState.id,n=>({...n,focusLayerId:t}))},undo:({prev:t})=>{this.store.update(this.pageState.id,n=>({...n,focusLayerId:t}))},squash({prev:t},{next:n}){return{prev:t,next:n}}}));v(this,"colors");v(this,"sizes",{s:2,m:3.5,l:5,xl:10});v(this,"inputs",{originPagePoint:new E,originScreenPoint:new E,previousPagePoint:new E,previousScreenPoint:new E,currentPagePoint:new E,currentScreenPoint:new E,keys:new Set,buttons:new Set,isPen:!1,shiftKey:!1,ctrlKey:!1,altKey:!1,isDragging:!1,isPointing:!1,isPinching:!1,isEditing:!1,isPanning:!1,pointerVelocity:new E});v(this,"_clickManager",new SJ(this));v(this,"_prevCursor","default");v(this,"_shiftKeyTimeout",-1);v(this,"_setShiftKeyTimeout",()=>{this.inputs.shiftKey=!1,this.dispatch({type:"keyboard",name:"key_up",key:"Shift",shiftKey:this.inputs.shiftKey,ctrlKey:this.inputs.ctrlKey,altKey:this.inputs.altKey,code:"ShiftLeft"})});v(this,"_altKeyTimeout",-1);v(this,"_setAltKeyTimeout",()=>{this.inputs.altKey=!1,this.dispatch({type:"keyboard",name:"key_up",key:"Alt",shiftKey:this.inputs.shiftKey,ctrlKey:this.inputs.ctrlKey,altKey:this.inputs.altKey,code:"AltLeft"})});v(this,"_ctrlKeyTimeout",-1);v(this,"_setCtrlKeyTimeout",()=>{this.inputs.ctrlKey=!1,this.dispatch({type:"keyboard",name:"key_up",key:"Ctrl",shiftKey:this.inputs.shiftKey,ctrlKey:this.inputs.ctrlKey,altKey:this.inputs.altKey,code:"ControlLeft"})});v(this,"_restoreToolId","select");v(this,"_pinchStart",1);v(this,"_didPinch",!1);v(this,"_selectedIdsAtPointerDown",[]);v(this,"capturedPointerId",null);v(this,"_createShapes",this.history.createCommand("createShapes",(t,n=!1)=>{if(this.isReadOnly||t.length<=0)return null;const{shapeIds:r,selectedIds:i}=this,o=n?i:void 0,s=t.length+r.size>bo;s&&Xf(this);const a=s?t.slice(0,bo-r.size):t;return a.length===0?null:{data:{currentPageId:this.currentPageId,createdIds:t.map(l=>l.id),prevSelectedIds:o,partials:a,select:n}}},{do:({createdIds:t,partials:n,select:r})=>{var a,l;const{focusLayerId:i}=this;n=n.map(c=>{if(!c.parentId||!this.store.get(c.parentId)&&!n.find(u=>u.id===c.parentId)){c={...c};const u=this.getParentIdForNewShapeAtPoint({x:c.x??0,y:c.y??0},c.type);if(c.parentId=u,Vr(u)){const d=this.getPointInShapeSpace(this.getShapeById(u),{x:c.x??0,y:c.y??0});c.x=d.x,c.y=d.y,c.rotation=-this.getPageRotationById(u)+(c.rotation??0)}return c}return c});const o=new Map,s=[];for(const c of n){const u=this.getShapeUtil(c);let d=c.index;if(!d){const x=c.parentId??i;o.has(x)||o.set(x,this.getHighestIndexForParent(x)),d=o.get(x),o.set(x,Co(d))}const h=u.defaultProps(),{propsForNextShape:f,opacityForNextShape:p}=this.instanceState;for(const x in h)if(x in f){if(x==="url")continue;h[x]=f[x]}let g=this.store.schema.types.shape.create({...c,index:d,opacity:c.opacity??p,parentId:c.parentId??i,props:"props"in c?{...h,...c.props}:h});if(g.index===void 0)throw Error("no index!");const y=(l=(a=this.getShapeUtil(g)).onBeforeCreate)==null?void 0:l.call(a,g);y&&(g=y),s.push(g)}this.store.put(s),r&&this.store.update(this.pageState.id,c=>({...c,selectedIds:t}))},undo:({createdIds:t,prevSelectedIds:n})=>{this.store.remove(t),n&&this.store.update(this.pageState.id,r=>({...r,selectedIds:n}))}}));v(this,"animatingShapes",new Map);v(this,"_updateShapes",this.history.createCommand("updateShapes",(t,n=!1)=>{if(this.isReadOnly)return null;const r=Ae(t),i=Object.fromEntries(Ae(r.map(({id:a})=>this.getShapeById(a))).map(a=>[a.id,a]));if(r.length<=0)return null;const o=Ae(r.map(a=>{const l=i[a.id];if(!l)return null;let c=null;for(const[u,d]of Object.entries(a))if(d!==void 0)switch(u){case"id":case"type":case"typeName":continue;default:if(d!==l[u])if(c||(c={...l}),u==="props"){const h={...l.props};for(const[f,p]of Object.entries(d))p!==void 0&&(h[f]=p);c.props=h}else c[u]=d}return c??l})),s=Object.fromEntries(o.map(a=>[a.id,a]));return{data:{snapshots:i,updates:s},squashing:n}},{do:({updates:t})=>{var r,i;const n=Object.values(t);for(let o=0;o<n.length;o++){const s=n[o],a=this.store.get(s.id);if(!a)continue;const l=(i=(r=this.getShapeUtil(s)).onBeforeUpdate)==null?void 0:i.call(r,a,s);l&&(n[o]=l)}this.store.put(n)},undo:({snapshots:t})=>{this.store.put(Object.values(t))},squash(t,n){return{snapshots:{...n.snapshots,...t.snapshots},updates:{...t.updates,...n.updates}}}}));v(this,"_deleteShapes",this.history.createCommand("delete_shapes",t=>{if(this.isReadOnly||t.length===0)return null;const n=[...this.pageState.selectedIds],r=new Set(t);for(const l of t)this.visitDescendants(l,c=>{r.add(c)});const i=[...r],o=this._arrowBindingsIndex.value,s=Ae(i.flatMap(l=>{const c=this.getShapeById(l),u=o[l];return u&&u.length>0?u.map(({arrowId:d})=>this.getShapeById(d)).concat(c):c})),a=n.filter(l=>!r.has(l));return{data:{deletedIds:i,snapshots:s,prevSelectedIds:n,postSelectedIds:a}}},{do:({deletedIds:t,postSelectedIds:n})=>{this.store.remove(t),this.store.update(this.pageState.id,r=>({...r,selectedIds:n}))},undo:({snapshots:t,prevSelectedIds:n})=>{this.store.put(t),this.store.update(this.pageState.id,r=>({...r,selectedIds:n}))}}));v(this,"_updatePage",this.history.createCommand("updatePage",(t,n=!1)=>{if(this.isReadOnly)return null;const r=this.getPageById(t.id);return r?{data:{prev:r,partial:t},squashing:n}:null},{do:({partial:t})=>{this.store.update(t.id,n=>({...n,...t}))},undo:({prev:t,partial:n})=>{this.store.update(n.id,()=>t)},squash(t,n){return{prev:{...t.prev,...n.prev},partial:n.partial}}}));v(this,"_createPage",this.history.createCommand("createPage",(t,n=ei.createId(),r)=>{var u,d;if(this.isReadOnly||this.pages.length>=im)return null;const i=this.pages,o=r??((u=i[i.length-1])==null?void 0:u.index)??"a1",s=(d=i[i.findIndex(h=>h.index===o)+1])==null?void 0:d.index;t=TZ(t,i.map(h=>h.name));const a=ei.create({id:n,name:t,index:s&&o!==s?ld(o,s):Co(o)}),l=$n.create({id:$n.createId(a.id)}),c=An.create({id:An.createId(a.id),pageId:a.id});return{data:{prevSelectedPageId:this.currentPageId,newPage:a,newTabPageState:c,newCamera:l}}},{do:({newPage:t,newTabPageState:n,newCamera:r})=>{this.store.put([t,r,n,{...this.instanceState,currentPageId:t.id}]),this.updateCullingBounds()},undo:({newPage:t,prevSelectedPageId:n,newTabPageState:r,newCamera:i})=>{this.pages.length!==1&&(this.store.remove([r.id,t.id,i.id]),this.store.has(n)&&this.currentPageId!==n&&this.store.put([{...this.instanceState,currentPageId:n}]),this.updateCullingBounds())}}));v(this,"_deletePage",this.history.createCommand("delete_page",t=>{if(this.isReadOnly)return null;const{pages:n}=this;if(n.length===1)return null;const r=this.getPageById(t),i=this._pageStates.value.filter(o=>o.pageId===t);if(!r)return null;if(t===this.currentPageId){const o=n.findIndex(a=>a.id===t),s=n[o-1]??n[o+1];this.setCurrentPageId(s.id)}return{data:{id:t,deletedPage:r,deletedPageStates:i}}},{do:({deletedPage:t,deletedPageStates:n})=>{const{pages:r}=this;if(r.length!==1){if(t.id===this.currentPageId){const i=r.findIndex(s=>s.id===t.id),o=r[i-1]??r[i+1];this.setCurrentPageId(o.id)}this.store.remove(n.map(i=>i.id)),this.store.remove([t.id]),this.updateCullingBounds()}},undo:({deletedPage:t,deletedPageStates:n})=>{this.store.put([t]),this.store.put(n),this.updateCullingBounds()}}));v(this,"_setInstancePageState",this.history.createCommand("setInstancePageState",(t,n=!1)=>({data:{prev:this.store.get(t.id??this.pageState.id),partial:t},ephemeral:n}),{do:({prev:t,partial:n})=>{this.store.update(t.id,r=>({...r,...n}))},undo:({prev:t})=>{this.store.update(t.id,()=>t)}}));v(this,"_setSelectedIds",this.history.createCommand("setSelectedIds",(t,n=!1)=>{const r=this.pageState.selectedIds,i=new Set(this.pageState.selectedIds);return t.length===i.size&&t.every(o=>i.has(o))?null:{data:{ids:t,prevSelectedIds:r},squashing:n,preservesRedoStack:!0}},{do:({ids:t})=>{this.store.update(this.pageState.id,n=>({...n,selectedIds:t}))},undo:({prevSelectedIds:t})=>{this.store.update(this.pageState.id,()=>({...this.pageState,selectedIds:t}))},squash(t,n){return{ids:n.ids,prevSelectedIds:t.prevSelectedIds}}}));v(this,"_createAssets",this.history.createCommand("createAssets",t=>this.isReadOnly||t.length<=0?null:{data:{assets:t}},{do:({assets:t})=>{this.store.put(t)},undo:({assets:t})=>{this.store.remove(t.map(n=>n.id))}}));v(this,"_deleteAssets",this.history.createCommand("deleteAssets",t=>{if(this.isReadOnly||t.length<=0)return;const n=Ae(t.map(r=>this.store.get(r)));return{data:{ids:t,prev:n}}},{do:({ids:t})=>{this.store.remove(t)},undo:({prev:t})=>{this.store.put(t)}}));v(this,"_updateAssets",this.history.createCommand("updateAssets",t=>this.isReadOnly||t.length<=0?void 0:{data:{snapshots:{},assets:t}},{do:({assets:t,snapshots:n})=>{this.store.put(t.map(r=>{const i=this.store.get(r.id);return n[r.id]=i,{...i,...r}}))},undo:({snapshots:t})=>{this.store.put(Object.values(t))}}));v(this,"_setCurrentPageId",this.history.createCommand("setCurrentPage",(t,{stopFollowing:n=!0}={})=>{if(!this.store.has(t)){console.error("Tried to set the current page id to a page that doesn't exist.");return}return n&&this.instanceState.followingUserId&&this.stopFollowingUser(),{data:{toId:t,fromId:this.currentPageId},squashing:!0,preservesRedoStack:!0}},{do:({toId:t})=>{if(this.store.has(t)){if(!this.getPageStateByPageId(t)){const n=$n.create({id:$n.createId(t)});this.store.put([n,An.create({id:An.createId(t),pageId:t})])}this.store.put([{...this.instanceState,currentPageId:t}]),this.updateCullingBounds()}},undo:({fromId:t})=>{this.store.has(t)&&(this.store.put([{...this.instanceState,currentPageId:t}]),this.updateCullingBounds())},squash:({fromId:t},{toId:n})=>({toId:n,fromId:t})}));v(this,"_updateInstanceState",this.history.createCommand("updateTabState",(t,n=!1,r=!1)=>{const i=this.instanceState,o={...i,...t};return{data:{prev:i,next:o},squashing:r,ephemeral:n}},{do:({next:t})=>{this.store.put([t])},undo:({prev:t})=>{this.store.put([t])},squash({prev:t},{next:n}){return{prev:t,next:n}}}));v(this,"_willSetInitialBounds",!0);v(this,"enableAnimations",!0);v(this,"_viewportAnimation",null);v(this,"textMeasure");this.store=t,this.user=new OJ(n??BZ()),this.getContainer=o??(()=>document.body),this.textMeasure=new AJ(this),this.root=new ng(this);const s=Object.fromEntries(Object.values(VQ).map(({util:h})=>[h.type,new h(this,h.type)]));for(const[h,{util:f}]of Object.entries(i)){if(s[h])throw Error(`May not overwrite core shape of type "${h}".`);if(h!==f.type)throw Error(`Shape util's type "${f.type}" does not match provided type "${h}".`);s[h]=new f(this,f.type)}this.shapeUtils=s;const a=Object.fromEntries(r.map(h=>[h.id,h]));for(const[h,f]of Object.entries(a)){if((d=this.root.children)!=null&&d[h])throw Error(`Can't override tool with id "${h}"`);this.root.children[h]=new f(this)}typeof window<"u"&&"navigator"in window?(this.isSafari=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),this.isIos=!!navigator.userAgent.match(/iPad/i)||!!navigator.userAgent.match(/iPhone/i),this.isChromeForIos=/crios.*safari/i.test(navigator.userAgent)):(this.isSafari=!1,this.isIos=!1,this.isChromeForIos=!1),this.colors=new Map(F6.styles.color.map(h=>[h.id,`var(--palette-${h.id})`])),this.store.onBeforeDelete=h=>{h.typeName==="shape"?this._shapeWillBeDeleted(h):h.typeName==="page"&&this._pageWillBeDeleted(h)},this.store.onAfterChange=(h,f)=>{this._updateDepth++,this._updateDepth>1e3&&console.error("[onAfterChange] Maximum update depth exceeded, bailing out."),h.typeName==="shape"&&f.typeName==="shape"?this._shapeDidChange(h,f):h.typeName==="instance_page_state"&&f.typeName==="instance_page_state"&&this._pageStateDidChange(h,f),this._updateDepth--},this.store.onAfterCreate=h=>{if(h.typeName==="shape"&&this.isShapeOfType(h,Qt)&&this._arrowDidUpdate(h),h.typeName==="page"){const f=$n.createId(h.id),p=An.createId(h.id);this.store.has(f)||this.store.put([$n.create({id:f})]),this.store.has(p)||this.store.put([An.create({id:p,pageId:h.id})])}},this._shapeIds=mJ(this.store,()=>this.currentPageId),this._parentIdsToChildIds=gJ(this.store),this.disposables.add(this.store.listen(h=>{this.emit("change",h)}));const l=this.getContainer(),c=()=>{this._isFocused.set(!0)},u=()=>{this._isFocused.set(!1)};l.addEventListener("focusin",c),l.addEventListener("focus",c),l.addEventListener("focusout",u),l.addEventListener("blur",u),this.disposables.add(()=>{l.removeEventListener("focusin",c),l.removeEventListener("focus",c),l.removeEventListener("focusout",u),l.removeEventListener("blur",u)}),this.store.ensureStoreIsUsable(),this.setInstancePageState({editingId:null,hoveredId:null,erasingIds:[]},!0),this.root.enter(void 0,"initial"),this.instanceState.followingUserId&&this.stopFollowingUser(),this.updateCullingBounds(),requestAnimationFrame(()=>{this._tickManager.start()})}get canMoveCamera(){return this._canMoveCamera.value}set canMoveCamera(t){this._canMoveCamera.set(t)}get isFocused(){return this._isFocused.value}annotateError(t,{origin:n,willCrashApp:r,tags:i,extras:o}){const s=this.createErrorAnnotations(n,r);MS(t,{tags:{...s.tags,...i},extras:{...s.extras,...o}}),r&&this.store.markAsPossiblyCorrupted()}createErrorAnnotations(t,n){try{return{tags:{origin:t,willCrashApp:n},extras:{activeStateNode:this.root.path.value,selectedShapes:this.selectedShapes,editingShape:this.editingId?this.getShapeById(this.editingId):void 0,inputs:this.inputs}}}catch{return{tags:{origin:t,willCrashApp:n},extras:{}}}}get crashingError(){return this._crashingError}crash(t){this._crashingError=t,this.store.markAsPossiblyCorrupted(),this.emit("crash",{error:t})}get devicePixelRatio(){return this._dprManager.dpr.value}get openMenus(){return this._openMenus.value}addOpenMenu(t){const n=new Set(this.openMenus);return n.has(t)||(n.add(t),this._openMenus.set([...n])),this}deleteOpenMenu(t){const n=new Set(this.openMenus);return n.has(t)&&(n.delete(t),this._openMenus.set([...n])),this}get isMenuOpen(){return this.openMenus.length>0}get isCoarsePointer(){return this._isCoarsePointer.value}set isCoarsePointer(t){this._isCoarsePointer.set(t)}get isChangingStyle(){return this._isChangingStyle.value}set isChangingStyle(t){this._isChangingStyle.set(t),clearTimeout(this._isChangingStyleTimeout),t&&(this._isChangingStyleTimeout=setTimeout(()=>this.isChangingStyle=!1,2e3))}get _pageTransformCache(){return this.store.createComputedCache("pageTransformCache",t=>{if(Un(t.parentId))return this.getTransform(t);const n=this._pageTransformCache.get(t.parentId)??ie.Identity();return ie.Compose(n,this.getTransform(t))})}get _pageBoundsCache(){return this.store.createComputedCache("pageBoundsCache",t=>{const n=this._pageTransformCache.get(t.id);return n?me.FromPoints(ie.applyToPoints(n,this.getShapeUtil(t).outline(t))):new me})}get _pageMaskCache(){return this.store.createComputedCache("pageMaskCache",t=>{if(Un(t.parentId))return;const n=this.getAncestorsById(t.id).filter(i=>i.type==="frame");return n.length===0?void 0:n.map(i=>ie.applyToPoints(this._pageTransformCache.get(i.id),this.getOutline(i))).reduce((i,o)=>o&&i?pb(i,o)??void 0:void 0)})}getPageMaskById(t){return this._pageMaskCache.get(t)}get _clipPathCache(){return this.store.createComputedCache("clipPathCache",t=>{const n=this._pageMaskCache.get(t.id);if(!n)return;const r=this._pageTransformCache.get(t.id);return r?n.length===0?"polygon(0px 0px, 0px 0px, 0px 0px)":`polygon(${ie.applyToPoints(ie.Inverse(r),n).map(o=>`${o.x}px ${o.y}px`).join(",")})`:void 0})}getClipPathById(t){return this._clipPathCache.get(t)}dispose(){this.disposables.forEach(t=>t()),this.disposables.clear()}undo(){return this.history.undo()}get canUndo(){return this.history.numUndos>0}redo(){return this.history.redo(),this}get canRedo(){return this.history.numRedos>0}mark(t,n,r){return this.history.mark(t,n,r)}bail(){return this.history.bail(),this}bailToMark(t){return this.history.bailToMark(t),this}batch(t){return this.history.batch(t),this}getShapeUtil({type:t}){return this.shapeUtils[t]}getSortedChildIds(t){const n=this._parentIdsToChildIds.value[t];return n?this._childIdsCache.get(n,()=>n.map(([r])=>r)):ri}visitDescendants(t,n){const r=this.getSortedChildIds(t);for(const i of r)n(i)!==!1&&this.visitDescendants(i,n)}get erasingIds(){return this.pageState.erasingIds}get hintingIds(){return this.pageState.hintingIds}get erasingIdsSet(){return new Set(this.erasingIds)}_extractSharedProps(t,n){if(t.type==="group"){const r=this._parentIdsToChildIds.value[t.id];if(!r)return;for(let i=0,o=r.length;i<o;i++)this._extractSharedProps(this.getShapeById(r[i][0]),n)}else{const r=Object.entries(t.props);let i;for(let o=0,s=r.length;o<s;o++)if(i=r[o],!oq.has(i[0]))switch(n[i[0]]){case void 0:{n[i[0]]=i[1];break}case null:case i[1]:continue;default:n[i[0]]=null}}}get props(){let t;if(this.isIn("select")&&this.selectedIds.length>0)t=this._selectionSharedProps.value;else{const n=this.root.current.value;if(n.styles.length===0)t=null;else{const{propsForNextShape:r}=this.instanceState;t=Object.fromEntries(n.styles.map(i=>[i,r[i]]))}}return JSON.stringify(this._prevProps)===JSON.stringify(t)?this._prevProps:(this._prevProps=t,t)}get opacity(){if(this.isIn("select")&&this.selectedIds.length>0){const t=[],n=i=>{const o=this.getShapeById(i);if(o)if(o.type==="group")for(const s of this.getSortedChildIds(o.id))n(s);else t.push(o)};for(const i of this.selectedIds)n(i);let r=null;for(const i of t)if(r===null)r=i.opacity;else if(r!==i.opacity)return null;return r}else return this.instanceState.opacityForNextShape}get shapeIds(){return this._shapeIds.value}_complete(){var t;for(const n of this._invalidParents){this._invalidParents.delete(n);const r=this.getShapeById(n);if(!r)continue;const i=this.getShapeUtil(r),o=(t=i.onChildrenChange)==null?void 0:t.call(i,r);o!=null&&o.length&&this.updateShapes(o,!0)}this.emit("update")}get _arrowBindingsIndex(){return pJ(this.store)}getArrowsBoundTo(t){return this._arrowBindingsIndex.value[t]||ri}_reparentArrow(t){const n=this.getShapeById(t);if(!n)return;const{start:r,end:i}=n.props,o=r.type==="binding"?this.getShapeById(r.boundShapeId):void 0,s=i.type==="binding"?this.getShapeById(i.boundShapeId):void 0,a=this.getParentPageId(n);if(!a)return;let l;if(o&&s)l=this.findCommonAncestor([o,s])??a;else if(o||s)l=a;else return;l&&l!==n.parentId&&this.reparentShapesById([t],l);const c=this.getShapeById(t);if(!c)throw Error("no reparented arrow");const u=this.getNearestSiblingShape(c,o),d=this.getNearestSiblingShape(c,s);let h;if(u&&d)h=u.index>d.index?u:d;else if(u&&!d)h=u;else if(d&&!u)h=d;else return;let f;const p=this.getSortedChildIds(h.parentId).map(g=>this.getShapeById(g)).filter(g=>g.index>h.index);if(p.length){const g=p.find(y=>y.type!=="arrow");if(c.index>h.index&&(!g||c.index<g.index))return;f=ld(h.index,p[0].index)}else f=Co(h.index);f!==c.index&&this.updateShapes([{id:t,type:"arrow",index:f}])}_unbindArrowTerminal(t,n){const{x:r,y:i}=Ei(this,t)[n];this.store.put([{...t,props:{...t.props,[n]:{type:"point",x:r,y:i}}}])}get _allPageStates(){return this.store.query.records("instance_page_state")}_shapeWillBeDeleted(t){t.parentId&&Vr(t.parentId)&&this._invalidParents.add(t.parentId);const n=this._arrowBindingsIndex.value[t.id];if(n!=null&&n.length)for(const{arrowId:s,handleId:a}of n){const l=this.getShapeById(s);l&&this._unbindArrowTerminal(l,a)}const r=this._allPageStates.value,i=new Set([t.id]),o=Ae(r.map(s=>this._cleanupInstancePageState(s,i)));o.length&&this.store.put(o)}_arrowDidUpdate(t){for(const n of["start","end"]){const r=t.props[n];if(r.type!=="binding")continue;const i=this.getShapeById(r.boundShapeId),o=this.getParentPageId(t)===this.getParentPageId(i);(!i||!o)&&this._unbindArrowTerminal(t,n)}this._reparentArrow(t.id)}_cleanupInstancePageState(t,n){let r=null;const i=t.selectedIds.filter(a=>!n.has(a));i.length!==t.selectedIds.length&&(r||(r={...t}),r.selectedIds=i);const o=t.erasingIds.filter(a=>!n.has(a));o.length!==t.erasingIds.length&&(r||(r={...t}),r.erasingIds=o),t.hoveredId&&n.has(t.hoveredId)&&(r||(r={...t}),r.hoveredId=null),t.editingId&&n.has(t.editingId)&&(r||(r={...t}),r.editingId=null);const s=t.hintingIds.filter(a=>!n.has(a));return s.length!==t.hintingIds.length&&(r||(r={...t}),r.hintingIds=s),t.focusLayerId&&n.has(t.focusLayerId)&&(r||(r={...t}),r.focusLayerId=null),r}_shapeDidChange(t,n){if(this.isShapeOfType(n,Qt)&&this._arrowDidUpdate(n),t.parentId!==n.parentId){const r=i=>{const o=this._arrowBindingsIndex.value[i];if(o!=null&&o.length)for(const s of o)this._reparentArrow(s.arrowId)};r(n.id),this.visitDescendants(n.id,r)}if(t.parentId!==n.parentId&&Un(n.parentId)){const r=new Set([t.id]);this.visitDescendants(t.id,i=>{r.add(i)});for(const i of this._allPageStates.value){if(i.pageId===n.parentId)continue;const o=this._cleanupInstancePageState(i,r);o&&this.store.put([o])}}t.parentId&&Vr(t.parentId)&&this._invalidParents.add(t.parentId),n.parentId!==t.parentId&&Vr(n.parentId)&&this._invalidParents.add(n.parentId)}_pageStateDidChange(t,n){if((t==null?void 0:t.selectedIds)!==(n==null?void 0:n.selectedIds)){const r=n.selectedIds.filter(o=>{var a,l;let s=(a=this.getShapeById(o))==null?void 0:a.parentId;for(;Vr(s);){if(n.selectedIds.includes(s))return!1;s=(l=this.getShapeById(s))==null?void 0:l.parentId}return!0}),i=r.length===0?n==null?void 0:n.focusLayerId:this.findCommonAncestor(Ae(r.map(o=>this.getShapeById(o))),o=>o.type==="group");(r.length!==n.selectedIds.length||i!=n.focusLayerId)&&this.store.put([{...n,selectedIds:r,focusLayerId:i??null}])}}_pageWillBeDeleted(t){var o;if(this.instanceState.currentPageId!==t.id)return;const n=(o=this.pages.find(s=>s.id!==t.id))==null?void 0:o.id;if(!n)return;this.store.put([{...this.instanceState,currentPageId:n}]);const r=$n.createId(t.id),i=An.createId(t.id);this.store.remove([r,i])}get documentSettings(){return this.store.get(hb)}updateDocumentSettings(t){this.store.put([{...this.documentSettings,...t}])}get gridSize(){return this.documentSettings.gridSize}get projectName(){return this.documentSettings.name}setProjectName(t){this.updateDocumentSettings({name:t})}get isSnapMode(){return this.user.isSnapMode}setSnapMode(t){return t!==this.isSnapMode&&this.user.updateUserPreferences({isSnapMode:t}),this}get isDarkMode(){return this.user.isDarkMode}setDarkMode(t){return t!==this.isDarkMode&&this.user.updateUserPreferences({isDarkMode:t}),this}get animationSpeed(){return this.user.animationSpeed}setAnimationSpeed(t){return t!==this.animationSpeed&&this.user.updateUserPreferences({animationSpeed:t}),this}get isFocusMode(){return this.instanceState.isFocusMode}setFocusMode(t){return t!==this.isFocusMode&&this.updateInstanceState({isFocusMode:t},!0),this}get isToolLocked(){return this.instanceState.isToolLocked}setToolLocked(t){return t!==this.isToolLocked&&this.updateInstanceState({isToolLocked:t},!0),this}get isGridMode(){return this.instanceState.isGridMode}setGridMode(t){return t!==this.isGridMode&&this.updateInstanceState({isGridMode:t},!0),this}setReadOnly(t){return this._isReadOnly.set(t),t&&this.setSelectedTool("hand"),this}get isReadOnly(){return this._isReadOnly.value}get isPenMode(){return this._isPenMode.value}setPenMode(t){return t&&(this._touchEventsRemainingBeforeExitingPenMode=3),t!==this.isPenMode&&this._isPenMode.set(t),this}get instanceState(){return this.store.get(ar)}get cursor(){return this.instanceState.cursor}get brush(){return this.instanceState.brush}get zoomBrush(){return this.instanceState.zoomBrush}get scribble(){return this.instanceState.scribble}get pageStateId(){return An.createId(this.currentPageId)}get pageState(){return this.store.get(this.pageStateId)}get cameraId(){return $n.createId(this.currentPageId)}get camera(){return this.store.get(this.cameraId)}get zoomLevel(){return this.camera.z}get selectedIds(){return this.pageState.selectedIds}get selectedIdsSet(){return new Set(this.selectedIds)}get _pages(){return this.store.query.records("page")}get pages(){return this._pages.value.sort(ir)}get currentPage(){return this.getPageById(this.currentPageId)}get currentPageId(){return this.instanceState.currentPageId}getPageById(t){return this.store.get(t)}get _pageStates(){return this.store.query.records("instance_page_state")}getPageStateByPageId(t){return this._pageStates.value.find(n=>n.pageId===t)}getPageInfoById(t){return this.store.get(t)}getShapeIdsInPage(t){const n=this.store.query.exec("shape",{parentId:{eq:t}});return this.getShapeAndDescendantIds(n.map(r=>r.id))}getTransform(t){return this.getShapeUtil(t).transform(t)}getParentTransform(t){return Un(t.parentId)?ie.Identity():this._pageTransformCache.get(t.parentId)??ie.Identity()}getPageTransform(t){return this.getPageTransformById(t.id)}getPageTransformById(t){return this._pageTransformCache.get(t)}getPagePointById(t){const n=this.getPageTransformById(t);if(n)return ie.applyToPoint(n,new E)}getPageCenter(t){const n=this.getPageTransformById(t.id);if(!n)return null;const i=this.getShapeUtil(t).center(t);return ie.applyToPoint(n,i)}getPageCenterById(t){const n=this.getShapeById(t);return this.getPageCenter(n)}getPageRotation(t){return this.getPageRotationById(t.id)}getPageRotationById(t){const n=this.getPageTransformById(t);return n?ie.Decompose(n).rotation:0}getBounds(t){return this.getShapeUtil(t).bounds(t)}getBoundsById(t){const n=this.getShapeById(t);if(n)return this.getBounds(n)}getPageBounds(t){return this.getPageBoundsById(t.id)}getPageBoundsById(t){return this._pageBoundsCache.get(t)}getMaskedPageBounds(t){return this.getMaskedPageBoundsById(t.id)}getMaskedPageBoundsById(t){const n=this._pageBoundsCache.get(t);if(!n)return;const r=this._pageMaskCache.get(t);if(r){const i=pb(r,n.corners);return i?me.FromPoints(i):void 0}return n}getOutline(t){return this.getShapeUtil(t).outline(t)}getOutlineById(t){return this.getOutline(this.getShapeById(t))}getAncestors(t,n=[]){const r=t.parentId;if(Un(r))return n.reverse(),n;const i=this.store.get(r);return n.push(i),this.getAncestors(i,n)}getAncestorsById(t,n=[]){const r=this.getShapeById(t);return this.getAncestors(r,n)}findAncestor(t,n){const r=t.parentId;if(Un(r))return;const i=this.getShapeById(r);if(i)return n(i)?i:this.findAncestor(i,n)}hasAncestor(t,n){return t?t.parentId===n?!0:this.hasAncestor(this.getParentShape(t),n):!1}findCommonAncestor(t,n){var s;if(t.length===0)return;if(t.length===1){const a=t[0].parentId;return Un(a)?void 0:n?(s=this.findAncestor(t[0],n))==null?void 0:s.id:a}const[r,...i]=t;let o=this.getParentShape(r);for(;o;){if(n&&!n(o)){o=this.getParentShape(o);continue}if(i.every(a=>this.hasAncestor(a,o.id)))return o.id;o=this.getParentShape(o)}}isShapeInViewport(t){const n=this.getPageBoundsById(t);return n?this.viewportPageBounds.includes(n):!1}isShapeOrAncestorLocked(t){return t===void 0?!1:t.isLocked?!0:this.isShapeOrAncestorLocked(this.getParentShape(t))}computeUnorderedRenderingShapes(t,{cullingBounds:n,cullingBoundsExpanded:r,erasingIdsSet:i,editingId:o}={}){const s=[];let a=bo,l=0;const c=(u,d,h)=>{if(ei.isId(u)){for(const T of this.getSortedChildIds(u))c(T,d,h);return}const f=this.getShapeById(u);if(!f)return;let p=f.opacity*d,g=!1;!h&&(i!=null&&i.has(u))&&(g=!0,p*=.32);const y=this.getMaskedPageBoundsById(u),x=y?(n==null?void 0:n.includes(y))??!0:!1,w=y?(o!==u&&!(r!=null&&r.includes(y)))??!0:!0;s.push({id:u,index:a,backgroundIndex:l,opacity:p,isCulled:w,isInViewport:x,maskedPageBounds:y}),a+=1,l+=1;const _=this.getSortedChildIds(u);if(!_.length)return;let S=null;this.getShapeUtil(f).providesBackgroundForChildren(f)&&(S=l,l=a,a+=bo);for(const T of _)c(T,p,h||g);S!==null&&(l=S)};for(const u of t)c(u,1,!1);return s}get renderingShapes(){return this.computeUnorderedRenderingShapes([this.currentPageId],{cullingBounds:this.cullingBounds,cullingBoundsExpanded:this.cullingBoundsExpanded,erasingIdsSet:this.erasingIdsSet,editingId:this.editingId}).sort(IH)}get allShapesCommonBounds(){let t=null;return this.shapeIds.forEach(n=>{const r=this.getMaskedPageBoundsById(n);r&&(t?t.expand(r):t=r.clone())}),t}getPageCorners(t){const n=this.getAncestors(t),r=this.getBounds(t).corners,i=ie.Compose(...n.flatMap(o=>[ie.Translate(o.x,o.y),ie.Rotate(o.rotation)]),ie.Translate(t.x,t.y),ie.Rotate(t.rotation,0,0));return ie.applyToPoints(i,r)}isPointInShape(t,n){const r=this.getShapeUtil(n),i=this._pageMaskCache.get(n.id);return i&&!ai(t,i)?!1:r.hitTestPoint(n,this.getPointInShapeSpace(n,t))}getShapesAtPoint(t){return this.shapesArray.filter(n=>{const r=this._pageMaskCache.get(n.id);return r?ai(t,r):this.getShapeUtil(n).hitTestPoint(n,this.getPointInShapeSpace(n,t))})}getPointInShapeSpace(t,n){return ie.applyToPoint(ie.Inverse(this.getPageTransform(t)),n)}getPointInParentSpace(t,n){const r=this.getShapeById(t);if(!r)return new E(0,0);if(Un(r.parentId))return E.From(n);const i=this.getPageTransformById(r.parentId);return i?ie.applyToPoint(ie.Inverse(i),n):E.From(n)}getDeltaInShapeSpace(t,n){const r=this.getPageTransform(t);return r?E.Rot(n,-ie.Decompose(r).rotation):E.From(n)}getDeltaInParentSpace(t,n){if(Un(t.parentId))return E.From(n);const r=this.getShapeById(t.parentId);return r?this.getDeltaInShapeSpace(r,n):E.From(n)}getParentsMappedToChildren(t){const n=t.map(i=>this.store.get(i)),r=new Map;return n.forEach(i=>{var o;r.has(i.parentId)||r.set(i.parentId,new Set),(o=r.get(i.parentId))==null||o.add(i)}),r}updateViewportScreenBounds(t=!1){const n=this.getContainer();if(!n)return this;const r=n.getBoundingClientRect(),i=new me(0,0,Math.max(r.width,1),Math.max(r.height,1)),o=i.equals(this.viewportScreenBounds),{_willSetInitialBounds:s}=this;if(o)this._willSetInitialBounds=!1;else if(s)this._willSetInitialBounds=!1,this.updateInstanceState({screenBounds:i.toJson()},!0,!0);else{const{zoomLevel:l}=this;if(t){const c=this.viewportPageCenter;this.updateInstanceState({screenBounds:i.toJson()},!0,!0);const u=this.viewportPageCenter;this.instanceState.followingUserId||this.pan((u.x-c.x)*l,(u.y-c.y)*l)}else{const c=this.screenToPage(0,0);this.updateInstanceState({screenBounds:i.toJson()},!0,!0);const u=this.screenToPage(0,0);this.instanceState.followingUserId||this.pan((u.x-c.x)*l,(u.y-c.y)*l)}}this._cameraManager.tick(),this.updateCullingBounds();const{editingId:a}=this;return a&&this.panZoomIntoView([a]),this}get viewportScreenBounds(){const{x:t,y:n,w:r,h:i}=this.instanceState.screenBounds;return new me(t,n,r,i)}get viewportScreenCenter(){return this.viewportScreenBounds.center}get viewportPageBounds(){const{x:t,y:n,w:r,h:i}=this.viewportScreenBounds,o=this.screenToPage(t,n),s=this.screenToPage(t+r,n+i);return new me(o.x,o.y,s.x-o.x,s.y-o.y)}get cullingBounds(){return this._cullingBounds.value}get cullingBoundsExpanded(){return this._cullingBoundsExpanded.value}updateCullingBounds(){const{viewportPageBounds:t}=this;return t.equals(this._cullingBounds.__unsafe__getWithoutCapture())?this:(this._cullingBounds.set(t.clone()),this._cullingBoundsExpanded.set(t.clone().expandBy(100/this.zoomLevel)),this)}get viewportPageCenter(){return this.viewportPageBounds.center}screenToPage(t,n,r=.5,i=this.camera){const{screenBounds:o}=this.store.unsafeGetWithoutCapture(ar),{x:s,y:a,z:l=1}=i;return{x:(t-o.x)/l-s,y:(n-o.y)/l-a,z:r}}pageToScreen(t,n,r=.5,i=this.camera){const{x:o,y:s,z:a=1}=i;return{x:t+o*a,y:n+s*a,z:r}}get focusLayerId(){return this.pageState.focusLayerId??this.currentPageId}get focusLayerShape(){const t=this.pageState.focusLayerId;if(t)return this.getShapeById(t)}popFocusLayer(){const t=this.pageState.focusLayerId,n=t&&this.getShapeById(t);if(n){const r=this.findAncestor(n,i=>i.type==="group");this.setFocusLayer((r==null?void 0:r.id)??null),this.select(n.id)}else this.setFocusLayer(null),this.selectNone();return this}setFocusLayer(t){return this._setFocusLayer(t),this}setHintingIds(t){return this.store.update(this.pageState.id,n=>({...n,hintingIds:qg(t)})),this}get editingId(){return this.pageState.editingId}get croppingId(){return this.pageState.croppingId}get editingShape(){return this.editingId?this.getShapeById(this.editingId)??null:null}setEditingId(t){if(!t)this.setInstancePageState({editingId:null});else if(t!==this.editingId){const n=this.getShapeById(t),r=this.getShapeUtil(n);if(n&&r.canEdit(n)){this.setInstancePageState({editingId:t,hoveredId:null},!1);const{viewportPageBounds:i}=this,o=r.getEditingBounds(n),s=this.getPageTransformById(t),a=me.FromPoints(ie.applyToPoints(s,o.corners));i.contains(a)||(a.width>i.width||a.height>i.height?this.zoomToBounds(a.minX,a.minY,a.width,a.height):this.centerOnPoint(a.midX,a.midY))}}return this}setCroppingId(t){if(t!==this.croppingId)if(!t)this.setInstancePageState({croppingId:null}),this.isInAny("select.crop","select.pointing_crop_handle","select.cropping")&&this.setSelectedTool("select.idle");else{const n=this.getShapeById(t),r=this.getShapeUtil(n);n&&r.canCrop(n)&&this.setInstancePageState({croppingId:t,hoveredId:null})}return this}getParentIdForNewShapeAtPoint(t,n){const r=this.sortedShapesArray;for(let i=r.length-1;i>=0;i--){const o=r[i],s=this.getShapeUtil(o);if(!s.canReceiveNewChildrenOfType(o,n))continue;const a=this.getMaskedPageBoundsById(o.id);if(a&&a.containsPoint(t)&&s.hitTestPoint(o,this.getPointInShapeSpace(o,t)))return o.id}return this.focusLayerId}getDroppingShape(t,n=[]){const r=this.sortedShapesArray;for(let i=r.length-1;i>=0;i--){const o=r[i];if(n.find(l=>l.id===o.id||this.hasAncestor(o,l.id)))continue;const s=this.getShapeUtil(o);if(!s.canDropShapes(o,n))continue;const a=this.getMaskedPageBoundsById(o.id);if(a&&a.containsPoint(t)&&s.hitTestPoint(o,this.getPointInShapeSpace(o,t)))return o}}getOutermostSelectableShape(t,n){let r=t,i=t;for(;i;){if(i.type==="group"&&this.focusLayerId!==i.id&&!this.hasAncestor(this.focusLayerShape,i.id)&&((n==null?void 0:n(i))??!0))r=i;else if(this.focusLayerId===i.id)break;i=this.getParentShape(i)}return r}get selectedPageBounds(){const{pageState:{selectedIds:t}}=this;return t.length===0?null:me.Common(Ae(t.map(n=>this.getPageBoundsById(n))))}get selectionRotation(){const{selectedIds:t}=this;if(t.length===0)return 0;if(t.length===1)return this.getPageRotationById(this.selectedIds[0]);const n=t.map(r=>this.getPageRotationById(r)%(Math.PI/2));return n.every(r=>Math.abs(r-n[0])<Math.PI/180)?this.getPageRotationById(t[0]):0}get selectionBounds(){const{selectedIds:t}=this;if(t.length===0)return;const{selectionRotation:n}=this;if(n===0)return this.selectedPageBounds;if(t.length===1){const o=this.getBounds(this.getShapeById(t[0])).clone();return o.point=ie.applyToPoint(this.getPageTransformById(t[0]),o.point),o}const r=this.selectedIds.flatMap(o=>{const s=this.getPageTransformById(o);return s?this.getOutlineById(o).map(a=>ie.applyToPoint(s,a)):[]}).map(o=>E.Rot(o,-n)),i=me.FromPoints(r);return i.point=i.point.rot(n),i}get selectionPageCenter(){const{selectionBounds:t,selectionRotation:n}=this;return t?E.RotWith(t.center,t.point,n):null}get shapesArray(){return Array.from(this.shapeIds,t=>this.store.get(t))}get sortedShapesArray(){const t=new Set(this.shapesArray.sort(ir)),n=[];function r(i){n.push(i),t.delete(i),t.forEach(o=>{o.parentId===i.id&&r(o)})}return t.forEach(i=>{const o=this.getShapeById(i.parentId);Aa(o)||r(i)}),n}get selectedShapes(){const{selectedIds:t}=this.pageState;return Ae(t.map(n=>this.store.get(n)))}get onlySelectedShape(){const{selectedShapes:t}=this;return t.length===1?t[0]:null}isShapeOfType(t,n){return t.type===n.type}getShapeById(t){if(Vr(t))return this.store.get(t)}getParentShape(t){if(!(t===void 0||!Vr(t.parentId)))return this.store.get(t.parentId)}getNearestSiblingShape(t,n){return n?n.parentId===t.parentId?n:this.findAncestor(n,i=>i.parentId===t.parentId):void 0}getParentPageId(t){if(t!==void 0)return Un(t.parentId)?t.parentId:this.getParentPageId(this.getShapeById(t.parentId))}isShapeInPage(t,n=this.currentPageId){let r=!1;if(t.parentId===n)r=!0;else{let i=this.getShapeById(t.parentId);e:for(;i;){if(i.parentId===n){r=!0;break e}i=this.getShapeById(i.parentId)}}return r}getCssColor(t){return this.colors.get(t)}getStrokeWidth(t){return this.sizes[t]}get currentToolId(){var r;const t=this.root.current.value;let n=t==null?void 0:t.id;if(n==="select"||n==="zoom"){const i=t==null?void 0:t.current.value;n=((r=i==null?void 0:i.info)==null?void 0:r.onInteractionEnd)??"select"}return n??"select"}setSelectedTool(t,n={}){return this.root.transition(t,n),this}getStateDescendant(t){var i;const n=t.split(".").reverse();let r=this.root;for(;n.length>0;){const o=n.pop();if(!o)return r;const s=(i=r.children)==null?void 0:i[o];if(!s)return;r=s}return r}isIn(t){const n=t.split(".").reverse();let r=this.root;for(;n.length>0;){const i=n.pop();if(!i)return!0;const o=r.current.value;if((o==null?void 0:o.id)===i){if(n.length===0)return!0;r=o;continue}else return!1}return!1}isInAny(...t){return t.some(n=>this.isIn(n))}_updateInputsFromEvent(t){const{previousScreenPoint:n,previousPagePoint:r,currentScreenPoint:i,currentPagePoint:o}=this.inputs,{screenBounds:s}=this.store.unsafeGetWithoutCapture(ar),{x:a,y:l,z:c}=t.point,{x:u,y:d,z:h}=this.camera;n.setTo(i),r.setTo(o);const f=(a-s.x)/h-u,p=(l-s.y)/h-d;i.set(a,l),o.set(f,p,c??.5),this.inputs.isPen=t.type==="pointer"&&t.isPen,t.name==="pointer_down"&&(this.inputs.pointerVelocity=new E),this.store.put([{id:fb,typeName:"pointer",x:o.x,y:o.y,lastActivityTimestamp:Date.now()}])}cancelDoubleClick(){this._clickManager.cancelDoubleClickTimeout()}dispatch(t){if(this.crashingError)return this;const{inputs:n}=this,{type:r}=t;return this.batch(()=>{if(t.type==="misc"){(t.name==="cancel"||t.name==="complete")&&(this.inputs.isDragging=!1,this.inputs.isPanning&&(this.inputs.isPanning=!1,this.setCursor({type:this._prevCursor}))),this.root.handleEvent(t);return}t.shiftKey?(clearInterval(this._shiftKeyTimeout),this._shiftKeyTimeout=-1,n.shiftKey=!0):!t.shiftKey&&n.shiftKey&&this._shiftKeyTimeout===-1&&(this._shiftKeyTimeout=setTimeout(this._setShiftKeyTimeout,150)),t.altKey?(clearInterval(this._altKeyTimeout),this._altKeyTimeout=-1,n.altKey=!0):!t.altKey&&n.altKey&&this._altKeyTimeout===-1&&(this._altKeyTimeout=setTimeout(this._setAltKeyTimeout,150)),t.ctrlKey?(clearInterval(this._ctrlKeyTimeout),this._ctrlKeyTimeout=-1,n.ctrlKey=!0):!t.ctrlKey&&n.ctrlKey&&this._ctrlKeyTimeout===-1&&(this._ctrlKeyTimeout=setTimeout(this._setCtrlKeyTimeout,150));const{originPagePoint:i,originScreenPoint:o,currentPagePoint:s,currentScreenPoint:a}=n;switch(n.isPointing||(n.isDragging=!1),r){case"pinch":{if(!this.canMoveCamera)return;switch(this._updateInputsFromEvent(t),t.name){case"pinch_start":{if(n.isPinching)return;n.isEditing||(this._pinchStart=this.camera.z,this._selectedIdsAtPointerDown.length||(this._selectedIdsAtPointerDown=this.selectedIds.slice()),this._didPinch=!0,n.isPinching=!0,this.interrupt());return}case"pinch":{if(!n.isPinching)return;const{point:{x:l,y:c,z:u=1},delta:{x:d,y:h}}=t,{camera:{x:f,y:p,z:g}}=this,y=Math.min(Cs,Math.max(ku,u));this.setCamera(f+d/g-l/g+l/y,p+h/g-c/g+c/y,y);return}case"pinch_end":{if(!n.isPinching)return this;n.isPinching=!1;const{_selectedIdsAtPointerDown:l}=this;this.setSelectedIds(this._selectedIdsAtPointerDown,!0),this._selectedIdsAtPointerDown=[];const{camera:{x:c,y:u,z:d}}=this;let h;if(d>.9&&d<1.05?h=1:d>.49&&d<.505&&(h=.5),d>this._pinchStart-.1&&d<this._pinchStart+.05&&(h=this._pinchStart),h!==void 0){const{x:f,y:p}=this.viewportScreenCenter;this.animateCamera(c+(f/h-f)-(f/d-f),u+(p/h-p)-(p/d-p),h,{duration:100})}this._didPinch&&(this._didPinch=!1,requestAnimationFrame(()=>{this._didPinch||this.setSelectedIds(l,!0)}));return}}}case"wheel":{if(!this.canMoveCamera)return;if(!this.isMenuOpen){if(n.ctrlKey){const{x:l,y:c}=this.inputs.currentScreenPoint,{x:u,y:d,z:h}=this.camera,f=Math.min(Cs,Math.max(ku,h+(t.delta.z??0)*h));this.setCamera(u+(l/f-l)-(l/h-l),d+(c/f-c)-(c/h-c),f);return}this.pan(t.delta.x,t.delta.y),!n.isDragging&&n.isPointing&&i.dist(s)>(this.isCoarsePointer?gb:Vd)/this.zoomLevel&&(n.isDragging=!0)}break}case"pointer":{if(n.isPinching)return;this._updateInputsFromEvent(t);const{isPen:l}=t;switch(t.name){case"pointer_down":{if(this._selectedIdsAtPointerDown=this.selectedIds.slice(),t.button===0&&(this.capturedPointerId=t.pointerId),n.buttons.add(t.button),n.isPointing=!0,n.isDragging=!1,this.isPenMode)if(l)this._touchEventsRemainingBeforeExitingPenMode=3;else if(this._touchEventsRemainingBeforeExitingPenMode--,this._touchEventsRemainingBeforeExitingPenMode===0)this.setPenMode(!1);else return;else l&&this.setPenMode(!0);if(t.button===5?(this._restoreToolId=this.currentToolId,this.complete(),this.setSelectedTool("eraser")):t.button===1&&(this.inputs.isPanning||(this._prevCursor=this.instanceState.cursor.type),this.inputs.isPanning=!0),this.inputs.isPanning)return this.stopCameraAnimation(),this.setCursor({type:"grabbing"}),this;o.setTo(a),i.setTo(s);break}case"pointer_move":{if(!l&&this.isPenMode)return;if(this.inputs.isPanning&&this.inputs.isPointing){const{currentScreenPoint:c,previousScreenPoint:u}=this.inputs,d=E.Sub(c,u);this.pan(d.x,d.y);return}!n.isDragging&&n.isPointing&&i.dist(s)>(this.isCoarsePointer?gb:Vd)/this.zoomLevel&&(n.isDragging=!0);break}case"pointer_up":{if(n.buttons.delete(t.button),n.isPointing=!1,n.isDragging=!1,this.isMenuOpen||!l&&this.isPenMode)return;this.capturedPointerId===t.pointerId&&(this.capturedPointerId=null,t.button=0),n.isPanning?t.button===1?this.inputs.keys.has(" ")?(this.slideCamera({speed:Math.min(2,this.inputs.pointerVelocity.len()),direction:this.inputs.pointerVelocity,friction:Np}),this.setCursor({type:"grab"})):(n.isPanning=!1,this.slideCamera({speed:Math.min(2,this.inputs.pointerVelocity.len()),direction:this.inputs.pointerVelocity,friction:Np}),this.setCursor({type:this._prevCursor})):t.button===0&&(this.slideCamera({speed:Math.min(2,this.inputs.pointerVelocity.len()),direction:this.inputs.pointerVelocity,friction:Np}),this.setCursor({type:"grab"})):t.button===5&&(this.complete(),this.setSelectedTool(this._restoreToolId));break}}break}case"keyboard":{switch(t.key==="ShiftRight"&&(t.key="ShiftLeft"),t.key==="AltRight"&&(t.key="AltLeft"),t.code==="ControlRight"&&(t.code="ControlLeft"),t.name){case"key_down":{n.keys.add(t.code),!t.ctrlKey&&t.code==="Space"&&(this.inputs.isPanning||(this._prevCursor=this.instanceState.cursor.type),this.inputs.isPanning=!0,this.setCursor({type:this.inputs.isPointing?"grabbing":"grab"}));break}case"key_up":{n.keys.delete(t.code),t.code==="Space"&&!this.inputs.buttons.has(1)&&(this.inputs.isPanning=!1,this.setCursor({type:this._prevCursor}));break}}break}}if(t.type==="pointer"&&(t.button===1?t.name="middle_click":t.button===2&&(t.name="right_click"),t.isPen===this.isPenMode))switch(t.name){case"pointer_down":{const l=this._clickManager.transformPointerDownEvent(t);if(t.name!==l.name){this.root.handleEvent(t),this.emit("event",t),this.root.handleEvent(l),this.emit("event",l);return}break}case"pointer_up":{const l=this._clickManager.transformPointerUpEvent(t);if(t.name!==l.name){this.root.handleEvent(t),this.emit("event",t),this.root.handleEvent(l),this.emit("event",l);return}break}case"pointer_move":{this._clickManager.handleMove();break}}this.root.handleEvent(t),this.emit("event",t)}),this}replaceStoreContentsWithRecordsForOtherDocument(t){Xr(()=>{this.store.clear();const[n,r]=wH(t,o=>o.typeName==="shape");this.store.put(r,"initialize"),this.store.ensureStoreIsUsable(),this.store.put(n,"initialize"),this.history.clear(),this.updateViewportScreenBounds(),this.updateCullingBounds();const i=this.allShapesCommonBounds;i&&this.zoomToBounds(i.minX,i.minY,i.width,i.height,1)})}getContent(t=this.selectedIds){if(!t||t.length===0)return;const n={};let r=qg(t.map(s=>this.getShapeById(s)).sort(ir).flatMap(s=>{const a=[s];return this.visitDescendants(s.id,l=>{a.push(this.getShapeById(l))}),a}));r=r.map(s=>{if(n[s.id]=this.getPageTransformById(s.id),s=Ao(s),this.isShapeOfType(s,Qt)){const a=s.props.start.type==="binding"?s.props.start.boundShapeId:void 0,l=s.props.end.type==="binding"?s.props.end.boundShapeId:void 0,c=this.getShapeUtil(Qt).getArrowInfo(s);if(s.props.start.type==="binding"&&!r.some(d=>d.id===a))if(c!=null&&c.isValid){const{x:d,y:h}=c.start.point;s.props.start={type:"point",x:d,y:h}}else{const{start:d}=Ei(this,s);s.props.start={type:"point",x:d.x,y:d.y}}if(s.props.end.type==="binding"&&!r.some(d=>d.id===l))if(c!=null&&c.isValid){const{x:d,y:h}=c.end.point;s.props.end={type:"point",x:d,y:h}}else{const{end:d}=Ei(this,s);s.props.end={type:"point",x:d.x,y:d.y}}const u=Gu(s)?Gd(this,s):bb(this,s);if(c!=null&&c.isValid&&(u!=null&&u.isValid)&&!Gu(s)){const d=E.Med(c.start.handle,c.end.handle),h=E.Dist(c.middle,d),f=E.Dist(u.middle,d);s.props.bend<0?s.props.bend+=f-h:s.props.bend-=f-h}return s}return s});const i=[];r.forEach(s=>{if(r.find(a=>a.id===s.parentId)===void 0){const a=this.getPagePointById(s.id),l=this.getPageRotationById(s.id);s.x=a.x,s.y=a.y,s.rotation=l,s.parentId=this.currentPageId,i.push(s.id)}});const o=new Set;return r.forEach(s=>{"assetId"in s.props&&s.props.assetId!==null&&o.add(s.props.assetId)}),{shapes:r,rootShapeIds:i,schema:this.store.schema.serialize(),assets:Ae(Array.from(o).map(s=>this.getAssetById(s)))}}putContent(t,n={}){if(this.isReadOnly)return this;if(!t.schema)throw Error("Could not put content: content is missing a schema.");const{select:r=!1,preserveIds:i=!1,preservePosition:o=!1}=n;let{point:s=void 0}=n;const{currentPageId:a}=this,{assets:l,shapes:c,rootShapeIds:u}=t,d=new Map(c.map(S=>[S.id,gt()]));let h=this.currentPageId,f=1/0,p=[];for(const S of this.selectedShapes){if(f===0)break;const T=this.getAncestors(S);S.type==="frame"&&T.push(S);const P=S.type==="frame"?T.length+1:T.length;if(P<f)f=P,p=T,h=S.type==="frame"?S.id:S.parentId;else if(P===f){if(p.length!==T.length)throw Error(`Ancestors: ${p.length} !== ${T.length}`);if(p.length===0){h=a;break}else{h=a;for(let I=0;I<p.length&&T[I]===p[I];I++)h=T[I].id}}}let g=!1;if(!Un(h)){const S=this.getShapeById(h);if(S){if(!this.viewportPageBounds.includes(this.getPageBounds(S)))h=a;else if(u.length===1){const T=c.find(P=>P.id===u[0]);this.isShapeOfType(S,mc)&&this.isShapeOfType(T,mc)&&T.props.w===(S==null?void 0:S.props.w)&&T.props.h===(S==null?void 0:S.props.h)&&(g=!0)}}else h=a}g||(g=d.has(h)),g&&(h=this.getShapeById(h).parentId);let y=this.getHighestIndexForParent(h);const x=[],w=c.map(S=>{let T;if(i)T=pr(S),d.set(S.id,S.id);else{const P=d.get(S.id);T=pr({...S,id:P})}if(u.includes(S.id)&&(T.parentId=a,x.push(T)),d.has(T.parentId)?T.parentId=d.get(S.parentId):(u.push(T.id),T.index=y,y=Co(y)),this.isShapeOfType(T,Qt)){if(T.props.start.type==="binding"){const P=d.get(T.props.start.boundShapeId);T.props.start=P?{...T.props.start,boundShapeId:P}:{type:"point",x:0,y:0}}if(T.props.end.type==="binding"){const P=d.get(T.props.end.boundShapeId);T.props.end=P?{...T.props.end,boundShapeId:P}:{type:"point",x:0,y:0}}}return T});if(w.length+this.shapeIds.size>bo)return Xf(this),this;let _=[];if(l){for(let T=0;T<l.length;T++){const P=l[T],I=this.store.schema.migratePersistedRecord(P,t.schema);if(I.type==="success")l[T]=I.value;else throw Error(`Could not put content: could not migrate content for asset:
${JSON.stringify(P,null,2)}`)}const S=[];_=l.filter(T=>!this.store.has(T.id)).map(T=>{var P;return(T.type==="image"||T.type==="video")&&(T.props.src&&((P=T.props.src)!=null&&P.startsWith("data:image"))?(S.push(Ao(T)),T.props.src=null):S.push(Ao(T))),T}),Promise.allSettled(S.map(async T=>{const P=await Dq(T.props.src,T.props.name,T.props.mimeType??"image/png"),I=await this.onCreateAssetFromFile(P);return[T,I]})).then(T=>{this.updateAssets(Ae(T.map(P=>P.status==="fulfilled"?{...P.value[1],id:P.value[0].id}:void 0)))})}for(let S=0;S<w.length;S++){const T=w[S],P=this.store.schema.migratePersistedRecord(T,t.schema);if(P.type==="success")w[S]=P.value;else throw Error(`Could not put content: could not migrate content for shape:
${JSON.stringify(T,null,2)}`)}return this.batch(()=>{_.length>0&&this.createAssets(_),this.createShapes(w,r),h!==a&&this.reparentShapesById(x.map(P=>P.id),h);const S=w.map(P=>this.getShapeById(P.id)),T=me.Common(S.map(P=>this.getPageBounds(P)));if(s===void 0)if(Un(h)){const{viewportPageBounds:P}=this;o||P.includes(me.From(T))?s=T.center:s=P.center}else{const P=this.getShapeById(h);s=this.getShapeUtil(P).center(P)}if(x.length===1){const P=x[0];if(P.type==="frame")for(;this.getShapesAtPoint(s).some(I=>this.isShapeOfType(I,mc)&&I.props.w===P.props.w&&I.props.h===P.props.h);)s.x+=T.w+16}this.updateShapes(x.map(P=>{const I={x:(P.x??0)-(T.x+T.w/2),y:(P.y??0)-(T.y+T.h/2)};return{id:P.id,type:P.type,x:s.x+I.x,y:s.y+I.y}}))}),this}getHighestIndexForParent(t){const n=this._parentIdsToChildIds.value[t];return!n||n.length===0?"a1":Co(n[n.length-1][1])}createShapes(t,n=!1){return this._createShapes(t,n),this}animateShapes(t,n={}){const{duration:r=500,ease:i=Bn.linear}=n,o=At();let s=r,a;const l=[];t.forEach(d=>{if(!d)return;const h={partial:d,values:[]},f=this.getShapeById(d.id);if(f){for(const p of["x","y","rotation"])d[p]!==void 0&&f[p]!==d[p]&&h.values.push({prop:p,from:f[p],to:d[p]});l.push(h),this.animatingShapes.set(f.id,o)}});let c;const u=d=>{if(s-=d,s<0){const{animatingShapes:f}=this,p=t.filter(g=>g&&f.get(g.id)===o);p.length&&this.updateShapes(p,!1),this.removeListener("tick",u);return}a=i(1-s/r);const{animatingShapes:h}=this;try{const f=[];for(let p=0;p<l.length;p++)c=l[p],h.get(c.partial.id)===o&&f.push({id:c.partial.id,type:c.partial.type,...c.values.reduce((g,{prop:y,from:x,to:w})=>(g[y]=x+(w-x)*a,g),{})});this._updateShapes(f,!0)}catch{}};return this.addListener("tick",u),this}updateShapes(t,n=!1){let r=Ae(t);return this.animatingShapes.size>0&&r.forEach(i=>this.animatingShapes.delete(i.id)),r=r.filter(i=>{const o=this.getShapeById(i.id);return!(!o||this.isShapeOrAncestorLocked(o)&&!Object.hasOwn(i,"isLocked"))}),this._updateShapes(r,n),this}_getUnlockedShapeIds(t){return t.filter(n=>{var r;return!((r=this.getShapeById(n))!=null&&r.isLocked)})}deleteShapes(t=this.selectedIds){return this._deleteShapes(this._getUnlockedShapeIds(t)),this}get locale(){return this.user.locale}setLocale(t){this.user.updateUserPreferences({locale:t})}updatePage(t,n=!1){return this._updatePage(t,n),this}createPage(t,n=ei.createId(),r){return this._createPage(t,n,r),this}duplicatePage(t=this.currentPageId,n=ei.createId()){if(this.pages.length>=im)return;const r=this.getPageById(t);if(!r)return;const i={...this.camera},o=this.getContent(this.getSortedChildIds(r.id));this.batch(()=>{if(this.createPage(r.name+" Copy",n,r.index),this.setCurrentPageId(n),this.setCamera(i.x,i.y,i.z),o)return this.putContent(o)})}deletePage(t){this._deletePage(t)}setInstancePageState(t,n=!1){this._setInstancePageState(t,n)}setSelectedIds(t,n=!1){return this._setSelectedIds(t,n),this}isSelected(t){return this.selectedIdsSet.has(t)}isWithinSelection(t){const n=this.getShapeById(t);return n?this.isSelected(t)?!0:!!this.findAncestor(n,r=>this.isSelected(r.id)):!1}get _assets(){return this.store.query.records("asset")}get assets(){return this._assets.value}createAssets(t){return this._createAssets(t),this}deleteAssets(t){return this._deleteAssets(t),this}updateAssets(t){return this._updateAssets(t),this}getAssetBySrc(t){return this.assets.find(n=>n.props.src===t)}getAssetById(t){return this.store.get(t)}async getSvg(t=this.selectedIds.length?this.selectedIds:Object.keys(this.shapeIds),n={}){var R,K,Q;if(t.length===0)return;if(!window.document)throw Error("No document");const{scale:r=1,background:i=!1,padding:o=rq,darkMode:s=this.isDarkMode,preserveAspectRatio:a=!1}=n,l=this.getContainer(),c=getComputedStyle(l),u=document.createElement("div");u.className=`tl-container tl-theme__${s?"dark":"light"} tl-theme__force-sRGB`,document.body.appendChild(u);const d=getComputedStyle(u),h=new Map,f={fill:Object.fromEntries(Tu.color.map(j=>[j.id,d.getPropertyValue(`--palette-${j.id}`)])),pattern:Object.fromEntries(Tu.color.map(j=>[j.id,d.getPropertyValue(`--palette-${j.id}-pattern`)])),semi:Object.fromEntries(Tu.color.map(j=>[j.id,d.getPropertyValue(`--palette-${j.id}-semi`)])),highlight:Object.fromEntries(Tu.color.map(j=>[j.id,d.getPropertyValue(`--palette-${j.id}-highlight`)])),text:d.getPropertyValue("--color-text"),background:d.getPropertyValue("--color-background"),solid:d.getPropertyValue("--palette-solid")};document.body.removeChild(u);const p=this.getShapeAndDescendantIds(t),g=this.computeUnorderedRenderingShapes([this.currentPageId]).filter(({id:j})=>p.has(j));let y=null;for(const{maskedPageBounds:j}of g)j&&(y?y.union(j):y=j.clone());if(!y)return;const x=t.length===1&&((R=this.getShapeById(t[0]))==null?void 0:R.type)==="frame"?t[0]:null;x||y.expandBy(o);const w=y.width*r,_=y.height*r,S=window.document.createElementNS("http://www.w3.org/2000/svg","svg");a&&S.setAttribute("preserveAspectRatio",a),S.setAttribute("direction","ltr"),S.setAttribute("width",w+""),S.setAttribute("height",_+""),S.setAttribute("viewBox",`${y.minX} ${y.minY} ${y.width} ${y.height}`),S.setAttribute("stroke-linecap","round"),S.setAttribute("stroke-linejoin","round"),i?x?S.style.setProperty("background",f.solid):S.style.setProperty("background-color",f.background):S.style.setProperty("background-color","transparent");const T=window.document.createElementNS("http://www.w3.org/2000/svg","defs");for(const j of Array.from(LX(f.solid)))T.appendChild(j);try{(Q=(K=document.body).focus)==null||Q.call(K)}catch{}S.append(T);const P=(await Promise.all(g.map(async({id:j,opacity:B,index:z,backgroundIndex:q})=>{var he,je;if(j===x)return[];const U=this.getShapeById(j),D=this.getShapeUtil(U);let F;"font"in U.props&&U.props.font&&(h.has(U.props.font)?F=h.get(U.props.font):(F=c.getPropertyValue(`--tl-font-${U.props.font}`),h.set(U.props.font,F)));let J=await((he=D.toSvg)==null?void 0:he.call(D,U,F,f)),Z=await((je=D.toBackgroundSvg)==null?void 0:je.call(D,U,F,f));if(J){const $e=document.createElementNS("http://www.w3.org/2000/svg","g");$e.appendChild(J),J=$e}if(Z){const $e=document.createElementNS("http://www.w3.org/2000/svg","g");$e.appendChild(Z),Z=$e}if(!J&&!Z){const $e=this.getPageBounds(U),Ee=window.document.createElementNS("http://www.w3.org/2000/svg","rect");Ee.setAttribute("width",$e.width+""),Ee.setAttribute("height",$e.height+""),Ee.setAttribute("fill",f.solid),Ee.setAttribute("stroke",f.pattern.grey),Ee.setAttribute("stroke-width","1"),J=Ee}let ne=this.getPageTransform(U).toCssString();"scale"in U.props&&U.props.scale!==1&&(ne=`${ne} scale(${U.props.scale}, ${U.props.scale})`),J==null||J.setAttribute("transform",ne),Z==null||Z.setAttribute("transform",ne),J==null||J.setAttribute("opacity",B+""),Z==null||Z.setAttribute("opacity",B+"");const de=this.getPageMaskById(U.id);if(de){const $e=document.createElementNS("http://www.w3.org/2000/svg","clipPath");T.appendChild($e);const Ee=$h();$e.id=Ee;const Ie=document.createElementNS("http://www.w3.org/2000/svg","path");if(Ie.setAttribute("d",`M${de.map(({x:Fe,y:ct})=>`${Fe},${ct}`).join("L")}Z`),$e.appendChild(Ie),J){const Fe=document.createElementNS("http://www.w3.org/2000/svg","g");Fe.setAttribute("clip-path",`url(#${Ee})`),Fe.appendChild(J),J=Fe}if(Z){const Fe=document.createElementNS("http://www.w3.org/2000/svg","g");Fe.setAttribute("clip-path",`url(#${Ee})`),Fe.appendChild(Z),Z=Fe}}const Ce=[];return J&&Ce.push({zIndex:z,element:J}),Z&&Ce.push({zIndex:q,element:Z}),Ce}))).flat();for(const{element:j}of P.sort((B,z)=>B.zIndex-z.zIndex))S.appendChild(j);let I="";const $=window.document.createElementNS("http://www.w3.org/2000/svg","style"),L=[];return"fonts"in document&&document.fonts.forEach(j=>L.push(j)),await Promise.all(L.map(async j=>{const B=new FileReader;let z=!1;if(h.forEach(D=>{D.includes(j.family)&&(z=!0)}),!z)return;const q=j.$$_url,U=j.$$_fontface;if(q){const D=await(await fetch(q)).blob(),F=await new Promise((Z,ne)=>{B.onload=()=>Z(B.result),B.onerror=()=>ne(B.error),B.readAsDataURL(D)}),J=`
`+U.replaceAll(q,F);I+=J}})),$.textContent=I,T.append($),S}renamePage(t,n,r=!1){return this.isReadOnly?this:(this.updatePage({id:t,name:n},r),this)}moveShapesToPage(t,n){if(t.length===0)return this;if(this.isReadOnly)return this;const{currentPageId:r}=this;if(n===r)return this;if(!this.store.has(n))return this;const i=this.getContent(t);if(!i)return this;if(this.getShapeIdsInPage(n).size+i.shapes.length>bo)return Xf(this,n),this;const o=this.camera.z;return this.history.batch(()=>{this.deleteShapes(t),this.setCurrentPageId(n),this.setFocusLayer(null),this.selectNone(),this.putContent(i,{select:!0,preserveIds:!0,preservePosition:!0});const{center:{x:s,y:a}}=this.selectionBounds;this.setCamera(this.camera.x,this.camera.y,o),this.centerOnPoint(s,a)}),this}toggleLock(t=this.selectedIds){if(this.isReadOnly||t.length===0)return this;let n=!0,r=!0;const i=[];for(const o of t){const s=this.getShapeById(o);s&&(i.push(s),s.isLocked?r=!1:n=!1)}return r?(this.updateShapes(i.map(o=>({id:o.id,type:o.type,isLocked:!0}))),this.setSelectedIds([])):n?this.updateShapes(i.map(o=>({id:o.id,type:o.type,isLocked:!1}))):this.updateShapes(i.map(o=>({id:o.id,type:o.type,isLocked:!0}))),this}reorderShapes(t,n){if(this.isReadOnly)return this;if(n.length===0)return this;const r=this.getParentsMappedToChildren(n),i=[];switch(t){case"toBack":{r.forEach((o,s)=>{const a=Ae(this.getSortedChildIds(s).map(d=>this.getShapeById(d)));if(o.size===a.length)return;let l,c;for(const d of a){if(!o.has(d)){c=d.index;break}o.delete(d),l=d.index}if(o.size===0)return;const u=El(l,c,o.size);Array.from(o.values()).sort(ir).forEach((d,h)=>i.push({id:d.id,type:d.type,index:u[h]}))});break}case"toFront":{r.forEach((o,s)=>{const a=Ae(this.getSortedChildIds(s).map(h=>this.getShapeById(h))),l=a.length;if(o.size===l)return;let c,u;for(let h=l-1;h>-1;h--){const f=a[h];if(!o.has(f)){c=f.index;break}o.delete(f),u=f.index}if(o.size===0)return;const d=El(c,u,o.size);Array.from(o.values()).sort(ir).forEach((h,f)=>i.push({id:h.id,type:h.type,index:d[f]}))});break}case"forward":{r.forEach((o,s)=>{var g;const a=Ae(this.getSortedChildIds(s).map(y=>this.getShapeById(y))),l=a.length;if(o.size===l)return;const c=new Set(Array.from(o).map(y=>a.indexOf(y)));let u=-1,d=!1,h,f,p;for(let y=0;y<l;y++){const x=c.has(y);if(!d&&x)d=!0,u=y,f=void 0;else if(d&&!x){d=!1,p=y-u,h=a[y].index,f=(g=a[y+1])==null?void 0:g.index;const w=El(h,f,p);for(let _=0;_<p;_++){const S=a[u+_];i.push({id:S.id,type:S.type,index:w[_]})}}}});break}case"backward":{r.forEach((o,s)=>{var f;const a=Ae(this.getSortedChildIds(s).map(p=>this.getShapeById(p))),l=a.length;if(o.size===l)return;const c=new Set(Array.from(o).map(p=>a.indexOf(p)));let u=-1,d=!1,h;for(let p=l-1;p>-1;p--){const g=c.has(p);if(!d&&g)d=!0,u=p;else if(d&&!g){d=!1,h=u-p;const y=El((f=a[p-1])==null?void 0:f.index,a[p].index,h);for(let x=0;x<h;x++){const w=a[p+x+1];i.push({id:w.id,type:w.type,index:y[x]})}}}});break}}return this.updateShapes(i),this}sendToBack(t=this.pageState.selectedIds){return this.reorderShapes("toBack",t),this}sendBackward(t=this.pageState.selectedIds){return this.reorderShapes("backward",t),this}bringForward(t=this.pageState.selectedIds){return this.reorderShapes("forward",t),this}bringToFront(t=this.pageState.selectedIds){return this.reorderShapes("toFront",t),this}flipShapes(t,n=this.selectedIds){if(this.isReadOnly)return this;let r=Ae(n.map(o=>this.getShapeById(o)));if(!r.length)return this;r=Ae(r.map(o=>o.type==="group"?this.getSortedChildIds(o.id).map(s=>this.getShapeById(s)):o).flat());const i=me.Common(Ae(r.map(o=>this.getPageBounds(o)))).center;return this.batch(()=>{for(const o of r){const a=this.getShapeUtil(o).bounds(o),l=this.getPageTransformById(o.id);l&&this.resizeShape(o.id,{x:t==="horizontal"?-1:1,y:t==="vertical"?-1:1},{initialBounds:a,initialPageTransform:l,initialShape:o,mode:"scale_shape",scaleOrigin:i,scaleAxisRotation:0})}}),this}stackShapes(t,n=this.pageState.selectedIds,r){if(this.isReadOnly)return this;const i=Ae(n.map(p=>this.getShapeById(p))).filter(p=>!(!p||this.isShapeOfType(p,Qt)&&(p.props.start.type==="binding"||p.props.end.type==="binding"))),o=i.length;if(r===void 0&&o<3||o<2)return this;const s=Object.fromEntries(i.map(p=>[p.id,this.getPageBounds(p)]));let a,l,c,u;t==="horizontal"?(a="x",l="minX",c="maxX",u="width"):(a="y",l="minY",c="maxY",u="height");let d;if(r===void 0){const p=[];i.sort((y,x)=>s[y.id][l]-s[x.id][l]);for(let y=0;y<o-1;y++){const x=i[y],w=i[y+1],_=s[x.id],T=s[w.id][l]-_[c],P=p.find(I=>I.gap===T);P?P.count++:p.push({gap:T,count:1})}let g=0;p.forEach(y=>{y.count>g&&(g=y.count,d=y.gap)}),g===1&&(d=Math.max(0,p.reduce((y,x)=>y+x.gap*x.count,0)/(o-1)))}else d=r;const h=[];let f=s[i[0].id][c];return i.forEach((p,g)=>{var S,T;if(g===0)return;const y={x:0,y:0};y[a]=f+d-s[p.id][a];const x=this.getParentShape(p),w=x?E.Rot(y,-this.getPageRotation(x)):y,_=(T=(S=this.getShapeUtil(p)).onTranslateStart)==null?void 0:T.call(S,p);h.push(_?{..._,[a]:p[a]+w[a]}:{id:p.id,type:p.type,[a]:p[a]+w[a]}),f+=s[p.id][u]+d}),this.updateShapes(h),this}packShapes(t=this.pageState.selectedIds,n=16){var T,P;if(this.isReadOnly)return this;if(t.length<2)return this;const r=Ae(t.map(I=>this.getShapeById(I)).filter(I=>!(!I||this.isShapeOfType(I,Qt)&&(I.props.start.type==="binding"||I.props.end.type==="binding")))),i={},o={};let s,a,l=0;for(let I=0;I<r.length;I++)s=r[I],a=this.getPageBounds(s),i[s.id]=a,o[s.id]=a.clone(),l+=a.width*a.height;const c=me.Common(Ae(Object.values(i))),u=c.width;r.sort((I,$)=>i[$.id].height-i[I.id].height);const d=Math.max(Math.ceil(Math.sqrt(l/.95)),u),h=[new me(c.x,c.y,d,1/0)];let f=0,p=0,g,y;for(let I=0;I<r.length;I++){s=r[I],a=o[s.id];for(let $=h.length-1;$>=0;$--)if(g=h[$],!(a.width>g.width||a.height>g.height)){a.x=g.x,a.y=g.y,p=Math.max(p,a.maxY),f=Math.max(f,a.maxX),a.width===g.width&&a.height===g.height?(y=h.pop(),$<h.length&&(h[$]=y)):a.height===g.height?(g.x+=a.width+n,g.width-=a.width+n):a.width===g.width?(g.y+=a.height+n,g.height-=a.height+n):(h.push(new me(g.x+(a.width+n),g.y,g.width-(a.width+n),a.height)),g.y+=a.height+n,g.height-=a.height+n);break}}const x=me.Common(Object.values(o)),w=E.Sub(c.center,x.center);let _;const S=[];for(let I=0;I<r.length;I++){s=r[I],a=i[s.id],_=o[s.id];const $=this.getDeltaInParentSpace(s,E.Sub(_.point,a.point).add(w)),L={id:s.id,type:s.type,x:s.x+$.x,y:s.y+$.y},R=(P=(T=this.getShapeUtil(s)).onTranslateStart)==null?void 0:P.call(T,{...s,...L});R?S.push({...L,...R}):S.push(L)}return S.length&&this.updateShapes(S),this}alignShapes(t,n=this.pageState.selectedIds){if(this.isReadOnly)return this;if(n.length<2)return this;const r=Ae(n.map(a=>this.getShapeById(a))),i=Object.fromEntries(r.map(a=>[a.id,this.getPageBounds(a)])),o=me.Common(Ae(Object.values(i))),s=[];return r.forEach(a=>{var f,p;const l=i[a.id];if(!l)return;const c={x:0,y:0};switch(t){case"top":{c.y=o.minY-l.minY;break}case"center-vertical":{c.y=o.midY-l.minY-l.height/2;break}case"bottom":{c.y=o.maxY-l.minY-l.height;break}case"left":{c.x=o.minX-l.minX;break}case"center-horizontal":{c.x=o.midX-l.minX-l.width/2;break}case"right":{c.x=o.maxX-l.minX-l.width;break}}const u=this.getParentShape(a),d=u?E.Rot(c,-this.getPageRotation(u)):c,h=(p=(f=this.getShapeUtil(a)).onTranslateStart)==null?void 0:p.call(f,a);s.push(h?{...h,x:a.x+d.x,y:a.y+d.y}:{id:a.id,type:a.type,x:a.x+d.x,y:a.y+d.y})}),this.updateShapes(s),this}distributeShapes(t,n=this.pageState.selectedIds){if(this.isReadOnly)return this;if(n.length<3)return this;const r=n.length,i=Ae(n.map(x=>this.getShapeById(x))),o=Object.fromEntries(i.map(x=>[x.id,this.getPageBounds(x)]));let s,a,l,c,u;t==="horizontal"?(s="x",a="minX",l="maxX",c="midX",u="width"):(s="y",a="minY",l="maxY",c="midY",u="height");const d=[],h=i.sort((x,w)=>o[x.id][a]-o[w.id][a])[0],f=i.sort((x,w)=>o[w.id][l]-o[x.id][l])[0],p=o[h.id][c],g=(o[f.id][c]-p)/(r-1),y=p+g;return i.filter(x=>x!==h&&x!==f).sort((x,w)=>o[x.id][c]-o[w.id][c]).forEach((x,w)=>{var I,$;const _={x:0,y:0};_[s]=y+g*w-o[x.id][u]/2-o[x.id][s];const S=this.getParentShape(x),T=S?E.Rot(_,-this.getPageRotation(S)):_,P=($=(I=this.getShapeUtil(x)).onTranslateStart)==null?void 0:$.call(I,x);d.push(P?{...P,[s]:x[s]+T[s]}:{id:x.id,type:x.type,[s]:x[s]+T[s]})}),this.updateShapes(d),this}_resizeUnalignedShape(t,n,r){const{type:i}=r.initialShape,o=new E(n.x,n.y);if(Math.abs(n.x)>Math.abs(n.y)?o.x=Math.sign(n.x)*Math.abs(n.y):o.y=Math.sign(n.y)*Math.abs(n.x),this.resizeShape(t,o,{initialShape:r.initialShape,initialBounds:r.initialBounds}),Math.sign(n.x)*Math.sign(n.y)<0){let{rotation:p}=ie.Decompose(r.initialPageTransform);p-=2*p,this.updateShapes([{id:t,type:i,rotation:p}],!0)}const s=ie.applyToPoint(r.initialPageTransform,r.initialBounds.center),a=this._scalePagePoint(s,r.scaleOrigin,n,r.scaleAxisRotation),l=this.getPageCenterById(t),c=this.getPagePointById(t);if(!l||!c)return this;const u=E.Sub(a,l),d=E.Add(c,u),{x:h,y:f}=this.getPointInParentSpace(t,d);return this.updateShapes([{id:t,type:i,x:h,y:f}],!0),this}_scalePagePoint(t,n,r,i){const o=E.RotWith(t,n,-i).sub(n),s=E.MulV(o,r);return E.Add(s,n).rotWith(n,i)}resizeShape(t,n,r){var d;if(this.isReadOnly)return this;Number.isFinite(n.x)||(n=new E(1,n.y)),Number.isFinite(n.y)||(n=new E(n.x,1));const i=(r==null?void 0:r.initialShape)??this.getShapeById(t);if(!i)return this;const o=(r==null?void 0:r.scaleOrigin)??((d=this.getPageBoundsById(t))==null?void 0:d.center);if(!o)return this;const s=this.getPageRotationById(t);if(s==null)return this;const a=(r==null?void 0:r.scaleAxisRotation)??s,l=(r==null?void 0:r.initialPageTransform)??this.getPageTransformById(t);if(!l)return this;const c=(r==null?void 0:r.initialBounds)??this.getBoundsById(t);if(!c)return this;if(!e5(s,a))return this._resizeUnalignedShape(t,n,{...r,initialBounds:c,scaleOrigin:o,scaleAxisRotation:a,initialPageTransform:l,initialShape:i});const u=this.getShapeUtil(i);if(u.isAspectRatioLocked(i)&&(Math.abs(n.x)>Math.abs(n.y)?n=new E(n.x,Math.sign(n.y)*Math.abs(n.x)):n=new E(Math.sign(n.x)*Math.abs(n.y),n.y)),u.onResize&&u.canResize(i)){const h=this._scalePagePoint(ie.applyToPoint(l,new E(0,0)),o,n,a),f=this.getPointInParentSpace(i.id,h),p=new E(n.x,n.y),g=ud((s-a)%Math.PI,0);p.x=g?n.x:n.y,p.y=g?n.y:n.x;const y=ie.applyToPoint(l,new E),{x,y:w}=this.getPointInParentSpace(i.id,y);this.updateShapes([{id:t,type:i.type,x:f.x,y:f.y,...u.onResize({...i,x,y:w},{newPoint:f,handle:(r==null?void 0:r.dragHandle)??"bottom_right",mode:(r==null?void 0:r.mode)??"scale_shape",scaleX:p.x,scaleY:p.y,initialBounds:c,initialShape:i})}],!0)}else{const h=ie.applyToPoint(l,c.center),f=this._scalePagePoint(h,o,n,a),p=this.getPointInParentSpace(i.id,h),g=this.getPointInParentSpace(i.id,f),y=E.Sub(g,p);this.updateShapes([{id:t,type:i.type,x:i.x+y.x,y:i.y+y.y}],!0)}return this}stretchShapes(t,n=this.pageState.selectedIds){if(this.isReadOnly)return this;if(n.length<2)return this;const r=Ae(n.map(l=>this.getShapeById(l))),i=Object.fromEntries(r.map(l=>[l.id,this.getBounds(l)])),o=Object.fromEntries(r.map(l=>[l.id,this.getPageBounds(l)])),s=me.Common(Ae(Object.values(o))),a=[];switch(t){case"vertical":{this.batch(()=>{for(const l of r){if(this.getPageRotation(l)%kt)continue;const u=i[l.id],d=o[l.id],h=this.getDeltaInParentSpace(l,new E(0,s.minY-d.minY)),{x:f,y:p}=E.Add(h,l);this.updateShapes([{id:l.id,type:l.type,x:f,y:p}],!0);const g=new E(1,s.height/d.height);this.resizeShape(l.id,g,{initialBounds:u,scaleOrigin:new E(d.center.x,s.minY),scaleAxisRotation:0})}});break}case"horizontal":{this.batch(()=>{for(const l of r){const c=i[l.id],u=o[l.id];if(this.getPageRotation(l)%kt)continue;const h=this.getDeltaInParentSpace(l,new E(s.minX-u.minX,0)),{x:f,y:p}=E.Add(h,l);this.updateShapes([{id:l.id,type:l.type,x:f,y:p}],!0);const g=new E(s.width/u.width,1);this.resizeShape(l.id,g,{initialBounds:c,scaleOrigin:new E(s.minX,u.center.y),scaleAxisRotation:0})}});break}}return this.updateShapes(a),this}reparentShapesById(t,n,r){const i=[],o=Un(n)?ie.Identity():this.getPageTransformById(n),s=o.decompose().rotation;let a=[];const l=Ae(this.getSortedChildIds(n).map(u=>this.getShapeById(u)));if(r){const u=l.find(d=>d.index===r);if(u){const d=l[l.indexOf(u)+1];d?a=El(r,d.index,t.length):a=fv(r,t.length)}else{const d=l.sort(ir).find(h=>h.index>r);d?a=El(r,d.index,t.length):a=fv(r,t.length)}}else{const u=l.length&&l[l.length-1];a=u?fv(u.index,t.length):bM(t.length)}let c;for(let u=0;u<t.length;u++){c=t[u];const d=this.getShapeById(c),h=this.getPagePointById(c);if(!d||!h)continue;const f=ie.applyToPoint(ie.Inverse(o),h),p=this.getPageRotation(d)-s;i.push({id:d.id,type:d.type,parentId:n,x:f.x,y:f.y,rotation:p,index:a[u]})}return this.updateShapes(i),this}select(...t){return this.setSelectedIds(t),this}deselect(...t){const{selectedIds:n}=this;return n.length>0&&t.length>0&&this.setSelectedIds(n.filter(r=>!t.includes(r))),this}selectAll(){const t=this.getSortedChildIds(this.currentPageId);return t.length<=0?this:(this.setSelectedIds(this._getUnlockedShapeIds(t)),this)}getShapeAndDescendantIds(t){const n=new Set,r=[...t];for(;r.length>0;){const i=r.pop();if(!i)break;n.has(i)||(n.add(i),this.getSortedChildIds(i).forEach(o=>{r.push(o)}))}return n}selectNone(){return this.selectedIds.length>0&&this.setSelectedIds([]),this}setCurrentPageId(t,{stopFollowing:n=!0}={}){return this._setCurrentPageId(t,{stopFollowing:n}),this}updateInstanceState(t,n=!1,r=!1){return this._updateInstanceState(t,n,r),this}get hoveredId(){return this.pageState.hoveredId}get hoveredShape(){return this.hoveredId?this.getShapeById(this.hoveredId)??null:null}setHoveredId(t=null){return t===this.pageState.hoveredId?this:(this.setInstancePageState({hoveredId:t},!0),this)}setErasingIds(t=[]){const n=this.erasingIdsSet;return t.length===n.size&&t.every(r=>n.has(r))?this:(this.setInstancePageState({erasingIds:t},!0),this)}setCursor(t){const n=this.cursor,r={...n,rotation:0,...t};return n.type===r.type&&n.rotation===r.rotation&&n.color===r.color||this.updateInstanceState({cursor:r},!0),this}setScribble(t=null){return this.updateInstanceState({scribble:t},!0),this}setBrush(t=null){return!t&&!this.brush?this:(this.updateInstanceState({brush:t},!0),this)}setZoomBrush(t=null){return!t&&!this.zoomBrush?this:(this.updateInstanceState({zoomBrush:t},!0),this)}rotateShapesBy(t,n){if(t.length<=0)return this;const r=p6({editor:this});return Qp({delta:n,snapshot:r,editor:this,stage:"one-off"}),this}nudgeShapes(t,n,r=!1,i=!1){var l,c;if(t.length<=0)return this;const o=this.isGridMode?r?this.gridSize*eq:this.gridSize:r?XY:ZY,s=E.Mul(n,o),a=[];for(const u of t){const d=this.getShapeById(u);if(!d)throw Error(`Could not find a shape with the id ${u}.`);const h=this.getDeltaInParentSpace(d,s),f=(c=(l=this.getShapeUtil(d)).onTranslateStart)==null?void 0:c.call(l,d);a.push(f?{...f,x:d.x+h.x,y:d.y+h.y}:{id:u,x:d.x+h.x,y:d.y+h.y,type:d.type})}return this.updateShapes(a,i),this}duplicateShapes(t=this.selectedIds,n){if(t.length<=0)return this;const r=new Set(t),i=[],o=[...t];for(;o.length>0;){const l=o.pop();if(!l)break;i.push(l),this.getSortedChildIds(l).forEach(c=>o.push(c))}i.reverse();const s=new Map(i.map(l=>[l,gt()])),a=Ae(i.map(l=>{const c=this.getShapeById(l);if(!c)return null;const u=s.get(l);let d=0,h=0;if(n&&r.has(l)){const S=this.getParentTransform(c),T=new E(n.x,n.y).rot(-ie.Decompose(S).rotation);d=T.x,h=T.y}const f=c.parentId??this.currentPageId,p=this.getSortedChildIds(f),g=p.indexOf(c.id),y=p[g+1],x=y?this.getShapeById(y):null,w=x?ld(c.index,x.index):Co(c.index);let _=pr(c);if(this.isShapeOfType(c,Qt)&&this.isShapeOfType(_,Qt)){const S=this.getShapeUtil(Qt).getArrowInfo(c);let T,P;if(c.props.start.type==="binding"&&(T=s.get(c.props.start.boundShapeId),!T))if(S!=null&&S.isValid){const{x:$,y:L}=S.start.point;_.props.start={type:"point",x:$,y:L}}else{const{start:$}=Ei(this,c);_.props.start={type:"point",x:$.x,y:$.y}}if(c.props.end.type==="binding"&&(P=s.get(c.props.end.boundShapeId),!P))if(S!=null&&S.isValid){const{x:$,y:L}=S.end.point;_.props.end={type:"point",x:$,y:L}}else{const{end:$}=Ei(this,c);_.props.start={type:"point",x:$.x,y:$.y}}const I=Gu(_)?Gd(this,_):bb(this,_);if(S!=null&&S.isValid&&(I!=null&&I.isValid)&&!Gu(c)){const $=E.Med(S.start.handle,S.end.handle),L=E.Dist(S.middle,$),R=E.Dist(I.middle,$);_.props.bend<0?_.props.bend+=R-L:_.props.bend-=R-L}_.props.start.type==="binding"&&T&&(_.props.start.boundShapeId=T),_.props.end.type==="binding"&&P&&(_.props.end.boundShapeId=P)}return _={..._,id:u,x:c.x+d,y:c.y+h,index:w},_}));return a.forEach(l=>{Vr(l.parentId)&&s.has(l.parentId)&&(l.parentId=s.get(l.parentId))}),this.history.batch(()=>{const l=a.length+this.shapeIds.size>bo;l&&Xf(this);const c=l?a.slice(0,bo-this.shapeIds.size):a,u=c.map(d=>d.id);if(this.createShapes(c),this.setSelectedIds(u),n!==void 0){const{viewportPageBounds:d,selectedPageBounds:h}=this;h&&!d.contains(h)&&this.centerOnPoint(h.center.x,h.center.y,{duration:ko})}}),this}setOpacity(t,n=!1,r=!1){return this.history.batch(()=>{if(this.isIn("select")){const{pageState:{selectedIds:i}}=this,o=[],s=a=>{const l=this.getShapeById(a);if(l)if(this.isShapeOfType(l,dd)){const c=this.getSortedChildIds(a);for(const u of c)s(u)}else o.push(l)};if(i.length>0){for(const a of i)s(a);this.updateShapes(o.map(a=>({id:a.id,type:a.type,opacity:t})),n)}}this.updateInstanceState({opacityForNextShape:t},n,r)}),this}setProp(t,n,r=!1,i=!1){return this.history.batch(()=>{if(this.isIn("select")){const{pageState:{selectedIds:o}}=this;if(o.length>0){const s=[],a=l=>{const c=this.getShapeById(l);if(c)if(this.isShapeOfType(c,dd)){const u=this.getSortedChildIds(l);for(const d of u)a(d)}else c.props[t]!==void 0&&s.push(c)};for(const l of o)a(l);if(this.updateShapes(s.map(l=>{const c={...l.props,[t]:n};return t==="color"&&"labelColor"in c&&(c.labelColor="black"),{id:l.id,type:l.type,props:c}}),r),t!=="color"){const l=[];for(const c of s){const u=this.getShapeById(c.id);if(!u)continue;const d=this.getShapeUtil(u),h=d.bounds(c),f=d.bounds(u),p={id:c.id,type:c.type};let g=!1;if(h.width!==f.width)if(g=!0,this.isShapeOfType(c,cl))switch(c.props.align){case"middle":{p.x=u.x+(h.width-f.width)/2;break}case"end":{p.x=u.x+h.width-f.width;break}}else p.x=u.x+(h.width-f.width)/2;h.height!==f.height&&(g=!0,p.y=u.y+(h.height-f.height)/2),g&&l.push(p)}l.length&&this.updateShapes(l,r)}}}this.updateInstanceState({propsForNextShape:fJ(this.instanceState.propsForNextShape,{[t]:n})},r,i)}),this}_setCamera(t,n,r=this.camera.z){const i=this.camera;if(i.x===t&&i.y===n&&i.z===r)return this;const o={...i,x:t,y:n,z:r};return this.batch(()=>{this.store.put([o]);const{currentScreenPoint:s}=this.inputs;this.dispatch({type:"pointer",target:"canvas",name:"pointer_move",point:s,pointerId:0,ctrlKey:this.inputs.ctrlKey,altKey:this.inputs.altKey,shiftKey:this.inputs.shiftKey,button:0,isPen:this.isPenMode??!1}),this._cameraManager.tick()}),this}setCamera(t,n,r=this.camera.z,{stopFollowing:i=!0}={}){return this.stopCameraAnimation(),i&&this.instanceState.followingUserId&&this.stopFollowingUser(),t=Number.isNaN(t)?0:t,n=Number.isNaN(n)?0:n,r=Number.isNaN(r)?1:r,this._setCamera(t,n,r),this}animateCamera(t,n,r=this.camera.z,i=Bk){t=Number.isNaN(t)?0:t,n=Number.isNaN(n)?0:n,r=Number.isNaN(r)?1:r;const{width:o,height:s}=this.viewportScreenBounds,a=o/r,l=s/r,c=new me(-t,-n,a,l);return this.enableAnimations?this._animateToViewport(c,i):this.setCamera(t,n,this.viewportScreenBounds.width/a)}centerOnPoint(t,n,r){if(!this.canMoveCamera)return this;const{viewportPageBounds:{width:i,height:o},camera:s}=this;return r!=null&&r.duration?this.animateCamera(-(t-i/2),-(n-o/2),s.z,r):this.setCamera(-(t-i/2),-(n-o/2),s.z),this}zoomToContent(){const t=this.selectedPageBounds??this.allShapesCommonBounds;return t&&this.zoomToBounds(t.minX,t.minY,t.width,t.height,Math.min(1,this.zoomLevel),{duration:220}),this}zoomToFit(t){if(!this.canMoveCamera)return this;const n=[...this.shapeIds];if(n.length<=0)return this;const r=me.Common(Ae(n.map(i=>this.getPageBoundsById(i))));return this.zoomToBounds(r.minX,r.minY,r.width,r.height,void 0,t),this}resetZoom(t=this.viewportScreenCenter,n){if(!this.canMoveCamera)return this;const{x:r,y:i,z:o}=this.camera,{x:s,y:a}=t;return n!=null&&n.duration?this.animateCamera(r+(s/1-s)-(s/o-s),i+(a/1-a)-(a/o-a),1,n):this.setCamera(r+(s/1-s)-(s/o-s),i+(a/1-a)-(a/o-a),1),this}zoomIn(t=this.viewportScreenCenter,n){if(!this.canMoveCamera)return this;const{x:r,y:i,z:o}=this.camera;let s=Cs;for(let c=1;c<Tl.length;c++){const u=Tl[c-1],d=Tl[c];if(!(d-o<=(d-u)/2)){s=d;break}}const{x:a,y:l}=t;return n!=null&&n.duration?this.animateCamera(r+(a/s-a)-(a/o-a),i+(l/s-l)-(l/o-l),s,n):this.setCamera(r+(a/s-a)-(a/o-a),i+(l/s-l)-(l/o-l),s),this}zoomOut(t=this.viewportScreenCenter,n){if(!this.canMoveCamera)return this;const{x:r,y:i,z:o}=this.camera;let s=ku;for(let c=Tl.length-1;c>0;c--){const u=Tl[c-1],d=Tl[c];if(!(d-o>=(d-u)/2)){s=u;break}}const{x:a,y:l}=t;return n!=null&&n.duration?this.animateCamera(r+(a/s-a)-(a/o-a),i+(l/s-l)-(l/o-l),s,n):this.setCamera(r+(a/s-a)-(a/o-a),i+(l/s-l)-(l/o-l),s),this}zoomToSelection(t){if(!this.canMoveCamera)return this;const n=this.selectedIds;if(n.length<=0)return this;const r=me.Common(Ae(n.map(i=>this.getPageBoundsById(i))));return this.zoomToBounds(r.minX,r.minY,r.width,r.height,Math.max(1,this.camera.z),t),this}panZoomIntoView(t,n){if(!this.canMoveCamera)return this;if(t.length<=0)return this;const r=me.Common(Ae(t.map(o=>this.getPageBoundsById(o)))),{viewportPageBounds:i}=this;if(i.h<r.h||i.w<r.w)return this.zoomToBounds(r.minX,r.minY,r.width,r.height,this.camera.z,n),this;{const o=this._activeAreaManager.offsets.value,s=i.y+o.top,a=i.maxY-o.right,l=i.maxY-o.bottom,c=i.x+o.left,u=r.y,d=r.maxX,h=r.maxY,f=r.x;let p=0,g=0;l<h?g=l-h:s>u&&(g=s-u),a<d?p=a-d:c>f&&(p=c-f);const{camera:y}=this;n!=null&&n.duration?this.animateCamera(y.x+p,y.y+g,y.z,n):this.setCamera(y.x+p,y.y+g,y.z)}return this}zoomToBounds(t,n,r,i,o,s){if(!this.canMoveCamera)return this;const{viewportScreenBounds:a}=this,l=Math.min(256,a.width*.28);let c=Ci(Math.min((a.width-l)/r,(a.height-l)/i),ku,Cs);return o!==void 0&&(c=Math.min(o,c)),s!=null&&s.duration?this.animateCamera(-t+(a.width-r*c)/2/c,-n+(a.height-i*c)/2/c,c,s):this.setCamera(-t+(a.width-r*c)/2/c,-n+(a.height-i*c)/2/c,c),this}pan(t,n,r){if(!this.canMoveCamera)return this;const{camera:i}=this,{x:o,y:s,z:a}=i,l=new E(t,n).div(a);return(r==null?void 0:r.duration)??0>0?this.animateCamera(o+l.x,s+l.y,a,r):(this.setCamera(o+l.x,s+l.y,a),this)}stopCameraAnimation(){return this.emit("stop-camera-animation"),this}_animateViewport(t){if(!this._viewportAnimation)return;const n=()=>{this.removeListener("tick",this._animateViewport),this.removeListener("stop-camera-animation",n),this._viewportAnimation=null};this.once("stop-camera-animation",n),this._viewportAnimation.elapsed+=t;const{elapsed:r,easing:i,duration:o,start:s,end:a}=this._viewportAnimation;if(r>o){const w=this.viewportScreenBounds.width/a.width,_=-a.x,S=-a.y;this._setCamera(_,S,w),n();return}const l=o-r,c=i(1-l/o),u=s.minX+(a.minX-s.minX)*c,d=s.minY+(a.minY-s.minY)*c,h=s.maxX+(a.maxX-s.maxX)*c,f=s.maxY+(a.maxY-s.maxY)*c,p=new me(u,d,h-u,f-d),g=this.viewportScreenBounds.width/p.width,y=-p.x,x=-p.y;this._setCamera(y,x,g)}_animateToViewport(t,n={}){const{duration:r=0,easing:i=Bn.easeInOutCubic}=n,{animationSpeed:o,viewportPageBounds:s}=this;return this.stopCameraAnimation(),this.instanceState.followingUserId&&this.stopFollowingUser(),r===0||o===0?this._setCamera(-t.x,-t.y,this.viewportScreenBounds.width/t.width):(this._viewportAnimation={elapsed:0,duration:r/o,easing:i,start:s.clone(),end:t},this.addListener("tick",this._animateViewport),this)}slideCamera(t={}){if(!this.canMoveCamera)return this;this.stopCameraAnimation();const{animationSpeed:n}=this;if(n===0)return;const{speed:r,friction:i,direction:o,speedThreshold:s=.01}=t;let a=Math.min(r,1);const l=()=>{this.removeListener("tick",c),this.removeListener("stop-camera-animation",l)};this.once("stop-camera-animation",l);const c=u=>{const{x:d,y:h,z:f}=this.camera,p=o.clone().mul(a*u/f);a*=1-i,a<s?l():this._setCamera(d+p.x,h+p.y,f)};return this.addListener("tick",c),this}startFollowingUser(t){const n=this.store.query.records("instance_presence",()=>({userId:{eq:t}})),r=this.user.id;if(r||console.warn("You should set the userId for the current instance before following a user"),n.value.some(a=>a.followingUserId===r))return;Xr(()=>{this.stopFollowingUser(),this.updateInstanceState({followingUserId:t},!0)});const i=()=>{this.removeListener("frame",s),this.removeListener("stop-following",i)};let o=!1;const s=()=>{const a=[...n.value].sort((Q,j)=>Q.lastActivityTimestamp-j.lastActivityTimestamp).pop();if(!a){this.stopFollowingUser();return}const l=a.currentPageId===this.currentPageId,c=l?KY:1;l||this.setCurrentPageId(a.currentPageId,{stopFollowing:!1});const{center:u,width:d,height:h}=this.viewportPageBounds,f=me.From(a.screenBounds),p=f.width/a.camera.z,g=f.height/a.camera.z,y=new E(p/2-a.camera.x,g/2-a.camera.y),x=a.followingUserId===r,w=d+(p-d)*c,_=h+(g-h)*c,S=x?h/_:Math.min(d/w,h/_),T=Ci(this.camera.z*S,ku,Cs),P=this.viewportScreenBounds.w/T,I=this.viewportScreenBounds.h/T,$=y.sub(u),L=E.Add(u,E.Mul($,c)),R=E.Sub(L,u).len(),K=Math.abs(T-this.camera.z);if(R<VY&&K<qY){o=!0;return}o&&R<YY&&K<GY||(o=!1,this.stopCameraAnimation(),this.setCamera(-(L.x-P/2),-(L.y-I/2),T,{stopFollowing:!1}))};return this.once("stop-following",i),this.addListener("frame",s),this}stopFollowingUser(){return this.updateInstanceState({followingUserId:null},!0),this.emit("stop-following"),this}animateToShape(t,n=Bk){if(!this.canMoveCamera)return this;const r=m6(this),i=r.width/r.height,o=this.getPageBoundsById(t);if(!o)return this;const s=o.width/o.height,a=o.clone(),l=o.width/r.width;return a.width+=(r.left+r.right)*l,a.height+=(r.top+r.bottom)*l,a.x-=r.left*l,a.y-=r.top*l,s>i?(a.height=o.width/i,a.y-=(a.height-o.height)/2):(a.width=o.height*i,a.x-=(a.width-o.width)/2),this._animateToViewport(a,n)}blur(){return this.complete(),this.getContainer().blur(),this._isFocused.set(!1),this}focus(){return this.getContainer().focus(),this._isFocused.set(!0),this}cancel(){return this.dispatch({type:"misc",name:"cancel"}),this}interrupt(){return this.dispatch({type:"misc",name:"interrupt"}),this}complete(){return this.dispatch({type:"misc",name:"complete"}),this}async onCreateAssetFromFile(t){return await Iq(t)}async onCreateBookmarkFromUrl(t){var n,r,i;try{const s=await(await fetch(t,{method:"GET",mode:"no-cors"})).text(),a=new DOMParser().parseFromString(s,"text/html");return{image:((n=a.head.querySelector('meta[property="og:image"]'))==null?void 0:n.getAttribute("content"))??"",title:((r=a.head.querySelector('meta[property="og:title"]'))==null?void 0:r.getAttribute("content"))??"",description:((i=a.head.querySelector('meta[property="og:description"]'))==null?void 0:i.getAttribute("content"))??""}}catch(o){return console.error(o),{image:"",title:"",description:""}}}groupShapes(t=this.selectedIds,n=gt()){var d;if(this.isReadOnly)return this;if(t.length<=1)return this;const r=Ae(this._getUnlockedShapeIds(t).map(h=>this.getShapeById(h))),i=r.sort(ir).map(h=>h.id),o=me.Common(Ae(r.map(h=>this.getPageBounds(h)))),{x:s,y:a}=o.point,l=this.findCommonAncestor(r)??this.currentPageId;if(this.currentToolId!=="select")return this;this.isIn("select.idle")||this.cancel();const c=r.filter(h=>h.parentId===l).sort(ir),u=(d=c[c.length-1])==null?void 0:d.index;return this.batch(()=>{this.createShapes([{id:n,type:"group",parentId:l,index:u,x:s,y:a,opacity:1,props:{}}]),this.reparentShapesById(i,n),this.select(n)}),this}ungroupShapes(t=this.selectedIds){if(this.isReadOnly)return this;if(t.length===0)return this;if(this.currentToolId!=="select")return this;this.isIn("select.idle")||this.cancel();const n=new Set,r=Ae(t.map(o=>this.getShapeById(o))),i=[];return r.forEach(o=>{this.isShapeOfType(o,dd)?i.push(o):n.add(o.id)}),i.length===0?this:(this.batch(()=>{let o;for(let s=0,a=i.length;s<a;s++){o=i[s];const l=this.getSortedChildIds(o.id);for(let c=0,u=l.length;c<u;c++)n.add(l[c]);this.reparentShapesById(l,o.parentId,o.index)}this.deleteShapes(i.map(s=>s.id)),this.select(...n)}),this)}},v(J1,"styles",Tu),J1);let Oe=F6;Re([ce],Oe.prototype,"openMenus",1);Re([ce],Oe.prototype,"isMenuOpen",1);Re([ce],Oe.prototype,"_pageTransformCache",1);Re([ce],Oe.prototype,"_pageBoundsCache",1);Re([ce],Oe.prototype,"_pageMaskCache",1);Re([ce],Oe.prototype,"_clipPathCache",1);Re([ce],Oe.prototype,"canUndo",1);Re([ce],Oe.prototype,"canRedo",1);Re([ce],Oe.prototype,"erasingIds",1);Re([ce],Oe.prototype,"hintingIds",1);Re([ce],Oe.prototype,"erasingIdsSet",1);Re([ce],Oe.prototype,"props",1);Re([ce],Oe.prototype,"opacity",1);Re([ce],Oe.prototype,"_arrowBindingsIndex",1);Re([ce],Oe.prototype,"_allPageStates",1);Re([ce],Oe.prototype,"documentSettings",1);Re([ce],Oe.prototype,"pageStateId",1);Re([ce],Oe.prototype,"pageState",1);Re([ce],Oe.prototype,"cameraId",1);Re([ce],Oe.prototype,"camera",1);Re([ce],Oe.prototype,"zoomLevel",1);Re([ce],Oe.prototype,"selectedIds",1);Re([ce],Oe.prototype,"selectedIdsSet",1);Re([ce],Oe.prototype,"_pages",1);Re([ce],Oe.prototype,"pages",1);Re([ce],Oe.prototype,"_pageStates",1);Re([ce],Oe.prototype,"renderingShapes",1);Re([ce],Oe.prototype,"allShapesCommonBounds",1);Re([ce],Oe.prototype,"viewportScreenBounds",1);Re([ce],Oe.prototype,"viewportScreenCenter",1);Re([ce],Oe.prototype,"viewportPageBounds",1);Re([ce],Oe.prototype,"cullingBounds",1);Re([ce],Oe.prototype,"cullingBoundsExpanded",1);Re([ce],Oe.prototype,"viewportPageCenter",1);Re([ce],Oe.prototype,"editingShape",1);Re([ce],Oe.prototype,"selectedPageBounds",1);Re([ce],Oe.prototype,"selectionRotation",1);Re([ce],Oe.prototype,"selectionBounds",1);Re([ce],Oe.prototype,"selectionPageCenter",1);Re([ce],Oe.prototype,"shapesArray",1);Re([ce],Oe.prototype,"sortedShapesArray",1);Re([ce],Oe.prototype,"selectedShapes",1);Re([ce],Oe.prototype,"onlySelectedShape",1);Re([ce],Oe.prototype,"_assets",1);Re([ce],Oe.prototype,"hoveredId",1);Re([ce],Oe.prototype,"hoveredShape",1);function Xf(e,t=e.currentPageId){const n=e.getPageById(t).name;e.emit("max-shapes",{name:n,pageId:t,count:bo})}function jJ(){const e=re(),t=tr(),n=ye("isDarkMode",()=>e.isDarkMode,[e]),r=ye(nn.forceSrgb);ke.useEffect(()=>{n?(t.setAttribute("data-color-mode","dark"),t.classList.remove("tl-theme__light"),t.classList.add("tl-theme__dark"),e.setCursor({color:"white"})):(t.setAttribute("data-color-mode","light"),t.classList.remove("tl-theme__dark"),t.classList.add("tl-theme__light"),e.setCursor({color:"black"})),r?t.classList.add("tl-theme__force-sRGB"):t.classList.remove("tl-theme__force-sRGB")},[e,t,r,n])}function zJ(e){const t=b.useRef();return b.useLayoutEffect(()=>{t.current=e}),b.useDebugValue(e),b.useCallback((...n)=>{const r=t.current;return _M(r,"fn does not exist"),r(...n)},[])}function UJ(){const[e,t]=b.useState(0);b.useEffect(()=>t(n=>n+1),[])}const yc="TLDRAW_TAB_ID_v2",mn=globalThis.window;function WJ(){return mn?["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(mn.navigator.platform)||mn.navigator.userAgent.includes("Mac")&&"ontouchend"in document:!1}const hm=(mn==null?void 0:mn[yc])??(mn==null?void 0:mn.sessionStorage[yc])??"TLDRAW_INSTANCE_STATE_V1_"+At();mn&&(mn[yc]=hm,WJ()?mn.sessionStorage[yc]=hm:delete mn.sessionStorage[yc]);mn==null||mn.addEventListener("beforeunload",()=>{mn.sessionStorage[yc]=hm});const HJ={Initial:0},Xd=HJ.Initial,N6=Ne({version:Be,currentPageId:Fd,isFocusMode:ot,exportBackground:ot,isDebugMode:ot,isToolLocked:ot,isGridMode:ot,pageStates:Zi(Ne({pageId:Fd,camera:Ne({x:Be,y:Be,z:Be}),selectedIds:Zi(bi),focusLayerId:bi.nullable()}))}),KJ=Qe({currentVersion:Xd});function VJ(e){if(!e||typeof e!="object")return console.warn("Invalid instance state"),null;if(!("version"in e)||typeof e.version!="number")return console.warn("No version in instance state"),null;const t=DS({value:e,fromVersion:e.version,toVersion:Xd,migrations:KJ});if(t.type==="error")return console.warn(t.reason),null;const n={...t.value,version:Xd};try{N6.validate(n)}catch(r){return console.warn(r),null}return n}function YJ(e){const t=e.query.ids("page");return ce("sessionStateSnapshot",()=>{const n=e.get(ar);if(!n)return null;const r=[...t.value];return{version:Xd,currentPageId:n.currentPageId,exportBackground:n.exportBackground,isFocusMode:n.isFocusMode,isDebugMode:n.isDebugMode,isToolLocked:n.isToolLocked,isGridMode:n.isGridMode,pageStates:r.map(i=>{const o=e.get(An.createId(i)),s=e.get($n.createId(i));return{pageId:i,camera:{x:(s==null?void 0:s.x)??0,y:(s==null?void 0:s.y)??0,z:(s==null?void 0:s.z)??1},selectedIds:(o==null?void 0:o.selectedIds)??[],focusLayerId:(o==null?void 0:o.focusLayerId)??null}})}})}function qJ(e,t){const n=VJ(t);if(!n)return;const r=e.allRecords().filter(s=>s.typeName==="instance_page_state"||s.typeName==="camera"),i={added:{},updated:{},removed:{...EM(r.map(s=>[s.id,s]))}};e.has(ar)&&(i.removed[ar]=e.get(ar));const o={removed:{},updated:{},added:{[ar]:by.create({id:ar,currentPageId:n.currentPageId,isDebugMode:n.isDebugMode,isFocusMode:n.isFocusMode,isToolLocked:n.isToolLocked,isGridMode:n.isGridMode,exportBackground:n.exportBackground})}};for(const s of n.pageStates){const a=$n.createId(s.pageId),l=An.createId(s.pageId);o.added[a]=$n.create({id:$n.createId(s.pageId),x:s.camera.x,y:s.camera.y,z:s.camera.z}),o.added[l]=An.create({id:An.createId(s.pageId),pageId:s.pageId,selectedIds:s.selectedIds,focusLayerId:s.focusLayerId})}Xr(()=>{e.applyDiff(yy([i,o])),e.ensureStoreIsUsable()})}function GJ(e){var i;const t=[];for(const o of Object.values(e))(i=o.typeName)!=null&&i.match(/^(instance.*|pointer|camera)$/)&&t.push(o);const n=t.filter(o=>o.typeName==="instance"&&o.id!==ar)[0];if(!n)return null;const r={version:Xd,currentPageId:n.currentPageId,exportBackground:!!n.exportBackground,isFocusMode:!!n.isFocusMode,isDebugMode:!!n.isDebugMode,isToolLocked:!!n.isToolLocked,isGridMode:!1,pageStates:t.filter(o=>o.typeName==="instance_page_state"&&o.instanceId===n.id).map(o=>{const s=e[o.cameraId]??{x:0,y:0,z:1};return{pageId:o.pageId,camera:{x:s.x,y:s.y,z:s.z},selectedIds:o.selectedIds,focusLayerId:o.focusLayerId}})};try{return N6.validate(r),r}catch{return null}}function XJ(){window.alert(`Oops! We could not save changes to your browser's storage. We now need to reload the page and try again.

Keep seeing this message?
• If you're using tldraw in a private or "incognito" window, try loading tldraw in a regular window or in a different browser.
• If your hard disk is full, try clearing up some space and then reload the page.`)}function ZJ(){window.alert(`Oops! We could not access your browser's storage—and the app won't work correctly without that. We now need to reload the page and try again.

Keep seeing this message?
• If you're using tldraw in a private or "incognito" window, try loading tldraw in a regular window or in a different browser.`)}const QJ=(e,t)=>t.some(n=>e instanceof n);let DT,FT;function JJ(){return DT||(DT=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function eee(){return FT||(FT=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const j6=new WeakMap,Sb=new WeakMap,z6=new WeakMap,Uv=new WeakMap,E_=new WeakMap;function tee(e){const t=new Promise((n,r)=>{const i=()=>{e.removeEventListener("success",o),e.removeEventListener("error",s)},o=()=>{n(Oo(e.result)),i()},s=()=>{r(e.error),i()};e.addEventListener("success",o),e.addEventListener("error",s)});return t.then(n=>{n instanceof IDBCursor&&j6.set(n,e)}).catch(()=>{}),E_.set(t,e),t}function nee(e){if(Sb.has(e))return;const t=new Promise((n,r)=>{const i=()=>{e.removeEventListener("complete",o),e.removeEventListener("error",s),e.removeEventListener("abort",s)},o=()=>{n(),i()},s=()=>{r(e.error||new DOMException("AbortError","AbortError")),i()};e.addEventListener("complete",o),e.addEventListener("error",s),e.addEventListener("abort",s)});Sb.set(e,t)}let _b={get(e,t,n){if(e instanceof IDBTransaction){if(t==="done")return Sb.get(e);if(t==="objectStoreNames")return e.objectStoreNames||z6.get(e);if(t==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Oo(e[t])},set(e,t,n){return e[t]=n,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function ree(e){_b=e(_b)}function iee(e){return e===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...n){const r=e.call(Wv(this),t,...n);return z6.set(r,t.sort?t.sort():[t]),Oo(r)}:eee().includes(e)?function(...t){return e.apply(Wv(this),t),Oo(j6.get(this))}:function(...t){return Oo(e.apply(Wv(this),t))}}function oee(e){return typeof e=="function"?iee(e):(e instanceof IDBTransaction&&nee(e),QJ(e,JJ())?new Proxy(e,_b):e)}function Oo(e){if(e instanceof IDBRequest)return tee(e);if(Uv.has(e))return Uv.get(e);const t=oee(e);return t!==e&&(Uv.set(e,t),E_.set(t,e)),t}const Wv=e=>E_.get(e);function see(e,t,{blocked:n,upgrade:r,blocking:i,terminated:o}={}){const s=indexedDB.open(e,t),a=Oo(s);return r&&s.addEventListener("upgradeneeded",l=>{r(Oo(s.result),l.oldVersion,l.newVersion,Oo(s.transaction),l)}),n&&s.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{o&&l.addEventListener("close",()=>o()),i&&l.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}function aee(e,{blocked:t}={}){const n=indexedDB.deleteDatabase(e);return t&&n.addEventListener("blocked",r=>t(r.oldVersion,r)),Oo(n).then(()=>{})}const lee=["get","getKey","getAll","getAllKeys","count"],cee=["put","add","delete","clear"],Hv=new Map;function NT(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(Hv.get(t))return Hv.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=cee.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||lee.includes(n)))return;const o=async function(s,...a){const l=this.transaction(s,i?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[n](...a),i&&l.done]))[0]};return Hv.set(t,o),o}ree(e=>({...e,get:(t,n,r)=>NT(t,n)||e.get(t,n,r),has:(t,n)=>!!NT(t,n)||e.has(t,n)}));const Ay="TLDRAW_DOCUMENT_v2",U6="TLDRAW_DB_NAME_INDEX_v2",nt={Records:"records",Schema:"schema",SessionState:"session_state"};async function My(e,t){pee(e);const n=await see(e,3,{upgrade(r){r.objectStoreNames.contains(nt.Records)||r.createObjectStore(nt.Records),r.objectStoreNames.contains(nt.Schema)||r.createObjectStore(nt.Schema),r.objectStoreNames.contains(nt.SessionState)||r.createObjectStore(nt.SessionState)}});try{return await t(n)}finally{n.close()}}async function uee({persistenceKey:e,sessionId:t,didCancel:n}){const r=Ay+e;if(k_().includes(r))return await fee({persistenceKey:e,didCancel:n}),await My(r,async i=>{var d,h;if(n!=null&&n())return;const o=i.transaction([nt.Records,nt.Schema,nt.SessionState],"readonly"),s=o.objectStore(nt.Records),a=o.objectStore(nt.Schema),l=o.objectStore(nt.SessionState);let c=t?(d=await l.get(t))==null?void 0:d.snapshot:null;c||(c=(h=(await l.getAll()).sort((p,g)=>p.updatedAt-g.updatedAt).pop())==null?void 0:h.snapshot);const u={records:await s.getAll(),schema:await a.get(nt.Schema),sessionStateSnapshot:c};if(n!=null&&n()){o.abort();return}return await o.done,u})}async function dee({persistenceKey:e,schema:t,changes:n,sessionId:r,sessionStateSnapshot:i,didCancel:o}){const s=Ay+e;await My(s,async a=>{const l=a.transaction([nt.Records,nt.Schema,nt.SessionState],"readwrite"),c=l.objectStore(nt.Records),u=l.objectStore(nt.Schema),d=l.objectStore(nt.SessionState);for(const[h,f]of Object.entries(n.added))await c.put(f,h);for(const[h,f]of Object.values(n.updated))await c.put(f,f.id);for(const h of Object.keys(n.removed))await c.delete(h);if(u.put(t.serialize(),nt.Schema),i&&r?d.put({snapshot:i,updatedAt:Date.now(),id:r},r):(i||r)&&console.error("sessionStateSnapshot and instanceId must be provided together"),o!=null&&o())return l.abort();await l.done})}async function hee({persistenceKey:e,schema:t,snapshot:n,sessionId:r,sessionStateSnapshot:i,didCancel:o}){const s=Ay+e;await My(s,async a=>{const l=a.transaction([nt.Records,nt.Schema,nt.SessionState],"readwrite"),c=l.objectStore(nt.Records),u=l.objectStore(nt.Schema),d=l.objectStore(nt.SessionState);await c.clear();for(const[h,f]of Object.entries(n))await c.put(f,h);if(u.put(t.serialize(),nt.Schema),i&&r?d.put({snapshot:i,updatedAt:Date.now(),id:r},r):(i||r)&&console.error("sessionStateSnapshot and instanceId must be provided together"),o!=null&&o())return l.abort();await l.done})}async function fee({persistenceKey:e,didCancel:t}){await My(Ay+e,async n=>{const r=n.transaction([nt.SessionState],"readwrite"),i=r.objectStore(nt.SessionState),o=(await i.getAll()).sort((a,l)=>a.updatedAt-l.updatedAt);if(o.length<10){await r.done;return}const s=o.slice(0,o.length-10);for(const{id:a}of s)await i.delete(a);if(t!=null&&t())return r.abort();await r.done})}function k_(){const e=JSON.parse((window==null?void 0:window.localStorage.getItem(U6))||"[]")??[];return Array.isArray(e)?e:[]}function pee(e){const t=new Set(k_());t.add(e),window==null||window.localStorage.setItem(U6,JSON.stringify([...t]))}const gee=350,mee=1e4,jT=Symbol("UPDATE_INSTANCE_STATE"),yee=e=>e;class vee{constructor(t){v(this,"onmessage")}postMessage(t){}close(){}}const xee=typeof BroadcastChannel>"u"?vee:BroadcastChannel;class bee{constructor(t,{persistenceKey:n,sessionId:r=hm,onLoad:i,onLoadError:o},s=new xee(`tldraw-tab-sync-${n}`)){v(this,"disposables",new Set);v(this,"diffQueue",[]);v(this,"didDispose",!1);v(this,"shouldDoFullDBWrite",!0);v(this,"isReloading",!1);v(this,"persistenceKey");v(this,"sessionId");v(this,"serializedSchema");v(this,"isDebugging",!1);v(this,"documentTypes");v(this,"$sessionStateSnapshot");v(this,"initTime",Date.now());v(this,"isPersisting",!1);v(this,"didLastWriteError",!1);v(this,"scheduledPersistTimeout",null);this.store=t,this.channel=s,typeof window<"u"&&(window.tlsync=this),this.persistenceKey=n,this.sessionId=r,this.serializedSchema=this.store.schema.serialize(),this.$sessionStateSnapshot=YJ(this.store),this.disposables.add(t.listen(({changes:a})=>{this.diffQueue.push(a),this.channel.postMessage(yee({type:"diff",storeId:this.store.id,changes:a,schema:this.serializedSchema})),this.schedulePersist()},{source:"user",scope:"document"})),this.disposables.add(t.listen(()=>{this.diffQueue.push(jT),this.schedulePersist()},{scope:"session"})),this.connect(i,o),this.documentTypes=new Set(Object.values(this.store.schema.types).filter(a=>a.scope==="document").map(a=>a.typeName))}debug(...t){this.isDebugging&&console.debug(...t)}async connect(t,n){this.debug("connecting");let r;try{r=await uee({persistenceKey:this.persistenceKey,sessionId:this.sessionId,didCancel:()=>this.didDispose})}catch(i){n(i),ZJ(),typeof window<"u"&&window.location.reload();return}if(this.debug("loaded data from store",r,"didDispose",this.didDispose),!this.didDispose)try{if(r){const i=Object.fromEntries(r.records.map(a=>[a.id,a])),o=r.sessionStateSnapshot??GJ(i),s=this.store.schema.migrateStoreSnapshot(i,r.schema??this.store.schema.serializeEarliestVersion());if(s.type==="error"){console.error("failed to migrate store",s),n(new Error(`Failed to migrate store: ${s.reason}`));return}this.store.mergeRemoteChanges(()=>{this.store.put(Object.values(s.value).filter(a=>this.documentTypes.has(a.typeName)),"initialize")}),o&&qJ(this.store,o)}this.channel.onmessage=({data:i})=>{var a,l;this.debug("got message",i);const o=i,s=VH(this.serializedSchema,o.schema??this.store.schema.serializeEarliestVersion());if(s===-1){if(Date.now()-this.initTime<5e3){n(new Error("Schema mismatch, please close other tabs and reload the page"));return}this.debug("reloading"),this.isReloading=!0,(l=(a=window==null?void 0:window.location)==null?void 0:a.reload)==null||l.call(a);return}else if(s===1){this.debug("telling them to reload"),this.channel.postMessage({type:"announce",schema:this.serializedSchema}),this.shouldDoFullDBWrite=!0,this.persistIfNeeded();return}o.type==="diff"&&(this.debug("applying diff"),Xr(()=>{this.store.mergeRemoteChanges(()=>{this.store.applyDiff(o.changes),this.store.ensureStoreIsUsable()})}))},this.channel.postMessage({type:"announce",schema:this.serializedSchema}),this.disposables.add(()=>{this.channel.close()}),t(this)}catch(i){if(this.debug("error loading data from store",i),this.didDispose)return;n(i);return}}close(){this.debug("closing"),this.didDispose=!0,this.disposables.forEach(t=>t())}schedulePersist(){this.debug("schedulePersist",this.scheduledPersistTimeout),!this.scheduledPersistTimeout&&(this.scheduledPersistTimeout=setTimeout(()=>{this.scheduledPersistTimeout=null,this.persistIfNeeded()},this.didLastWriteError?mee:gee))}persistIfNeeded(){this.debug("persistIfNeeded",{isPersisting:this.isPersisting,isReloading:this.isReloading,shouldDoFullDBWrite:this.shouldDoFullDBWrite,diffQueueLength:this.diffQueue.length,storeIsPossiblyCorrupt:this.store.isPossiblyCorrupted()}),this.scheduledPersistTimeout&&(clearTimeout(this.scheduledPersistTimeout),this.scheduledPersistTimeout=null),!this.isPersisting&&(this.isReloading||this.store.isPossiblyCorrupted()||(this.shouldDoFullDBWrite||this.diffQueue.length>0)&&this.doPersist())}async doPersist(){_M(!this.isPersisting,"persist already in progress"),this.isPersisting=!0,this.debug("doPersist start");const t=this.diffQueue;this.diffQueue=[];try{if(this.shouldDoFullDBWrite)this.shouldDoFullDBWrite=!1,await hee({persistenceKey:this.persistenceKey,schema:this.store.schema,snapshot:this.store.serialize(),didCancel:()=>this.didDispose,sessionId:this.sessionId,sessionStateSnapshot:this.$sessionStateSnapshot.value});else{const n=yy(t.filter(r=>r!==jT));await dee({persistenceKey:this.persistenceKey,changes:n,schema:this.store.schema,didCancel:()=>this.didDispose,sessionId:this.sessionId,sessionStateSnapshot:this.$sessionStateSnapshot.value})}this.didLastWriteError=!1}catch(n){this.shouldDoFullDBWrite=!0,this.didLastWriteError=!0,console.error("failed to store changes in indexed db",n),XJ(),typeof window<"u"&&window.location.reload()}this.isPersisting=!1,this.debug("doPersist end"),this.schedulePersist()}}function Cb(e={}){const{customShapes:t={},initialData:n,defaultName:r=""}=e;return new BM({schema:xV({customShapes:t}),initialData:n,props:{defaultName:r}})}function wee(e){const t=b.useRef(e);return b.useEffect(()=>{t.current=e}),t.current}function See(e){const[t,n]=b.useState(()=>Cb(e)),r=wee(e);if(Object.keys(r).some(i=>r[i]!==e[i])){const i=Cb(e);return n(i),i}return t}function _ee(e={}){const{persistenceKey:t,sessionId:n,...r}=e,[i,o]=b.useState(null),s=See(r);return b.useEffect(()=>{const a=At();if(!t){o({id:a,storeWithStatus:{status:"not-synced",store:s}});return}o({id:a,storeWithStatus:{status:"loading"}});const l=u=>{o(d=>(d==null?void 0:d.id)===a?{id:a,storeWithStatus:u}:d)},c=new bee(s,{sessionId:n,persistenceKey:t,onLoad(){l({store:s,status:"synced-local"})},onLoadError(u){l({status:"error",error:u})}});return()=>{o(u=>(u==null?void 0:u.id)===a?null:u),c.close()}},[t,s,n]),(i==null?void 0:i.storeWithStatus)??{status:"loading"}}const Zf=(e,t)=>{const[n,r]=b.useState(2);return b.useEffect(()=>{const{url:i,style:o="normal",weight:s="500",display:a,featureSettings:l,stretch:c,unicodeRange:u,variant:d}=t;let h=!1;r(2);const f={style:o,weight:s,display:a,featureSettings:l,stretch:c,unicodeRange:u,variant:d},p=new FontFace(e,`url(${i})`,f);return p.load().then(()=>{h||(document.fonts.add(p),r(0))}).catch(g=>{h||(console.error(g),r(1))}),p.$$_url=i,p.$$_fontface=`
@font-face {
	font-family: ${p.family};
	font-stretch: ${p.stretch};
	font-weight: ${p.weight};
	font-style: ${p.style};
	src: url("${i}") format("woff2")
}`,()=>{document.fonts.delete(p),h=!0}},[e,t]),n};function Cee(e){return{draw:{url:e.fonts.draw},serif:{url:e.fonts.serif},sansSerif:{url:e.fonts.sansSerif},monospace:{url:e.fonts.monospace}}}function Eee(e){const t=b.useMemo(()=>Cee(e),[e]),n=[Zf("tldraw_draw",t.draw),Zf("tldraw_serif",t.serif),Zf("tldraw_sans",t.sansSerif),Zf("tldraw_mono",t.monospace)];return{error:n.some(r=>r===1),done:!n.some(r=>r===2)}}let W6=!1;if(typeof window<"u"){const e=window.navigator.userAgent,t=!!e.match(/iPad/i)||!!e.match(/iPhone/i),n=!!e.match(/WebKit/i);W6=t&&n&&!e.match(/CriOS/i)}function kee(){const e=re();b.useEffect(()=>{if(!W6)return;function t(n){(n.target instanceof HTMLInputElement&&n.target.type==="text"||n.target instanceof HTMLTextAreaElement)&&e.complete()}return document.addEventListener("focusout",t),()=>document.removeEventListener("focusout",t)},[e])}function Tee(){const e=re(),t=tr();b.useEffect(()=>{const n=o=>t.style.setProperty("--tl-zoom",o.toString()),r=CM(n,100),i=new Ah("useZoomCss",()=>{e.shapeIds.size<300?n(e.zoomLevel):r(e.zoomLevel)});return i.attach(),i.execute(),()=>{i.detach()}},[e,t])}const Pee=b.memo(function(t){var a,l;const[n,r]=ke.useState(null),i=((a=t.components)==null?void 0:a.ErrorFallback)===void 0?R5:(l=t.components)==null?void 0:l.ErrorFallback,{store:o,...s}=t;return m.jsx("div",{ref:r,draggable:!1,className:"tl-container tl-theme__light",tabIndex:0,children:m.jsx(qd,{fallback:i?c=>m.jsx(i,{error:c}):null,onError:c=>MS(c,{tags:{origin:"react.tldraw-before-app"}}),children:n&&m.jsx(Uq,{container:n,children:m.jsx(aG,{overrides:t.components,children:o?o instanceof BM?m.jsx(K6,{...s,store:o}):m.jsx(H6,{...s,store:o}):m.jsx(Iee,{...s,store:o})})})})})});function Iee(e){const{defaultName:t,initialData:n,shapes:r,persistenceKey:i,sessionId:o}=e,s=_ee({customShapes:r,initialData:n,persistenceKey:i,sessionId:o,defaultName:t});return m.jsx(H6,{...e,store:s})}const H6=b.memo(function({store:t,assetUrls:n,...r}){const{done:i,error:o}=Eee(n??GM);switch(t.status){case"error":throw t.error;case"loading":return m.jsx(zT,{children:"Connecting..."})}return o?m.jsx(Mee,{children:"Could not load assets. Please refresh the page."}):i?m.jsx(K6,{...r,store:t.store}):m.jsx(zT,{children:"Loading assets..."})});function K6({onMount:e,children:t,onCreateAssetFromFile:n,onCreateBookmarkFromUrl:r,store:i,tools:o,shapes:s,autoFocus:a}){const{ErrorFallback:l}=di(),c=tr(),[u,d]=b.useState(null);b.useLayoutEffect(()=>{const p=new Oe({store:i,shapes:s,tools:o,getContainer:()=>c});return window.app=p,window.editor=p,d(p),()=>{p.dispose()}},[c,s,o,i]),ke.useEffect(()=>{u&&(n&&(u.onCreateAssetFromFile=n),r&&(u.onCreateBookmarkFromUrl=r))},[u,n,r]),ke.useLayoutEffect(()=>{u&&a&&u.focus()},[u,a]);const h=zJ(p=>{e==null||e(p),p.emit("mount"),window.tldrawReady=!0});ke.useEffect(()=>{u&&h(u)},[u,h]);const f=b.useSyncExternalStore(b.useCallback(p=>u?(u.on("crash",p),()=>u.off("crash",p)):()=>{},[u]),()=>(u==null?void 0:u.crashingError)??null);return u?m.jsx(qd,{fallback:l?p=>m.jsx(l,{error:p,editor:u}):null,onError:p=>u.annotateError(p,{origin:"react.tldraw",willCrashApp:!0}),children:f?m.jsx(Aee,{crashingError:f}):m.jsx(YS.Provider,{value:u,children:m.jsx($ee,{children:t})})}):null}function $ee({children:e}){return Tee(),ZX(),jJ(),kee(),UJ(),e}function Aee({crashingError:e}){throw e}function zT({children:e}){const{Spinner:t}=di();return m.jsxs("div",{className:"tl-loading",children:[t?m.jsx(t,{}):null,e]})}function Mee({children:e}){return m.jsx("div",{className:"tl-loading",children:e})}/*!
 * canvas-size
 * v1.2.6
 * https://github.com/jhildenbiddle/canvas-size
 * (c) 2015-2023 John Hildenbiddle <http://hildenbiddle.com>
 * MIT license
 */function Oee(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,i,o,s,a=[],l=!0,c=!1;try{if(o=(n=n.call(e)).next,t===0){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(a.push(r.value),a.length!==t);l=!0);}catch(u){c=!0,i=u}finally{try{if(!l&&n.return!=null&&(s=n.return(),Object(s)!==s))return}finally{if(c)throw i}}return a}}function UT(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function Cr(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?UT(Object(n),!0).forEach(function(r){Lee(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):UT(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Lee(e,t,n){return t=Wee(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Bee(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,o;for(o=0;o<r.length;o++)i=r[o],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function Ree(e,t){if(e==null)return{};var n=Bee(e,t),r,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)r=o[i],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function WT(e,t){return Fee(e)||Oee(e,t)||V6(e,t)||zee()}function Qf(e){return Dee(e)||Nee(e)||V6(e)||jee()}function Dee(e){if(Array.isArray(e))return Eb(e)}function Fee(e){if(Array.isArray(e))return e}function Nee(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function V6(e,t){if(e){if(typeof e=="string")return Eb(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Eb(e,t)}}function Eb(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function jee(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zee(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Uee(e,t){if(typeof e!="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Wee(e){var t=Uee(e,"string");return typeof t=="symbol"?t:String(t)}function hd(e){var t=e.sizes.shift(),n=Math.max(Math.ceil(t[0]),1),r=Math.max(Math.ceil(t[1]),1),i=[n-1,r-1,1,1],o=Date.now(),s=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,a,l;s?(a=new OffscreenCanvas(1,1),l=new OffscreenCanvas(n,r)):(a=document.createElement("canvas"),a.width=1,a.height=1,l=document.createElement("canvas"),l.width=n,l.height=r);var c=a.getContext("2d"),u=l.getContext("2d");u&&(u.fillRect.apply(u,i),c.drawImage(l,n-1,r-1,1,1,0,0,1,1));var d=c&&c.getImageData(0,0,1,1).data[3]!==0,h=Date.now()-o;return[a,l].forEach(function(f){f.height=0,f.width=0}),s?(postMessage({width:n,height:r,benchmark:h,isTestPass:d}),!d&&e.sizes.length&&hd(e)):d?e.onSuccess(n,r,h):(e.onError(n,r,h),e.sizes.length&&hd(e)),d}var Kv={area:[16384,14188,11402,11180,10836,8192,4096,1],height:[8388607,65535,32767,16384,8192,4096,1],width:[4194303,65535,32767,16384,8192,4096,1]},Hee=["onError","onSuccess"],rc={max:null,min:1,sizes:[],step:1024,usePromise:!1,useWorker:!1,onError:Function.prototype,onSuccess:Function.prototype},Mu={};function Vv(e){var t=e.width===e.height,n=e.height===1,r=e.width===1,i=[];if(!e.width||!e.height)e.sizes.forEach(function(u){var d=t||n?u:1,h=t||r?u:1;i.push([d,h])});else for(var o=e.min||rc.min,s=e.step||rc.step,a=Math.max(e.width,e.height);a>=o;){var l=t||n?a:1,c=t||r?a:1;i.push([l,c]),a-=s}return i}function Jf(e){var t=window&&"HTMLCanvasElement"in window,n=window&&"OffscreenCanvas"in window,r=Date.now(),i=e.onError,o=e.onSuccess,s=Ree(e,Hee),a=null;if(!t)return!1;if(e.useWorker&&n){var l=`
            var canvasTest = `.concat(hd.toString(),`;
            onmessage = function(e) {
                canvasTest(e.data);
            };
        `),c=new Blob([l],{type:"application/javascript"}),u=URL.createObjectURL(c);a=new Worker(u),URL.revokeObjectURL(u),a.onmessage=function(d){var h=d.data,f=h.width,p=h.height,g=h.benchmark,y=h.isTestPass;y?(Mu[r].onSuccess(f,p,g),delete Mu[r]):Mu[r].onError(f,p,g)}}if(e.usePromise)return new Promise(function(d,h){var f=Cr(Cr({},e),{},{onError:function(x,w,_){var S;if(e.sizes.length===0)S=!0;else{var T=e.sizes.slice(-1),P=WT(T,1),I=WT(P[0],2),$=I[0],L=I[1];S=x===$&&w===L}i(x,w,_),S&&h({width:x,height:w,benchmark:_})},onSuccess:function(x,w,_){o(x,w,_),d({width:x,height:w,benchmark:_})}});if(a){var p=f.onError,g=f.onSuccess;Mu[r]={onError:p,onSuccess:g},a.postMessage(s)}else hd(f)});if(a)Mu[r]={onError:i,onSuccess:o},a.postMessage(s);else return hd(e)}var Yv={maxArea:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=Vv({width:t.max,height:t.max,min:t.min,step:t.step,sizes:Qf(Kv.area)}),r=Cr(Cr(Cr({},rc),t),{},{sizes:n});return Jf(r)},maxHeight:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=Vv({width:1,height:t.max,min:t.min,step:t.step,sizes:Qf(Kv.height)}),r=Cr(Cr(Cr({},rc),t),{},{sizes:n});return Jf(r)},maxWidth:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=Vv({width:t.max,height:1,min:t.min,step:t.step,sizes:Qf(Kv.width)}),r=Cr(Cr(Cr({},rc),t),{},{sizes:n});return Jf(r)},test:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=Cr(Cr({},rc),t);return n.sizes=Qf(n.sizes),n.width&&n.height&&(n.sizes=[[n.width,n.height]]),Jf(n)}};let qv=null;function Kee(){return qv||(qv=Vee()),qv}async function Vee(){const e=await Yv.maxWidth({usePromise:!0}),t=await Yv.maxHeight({usePromise:!0}),n=await Yv.maxArea({usePromise:!0});return{maxWidth:e.width,maxHeight:t.height,maxArea:n.width*n.height}}function Y6(e){const t=e.cloneNode(!0);return e.setAttribute("width",+e.getAttribute("width")+""),e.setAttribute("height",+e.getAttribute("height")+""),new XMLSerializer().serializeToString(t).replaceAll("&#10;      ","").replaceAll(/((\s|")[0-9]*\.[0-9]{2})([0-9]*)(\b|"|\))/g,"$1")}async function q6(e,t){const{type:n,quality:r,scale:i}=t,o=+e.getAttribute("width"),s=+e.getAttribute("height");let a=o*i,l=s*i;const c=await G6(e),u=await Kee();if(o>u.maxWidth&&(a=u.maxWidth,l=a/o*s),s>u.maxHeight&&(l=u.maxHeight,a=l/s*o),a*l>u.maxArea){const g=Math.sqrt(u.maxArea/(a*l));a*=g,l*=g}a=Math.floor(a),l=Math.floor(l);const d=a/o,h=await new Promise(g=>{const y=new Image;y.crossOrigin="anonymous",y.onload=async()=>{await new Promise(_=>setTimeout(_,250));const x=document.createElement("canvas"),w=x.getContext("2d");x.width=a,x.height=l,w.imageSmoothingEnabled=!0,w.imageSmoothingQuality="high",w.drawImage(y,0,0,a,l),URL.revokeObjectURL(c),g(x)},y.onerror=()=>{g(null)},y.src=c});if(!h)return null;const f=await new Promise(g=>h.toBlob(y=>{(!y||nn.throwToBlob.value)&&g(null),g(y)},"image/"+n,r));if(!f)return null;const p=new DataView(await f.arrayBuffer());return _q(p,d,{type:"image/"+n})}async function G6(e){const t=e.cloneNode(!0);t.setAttribute("encoding",'UTF-8"');const n=new FileReader,r=Array.from(t.querySelectorAll("image"));for(const i of r){const o=i.getAttribute("xlink:href");if(o&&!o.startsWith("data:")){const s=await(await fetch(o)).blob(),a=await new Promise((l,c)=>{n.onload=()=>l(n.result),n.onerror=()=>c(n.error),n.readAsDataURL(s)});i.setAttribute("xlink:href",a)}}return Yee(t)}function Yee(e){const t=new XMLSerializer().serializeToString(e);return`data:image/svg+xml;base64,${window.btoa(unescape(encodeURIComponent(t)))}`}function Gv(e,t){const n=document.createElement("a");n.href=e,n.download=t,n.click()}async function qee({shouldReload:e=!0}={}){sessionStorage.clear(),await Promise.all(k_().map(t=>aee(t))),localStorage.clear(),e&&window.location.reload()}typeof window<"u"&&(window.__tldraw__hardReset=qee);function Gee(e,t="_blank"){qS.openWindow(e,t)}function oe(){return oe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},oe.apply(this,arguments)}function we(e,t,{checkForDefaultPrevented:n=!0}={}){return function(i){if(e==null||e(i),n===!1||!i.defaultPrevented)return t==null?void 0:t(i)}}function Xee(e,t){typeof e=="function"?e(t):e!=null&&(e.current=t)}function Oy(...e){return t=>e.forEach(n=>Xee(n,t))}function Tt(...e){return b.useCallback(Oy(...e),e)}function Qo(e,t=[]){let n=[];function r(o,s){const a=b.createContext(s),l=n.length;n=[...n,s];function c(d){const{scope:h,children:f,...p}=d,g=(h==null?void 0:h[e][l])||a,y=b.useMemo(()=>p,Object.values(p));return b.createElement(g.Provider,{value:y},f)}function u(d,h){const f=(h==null?void 0:h[e][l])||a,p=b.useContext(f);if(p)return p;if(s!==void 0)return s;throw new Error(`\`${d}\` must be used within \`${o}\``)}return c.displayName=o+"Provider",[c,u]}const i=()=>{const o=n.map(s=>b.createContext(s));return function(a){const l=(a==null?void 0:a[e])||o;return b.useMemo(()=>({[`__scope${e}`]:{...a,[e]:l}}),[a,l])}};return i.scopeName=e,[r,Zee(i,...t)]}function Zee(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(o){const s=r.reduce((a,{useScope:l,scopeName:c})=>{const d=l(o)[`__scope${c}`];return{...a,...d}},{});return b.useMemo(()=>({[`__scope${t.scopeName}`]:s}),[s])}};return n.scopeName=t.scopeName,n}const Za=globalThis!=null&&globalThis.document?b.useLayoutEffect:()=>{},Qee=d$["useId".toString()]||(()=>{});let Jee=0;function Ws(e){const[t,n]=b.useState(Qee());return Za(()=>{e||n(r=>r??String(Jee++))},[e]),e||(t?`radix-${t}`:"")}function Fn(e){const t=b.useRef(e);return b.useEffect(()=>{t.current=e}),b.useMemo(()=>(...n)=>{var r;return(r=t.current)===null||r===void 0?void 0:r.call(t,...n)},[])}function ul({prop:e,defaultProp:t,onChange:n=()=>{}}){const[r,i]=ete({defaultProp:t,onChange:n}),o=e!==void 0,s=o?e:r,a=Fn(n),l=b.useCallback(c=>{if(o){const d=typeof c=="function"?c(e):c;d!==e&&a(d)}else i(c)},[o,e,i,a]);return[s,l]}function ete({defaultProp:e,onChange:t}){const n=b.useState(e),[r]=n,i=b.useRef(r),o=Fn(t);return b.useEffect(()=>{i.current!==r&&(o(r),i.current=r)},[r,i,o]),n}const Mc=b.forwardRef((e,t)=>{const{children:n,...r}=e,i=b.Children.toArray(n),o=i.find(nte);if(o){const s=o.props.children,a=i.map(l=>l===o?b.Children.count(s)>1?b.Children.only(null):b.isValidElement(s)?s.props.children:null:l);return b.createElement(kb,oe({},r,{ref:t}),b.isValidElement(s)?b.cloneElement(s,void 0,a):null)}return b.createElement(kb,oe({},r,{ref:t}),n)});Mc.displayName="Slot";const kb=b.forwardRef((e,t)=>{const{children:n,...r}=e;return b.isValidElement(n)?b.cloneElement(n,{...rte(r,n.props),ref:t?Oy(t,n.ref):n.ref}):b.Children.count(n)>1?b.Children.only(null):null});kb.displayName="SlotClone";const tte=({children:e})=>b.createElement(b.Fragment,null,e);function nte(e){return b.isValidElement(e)&&e.type===tte}function rte(e,t){const n={...t};for(const r in t){const i=e[r],o=t[r];/^on[A-Z]/.test(r)?i&&o?n[r]=(...a)=>{o(...a),i(...a)}:i&&(n[r]=i):r==="style"?n[r]={...i,...o}:r==="className"&&(n[r]=[i,o].filter(Boolean).join(" "))}return{...e,...n}}const ite=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],lt=ite.reduce((e,t)=>{const n=b.forwardRef((r,i)=>{const{asChild:o,...s}=r,a=o?Mc:t;return b.useEffect(()=>{window[Symbol.for("radix-ui")]=!0},[]),b.createElement(a,oe({},s,{ref:i}))});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function T_(e,t){e&&Yo.flushSync(()=>e.dispatchEvent(t))}function ote(e,t=globalThis==null?void 0:globalThis.document){const n=Fn(e);b.useEffect(()=>{const r=i=>{i.key==="Escape"&&n(i)};return t.addEventListener("keydown",r),()=>t.removeEventListener("keydown",r)},[n,t])}const Tb="dismissableLayer.update",ste="dismissableLayer.pointerDownOutside",ate="dismissableLayer.focusOutside";let HT;const X6=b.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),P_=b.forwardRef((e,t)=>{var n;const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:s,onInteractOutside:a,onDismiss:l,...c}=e,u=b.useContext(X6),[d,h]=b.useState(null),f=(n=d==null?void 0:d.ownerDocument)!==null&&n!==void 0?n:globalThis==null?void 0:globalThis.document,[,p]=b.useState({}),g=Tt(t,$=>h($)),y=Array.from(u.layers),[x]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),w=y.indexOf(x),_=d?y.indexOf(d):-1,S=u.layersWithOutsidePointerEventsDisabled.size>0,T=_>=w,P=cte($=>{const L=$.target,R=[...u.branches].some(K=>K.contains(L));!T||R||(o==null||o($),a==null||a($),$.defaultPrevented||l==null||l())},f),I=ute($=>{const L=$.target;[...u.branches].some(K=>K.contains(L))||(s==null||s($),a==null||a($),$.defaultPrevented||l==null||l())},f);return ote($=>{_===u.layers.size-1&&(i==null||i($),!$.defaultPrevented&&l&&($.preventDefault(),l()))},f),b.useEffect(()=>{if(d)return r&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(HT=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(d)),u.layers.add(d),KT(),()=>{r&&u.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=HT)}},[d,f,r,u]),b.useEffect(()=>()=>{d&&(u.layers.delete(d),u.layersWithOutsidePointerEventsDisabled.delete(d),KT())},[d,u]),b.useEffect(()=>{const $=()=>p({});return document.addEventListener(Tb,$),()=>document.removeEventListener(Tb,$)},[]),b.createElement(lt.div,oe({},c,{ref:g,style:{pointerEvents:S?T?"auto":"none":void 0,...e.style},onFocusCapture:we(e.onFocusCapture,I.onFocusCapture),onBlurCapture:we(e.onBlurCapture,I.onBlurCapture),onPointerDownCapture:we(e.onPointerDownCapture,P.onPointerDownCapture)}))}),lte=b.forwardRef((e,t)=>{const n=b.useContext(X6),r=b.useRef(null),i=Tt(t,r);return b.useEffect(()=>{const o=r.current;if(o)return n.branches.add(o),()=>{n.branches.delete(o)}},[n.branches]),b.createElement(lt.div,oe({},e,{ref:i}))});function cte(e,t=globalThis==null?void 0:globalThis.document){const n=Fn(e),r=b.useRef(!1),i=b.useRef(()=>{});return b.useEffect(()=>{const o=a=>{if(a.target&&!r.current){let c=function(){Z6(ste,n,l,{discrete:!0})};const l={originalEvent:a};a.pointerType==="touch"?(t.removeEventListener("click",i.current),i.current=c,t.addEventListener("click",i.current,{once:!0})):c()}r.current=!1},s=window.setTimeout(()=>{t.addEventListener("pointerdown",o)},0);return()=>{window.clearTimeout(s),t.removeEventListener("pointerdown",o),t.removeEventListener("click",i.current)}},[t,n]),{onPointerDownCapture:()=>r.current=!0}}function ute(e,t=globalThis==null?void 0:globalThis.document){const n=Fn(e),r=b.useRef(!1);return b.useEffect(()=>{const i=o=>{o.target&&!r.current&&Z6(ate,n,{originalEvent:o},{discrete:!1})};return t.addEventListener("focusin",i),()=>t.removeEventListener("focusin",i)},[t,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function KT(){const e=new CustomEvent(Tb);document.dispatchEvent(e)}function Z6(e,t,n,{discrete:r}){const i=n.originalEvent.target,o=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&i.addEventListener(e,t,{once:!0}),r?T_(i,o):i.dispatchEvent(o)}const dte=P_,hte=lte,Xv="focusScope.autoFocusOnMount",Zv="focusScope.autoFocusOnUnmount",VT={bubbles:!1,cancelable:!0},Q6=b.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:i,onUnmountAutoFocus:o,...s}=e,[a,l]=b.useState(null),c=Fn(i),u=Fn(o),d=b.useRef(null),h=Tt(t,g=>l(g)),f=b.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;b.useEffect(()=>{if(r){let g=function(_){if(f.paused||!a)return;const S=_.target;a.contains(S)?d.current=S:ms(d.current,{select:!0})},y=function(_){if(f.paused||!a)return;const S=_.relatedTarget;S!==null&&(a.contains(S)||ms(d.current,{select:!0}))},x=function(_){const S=document.activeElement;for(const T of _)T.removedNodes.length>0&&(a!=null&&a.contains(S)||ms(a))};document.addEventListener("focusin",g),document.addEventListener("focusout",y);const w=new MutationObserver(x);return a&&w.observe(a,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",g),document.removeEventListener("focusout",y),w.disconnect()}}},[r,a,f.paused]),b.useEffect(()=>{if(a){qT.add(f);const g=document.activeElement;if(!a.contains(g)){const x=new CustomEvent(Xv,VT);a.addEventListener(Xv,c),a.dispatchEvent(x),x.defaultPrevented||(fte(vte(J6(a)),{select:!0}),document.activeElement===g&&ms(a))}return()=>{a.removeEventListener(Xv,c),setTimeout(()=>{const x=new CustomEvent(Zv,VT);a.addEventListener(Zv,u),a.dispatchEvent(x),x.defaultPrevented||ms(g??document.body,{select:!0}),a.removeEventListener(Zv,u),qT.remove(f)},0)}}},[a,c,u,f]);const p=b.useCallback(g=>{if(!n&&!r||f.paused)return;const y=g.key==="Tab"&&!g.altKey&&!g.ctrlKey&&!g.metaKey,x=document.activeElement;if(y&&x){const w=g.currentTarget,[_,S]=pte(w);_&&S?!g.shiftKey&&x===S?(g.preventDefault(),n&&ms(_,{select:!0})):g.shiftKey&&x===_&&(g.preventDefault(),n&&ms(S,{select:!0})):x===w&&g.preventDefault()}},[n,r,f.paused]);return b.createElement(lt.div,oe({tabIndex:-1},s,{ref:h,onKeyDown:p}))});function fte(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(ms(r,{select:t}),document.activeElement!==n)return}function pte(e){const t=J6(e),n=YT(t,e),r=YT(t.reverse(),e);return[n,r]}function J6(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const i=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||i?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function YT(e,t){for(const n of e)if(!gte(n,{upTo:t}))return n}function gte(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function mte(e){return e instanceof HTMLInputElement&&"select"in e}function ms(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&mte(e)&&t&&e.select()}}const qT=yte();function yte(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=GT(e,t),e.unshift(t)},remove(t){var n;e=GT(e,t),(n=e[0])===null||n===void 0||n.resume()}}}function GT(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function vte(e){return e.filter(t=>t.tagName!=="A")}const I_=b.forwardRef((e,t)=>{var n;const{container:r=globalThis==null||(n=globalThis.document)===null||n===void 0?void 0:n.body,...i}=e;return r?m3.createPortal(b.createElement(lt.div,oe({},i,{ref:t})),r):null});function xte(e,t){return b.useReducer((n,r)=>{const i=t[n][r];return i??n},e)}const Jo=e=>{const{present:t,children:n}=e,r=bte(t),i=typeof n=="function"?n({present:r.isPresent}):b.Children.only(n),o=Tt(r.ref,i.ref);return typeof n=="function"||r.isPresent?b.cloneElement(i,{ref:o}):null};Jo.displayName="Presence";function bte(e){const[t,n]=b.useState(),r=b.useRef({}),i=b.useRef(e),o=b.useRef("none"),s=e?"mounted":"unmounted",[a,l]=xte(s,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return b.useEffect(()=>{const c=ep(r.current);o.current=a==="mounted"?c:"none"},[a]),Za(()=>{const c=r.current,u=i.current;if(u!==e){const h=o.current,f=ep(c);e?l("MOUNT"):f==="none"||(c==null?void 0:c.display)==="none"?l("UNMOUNT"):l(u&&h!==f?"ANIMATION_OUT":"UNMOUNT"),i.current=e}},[e,l]),Za(()=>{if(t){const c=d=>{const f=ep(r.current).includes(d.animationName);d.target===t&&f&&Yo.flushSync(()=>l("ANIMATION_END"))},u=d=>{d.target===t&&(o.current=ep(r.current))};return t.addEventListener("animationstart",u),t.addEventListener("animationcancel",c),t.addEventListener("animationend",c),()=>{t.removeEventListener("animationstart",u),t.removeEventListener("animationcancel",c),t.removeEventListener("animationend",c)}}else l("ANIMATION_END")},[t,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:b.useCallback(c=>{c&&(r.current=getComputedStyle(c)),n(c)},[])}}function ep(e){return(e==null?void 0:e.animationName)||"none"}let Qv=0;function eO(){b.useEffect(()=>{var e,t;const n=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",(e=n[0])!==null&&e!==void 0?e:XT()),document.body.insertAdjacentElement("beforeend",(t=n[1])!==null&&t!==void 0?t:XT()),Qv++,()=>{Qv===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(r=>r.remove()),Qv--}},[])}function XT(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.cssText="outline: none; opacity: 0; position: fixed; pointer-events: none",e}var qi=function(){return qi=Object.assign||function(t){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},qi.apply(this,arguments)};function tO(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}function wte(e,t,n){if(n||arguments.length===2)for(var r=0,i=t.length,o;r<i;r++)(o||!(r in t))&&(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))}var rg="right-scroll-bar-position",ig="width-before-scroll-bar",Ste="with-scroll-bars-hidden",_te="--removed-body-scroll-bar-size";function Cte(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function Ete(e,t){var n=b.useState(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(r){var i=n.value;i!==r&&(n.value=r,n.callback(r,i))}}}})[0];return n.callback=t,n.facade}function kte(e,t){return Ete(t||null,function(n){return e.forEach(function(r){return Cte(r,n)})})}function Tte(e){return e}function Pte(e,t){t===void 0&&(t=Tte);var n=[],r=!1,i={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(o){var s=t(o,r);return n.push(s),function(){n=n.filter(function(a){return a!==s})}},assignSyncMedium:function(o){for(r=!0;n.length;){var s=n;n=[],s.forEach(o)}n={push:function(a){return o(a)},filter:function(){return n}}},assignMedium:function(o){r=!0;var s=[];if(n.length){var a=n;n=[],a.forEach(o),s=n}var l=function(){var u=s;s=[],u.forEach(o)},c=function(){return Promise.resolve().then(l)};c(),n={push:function(u){s.push(u),c()},filter:function(u){return s=s.filter(u),n}}}};return i}function Ite(e){e===void 0&&(e={});var t=Pte(null);return t.options=qi({async:!0,ssr:!1},e),t}var nO=function(e){var t=e.sideCar,n=tO(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=t.read();if(!r)throw new Error("Sidecar medium not found");return b.createElement(r,qi({},n))};nO.isSideCarExport=!0;function $te(e,t){return e.useMedium(t),nO}var rO=Ite(),Jv=function(){},Ly=b.forwardRef(function(e,t){var n=b.useRef(null),r=b.useState({onScrollCapture:Jv,onWheelCapture:Jv,onTouchMoveCapture:Jv}),i=r[0],o=r[1],s=e.forwardProps,a=e.children,l=e.className,c=e.removeScrollBar,u=e.enabled,d=e.shards,h=e.sideCar,f=e.noIsolation,p=e.inert,g=e.allowPinchZoom,y=e.as,x=y===void 0?"div":y,w=tO(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as"]),_=h,S=kte([n,t]),T=qi(qi({},w),i);return b.createElement(b.Fragment,null,u&&b.createElement(_,{sideCar:rO,removeScrollBar:c,shards:d,noIsolation:f,inert:p,setCallbacks:o,allowPinchZoom:!!g,lockRef:n}),s?b.cloneElement(b.Children.only(a),qi(qi({},T),{ref:S})):b.createElement(x,qi({},T,{className:l,ref:S}),a))});Ly.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Ly.classNames={fullWidth:ig,zeroRight:rg};var ZT,Ate=function(){if(ZT)return ZT;if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function Mte(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=Ate();return t&&e.setAttribute("nonce",t),e}function Ote(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function Lte(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var Bte=function(){var e=0,t=null;return{add:function(n){e==0&&(t=Mte())&&(Ote(t,n),Lte(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},Rte=function(){var e=Bte();return function(t,n){b.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},iO=function(){var e=Rte(),t=function(n){var r=n.styles,i=n.dynamic;return e(r,i),null};return t},Dte={left:0,top:0,right:0,gap:0},e1=function(e){return parseInt(e||"",10)||0},Fte=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],r=t[e==="padding"?"paddingTop":"marginTop"],i=t[e==="padding"?"paddingRight":"marginRight"];return[e1(n),e1(r),e1(i)]},Nte=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return Dte;var t=Fte(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},jte=iO(),zte=function(e,t,n,r){var i=e.left,o=e.top,s=e.right,a=e.gap;return n===void 0&&(n="margin"),`
  .`.concat(Ste,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(a,"px ").concat(r,`;
  }
  body {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(i,`px;
    padding-top: `).concat(o,`px;
    padding-right: `).concat(s,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(a,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(a,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(rg,` {
    right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(ig,` {
    margin-right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(rg," .").concat(rg,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(ig," .").concat(ig,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body {
    `).concat(_te,": ").concat(a,`px;
  }
`)},Ute=function(e){var t=e.noRelative,n=e.noImportant,r=e.gapMode,i=r===void 0?"margin":r,o=b.useMemo(function(){return Nte(i)},[i]);return b.createElement(jte,{styles:zte(o,!t,i,n?"":"!important")})},Pb=!1;if(typeof window<"u")try{var tp=Object.defineProperty({},"passive",{get:function(){return Pb=!0,!0}});window.addEventListener("test",tp,tp),window.removeEventListener("test",tp,tp)}catch{Pb=!1}var Ol=Pb?{passive:!1}:!1,Wte=function(e){return e.tagName==="TEXTAREA"},oO=function(e,t){var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!Wte(e)&&n[t]==="visible")},Hte=function(e){return oO(e,"overflowY")},Kte=function(e){return oO(e,"overflowX")},QT=function(e,t){var n=t;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var r=sO(e,n);if(r){var i=aO(e,n),o=i[1],s=i[2];if(o>s)return!0}n=n.parentNode}while(n&&n!==document.body);return!1},Vte=function(e){var t=e.scrollTop,n=e.scrollHeight,r=e.clientHeight;return[t,n,r]},Yte=function(e){var t=e.scrollLeft,n=e.scrollWidth,r=e.clientWidth;return[t,n,r]},sO=function(e,t){return e==="v"?Hte(t):Kte(t)},aO=function(e,t){return e==="v"?Vte(t):Yte(t)},qte=function(e,t){return e==="h"&&t==="rtl"?-1:1},Gte=function(e,t,n,r,i){var o=qte(e,window.getComputedStyle(t).direction),s=o*r,a=n.target,l=t.contains(a),c=!1,u=s>0,d=0,h=0;do{var f=aO(e,a),p=f[0],g=f[1],y=f[2],x=g-y-o*p;(p||x)&&sO(e,a)&&(d+=x,h+=p),a=a.parentNode}while(!l&&a!==document.body||l&&(t.contains(a)||t===a));return(u&&(i&&d===0||!i&&s>d)||!u&&(i&&h===0||!i&&-s>h))&&(c=!0),c},np=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},JT=function(e){return[e.deltaX,e.deltaY]},eP=function(e){return e&&"current"in e?e.current:e},Xte=function(e,t){return e[0]===t[0]&&e[1]===t[1]},Zte=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},Qte=0,Ll=[];function Jte(e){var t=b.useRef([]),n=b.useRef([0,0]),r=b.useRef(),i=b.useState(Qte++)[0],o=b.useState(function(){return iO()})[0],s=b.useRef(e);b.useEffect(function(){s.current=e},[e]),b.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(i));var g=wte([e.lockRef.current],(e.shards||[]).map(eP),!0).filter(Boolean);return g.forEach(function(y){return y.classList.add("allow-interactivity-".concat(i))}),function(){document.body.classList.remove("block-interactivity-".concat(i)),g.forEach(function(y){return y.classList.remove("allow-interactivity-".concat(i))})}}},[e.inert,e.lockRef.current,e.shards]);var a=b.useCallback(function(g,y){if("touches"in g&&g.touches.length===2)return!s.current.allowPinchZoom;var x=np(g),w=n.current,_="deltaX"in g?g.deltaX:w[0]-x[0],S="deltaY"in g?g.deltaY:w[1]-x[1],T,P=g.target,I=Math.abs(_)>Math.abs(S)?"h":"v";if("touches"in g&&I==="h"&&P.type==="range")return!1;var $=QT(I,P);if(!$)return!0;if($?T=I:(T=I==="v"?"h":"v",$=QT(I,P)),!$)return!1;if(!r.current&&"changedTouches"in g&&(_||S)&&(r.current=T),!T)return!0;var L=r.current||T;return Gte(L,y,g,L==="h"?_:S,!0)},[]),l=b.useCallback(function(g){var y=g;if(!(!Ll.length||Ll[Ll.length-1]!==o)){var x="deltaY"in y?JT(y):np(y),w=t.current.filter(function(T){return T.name===y.type&&T.target===y.target&&Xte(T.delta,x)})[0];if(w&&w.should){y.cancelable&&y.preventDefault();return}if(!w){var _=(s.current.shards||[]).map(eP).filter(Boolean).filter(function(T){return T.contains(y.target)}),S=_.length>0?a(y,_[0]):!s.current.noIsolation;S&&y.cancelable&&y.preventDefault()}}},[]),c=b.useCallback(function(g,y,x,w){var _={name:g,delta:y,target:x,should:w};t.current.push(_),setTimeout(function(){t.current=t.current.filter(function(S){return S!==_})},1)},[]),u=b.useCallback(function(g){n.current=np(g),r.current=void 0},[]),d=b.useCallback(function(g){c(g.type,JT(g),g.target,a(g,e.lockRef.current))},[]),h=b.useCallback(function(g){c(g.type,np(g),g.target,a(g,e.lockRef.current))},[]);b.useEffect(function(){return Ll.push(o),e.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:h}),document.addEventListener("wheel",l,Ol),document.addEventListener("touchmove",l,Ol),document.addEventListener("touchstart",u,Ol),function(){Ll=Ll.filter(function(g){return g!==o}),document.removeEventListener("wheel",l,Ol),document.removeEventListener("touchmove",l,Ol),document.removeEventListener("touchstart",u,Ol)}},[]);var f=e.removeScrollBar,p=e.inert;return b.createElement(b.Fragment,null,p?b.createElement(o,{styles:Zte(i)}):null,f?b.createElement(Ute,{gapMode:"margin"}):null)}const ene=$te(rO,Jte);var lO=b.forwardRef(function(e,t){return b.createElement(Ly,qi({},e,{ref:t,sideCar:ene}))});lO.classNames=Ly.classNames;const $_=lO;var tne=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},Bl=new WeakMap,rp=new WeakMap,ip={},t1=0,cO=function(e){return e&&(e.host||cO(e.parentNode))},nne=function(e,t){return t.map(function(n){if(e.contains(n))return n;var r=cO(n);return r&&e.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",e,". Doing nothing"),null)}).filter(function(n){return!!n})},rne=function(e,t,n,r){var i=nne(t,Array.isArray(e)?e:[e]);ip[n]||(ip[n]=new WeakMap);var o=ip[n],s=[],a=new Set,l=new Set(i),c=function(d){!d||a.has(d)||(a.add(d),c(d.parentNode))};i.forEach(c);var u=function(d){!d||l.has(d)||Array.prototype.forEach.call(d.children,function(h){if(a.has(h))u(h);else{var f=h.getAttribute(r),p=f!==null&&f!=="false",g=(Bl.get(h)||0)+1,y=(o.get(h)||0)+1;Bl.set(h,g),o.set(h,y),s.push(h),g===1&&p&&rp.set(h,!0),y===1&&h.setAttribute(n,"true"),p||h.setAttribute(r,"true")}})};return u(t),a.clear(),t1++,function(){s.forEach(function(d){var h=Bl.get(d)-1,f=o.get(d)-1;Bl.set(d,h),o.set(d,f),h||(rp.has(d)||d.removeAttribute(r),rp.delete(d)),f||d.removeAttribute(n)}),t1--,t1||(Bl=new WeakMap,Bl=new WeakMap,rp=new WeakMap,ip={})}},A_=function(e,t,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(e)?e:[e]),i=t||tne(e);return i?(r.push.apply(r,Array.from(i.querySelectorAll("[aria-live]"))),rne(r,i,n,"aria-hidden")):function(){return null}};const uO="Dialog",[dO,Mwe]=Qo(uO),[ine,es]=dO(uO),one=e=>{const{__scopeDialog:t,children:n,open:r,defaultOpen:i,onOpenChange:o,modal:s=!0}=e,a=b.useRef(null),l=b.useRef(null),[c=!1,u]=ul({prop:r,defaultProp:i,onChange:o});return b.createElement(ine,{scope:t,triggerRef:a,contentRef:l,contentId:Ws(),titleId:Ws(),descriptionId:Ws(),open:c,onOpenChange:u,onOpenToggle:b.useCallback(()=>u(d=>!d),[u]),modal:s},n)},hO="DialogPortal",[sne,fO]=dO(hO,{forceMount:void 0}),ane=e=>{const{__scopeDialog:t,forceMount:n,children:r,container:i}=e,o=es(hO,t);return b.createElement(sne,{scope:t,forceMount:n},b.Children.map(r,s=>b.createElement(Jo,{present:n||o.open},b.createElement(I_,{asChild:!0,container:i},s))))},Ib="DialogOverlay",lne=b.forwardRef((e,t)=>{const n=fO(Ib,e.__scopeDialog),{forceMount:r=n.forceMount,...i}=e,o=es(Ib,e.__scopeDialog);return o.modal?b.createElement(Jo,{present:r||o.open},b.createElement(cne,oe({},i,{ref:t}))):null}),cne=b.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,i=es(Ib,n);return b.createElement($_,{as:Mc,allowPinchZoom:!0,shards:[i.contentRef]},b.createElement(lt.div,oe({"data-state":gO(i.open)},r,{ref:t,style:{pointerEvents:"auto",...r.style}})))}),Zd="DialogContent",une=b.forwardRef((e,t)=>{const n=fO(Zd,e.__scopeDialog),{forceMount:r=n.forceMount,...i}=e,o=es(Zd,e.__scopeDialog);return b.createElement(Jo,{present:r||o.open},o.modal?b.createElement(dne,oe({},i,{ref:t})):b.createElement(hne,oe({},i,{ref:t})))}),dne=b.forwardRef((e,t)=>{const n=es(Zd,e.__scopeDialog),r=b.useRef(null),i=Tt(t,n.contentRef,r);return b.useEffect(()=>{const o=r.current;if(o)return A_(o)},[]),b.createElement(pO,oe({},e,{ref:i,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:we(e.onCloseAutoFocus,o=>{var s;o.preventDefault(),(s=n.triggerRef.current)===null||s===void 0||s.focus()}),onPointerDownOutside:we(e.onPointerDownOutside,o=>{const s=o.detail.originalEvent,a=s.button===0&&s.ctrlKey===!0;(s.button===2||a)&&o.preventDefault()}),onFocusOutside:we(e.onFocusOutside,o=>o.preventDefault())}))}),hne=b.forwardRef((e,t)=>{const n=es(Zd,e.__scopeDialog),r=b.useRef(!1),i=b.useRef(!1);return b.createElement(pO,oe({},e,{ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{var s;if((s=e.onCloseAutoFocus)===null||s===void 0||s.call(e,o),!o.defaultPrevented){var a;r.current||(a=n.triggerRef.current)===null||a===void 0||a.focus(),o.preventDefault()}r.current=!1,i.current=!1},onInteractOutside:o=>{var s,a;(s=e.onInteractOutside)===null||s===void 0||s.call(e,o),o.defaultPrevented||(r.current=!0,o.detail.originalEvent.type==="pointerdown"&&(i.current=!0));const l=o.target;((a=n.triggerRef.current)===null||a===void 0?void 0:a.contains(l))&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&i.current&&o.preventDefault()}}))}),pO=b.forwardRef((e,t)=>{const{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:i,onCloseAutoFocus:o,...s}=e,a=es(Zd,n),l=b.useRef(null),c=Tt(t,l);return eO(),b.createElement(b.Fragment,null,b.createElement(Q6,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:i,onUnmountAutoFocus:o},b.createElement(P_,oe({role:"dialog",id:a.contentId,"aria-describedby":a.descriptionId,"aria-labelledby":a.titleId,"data-state":gO(a.open)},s,{ref:c,onDismiss:()=>a.onOpenChange(!1)}))),!1)}),fne="DialogTitle",pne=b.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,i=es(fne,n);return b.createElement(lt.h2,oe({id:i.titleId},r,{ref:t}))}),gne="DialogClose",mne=b.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,i=es(gne,n);return b.createElement(lt.button,oe({type:"button"},r,{ref:t,onClick:we(e.onClick,()=>i.onOpenChange(!1))}))});function gO(e){return e?"open":"closed"}const yne=one,vne=ane,xne=lne,bne=une,mO=b.createContext(null);function wne({assetUrls:e,children:t}){return m.jsx(mO.Provider,{value:e,children:t})}function M_(){const e=b.useContext(mO);if(!e)throw new Error("useAssetUrls must be used within an AssetUrlsProvider");return e}const $b={"action.convert-to-bookmark":"Convert to Bookmark","action.convert-to-embed":"Convert to Embed","action.open-embed-link":"Open link","action.align-bottom":"Align bottom","action.align-center-horizontal":"Align horizontally","action.align-center-vertical":"Align vertically","action.align-center-horizontal.short":"Align H","action.align-center-vertical.short":"Align V","action.align-left":"Align left","action.align-right":"Align right","action.align-top":"Align top","action.back-to-content":"Back to content","action.bring-forward":"Bring forward","action.bring-to-front":"Bring to front","action.copy-as-json.short":"JSON","action.copy-as-json":"Copy as JSON","action.copy-as-png.short":"PNG","action.copy-as-png":"Copy as PNG","action.copy-as-svg.short":"SVG","action.copy-as-svg":"Copy as SVG","action.copy":"Copy","action.cut":"Cut","action.delete":"Delete","action.distribute-horizontal":"Distribute horizontally","action.distribute-vertical":"Distribute vertically","action.distribute-horizontal.short":"Distribute H","action.distribute-vertical.short":"Distribute V","action.duplicate":"Duplicate","action.edit-link":"Edit link","action.exit-pen-mode":"Exit pen mode","action.export-as-json.short":"JSON","action.export-as-json":"Export as JSON","action.export-as-png.short":"PNG","action.export-as-png":"Export as PNG","action.export-as-svg.short":"SVG","action.export-as-svg":"Export as SVG","action.flip-horizontal":"Flip horizontally","action.flip-vertical":"Flip vertically","action.flip-horizontal.short":"Flip H","action.flip-vertical.short":"Flip V","action.fork-project":"Fork this project","action.group":"Group","action.insert-embed":"Insert embed","action.insert-media":"Upload media","action.leave-shared-project":"Leave shared project","action.new-project":"New project","action.new-shared-project":"New shared project","action.open-file":"Open file","action.pack":"Pack","action.paste":"Paste","action.print":"Print","action.redo":"Redo","action.rotate-ccw":"Rotate counterclockwise","action.rotate-cw":"Rotate clockwise","action.save-copy":"Save a copy","action.select-all":"Select all","action.select-none":"Select none","action.send-backward":"Send backward","action.send-to-back":"Send to back","action.share-project":"Share this project","action.stack-horizontal":"Stack horizontally","action.stack-vertical":"Stack vertically","action.stack-horizontal.short":"Stack H","action.stack-vertical.short":"Stack V","action.stop-following":"Stop following","action.stretch-horizontal":"Stretch horizontally","action.stretch-vertical":"Stretch vertically","action.stretch-horizontal.short":"Stretch H","action.stretch-vertical.short":"Stretch V","action.toggle-auto-size":"Toggle auto size","action.toggle-dark-mode.menu":"Dark mode","action.toggle-dark-mode":"Toggle dark mode","action.toggle-reduce-motion.menu":"Reduce motion","action.toggle-reduce-motion":"Toggle reduce motion","action.toggle-debug-mode.menu":"Debug mode","action.toggle-debug-mode":"Toggle debug mode","action.toggle-focus-mode.menu":"Focus mode","action.toggle-focus-mode":"Toggle focus mode","action.toggle-grid.menu":"Show grid","action.toggle-grid":"Toggle grid","action.toggle-lock":"Toggle locked","action.toggle-snap-mode.menu":"Always snap","action.toggle-snap-mode":"Toggle always snap","action.toggle-tool-lock.menu":"Tool lock","action.toggle-tool-lock":"Toggle tool lock","action.toggle-transparent.context-menu":"Transparent","action.toggle-transparent.menu":"Transparent","action.toggle-transparent":"Toggle transparent background","action.undo":"Undo","action.ungroup":"Ungroup","action.zoom-in":"Zoom in","action.zoom-out":"Zoom out","action.zoom-to-100":"Zoom to 100%","action.zoom-to-fit":"Zoom to fit","action.zoom-to-selection":"Zoom to selection","color-style.black":"Black","color-style.blue":"Blue","color-style.green":"Green","color-style.grey":"Grey","color-style.light-blue":"Light blue","color-style.light-green":"Light green","color-style.light-red":"Light red","color-style.light-violet":"Light violet","color-style.orange":"Orange","color-style.red":"Red","color-style.violet":"Violet","color-style.yellow":"Yellow","fill-style.none":"None","fill-style.semi":"Semi","fill-style.solid":"Solid","fill-style.pattern":"Pattern","dash-style.dashed":"Dashed","dash-style.dotted":"Dotted","dash-style.draw":"Draw","dash-style.solid":"Solid","size-style.s":"Small","size-style.m":"Medium","size-style.l":"Large","size-style.xl":"Extra large","opacity-style.0.1":"10%","opacity-style.0.25":"25%","opacity-style.0.5":"50%","opacity-style.0.75":"75%","opacity-style.1":"100%","font-style.draw":"Draw","font-style.sans":"Sans","font-style.serif":"Serif","font-style.mono":"Mono","align-style.start":"Start","align-style.middle":"Middle","align-style.end":"End","align-style.justify":"Justify","geo-style.arrow-down":"Arrow down","geo-style.arrow-left":"Arrow left","geo-style.arrow-right":"Arrow right","geo-style.arrow-up":"Arrow up","geo-style.diamond":"Diamond","geo-style.ellipse":"Ellipse","geo-style.hexagon":"Hexagon","geo-style.octagon":"Octagon","geo-style.oval":"Oval","geo-style.pentagon":"Pentagon","geo-style.rectangle":"Rectangle","geo-style.rhombus-2":"Rhombus 2","geo-style.rhombus":"Rhombus","geo-style.star":"Star","geo-style.trapezoid":"Trapezoid","geo-style.triangle":"Triangle","geo-style.x-box":"X box","geo-style.check-box":"Check box","arrowheadStart-style.none":"None","arrowheadStart-style.arrow":"Arrow","arrowheadStart-style.bar":"Bar","arrowheadStart-style.diamond":"Diamond","arrowheadStart-style.dot":"Dot","arrowheadStart-style.inverted":"Inverted","arrowheadStart-style.pipe":"Pipe","arrowheadStart-style.square":"Square","arrowheadStart-style.triangle":"Triangle","arrowheadEnd-style.none":"None","arrowheadEnd-style.arrow":"Arrow","arrowheadEnd-style.bar":"Bar","arrowheadEnd-style.diamond":"Diamond","arrowheadEnd-style.dot":"Dot","arrowheadEnd-style.inverted":"Inverted","arrowheadEnd-style.pipe":"Pipe","arrowheadEnd-style.square":"Square","arrowheadEnd-style.triangle":"Triangle","spline-style.line":"Line","spline-style.cubic":"Cubic","tool.select":"Select","tool.hand":"Hand","tool.draw":"Draw","tool.eraser":"Eraser","tool.arrow-down":"Arrow down","tool.arrow-left":"Arrow left","tool.arrow-right":"Arrow right","tool.arrow-up":"Arrow up","tool.arrow":"Arrow","tool.diamond":"Diamond","tool.ellipse":"Ellipse","tool.hexagon":"Hexagon","tool.highlight":"Highlight","tool.line":"Line","tool.octagon":"Octagon","tool.oval":"Oval","tool.pentagon":"Pentagon","tool.rectangle":"Rectangle","tool.rhombus":"Rhombus","tool.star":"Star","tool.trapezoid":"Trapezoid","tool.triangle":"Triangle","tool.x-box":"X box","tool.check-box":"Check box","tool.asset":"Asset","tool.frame":"Frame","tool.note":"Note","tool.laser":"Laser","tool.embed":"Embed","tool.text":"Text","menu.title":"Menu","menu.copy-as":"Copy as","menu.edit":"Edit","menu.export-as":"Export as","menu.file":"File","menu.language":"Language","menu.preferences":"Preferences","menu.view":"View","context-menu.arrange":"Arrange","context-menu.copy-as":"Copy as","context-menu.export-as":"Export as","context-menu.move-to-page":"Move to page","context-menu.reorder":"Reorder","page-menu.title":"Pages","page-menu.create-new-page":"Create new page","page-menu.max-page-count-reached":"Max pages reached","page-menu.new-page-initial-name":"Page 1","page-menu.edit-start":"Edit","page-menu.edit-done":"Done","page-menu.go-to-page":"Go to page","page-menu.submenu.rename":"Rename","page-menu.submenu.duplicate-page":"Duplicate","page-menu.submenu.title":"Menu","page-menu.submenu.move-down":"Move down","page-menu.submenu.move-up":"Move up","page-menu.submenu.delete":"Delete","share-menu.title":"Share","share-menu.save-note":"Download this project to your computer as a .tldr file.","share-menu.fork-note":"Create a new shared project based on this snapshot.","share-menu.share-project":"Share this project","share-menu.default-project-name":"Shared Project","share-menu.copy-link":"Copy share link","share-menu.readonly-link":"Read-only","share-menu.create-snapshot-link":"Copy snapshot link","share-menu.snapshot-link-note":"Capture and share this project as a read-only snapshot link.","share-menu.copy-readonly-link":"Copy read-only link","share-menu.offline-note":"Create a new shared project based on your current project.","share-menu.copy-link-note":"Anyone with the link will be able to view and edit this project.","share-menu.copy-readonly-link-note":"Anyone with the link will be able to view (but not edit) this project.","share-menu.project-too-large":"Sorry, this project can't be shared because it's too large. We're working on it!","share-menu.upload-failed":"Sorry, we couldn't upload your project at the moment. Please try again or let us know if the problem persists.","people-menu.title":"People","people-menu.change-name":"Change name","people-menu.change-color":"Change color","people-menu.follow":"Following","people-menu.following":"Following","people-menu.leading":"Following You","people-menu.user":"(You)","people-menu.invite":"Invite others","help-menu.title":"Help and resources","help-menu.about":"About","help-menu.discord":"Discord","help-menu.github":"GitHub","help-menu.keyboard-shortcuts":"Keyboard shortcuts","help-menu.twitter":"Twitter","actions-menu.title":"Actions","edit-link-dialog.title":"Edit link","edit-link-dialog.invalid-url":"A link must be a valid URL.","edit-link-dialog.detail":"Links will open in a new tab.","edit-link-dialog.url":"URL","edit-link-dialog.clear":"Clear","edit-link-dialog.save":"Continue","edit-link-dialog.cancel":"Cancel","embed-dialog.title":"Insert embed","embed-dialog.back":"Back","embed-dialog.create":"Create","embed-dialog.cancel":"Cancel","embed-dialog.url":"URL","embed-dialog.instruction":"Paste in the site's URL to create the embed.","embed-dialog.invalid-url":"We could not create an embed from that URL.","edit-pages-dialog.move-down":"Move down","edit-pages-dialog.move-up":"Move up","shortcuts-dialog.title":"Keyboard shortcuts","shortcuts-dialog.edit":"Edit","shortcuts-dialog.file":"File","shortcuts-dialog.preferences":"Preferences","shortcuts-dialog.tools":"Tools","shortcuts-dialog.transform":"Transform","shortcuts-dialog.view":"View","home-project-dialog.title":"Home project","home-project-dialog.description":"This is your local home project. It's just for you!","rename-project-dialog.title":"Rename project","rename-project-dialog.cancel":"Cancel","rename-project-dialog.rename":"Rename","home-project-dialog.ok":"Ok","style-panel.title":"Styles","style-panel.align":"Align","style-panel.vertical-align":"Vertical align","style-panel.position":"Position","style-panel.arrowheads":"Arrowheads","style-panel.arrowhead-start":"Start","style-panel.arrowhead-end":"End","style-panel.color":"Color","style-panel.dash":"Dash","style-panel.fill":"Fill","style-panel.font":"Font","style-panel.geo":"Shape","style-panel.mixed":"Mixed","style-panel.opacity":"Opacity","style-panel.size":"Size","style-panel.spline":"Spline","tool-panel.drawing":"Drawing","tool-panel.shapes":"Shapes","tool-panel.more":"More","debug-panel.more":"More","navigation-zone.toggle-minimap":"Toggle minimap","navigation-zone.zoom":"Zoom","focus-mode.toggle-focus-mode":"Toggle focus mode","toast.close":"Close","file-system.file-open-error.title":"Could not open file","file-system.file-open-error.not-a-tldraw-file":"The file you tried to open doesn't look like a tldraw file.","file-system.file-open-error.file-format-version-too-new":"The file you tried to open is from a newer version of tldraw. Please reload the page and try again.","file-system.file-open-error.generic-corrupted-file":"The file you tried to open is corrupted.","file-system.confirm-open.title":"Overwrite current project?","file-system.confirm-open.description":"Opening a file will replace your current project and any unsaved changes will be lost. Are you sure you want to continue?","file-system.confirm-open.cancel":"Cancel","file-system.confirm-open.open":"Open file","file-system.confirm-open.dont-show-again":"Don't ask again","file-system.confirm-clear.title":"Clear current project?","file-system.confirm-clear.description":"Creating a new project will clear your current project and any unsaved changes will be lost. Are you sure you want to continue?","file-system.confirm-clear.cancel":"Cancel","file-system.confirm-clear.continue":"Continue","file-system.confirm-clear.dont-show-again":"Don't ask again","file-system.shared-document-file-open-error.title":"Could not open file","file-system.shared-document-file-open-error.description":"Opening files from shared projects is not supported.","sharing.confirm-leave.title":"Leave current project?","sharing.confirm-leave.description":"Are you sure you want to leave this shared project? You can return to it by navigating to its URL.","sharing.confirm-leave.cancel":"Cancel","sharing.confirm-leave.leave":"Leave","sharing.confirm-leave.dont-show-again":"Don't ask again","toast.error.export-fail.title":"Failed export","toast.error.export-fail.desc":"Failed to export image","toast.error.copy-fail.title":"Failed copy","toast.error.copy-fail.desc":"Failed to copy image","context.pages.new-page":"New page","vscode.file-open.desc":"We've updated this document to work with the current version of tldraw. If you'd like to keep the original version (which will work on old.tldraw.com), click below to create a backup.","vscode.file-open.open":"Continue","vscode.file-open.backup":"Backup","vscode.file-open.backup-saved":"Backup saved","vscode.file-open.backup-failed":"Backup failed: this is not a .tldr file.","vscode.file-open.dont-show-again":"Don't ask again"},Rl={locale:"en",label:"English",messages:$b};async function Sne(e,t){if(!(await fetch(t.translations.en)).ok)return console.warn("No main translations found."),Rl;if(e==="en")return Rl;const r=Nd.find(a=>a.locale===e);if(!r)return console.warn(`No translation found for locale ${e}`),Rl;const o=await(await fetch(t.translations[r.locale])).json();if(!o)return console.warn(`No messages found for locale ${e}`),Rl;const s=[];for(const a in Rl)o[a]||s.push(a);return s.length>0,{locale:e,label:r.label,messages:{...Rl.messages,...o}}}const yO=b.createContext({}),_ne=()=>b.useContext(yO),Cne=Ke(function({overrides:t,children:n}){const i=re().locale,o=M_(),[s,a]=b.useState(()=>t&&t.en?{locale:"en",label:"English",messages:{...$b,...t.en}}:{locale:"en",label:"English",messages:$b});return b.useEffect(()=>{let l=!1;async function c(){const u=await Sne(i,o);u&&!l&&(t&&t[i]?a({...u,messages:{...u.messages,...t[i]}}):a(u))}return c(),()=>{l=!0}},[o,i,t]),m.jsx(yO.Provider,{value:s,children:n})});function qe(){const e=_ne();return b.useCallback(function(n){return e.messages[n]??n},[e])}function Ene(e){return m.jsx("svg",{width:16,height:16,viewBox:"0 0 16 16",...e,children:m.jsxs("g",{strokeWidth:2,fill:"none",fillRule:"evenodd",children:[m.jsx("circle",{strokeOpacity:.25,cx:8,cy:8,r:7,stroke:"currentColor"}),m.jsx("path",{strokeLinecap:"round",d:"M15 8c0-4.5-4.5-7-7-7",stroke:"currentColor",children:m.jsx("animateTransform",{attributeName:"transform",type:"rotate",from:"0 8 8",to:"360 8 8",dur:"1s",repeatCount:"indefinite"})})]})})}const mr=b.memo(function({small:t,invertIcon:n,icon:r,color:i,className:o,...s}){const l=M_().icons[r],c=b.useRef(null);return b.useLayoutEffect(()=>{c!=null&&c.current&&(c.current.style.webkitMask=`url(${l}) center 100% / 100% no-repeat`)},[c,l]),m.jsx("div",{...s,ref:c,className:Me("tlui-icon",{"tlui-icon__small":t},o),style:{color:i,mask:`url(${l}) center 100% / 100% no-repeat`,transform:n?"scale(-1, 1)":void 0}})}),vO=typeof window>"u"?!1:window.navigator.userAgent.toLowerCase().indexOf("mac")>-1,xO=vO?"⌘":"Ctrl",bO=vO?"⌥":"Alt";function kne(e){return e.split(",")[0].split("").map(t=>{const n=t.replace(/\$/g,xO).replace(/\?/g,bO).replace(/!/g,"⇧");return n[0].toUpperCase()+n.slice(1)})}function no(e){return"— "+e.split(",")[0].split("").map(t=>{const n=t.replace(/\$/g,xO).replace(/\?/g,bO).replace(/!/g,"⇧");return n[0].toUpperCase()+n.slice(1)}).join(" ")}function By({children:e}){return m.jsx("kbd",{className:"tlui-kbd",children:kne(e).map((t,n)=>m.jsx("span",{children:t},n))})}const be=b.forwardRef(function({label:t,icon:n,invertIcon:r,iconLeft:i,smallIcon:o,kbd:s,isChecked:a=!1,type:l="normal",children:c,spinner:u,...d},h){const f=qe(),p=t?f(t):"";return m.jsxs("button",{ref:h,draggable:!1,type:"button",...d,title:d.title??p,className:Me("tlui-button",`tlui-button__${l}`,d.className),children:[i&&m.jsx(mr,{icon:i,className:"tlui-icon-left",small:!0}),c,t&&m.jsxs("span",{draggable:!1,children:[p,a&&m.jsx(mr,{icon:"check"})]}),s&&m.jsx(By,{children:s}),n&&!u&&m.jsx(mr,{icon:n,small:!!t||o,invertIcon:r}),u&&m.jsx(Ene,{})]})});function Ry({className:e,children:t}){return m.jsx("div",{className:Me("tlui-dialog__header",e),children:t})}function Dy({className:e,children:t}){return m.jsx(pne,{dir:"ltr",className:Me("tlui-dialog__header__title",e),children:t})}function Fy(){return m.jsx("div",{className:"tlui-dialog__header__close",children:m.jsx(mne,{"data-testid":"dialog.close",dir:"ltr",asChild:!0,children:m.jsx(be,{"aria-label":"Close",onTouchEnd:e=>e.target.click(),children:m.jsx(mr,{small:!0,icon:"cross-2"})})})})}function Qd({className:e,children:t,style:n}){return m.jsx("div",{className:Me("tlui-dialog__body",e),style:n,children:t})}function O_({className:e,children:t}){return m.jsx("div",{className:Me("tlui-dialog__footer",e),children:t})}function Ny(e){const t=e+"CollectionProvider",[n,r]=Qo(t),[i,o]=n(t,{collectionRef:{current:null},itemMap:new Map}),s=f=>{const{scope:p,children:g}=f,y=ke.useRef(null),x=ke.useRef(new Map).current;return ke.createElement(i,{scope:p,itemMap:x,collectionRef:y},g)},a=e+"CollectionSlot",l=ke.forwardRef((f,p)=>{const{scope:g,children:y}=f,x=o(a,g),w=Tt(p,x.collectionRef);return ke.createElement(Mc,{ref:w},y)}),c=e+"CollectionItemSlot",u="data-radix-collection-item",d=ke.forwardRef((f,p)=>{const{scope:g,children:y,...x}=f,w=ke.useRef(null),_=Tt(p,w),S=o(c,g);return ke.useEffect(()=>(S.itemMap.set(w,{ref:w,...x}),()=>void S.itemMap.delete(w))),ke.createElement(Mc,{[u]:"",ref:_},y)});function h(f){const p=o(e+"CollectionConsumer",f);return ke.useCallback(()=>{const y=p.collectionRef.current;if(!y)return[];const x=Array.from(y.querySelectorAll(`[${u}]`));return Array.from(p.itemMap.values()).sort((S,T)=>x.indexOf(S.ref.current)-x.indexOf(T.ref.current))},[p.collectionRef,p.itemMap])}return[{Provider:s,Slot:l,ItemSlot:d},h,r]}const Tne=b.createContext(void 0);function L_(e){const t=b.useContext(Tne);return e||t||"ltr"}const Pne=["top","right","bottom","left"],Gs=Math.min,Tr=Math.max,fm=Math.round,op=Math.floor,Xs=e=>({x:e,y:e}),Ine={left:"right",right:"left",bottom:"top",top:"bottom"},$ne={start:"end",end:"start"};function Ab(e,t,n){return Tr(e,Gs(t,n))}function Uo(e,t){return typeof e=="function"?e(t):e}function Wo(e){return e.split("-")[0]}function eu(e){return e.split("-")[1]}function B_(e){return e==="x"?"y":"x"}function R_(e){return e==="y"?"height":"width"}function tu(e){return["top","bottom"].includes(Wo(e))?"y":"x"}function D_(e){return B_(tu(e))}function Ane(e,t,n){n===void 0&&(n=!1);const r=eu(e),i=D_(e),o=R_(i);let s=i==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return t.reference[o]>t.floating[o]&&(s=pm(s)),[s,pm(s)]}function Mne(e){const t=pm(e);return[Mb(e),t,Mb(t)]}function Mb(e){return e.replace(/start|end/g,t=>$ne[t])}function One(e,t,n){const r=["left","right"],i=["right","left"],o=["top","bottom"],s=["bottom","top"];switch(e){case"top":case"bottom":return n?t?i:r:t?r:i;case"left":case"right":return t?o:s;default:return[]}}function Lne(e,t,n,r){const i=eu(e);let o=One(Wo(e),n==="start",r);return i&&(o=o.map(s=>s+"-"+i),t&&(o=o.concat(o.map(Mb)))),o}function pm(e){return e.replace(/left|right|bottom|top/g,t=>Ine[t])}function Bne(e){return{top:0,right:0,bottom:0,left:0,...e}}function wO(e){return typeof e!="number"?Bne(e):{top:e,right:e,bottom:e,left:e}}function gm(e){return{...e,top:e.y,left:e.x,right:e.x+e.width,bottom:e.y+e.height}}function tP(e,t,n){let{reference:r,floating:i}=e;const o=tu(t),s=D_(t),a=R_(s),l=Wo(t),c=o==="y",u=r.x+r.width/2-i.width/2,d=r.y+r.height/2-i.height/2,h=r[a]/2-i[a]/2;let f;switch(l){case"top":f={x:u,y:r.y-i.height};break;case"bottom":f={x:u,y:r.y+r.height};break;case"right":f={x:r.x+r.width,y:d};break;case"left":f={x:r.x-i.width,y:d};break;default:f={x:r.x,y:r.y}}switch(eu(t)){case"start":f[s]-=h*(n&&c?-1:1);break;case"end":f[s]+=h*(n&&c?-1:1);break}return f}const Rne=async(e,t,n)=>{const{placement:r="bottom",strategy:i="absolute",middleware:o=[],platform:s}=n,a=o.filter(Boolean),l=await(s.isRTL==null?void 0:s.isRTL(t));let c=await s.getElementRects({reference:e,floating:t,strategy:i}),{x:u,y:d}=tP(c,r,l),h=r,f={},p=0;for(let g=0;g<a.length;g++){const{name:y,fn:x}=a[g],{x:w,y:_,data:S,reset:T}=await x({x:u,y:d,initialPlacement:r,placement:h,strategy:i,middlewareData:f,rects:c,platform:s,elements:{reference:e,floating:t}});if(u=w??u,d=_??d,f={...f,[y]:{...f[y],...S}},T&&p<=50){p++,typeof T=="object"&&(T.placement&&(h=T.placement),T.rects&&(c=T.rects===!0?await s.getElementRects({reference:e,floating:t,strategy:i}):T.rects),{x:u,y:d}=tP(c,h,l)),g=-1;continue}}return{x:u,y:d,placement:h,strategy:i,middlewareData:f}};async function Jd(e,t){var n;t===void 0&&(t={});const{x:r,y:i,platform:o,rects:s,elements:a,strategy:l}=e,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:h=!1,padding:f=0}=Uo(t,e),p=wO(f),y=a[h?d==="floating"?"reference":"floating":d],x=gm(await o.getClippingRect({element:(n=await(o.isElement==null?void 0:o.isElement(y)))==null||n?y:y.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),w=d==="floating"?{...s.floating,x:r,y:i}:s.reference,_=await(o.getOffsetParent==null?void 0:o.getOffsetParent(a.floating)),S=await(o.isElement==null?void 0:o.isElement(_))?await(o.getScale==null?void 0:o.getScale(_))||{x:1,y:1}:{x:1,y:1},T=gm(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({rect:w,offsetParent:_,strategy:l}):w);return{top:(x.top-T.top+p.top)/S.y,bottom:(T.bottom-x.bottom+p.bottom)/S.y,left:(x.left-T.left+p.left)/S.x,right:(T.right-x.right+p.right)/S.x}}const nP=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:r,placement:i,rects:o,platform:s,elements:a,middlewareData:l}=t,{element:c,padding:u=0}=Uo(e,t)||{};if(c==null)return{};const d=wO(u),h={x:n,y:r},f=D_(i),p=R_(f),g=await s.getDimensions(c),y=f==="y",x=y?"top":"left",w=y?"bottom":"right",_=y?"clientHeight":"clientWidth",S=o.reference[p]+o.reference[f]-h[f]-o.floating[p],T=h[f]-o.reference[f],P=await(s.getOffsetParent==null?void 0:s.getOffsetParent(c));let I=P?P[_]:0;(!I||!await(s.isElement==null?void 0:s.isElement(P)))&&(I=a.floating[_]||o.floating[p]);const $=S/2-T/2,L=I/2-g[p]/2-1,R=Gs(d[x],L),K=Gs(d[w],L),Q=R,j=I-g[p]-K,B=I/2-g[p]/2+$,z=Ab(Q,B,j),q=!l.arrow&&eu(i)!=null&&B!=z&&o.reference[p]/2-(B<Q?R:K)-g[p]/2<0,U=q?B<Q?B-Q:B-j:0;return{[f]:h[f]+U,data:{[f]:z,centerOffset:B-z-U,...q&&{alignmentOffset:U}},reset:q}}}),Dne=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n,r;const{placement:i,middlewareData:o,rects:s,initialPlacement:a,platform:l,elements:c}=t,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:h,fallbackStrategy:f="bestFit",fallbackAxisSideDirection:p="none",flipAlignment:g=!0,...y}=Uo(e,t);if((n=o.arrow)!=null&&n.alignmentOffset)return{};const x=Wo(i),w=Wo(a)===a,_=await(l.isRTL==null?void 0:l.isRTL(c.floating)),S=h||(w||!g?[pm(a)]:Mne(a));!h&&p!=="none"&&S.push(...Lne(a,g,p,_));const T=[a,...S],P=await Jd(t,y),I=[];let $=((r=o.flip)==null?void 0:r.overflows)||[];if(u&&I.push(P[x]),d){const Q=Ane(i,s,_);I.push(P[Q[0]],P[Q[1]])}if($=[...$,{placement:i,overflows:I}],!I.every(Q=>Q<=0)){var L,R;const Q=(((L=o.flip)==null?void 0:L.index)||0)+1,j=T[Q];if(j)return{data:{index:Q,overflows:$},reset:{placement:j}};let B=(R=$.filter(z=>z.overflows[0]<=0).sort((z,q)=>z.overflows[1]-q.overflows[1])[0])==null?void 0:R.placement;if(!B)switch(f){case"bestFit":{var K;const z=(K=$.map(q=>[q.placement,q.overflows.filter(U=>U>0).reduce((U,D)=>U+D,0)]).sort((q,U)=>q[1]-U[1])[0])==null?void 0:K[0];z&&(B=z);break}case"initialPlacement":B=a;break}if(i!==B)return{reset:{placement:B}}}return{}}}};function rP(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function iP(e){return Pne.some(t=>e[t]>=0)}const Fne=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:n}=t,{strategy:r="referenceHidden",...i}=Uo(e,t);switch(r){case"referenceHidden":{const o=await Jd(t,{...i,elementContext:"reference"}),s=rP(o,n.reference);return{data:{referenceHiddenOffsets:s,referenceHidden:iP(s)}}}case"escaped":{const o=await Jd(t,{...i,altBoundary:!0}),s=rP(o,n.floating);return{data:{escapedOffsets:s,escaped:iP(s)}}}default:return{}}}}};async function Nne(e,t){const{placement:n,platform:r,elements:i}=e,o=await(r.isRTL==null?void 0:r.isRTL(i.floating)),s=Wo(n),a=eu(n),l=tu(n)==="y",c=["left","top"].includes(s)?-1:1,u=o&&l?-1:1,d=Uo(t,e);let{mainAxis:h,crossAxis:f,alignmentAxis:p}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...d};return a&&typeof p=="number"&&(f=a==="end"?p*-1:p),l?{x:f*u,y:h*c}:{x:h*c,y:f*u}}const jne=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){const{x:n,y:r}=t,i=await Nne(t,e);return{x:n+i.x,y:r+i.y,data:i}}}},zne=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:r,placement:i}=t,{mainAxis:o=!0,crossAxis:s=!1,limiter:a={fn:y=>{let{x,y:w}=y;return{x,y:w}}},...l}=Uo(e,t),c={x:n,y:r},u=await Jd(t,l),d=tu(Wo(i)),h=B_(d);let f=c[h],p=c[d];if(o){const y=h==="y"?"top":"left",x=h==="y"?"bottom":"right",w=f+u[y],_=f-u[x];f=Ab(w,f,_)}if(s){const y=d==="y"?"top":"left",x=d==="y"?"bottom":"right",w=p+u[y],_=p-u[x];p=Ab(w,p,_)}const g=a.fn({...t,[h]:f,[d]:p});return{...g,data:{x:g.x-n,y:g.y-r}}}}},Une=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:n,y:r,placement:i,rects:o,middlewareData:s}=t,{offset:a=0,mainAxis:l=!0,crossAxis:c=!0}=Uo(e,t),u={x:n,y:r},d=tu(i),h=B_(d);let f=u[h],p=u[d];const g=Uo(a,t),y=typeof g=="number"?{mainAxis:g,crossAxis:0}:{mainAxis:0,crossAxis:0,...g};if(l){const _=h==="y"?"height":"width",S=o.reference[h]-o.floating[_]+y.mainAxis,T=o.reference[h]+o.reference[_]-y.mainAxis;f<S?f=S:f>T&&(f=T)}if(c){var x,w;const _=h==="y"?"width":"height",S=["top","left"].includes(Wo(i)),T=o.reference[d]-o.floating[_]+(S&&((x=s.offset)==null?void 0:x[d])||0)+(S?0:y.crossAxis),P=o.reference[d]+o.reference[_]+(S?0:((w=s.offset)==null?void 0:w[d])||0)-(S?y.crossAxis:0);p<T?p=T:p>P&&(p=P)}return{[h]:f,[d]:p}}}},Wne=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){const{placement:n,rects:r,platform:i,elements:o}=t,{apply:s=()=>{},...a}=Uo(e,t),l=await Jd(t,a),c=Wo(n),u=eu(n),d=tu(n)==="y",{width:h,height:f}=r.floating;let p,g;c==="top"||c==="bottom"?(p=c,g=u===(await(i.isRTL==null?void 0:i.isRTL(o.floating))?"start":"end")?"left":"right"):(g=c,p=u==="end"?"top":"bottom");const y=f-l[p],x=h-l[g],w=!t.middlewareData.shift;let _=y,S=x;if(d){const P=h-l.left-l.right;S=u||w?Gs(x,P):P}else{const P=f-l.top-l.bottom;_=u||w?Gs(y,P):P}if(w&&!u){const P=Tr(l.left,0),I=Tr(l.right,0),$=Tr(l.top,0),L=Tr(l.bottom,0);d?S=h-2*(P!==0||I!==0?P+I:Tr(l.left,l.right)):_=f-2*($!==0||L!==0?$+L:Tr(l.top,l.bottom))}await s({...t,availableWidth:S,availableHeight:_});const T=await i.getDimensions(o.floating);return h!==T.width||f!==T.height?{reset:{rects:!0}}:{}}}};function Zs(e){return SO(e)?(e.nodeName||"").toLowerCase():"#document"}function Or(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function ts(e){var t;return(t=(SO(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function SO(e){return e instanceof Node||e instanceof Or(e).Node}function Ho(e){return e instanceof Element||e instanceof Or(e).Element}function ro(e){return e instanceof HTMLElement||e instanceof Or(e).HTMLElement}function oP(e){return typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Or(e).ShadowRoot}function zh(e){const{overflow:t,overflowX:n,overflowY:r,display:i}=li(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!["inline","contents"].includes(i)}function Hne(e){return["table","td","th"].includes(Zs(e))}function F_(e){const t=N_(),n=li(e);return n.transform!=="none"||n.perspective!=="none"||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||["transform","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function Kne(e){let t=Oc(e);for(;ro(t)&&!jy(t);){if(F_(t))return t;t=Oc(t)}return null}function N_(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function jy(e){return["html","body","#document"].includes(Zs(e))}function li(e){return Or(e).getComputedStyle(e)}function zy(e){return Ho(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function Oc(e){if(Zs(e)==="html")return e;const t=e.assignedSlot||e.parentNode||oP(e)&&e.host||ts(e);return oP(t)?t.host:t}function _O(e){const t=Oc(e);return jy(t)?e.ownerDocument?e.ownerDocument.body:e.body:ro(t)&&zh(t)?t:_O(t)}function eh(e,t,n){var r;t===void 0&&(t=[]),n===void 0&&(n=!0);const i=_O(e),o=i===((r=e.ownerDocument)==null?void 0:r.body),s=Or(i);return o?t.concat(s,s.visualViewport||[],zh(i)?i:[],s.frameElement&&n?eh(s.frameElement):[]):t.concat(i,eh(i,[],n))}function CO(e){const t=li(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const i=ro(e),o=i?e.offsetWidth:n,s=i?e.offsetHeight:r,a=fm(n)!==o||fm(r)!==s;return a&&(n=o,r=s),{width:n,height:r,$:a}}function j_(e){return Ho(e)?e:e.contextElement}function vc(e){const t=j_(e);if(!ro(t))return Xs(1);const n=t.getBoundingClientRect(),{width:r,height:i,$:o}=CO(t);let s=(o?fm(n.width):n.width)/r,a=(o?fm(n.height):n.height)/i;return(!s||!Number.isFinite(s))&&(s=1),(!a||!Number.isFinite(a))&&(a=1),{x:s,y:a}}const Vne=Xs(0);function EO(e){const t=Or(e);return!N_()||!t.visualViewport?Vne:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function Yne(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==Or(e)?!1:t}function Qa(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=!1);const i=e.getBoundingClientRect(),o=j_(e);let s=Xs(1);t&&(r?Ho(r)&&(s=vc(r)):s=vc(e));const a=Yne(o,n,r)?EO(o):Xs(0);let l=(i.left+a.x)/s.x,c=(i.top+a.y)/s.y,u=i.width/s.x,d=i.height/s.y;if(o){const h=Or(o),f=r&&Ho(r)?Or(r):r;let p=h.frameElement;for(;p&&r&&f!==h;){const g=vc(p),y=p.getBoundingClientRect(),x=li(p),w=y.left+(p.clientLeft+parseFloat(x.paddingLeft))*g.x,_=y.top+(p.clientTop+parseFloat(x.paddingTop))*g.y;l*=g.x,c*=g.y,u*=g.x,d*=g.y,l+=w,c+=_,p=Or(p).frameElement}}return gm({width:u,height:d,x:l,y:c})}function qne(e){let{rect:t,offsetParent:n,strategy:r}=e;const i=ro(n),o=ts(n);if(n===o)return t;let s={scrollLeft:0,scrollTop:0},a=Xs(1);const l=Xs(0);if((i||!i&&r!=="fixed")&&((Zs(n)!=="body"||zh(o))&&(s=zy(n)),ro(n))){const c=Qa(n);a=vc(n),l.x=c.x+n.clientLeft,l.y=c.y+n.clientTop}return{width:t.width*a.x,height:t.height*a.y,x:t.x*a.x-s.scrollLeft*a.x+l.x,y:t.y*a.y-s.scrollTop*a.y+l.y}}function Gne(e){return Array.from(e.getClientRects())}function kO(e){return Qa(ts(e)).left+zy(e).scrollLeft}function Xne(e){const t=ts(e),n=zy(e),r=e.ownerDocument.body,i=Tr(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),o=Tr(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let s=-n.scrollLeft+kO(e);const a=-n.scrollTop;return li(r).direction==="rtl"&&(s+=Tr(t.clientWidth,r.clientWidth)-i),{width:i,height:o,x:s,y:a}}function Zne(e,t){const n=Or(e),r=ts(e),i=n.visualViewport;let o=r.clientWidth,s=r.clientHeight,a=0,l=0;if(i){o=i.width,s=i.height;const c=N_();(!c||c&&t==="fixed")&&(a=i.offsetLeft,l=i.offsetTop)}return{width:o,height:s,x:a,y:l}}function Qne(e,t){const n=Qa(e,!0,t==="fixed"),r=n.top+e.clientTop,i=n.left+e.clientLeft,o=ro(e)?vc(e):Xs(1),s=e.clientWidth*o.x,a=e.clientHeight*o.y,l=i*o.x,c=r*o.y;return{width:s,height:a,x:l,y:c}}function sP(e,t,n){let r;if(t==="viewport")r=Zne(e,n);else if(t==="document")r=Xne(ts(e));else if(Ho(t))r=Qne(t,n);else{const i=EO(e);r={...t,x:t.x-i.x,y:t.y-i.y}}return gm(r)}function TO(e,t){const n=Oc(e);return n===t||!Ho(n)||jy(n)?!1:li(n).position==="fixed"||TO(n,t)}function Jne(e,t){const n=t.get(e);if(n)return n;let r=eh(e,[],!1).filter(a=>Ho(a)&&Zs(a)!=="body"),i=null;const o=li(e).position==="fixed";let s=o?Oc(e):e;for(;Ho(s)&&!jy(s);){const a=li(s),l=F_(s);!l&&a.position==="fixed"&&(i=null),(o?!l&&!i:!l&&a.position==="static"&&!!i&&["absolute","fixed"].includes(i.position)||zh(s)&&!l&&TO(e,s))?r=r.filter(u=>u!==s):i=a,s=Oc(s)}return t.set(e,r),r}function ere(e){let{element:t,boundary:n,rootBoundary:r,strategy:i}=e;const s=[...n==="clippingAncestors"?Jne(t,this._c):[].concat(n),r],a=s[0],l=s.reduce((c,u)=>{const d=sP(t,u,i);return c.top=Tr(d.top,c.top),c.right=Gs(d.right,c.right),c.bottom=Gs(d.bottom,c.bottom),c.left=Tr(d.left,c.left),c},sP(t,a,i));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function tre(e){return CO(e)}function nre(e,t,n){const r=ro(t),i=ts(t),o=n==="fixed",s=Qa(e,!0,o,t);let a={scrollLeft:0,scrollTop:0};const l=Xs(0);if(r||!r&&!o)if((Zs(t)!=="body"||zh(i))&&(a=zy(t)),r){const c=Qa(t,!0,o,t);l.x=c.x+t.clientLeft,l.y=c.y+t.clientTop}else i&&(l.x=kO(i));return{x:s.left+a.scrollLeft-l.x,y:s.top+a.scrollTop-l.y,width:s.width,height:s.height}}function aP(e,t){return!ro(e)||li(e).position==="fixed"?null:t?t(e):e.offsetParent}function PO(e,t){const n=Or(e);if(!ro(e))return n;let r=aP(e,t);for(;r&&Hne(r)&&li(r).position==="static";)r=aP(r,t);return r&&(Zs(r)==="html"||Zs(r)==="body"&&li(r).position==="static"&&!F_(r))?n:r||Kne(e)||n}const rre=async function(e){let{reference:t,floating:n,strategy:r}=e;const i=this.getOffsetParent||PO,o=this.getDimensions;return{reference:nre(t,await i(n),r),floating:{x:0,y:0,...await o(n)}}};function ire(e){return li(e).direction==="rtl"}const ore={convertOffsetParentRelativeRectToViewportRelativeRect:qne,getDocumentElement:ts,getClippingRect:ere,getOffsetParent:PO,getElementRects:rre,getClientRects:Gne,getDimensions:tre,getScale:vc,isElement:Ho,isRTL:ire};function sre(e,t){let n=null,r;const i=ts(e);function o(){clearTimeout(r),n&&n.disconnect(),n=null}function s(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),o();const{left:c,top:u,width:d,height:h}=e.getBoundingClientRect();if(a||t(),!d||!h)return;const f=op(u),p=op(i.clientWidth-(c+d)),g=op(i.clientHeight-(u+h)),y=op(c),w={rootMargin:-f+"px "+-p+"px "+-g+"px "+-y+"px",threshold:Tr(0,Gs(1,l))||1};let _=!0;function S(T){const P=T[0].intersectionRatio;if(P!==l){if(!_)return s();P?s(!1,P):r=setTimeout(()=>{s(!1,1e-7)},100)}_=!1}try{n=new IntersectionObserver(S,{...w,root:i.ownerDocument})}catch{n=new IntersectionObserver(S,w)}n.observe(e)}return s(!0),o}function are(e,t,n,r){r===void 0&&(r={});const{ancestorScroll:i=!0,ancestorResize:o=!0,elementResize:s=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=r,c=j_(e),u=i||o?[...c?eh(c):[],...eh(t)]:[];u.forEach(x=>{i&&x.addEventListener("scroll",n,{passive:!0}),o&&x.addEventListener("resize",n)});const d=c&&a?sre(c,n):null;let h=-1,f=null;s&&(f=new ResizeObserver(x=>{let[w]=x;w&&w.target===c&&f&&(f.unobserve(t),cancelAnimationFrame(h),h=requestAnimationFrame(()=>{f&&f.observe(t)})),n()}),c&&!l&&f.observe(c),f.observe(t));let p,g=l?Qa(e):null;l&&y();function y(){const x=Qa(e);g&&(x.x!==g.x||x.y!==g.y||x.width!==g.width||x.height!==g.height)&&n(),g=x,p=requestAnimationFrame(y)}return n(),()=>{u.forEach(x=>{i&&x.removeEventListener("scroll",n),o&&x.removeEventListener("resize",n)}),d&&d(),f&&f.disconnect(),f=null,l&&cancelAnimationFrame(p)}}const lre=(e,t,n)=>{const r=new Map,i={platform:ore,...n},o={...i.platform,_c:r};return Rne(e,t,{...i,platform:o})},cre=e=>{function t(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:e,fn(n){const{element:r,padding:i}=typeof e=="function"?e(n):e;return r&&t(r)?r.current!=null?nP({element:r.current,padding:i}).fn(n):{}:r?nP({element:r,padding:i}).fn(n):{}}}};var og=typeof document<"u"?b.useLayoutEffect:b.useEffect;function mm(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let n,r,i;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(n=e.length,n!=t.length)return!1;for(r=n;r--!==0;)if(!mm(e[r],t[r]))return!1;return!0}if(i=Object.keys(e),n=i.length,n!==Object.keys(t).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(t,i[r]))return!1;for(r=n;r--!==0;){const o=i[r];if(!(o==="_owner"&&e.$$typeof)&&!mm(e[o],t[o]))return!1}return!0}return e!==e&&t!==t}function IO(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function lP(e,t){const n=IO(e);return Math.round(t*n)/n}function cP(e){const t=b.useRef(e);return og(()=>{t.current=e}),t}function ure(e){e===void 0&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:r=[],platform:i,elements:{reference:o,floating:s}={},transform:a=!0,whileElementsMounted:l,open:c}=e,[u,d]=b.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[h,f]=b.useState(r);mm(h,r)||f(r);const[p,g]=b.useState(null),[y,x]=b.useState(null),w=b.useCallback(q=>{q!=P.current&&(P.current=q,g(q))},[g]),_=b.useCallback(q=>{q!==I.current&&(I.current=q,x(q))},[x]),S=o||p,T=s||y,P=b.useRef(null),I=b.useRef(null),$=b.useRef(u),L=cP(l),R=cP(i),K=b.useCallback(()=>{if(!P.current||!I.current)return;const q={placement:t,strategy:n,middleware:h};R.current&&(q.platform=R.current),lre(P.current,I.current,q).then(U=>{const D={...U,isPositioned:!0};Q.current&&!mm($.current,D)&&($.current=D,Yo.flushSync(()=>{d(D)}))})},[h,t,n,R]);og(()=>{c===!1&&$.current.isPositioned&&($.current.isPositioned=!1,d(q=>({...q,isPositioned:!1})))},[c]);const Q=b.useRef(!1);og(()=>(Q.current=!0,()=>{Q.current=!1}),[]),og(()=>{if(S&&(P.current=S),T&&(I.current=T),S&&T){if(L.current)return L.current(S,T,K);K()}},[S,T,K,L]);const j=b.useMemo(()=>({reference:P,floating:I,setReference:w,setFloating:_}),[w,_]),B=b.useMemo(()=>({reference:S,floating:T}),[S,T]),z=b.useMemo(()=>{const q={position:n,left:0,top:0};if(!B.floating)return q;const U=lP(B.floating,u.x),D=lP(B.floating,u.y);return a?{...q,transform:"translate("+U+"px, "+D+"px)",...IO(B.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:U,top:D}},[n,a,B.floating,u.x,u.y]);return b.useMemo(()=>({...u,update:K,refs:j,elements:B,floatingStyles:z}),[u,K,j,B,z])}function $O(e){const[t,n]=b.useState(void 0);return Za(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});const r=new ResizeObserver(i=>{if(!Array.isArray(i)||!i.length)return;const o=i[0];let s,a;if("borderBoxSize"in o){const l=o.borderBoxSize,c=Array.isArray(l)?l[0]:l;s=c.inlineSize,a=c.blockSize}else s=e.offsetWidth,a=e.offsetHeight;n({width:s,height:a})});return r.observe(e,{box:"border-box"}),()=>r.unobserve(e)}else n(void 0)},[e]),t}const AO="Popper",[MO,OO]=Qo(AO),[dre,LO]=MO(AO),hre=e=>{const{__scopePopper:t,children:n}=e,[r,i]=b.useState(null);return b.createElement(dre,{scope:t,anchor:r,onAnchorChange:i},n)},fre="PopperAnchor",pre=b.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...i}=e,o=LO(fre,n),s=b.useRef(null),a=Tt(t,s);return b.useEffect(()=>{o.onAnchorChange((r==null?void 0:r.current)||s.current)}),r?null:b.createElement(lt.div,oe({},i,{ref:a}))}),BO="PopperContent",[gre,Owe]=MO(BO),mre=b.forwardRef((e,t)=>{var n,r,i,o,s,a,l,c;const{__scopePopper:u,side:d="bottom",sideOffset:h=0,align:f="center",alignOffset:p=0,arrowPadding:g=0,collisionBoundary:y=[],collisionPadding:x=0,sticky:w="partial",hideWhenDetached:_=!1,avoidCollisions:S=!0,onPlaced:T,...P}=e,I=LO(BO,u),[$,L]=b.useState(null),R=Tt(t,_t=>L(_t)),[K,Q]=b.useState(null),j=$O(K),B=(n=j==null?void 0:j.width)!==null&&n!==void 0?n:0,z=(r=j==null?void 0:j.height)!==null&&r!==void 0?r:0,q=d+(f!=="center"?"-"+f:""),U=typeof x=="number"?x:{top:0,right:0,bottom:0,left:0,...x},D=Array.isArray(y)?y:[y],F=D.length>0,J={padding:U,boundary:D.filter(yre),altBoundary:F},{refs:Z,floatingStyles:ne,placement:de,isPositioned:Ce,middlewareData:he}=ure({strategy:"fixed",placement:q,whileElementsMounted:are,elements:{reference:I.anchor},middleware:[jne({mainAxis:h+z,alignmentAxis:p}),S&&zne({mainAxis:!0,crossAxis:!1,limiter:w==="partial"?Une():void 0,...J}),S&&Dne({...J}),Wne({...J,apply:({elements:_t,rects:jn,availableWidth:Sn,availableHeight:Zt})=>{const{width:_n,height:Cn}=jn.reference,Rt=_t.floating.style;Rt.setProperty("--radix-popper-available-width",`${Sn}px`),Rt.setProperty("--radix-popper-available-height",`${Zt}px`),Rt.setProperty("--radix-popper-anchor-width",`${_n}px`),Rt.setProperty("--radix-popper-anchor-height",`${Cn}px`)}}),K&&cre({element:K,padding:g}),vre({arrowWidth:B,arrowHeight:z}),_&&Fne({strategy:"referenceHidden"})]}),[je,$e]=RO(de),Ee=Fn(T);Za(()=>{Ce&&(Ee==null||Ee())},[Ce,Ee]);const Ie=(i=he.arrow)===null||i===void 0?void 0:i.x,Fe=(o=he.arrow)===null||o===void 0?void 0:o.y,ct=((s=he.arrow)===null||s===void 0?void 0:s.centerOffset)!==0,[mt,Wt]=b.useState();return Za(()=>{$&&Wt(window.getComputedStyle($).zIndex)},[$]),b.createElement("div",{ref:Z.setFloating,"data-radix-popper-content-wrapper":"",style:{...ne,transform:Ce?ne.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:mt,"--radix-popper-transform-origin":[(a=he.transformOrigin)===null||a===void 0?void 0:a.x,(l=he.transformOrigin)===null||l===void 0?void 0:l.y].join(" ")},dir:e.dir},b.createElement(gre,{scope:u,placedSide:je,onArrowChange:Q,arrowX:Ie,arrowY:Fe,shouldHideArrow:ct},b.createElement(lt.div,oe({"data-side":je,"data-align":$e},P,{ref:R,style:{...P.style,animation:Ce?void 0:"none",opacity:(c=he.hide)!==null&&c!==void 0&&c.referenceHidden?0:void 0}}))))});function yre(e){return e!==null}const vre=e=>({name:"transformOrigin",options:e,fn(t){var n,r,i,o,s;const{placement:a,rects:l,middlewareData:c}=t,d=((n=c.arrow)===null||n===void 0?void 0:n.centerOffset)!==0,h=d?0:e.arrowWidth,f=d?0:e.arrowHeight,[p,g]=RO(a),y={start:"0%",center:"50%",end:"100%"}[g],x=((r=(i=c.arrow)===null||i===void 0?void 0:i.x)!==null&&r!==void 0?r:0)+h/2,w=((o=(s=c.arrow)===null||s===void 0?void 0:s.y)!==null&&o!==void 0?o:0)+f/2;let _="",S="";return p==="bottom"?(_=d?y:`${x}px`,S=`${-f}px`):p==="top"?(_=d?y:`${x}px`,S=`${l.floating.height+f}px`):p==="right"?(_=`${-f}px`,S=d?y:`${w}px`):p==="left"&&(_=`${l.floating.width+f}px`,S=d?y:`${w}px`),{data:{x:_,y:S}}}});function RO(e){const[t,n="center"]=e.split("-");return[t,n]}const DO=hre,xre=pre,bre=mre,n1="rovingFocusGroup.onEntryFocus",wre={bubbles:!1,cancelable:!0},z_="RovingFocusGroup",[Ob,FO,Sre]=Ny(z_),[_re,NO]=Qo(z_,[Sre]),[Cre,Ere]=_re(z_),kre=b.forwardRef((e,t)=>b.createElement(Ob.Provider,{scope:e.__scopeRovingFocusGroup},b.createElement(Ob.Slot,{scope:e.__scopeRovingFocusGroup},b.createElement(Tre,oe({},e,{ref:t}))))),Tre=b.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:i=!1,dir:o,currentTabStopId:s,defaultCurrentTabStopId:a,onCurrentTabStopIdChange:l,onEntryFocus:c,...u}=e,d=b.useRef(null),h=Tt(t,d),f=L_(o),[p=null,g]=ul({prop:s,defaultProp:a,onChange:l}),[y,x]=b.useState(!1),w=Fn(c),_=FO(n),S=b.useRef(!1),[T,P]=b.useState(0);return b.useEffect(()=>{const I=d.current;if(I)return I.addEventListener(n1,w),()=>I.removeEventListener(n1,w)},[w]),b.createElement(Cre,{scope:n,orientation:r,dir:f,loop:i,currentTabStopId:p,onItemFocus:b.useCallback(I=>g(I),[g]),onItemShiftTab:b.useCallback(()=>x(!0),[]),onFocusableItemAdd:b.useCallback(()=>P(I=>I+1),[]),onFocusableItemRemove:b.useCallback(()=>P(I=>I-1),[])},b.createElement(lt.div,oe({tabIndex:y||T===0?-1:0,"data-orientation":r},u,{ref:h,style:{outline:"none",...e.style},onMouseDown:we(e.onMouseDown,()=>{S.current=!0}),onFocus:we(e.onFocus,I=>{const $=!S.current;if(I.target===I.currentTarget&&$&&!y){const L=new CustomEvent(n1,wre);if(I.currentTarget.dispatchEvent(L),!L.defaultPrevented){const R=_().filter(z=>z.focusable),K=R.find(z=>z.active),Q=R.find(z=>z.id===p),B=[K,Q,...R].filter(Boolean).map(z=>z.ref.current);jO(B)}}S.current=!1}),onBlur:we(e.onBlur,()=>x(!1))})))}),Pre="RovingFocusGroupItem",Ire=b.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:i=!1,tabStopId:o,...s}=e,a=Ws(),l=o||a,c=Ere(Pre,n),u=c.currentTabStopId===l,d=FO(n),{onFocusableItemAdd:h,onFocusableItemRemove:f}=c;return b.useEffect(()=>{if(r)return h(),()=>f()},[r,h,f]),b.createElement(Ob.ItemSlot,{scope:n,id:l,focusable:r,active:i},b.createElement(lt.span,oe({tabIndex:u?0:-1,"data-orientation":c.orientation},s,{ref:t,onMouseDown:we(e.onMouseDown,p=>{r?c.onItemFocus(l):p.preventDefault()}),onFocus:we(e.onFocus,()=>c.onItemFocus(l)),onKeyDown:we(e.onKeyDown,p=>{if(p.key==="Tab"&&p.shiftKey){c.onItemShiftTab();return}if(p.target!==p.currentTarget)return;const g=Mre(p,c.orientation,c.dir);if(g!==void 0){p.preventDefault();let x=d().filter(w=>w.focusable).map(w=>w.ref.current);if(g==="last")x.reverse();else if(g==="prev"||g==="next"){g==="prev"&&x.reverse();const w=x.indexOf(p.currentTarget);x=c.loop?Ore(x,w+1):x.slice(w+1)}setTimeout(()=>jO(x))}})})))}),$re={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function Are(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function Mre(e,t,n){const r=Are(e.key,n);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return $re[r]}function jO(e){const t=document.activeElement;for(const n of e)if(n===t||(n.focus(),document.activeElement!==t))return}function Ore(e,t){return e.map((n,r)=>e[(t+r)%e.length])}const Lre=kre,Bre=Ire,Lb=["Enter"," "],Rre=["ArrowDown","PageUp","Home"],zO=["ArrowUp","PageDown","End"],Dre=[...Rre,...zO],Fre={ltr:[...Lb,"ArrowRight"],rtl:[...Lb,"ArrowLeft"]},Nre={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Uy="Menu",[th,jre,zre]=Ny(Uy),[dl,Wy]=Qo(Uy,[zre,OO,NO]),Hy=OO(),UO=NO(),[WO,da]=dl(Uy),[Ure,Uh]=dl(Uy),Wre=e=>{const{__scopeMenu:t,open:n=!1,children:r,dir:i,onOpenChange:o,modal:s=!0}=e,a=Hy(t),[l,c]=b.useState(null),u=b.useRef(!1),d=Fn(o),h=L_(i);return b.useEffect(()=>{const f=()=>{u.current=!0,document.addEventListener("pointerdown",p,{capture:!0,once:!0}),document.addEventListener("pointermove",p,{capture:!0,once:!0})},p=()=>u.current=!1;return document.addEventListener("keydown",f,{capture:!0}),()=>{document.removeEventListener("keydown",f,{capture:!0}),document.removeEventListener("pointerdown",p,{capture:!0}),document.removeEventListener("pointermove",p,{capture:!0})}},[]),b.createElement(DO,a,b.createElement(WO,{scope:t,open:n,onOpenChange:d,content:l,onContentChange:c},b.createElement(Ure,{scope:t,onClose:b.useCallback(()=>d(!1),[d]),isUsingKeyboardRef:u,dir:h,modal:s},r)))},HO=b.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,i=Hy(n);return b.createElement(xre,oe({},i,r,{ref:t}))}),KO="MenuPortal",[Hre,VO]=dl(KO,{forceMount:void 0}),Kre=e=>{const{__scopeMenu:t,forceMount:n,children:r,container:i}=e,o=da(KO,t);return b.createElement(Hre,{scope:t,forceMount:n},b.createElement(Jo,{present:n||o.open},b.createElement(I_,{asChild:!0,container:i},r)))},Mi="MenuContent",[Vre,U_]=dl(Mi),Yre=b.forwardRef((e,t)=>{const n=VO(Mi,e.__scopeMenu),{forceMount:r=n.forceMount,...i}=e,o=da(Mi,e.__scopeMenu),s=Uh(Mi,e.__scopeMenu);return b.createElement(th.Provider,{scope:e.__scopeMenu},b.createElement(Jo,{present:r||o.open},b.createElement(th.Slot,{scope:e.__scopeMenu},s.modal?b.createElement(qre,oe({},i,{ref:t})):b.createElement(Gre,oe({},i,{ref:t})))))}),qre=b.forwardRef((e,t)=>{const n=da(Mi,e.__scopeMenu),r=b.useRef(null),i=Tt(t,r);return b.useEffect(()=>{const o=r.current;if(o)return A_(o)},[]),b.createElement(W_,oe({},e,{ref:i,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:we(e.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)}))}),Gre=b.forwardRef((e,t)=>{const n=da(Mi,e.__scopeMenu);return b.createElement(W_,oe({},e,{ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)}))}),W_=b.forwardRef((e,t)=>{const{__scopeMenu:n,loop:r=!1,trapFocus:i,onOpenAutoFocus:o,onCloseAutoFocus:s,disableOutsidePointerEvents:a,onEntryFocus:l,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:h,onDismiss:f,disableOutsideScroll:p,...g}=e,y=da(Mi,n),x=Uh(Mi,n),w=Hy(n),_=UO(n),S=jre(n),[T,P]=b.useState(null),I=b.useRef(null),$=Tt(t,I,y.onContentChange),L=b.useRef(0),R=b.useRef(""),K=b.useRef(0),Q=b.useRef(null),j=b.useRef("right"),B=b.useRef(0),z=p?$_:b.Fragment,q=p?{as:Mc,allowPinchZoom:!0}:void 0,U=F=>{var J,Z;const ne=R.current+F,de=S().filter(Ie=>!Ie.disabled),Ce=document.activeElement,he=(J=de.find(Ie=>Ie.ref.current===Ce))===null||J===void 0?void 0:J.textValue,je=de.map(Ie=>Ie.textValue),$e=cie(je,ne,he),Ee=(Z=de.find(Ie=>Ie.textValue===$e))===null||Z===void 0?void 0:Z.ref.current;(function Ie(Fe){R.current=Fe,window.clearTimeout(L.current),Fe!==""&&(L.current=window.setTimeout(()=>Ie(""),1e3))})(ne),Ee&&setTimeout(()=>Ee.focus())};b.useEffect(()=>()=>window.clearTimeout(L.current),[]),eO();const D=b.useCallback(F=>{var J,Z;return j.current===((J=Q.current)===null||J===void 0?void 0:J.side)&&die(F,(Z=Q.current)===null||Z===void 0?void 0:Z.area)},[]);return b.createElement(Vre,{scope:n,searchRef:R,onItemEnter:b.useCallback(F=>{D(F)&&F.preventDefault()},[D]),onItemLeave:b.useCallback(F=>{var J;D(F)||((J=I.current)===null||J===void 0||J.focus(),P(null))},[D]),onTriggerLeave:b.useCallback(F=>{D(F)&&F.preventDefault()},[D]),pointerGraceTimerRef:K,onPointerGraceIntentChange:b.useCallback(F=>{Q.current=F},[])},b.createElement(z,q,b.createElement(Q6,{asChild:!0,trapped:i,onMountAutoFocus:we(o,F=>{var J;F.preventDefault(),(J=I.current)===null||J===void 0||J.focus()}),onUnmountAutoFocus:s},b.createElement(P_,{asChild:!0,disableOutsidePointerEvents:a,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:h,onDismiss:f},b.createElement(Lre,oe({asChild:!0},_,{dir:x.dir,orientation:"vertical",loop:r,currentTabStopId:T,onCurrentTabStopIdChange:P,onEntryFocus:we(l,F=>{x.isUsingKeyboardRef.current||F.preventDefault()})}),b.createElement(bre,oe({role:"menu","aria-orientation":"vertical","data-state":QO(y.open),"data-radix-menu-content":"",dir:x.dir},w,g,{ref:$,style:{outline:"none",...g.style},onKeyDown:we(g.onKeyDown,F=>{const Z=F.target.closest("[data-radix-menu-content]")===F.currentTarget,ne=F.ctrlKey||F.altKey||F.metaKey,de=F.key.length===1;Z&&(F.key==="Tab"&&F.preventDefault(),!ne&&de&&U(F.key));const Ce=I.current;if(F.target!==Ce||!Dre.includes(F.key))return;F.preventDefault();const je=S().filter($e=>!$e.disabled).map($e=>$e.ref.current);zO.includes(F.key)&&je.reverse(),aie(je)}),onBlur:we(e.onBlur,F=>{F.currentTarget.contains(F.target)||(window.clearTimeout(L.current),R.current="")}),onPointerMove:we(e.onPointerMove,nh(F=>{const J=F.target,Z=B.current!==F.clientX;if(F.currentTarget.contains(J)&&Z){const ne=F.clientX>B.current?"right":"left";j.current=ne,B.current=F.clientX}}))})))))))}),Xre=b.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return b.createElement(lt.div,oe({role:"group"},r,{ref:t}))}),Bb="MenuItem",uP="menu.itemSelect",YO=b.forwardRef((e,t)=>{const{disabled:n=!1,onSelect:r,...i}=e,o=b.useRef(null),s=Uh(Bb,e.__scopeMenu),a=U_(Bb,e.__scopeMenu),l=Tt(t,o),c=b.useRef(!1),u=()=>{const d=o.current;if(!n&&d){const h=new CustomEvent(uP,{bubbles:!0,cancelable:!0});d.addEventListener(uP,f=>r==null?void 0:r(f),{once:!0}),T_(d,h),h.defaultPrevented?c.current=!1:s.onClose()}};return b.createElement(qO,oe({},i,{ref:l,disabled:n,onClick:we(e.onClick,u),onPointerDown:d=>{var h;(h=e.onPointerDown)===null||h===void 0||h.call(e,d),c.current=!0},onPointerUp:we(e.onPointerUp,d=>{var h;c.current||(h=d.currentTarget)===null||h===void 0||h.click()}),onKeyDown:we(e.onKeyDown,d=>{const h=a.searchRef.current!=="";n||h&&d.key===" "||Lb.includes(d.key)&&(d.currentTarget.click(),d.preventDefault())})}))}),qO=b.forwardRef((e,t)=>{const{__scopeMenu:n,disabled:r=!1,textValue:i,...o}=e,s=U_(Bb,n),a=UO(n),l=b.useRef(null),c=Tt(t,l),[u,d]=b.useState(!1),[h,f]=b.useState("");return b.useEffect(()=>{const p=l.current;if(p){var g;f(((g=p.textContent)!==null&&g!==void 0?g:"").trim())}},[o.children]),b.createElement(th.ItemSlot,{scope:n,disabled:r,textValue:i??h},b.createElement(Bre,oe({asChild:!0},a,{focusable:!r}),b.createElement(lt.div,oe({role:"menuitem","data-highlighted":u?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0},o,{ref:c,onPointerMove:we(e.onPointerMove,nh(p=>{r?s.onItemLeave(p):(s.onItemEnter(p),p.defaultPrevented||p.currentTarget.focus())})),onPointerLeave:we(e.onPointerLeave,nh(p=>s.onItemLeave(p))),onFocus:we(e.onFocus,()=>d(!0)),onBlur:we(e.onBlur,()=>d(!1))}))))}),Zre=b.forwardRef((e,t)=>{const{checked:n=!1,onCheckedChange:r,...i}=e;return b.createElement(Jre,{scope:e.__scopeMenu,checked:n},b.createElement(YO,oe({role:"menuitemcheckbox","aria-checked":ym(n)?"mixed":n},i,{ref:t,"data-state":JO(n),onSelect:we(i.onSelect,()=>r==null?void 0:r(ym(n)?!0:!n),{checkForDefaultPrevented:!1})})))}),Qre="MenuRadioGroup";dl(Qre,{value:void 0,onValueChange:()=>{}});const GO="MenuItemIndicator",[Jre,eie]=dl(GO,{checked:!1}),tie=b.forwardRef((e,t)=>{const{__scopeMenu:n,forceMount:r,...i}=e,o=eie(GO,n);return b.createElement(Jo,{present:r||ym(o.checked)||o.checked===!0},b.createElement(lt.span,oe({},i,{ref:t,"data-state":JO(o.checked)})))}),XO="MenuSub",[nie,ZO]=dl(XO),rie=e=>{const{__scopeMenu:t,children:n,open:r=!1,onOpenChange:i}=e,o=da(XO,t),s=Hy(t),[a,l]=b.useState(null),[c,u]=b.useState(null),d=Fn(i);return b.useEffect(()=>(o.open===!1&&d(!1),()=>d(!1)),[o.open,d]),b.createElement(DO,s,b.createElement(WO,{scope:t,open:r,onOpenChange:d,content:c,onContentChange:u},b.createElement(nie,{scope:t,contentId:Ws(),triggerId:Ws(),trigger:a,onTriggerChange:l},n)))},sp="MenuSubTrigger",iie=b.forwardRef((e,t)=>{const n=da(sp,e.__scopeMenu),r=Uh(sp,e.__scopeMenu),i=ZO(sp,e.__scopeMenu),o=U_(sp,e.__scopeMenu),s=b.useRef(null),{pointerGraceTimerRef:a,onPointerGraceIntentChange:l}=o,c={__scopeMenu:e.__scopeMenu},u=b.useCallback(()=>{s.current&&window.clearTimeout(s.current),s.current=null},[]);return b.useEffect(()=>u,[u]),b.useEffect(()=>{const d=a.current;return()=>{window.clearTimeout(d),l(null)}},[a,l]),b.createElement(HO,oe({asChild:!0},c),b.createElement(qO,oe({id:i.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":i.contentId,"data-state":QO(n.open)},e,{ref:Oy(t,i.onTriggerChange),onClick:d=>{var h;(h=e.onClick)===null||h===void 0||h.call(e,d),!(e.disabled||d.defaultPrevented)&&(d.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:we(e.onPointerMove,nh(d=>{o.onItemEnter(d),!d.defaultPrevented&&!e.disabled&&!n.open&&!s.current&&(o.onPointerGraceIntentChange(null),s.current=window.setTimeout(()=>{n.onOpenChange(!0),u()},100))})),onPointerLeave:we(e.onPointerLeave,nh(d=>{var h;u();const f=(h=n.content)===null||h===void 0?void 0:h.getBoundingClientRect();if(f){var p;const g=(p=n.content)===null||p===void 0?void 0:p.dataset.side,y=g==="right",x=y?-5:5,w=f[y?"left":"right"],_=f[y?"right":"left"];o.onPointerGraceIntentChange({area:[{x:d.clientX+x,y:d.clientY},{x:w,y:f.top},{x:_,y:f.top},{x:_,y:f.bottom},{x:w,y:f.bottom}],side:g}),window.clearTimeout(a.current),a.current=window.setTimeout(()=>o.onPointerGraceIntentChange(null),300)}else{if(o.onTriggerLeave(d),d.defaultPrevented)return;o.onPointerGraceIntentChange(null)}})),onKeyDown:we(e.onKeyDown,d=>{const h=o.searchRef.current!=="";if(!(e.disabled||h&&d.key===" ")&&Fre[r.dir].includes(d.key)){var f;n.onOpenChange(!0),(f=n.content)===null||f===void 0||f.focus(),d.preventDefault()}})})))}),oie="MenuSubContent",sie=b.forwardRef((e,t)=>{const n=VO(Mi,e.__scopeMenu),{forceMount:r=n.forceMount,...i}=e,o=da(Mi,e.__scopeMenu),s=Uh(Mi,e.__scopeMenu),a=ZO(oie,e.__scopeMenu),l=b.useRef(null),c=Tt(t,l);return b.createElement(th.Provider,{scope:e.__scopeMenu},b.createElement(Jo,{present:r||o.open},b.createElement(th.Slot,{scope:e.__scopeMenu},b.createElement(W_,oe({id:a.contentId,"aria-labelledby":a.triggerId},i,{ref:c,align:"start",side:s.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:u=>{var d;s.isUsingKeyboardRef.current&&((d=l.current)===null||d===void 0||d.focus()),u.preventDefault()},onCloseAutoFocus:u=>u.preventDefault(),onFocusOutside:we(e.onFocusOutside,u=>{u.target!==a.trigger&&o.onOpenChange(!1)}),onEscapeKeyDown:we(e.onEscapeKeyDown,u=>{s.onClose(),u.preventDefault()}),onKeyDown:we(e.onKeyDown,u=>{const d=u.currentTarget.contains(u.target),h=Nre[s.dir].includes(u.key);if(d&&h){var f;o.onOpenChange(!1),(f=a.trigger)===null||f===void 0||f.focus(),u.preventDefault()}})})))))});function QO(e){return e?"open":"closed"}function ym(e){return e==="indeterminate"}function JO(e){return ym(e)?"indeterminate":e?"checked":"unchecked"}function aie(e){const t=document.activeElement;for(const n of e)if(n===t||(n.focus(),document.activeElement!==t))return}function lie(e,t){return e.map((n,r)=>e[(t+r)%e.length])}function cie(e,t,n){const i=t.length>1&&Array.from(t).every(c=>c===t[0])?t[0]:t,o=n?e.indexOf(n):-1;let s=lie(e,Math.max(o,0));i.length===1&&(s=s.filter(c=>c!==n));const l=s.find(c=>c.toLowerCase().startsWith(i.toLowerCase()));return l!==n?l:void 0}function uie(e,t){const{x:n,y:r}=e;let i=!1;for(let o=0,s=t.length-1;o<t.length;s=o++){const a=t[o].x,l=t[o].y,c=t[s].x,u=t[s].y;l>r!=u>r&&n<(c-a)*(r-l)/(u-l)+a&&(i=!i)}return i}function die(e,t){if(!t)return!1;const n={x:e.clientX,y:e.clientY};return uie(n,t)}function nh(e){return t=>t.pointerType==="mouse"?e(t):void 0}const e4=Wre,t4=HO,n4=Kre,r4=Yre,i4=Xre,o4=YO,s4=Zre,hie=tie,a4=rie,l4=iie,c4=sie,u4="DropdownMenu",[fie,Lwe]=Qo(u4,[Wy]),Fi=Wy(),[pie,d4]=fie(u4),gie=e=>{const{__scopeDropdownMenu:t,children:n,dir:r,open:i,defaultOpen:o,onOpenChange:s,modal:a=!0}=e,l=Fi(t),c=b.useRef(null),[u=!1,d]=ul({prop:i,defaultProp:o,onChange:s});return b.createElement(pie,{scope:t,triggerId:Ws(),triggerRef:c,contentId:Ws(),open:u,onOpenChange:d,onOpenToggle:b.useCallback(()=>d(h=>!h),[d]),modal:a},b.createElement(e4,oe({},l,{open:u,onOpenChange:d,dir:r,modal:a}),n))},mie="DropdownMenuTrigger",yie=b.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,disabled:r=!1,...i}=e,o=d4(mie,n),s=Fi(n);return b.createElement(t4,oe({asChild:!0},s),b.createElement(lt.button,oe({type:"button",id:o.triggerId,"aria-haspopup":"menu","aria-expanded":o.open,"aria-controls":o.open?o.contentId:void 0,"data-state":o.open?"open":"closed","data-disabled":r?"":void 0,disabled:r},i,{ref:Oy(t,o.triggerRef),onPointerDown:we(e.onPointerDown,a=>{!r&&a.button===0&&a.ctrlKey===!1&&(o.onOpenToggle(),o.open||a.preventDefault())}),onKeyDown:we(e.onKeyDown,a=>{r||(["Enter"," "].includes(a.key)&&o.onOpenToggle(),a.key==="ArrowDown"&&o.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(a.key)&&a.preventDefault())})})))}),vie=e=>{const{__scopeDropdownMenu:t,...n}=e,r=Fi(t);return b.createElement(n4,oe({},r,n))},xie="DropdownMenuContent",bie=b.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,i=d4(xie,n),o=Fi(n),s=b.useRef(!1);return b.createElement(r4,oe({id:i.contentId,"aria-labelledby":i.triggerId},o,r,{ref:t,onCloseAutoFocus:we(e.onCloseAutoFocus,a=>{var l;s.current||(l=i.triggerRef.current)===null||l===void 0||l.focus(),s.current=!1,a.preventDefault()}),onInteractOutside:we(e.onInteractOutside,a=>{const l=a.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,u=l.button===2||c;(!i.modal||u)&&(s.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}}))}),wie=b.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,i=Fi(n);return b.createElement(i4,oe({},i,r,{ref:t}))}),Sie=b.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,i=Fi(n);return b.createElement(o4,oe({},i,r,{ref:t}))}),_ie=b.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,i=Fi(n);return b.createElement(s4,oe({},i,r,{ref:t}))}),Cie=b.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,i=Fi(n);return b.createElement(hie,oe({},i,r,{ref:t}))}),Eie=e=>{const{__scopeDropdownMenu:t,children:n,open:r,onOpenChange:i,defaultOpen:o}=e,s=Fi(t),[a=!1,l]=ul({prop:r,defaultProp:o,onChange:i});return b.createElement(a4,oe({},s,{open:a,onOpenChange:l}),n)},kie=b.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,i=Fi(n);return b.createElement(l4,oe({},i,r,{ref:t}))}),Tie=b.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,i=Fi(n);return b.createElement(c4,oe({},i,r,{ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}}))}),h4=gie,rh=yie,H_=vie,f4=bie,Pie=wie,jl=Sie,p4=_ie,Iie=Cie,$ie=Eie,Aie=kie,Mie=Tie,Oie=()=>{},g4=b.createContext({});function Lie({onEvent:e,children:t}){return m.jsx(g4.Provider,{value:e??Oie,children:t})}function nu(){return b.useContext(g4)}function hl(e,t){const n=re(),r=b.useRef(!1),i=nu(),o=b.useCallback(a=>{r.current=a,n.batch(()=>{a?(n.complete(),n.addOpenMenu(e)):(n.deleteOpenMenu(e),n.openMenus.forEach(l=>{l.startsWith(e)&&n.deleteOpenMenu(l)})),t==null||t(a)})},[n,e,t]);return b.useEffect(()=>(r.current&&(i("open-menu",{source:"unknown",id:e}),n.addOpenMenu(e)),()=>{r.current&&(n.deleteOpenMenu(e),n.openMenus.forEach(a=>{a.startsWith(e)&&(i("close-menu",{source:"unknown",id:e}),n.deleteOpenMenu(a))}),r.current=!1)}),[n,e,i]),[ye("is menu open",()=>n.openMenus.includes(e),[n,e]),o]}function Qs({id:e,children:t,modal:n=!1}){const[r,i]=hl(e);return m.jsx(h4,{open:r,dir:"ltr",modal:n,onOpenChange:i,children:t})}function Wh({children:e,"data-testid":t}){return m.jsx(rh,{dir:"ltr","data-testid":t,asChild:!0,children:e})}function Js({side:e="bottom",align:t="start",sideOffset:n=8,alignOffset:r=8,children:i}){const o=tr();return m.jsx(H_,{dir:"ltr",container:o,children:m.jsx(f4,{className:"tlui-menu",align:t,sideOffset:n,side:e,alignOffset:r,collisionPadding:4,children:i})})}function K_({id:e,children:t}){const[n,r]=hl(e);return m.jsx($ie,{open:n,onOpenChange:r,children:t})}function V_({label:e,"data-testid":t,"data-direction":n}){return m.jsx(Aie,{dir:"ltr","data-direction":n,"data-testid":t,asChild:!0,children:m.jsx(be,{className:"tlui-menu__button tlui-menu__submenu__trigger",label:e,icon:"chevron-right"})})}function Y_({alignOffset:e=0,sideOffset:t=5,children:n}){const r=tr();return m.jsx(H_,{container:r,dir:"ltr",children:m.jsx(Mie,{className:"tlui-menu tlui-menu__submenu__content",alignOffset:e,sideOffset:t,collisionPadding:4,children:n})})}function Lo({children:e,size:t="medium"}){return m.jsx(Pie,{dir:"ltr",className:"tlui-menu__group","data-size":t,children:e})}function Pr({noClose:e,...t}){return m.jsx(jl,{dir:"ltr",asChild:!0,onClick:e||t.isChecked!==void 0?Xe:void 0,children:m.jsx(be,{className:"tlui-menu__button",...t})})}function m4({children:e,onSelect:t,...n}){return m.jsxs(p4,{dir:"ltr",className:"tlui-button tlui-menu__button tlui-menu__checkbox-item",onSelect:r=>{t==null||t(r),Xe(r)},...n,children:[m.jsx("div",{className:"tlui-menu__checkbox-item__check",style:{transformOrigin:"75% center",transform:`scale(${n.checked?1:.5})`,opacity:n.checked?1:.5},children:m.jsx(mr,{small:!0,icon:n.checked?"check":"checkbox-empty"})}),e]})}function Bie({children:e,onSelect:t,...n}){return m.jsxs(p4,{dir:"ltr",className:"tlui-button tlui-menu__button tlui-menu__checkbox-item",onSelect:r=>{t==null||t(r),Xe(r)},...n,children:[m.jsx(Iie,{dir:"ltr",className:"tlui-menu__checkbox-item__check",children:m.jsx(mr,{icon:"check"})}),e]})}const y4=b.forwardRef((e,t)=>b.createElement(lt.span,oe({},e,{ref:t,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...e.style}}))),v4="ToastProvider",[q_,Rie,Die]=Ny("Toast"),[x4,Bwe]=Qo("Toast",[Die]),[Fie,Ky]=x4(v4),b4=e=>{const{__scopeToast:t,label:n="Notification",duration:r=5e3,swipeDirection:i="right",swipeThreshold:o=50,children:s}=e,[a,l]=b.useState(null),[c,u]=b.useState(0),d=b.useRef(!1),h=b.useRef(!1);return b.createElement(q_.Provider,{scope:t},b.createElement(Fie,{scope:t,label:n,duration:r,swipeDirection:i,swipeThreshold:o,toastCount:c,viewport:a,onViewportChange:l,onToastAdd:b.useCallback(()=>u(f=>f+1),[]),onToastRemove:b.useCallback(()=>u(f=>f-1),[]),isFocusedToastEscapeKeyDownRef:d,isClosePausedRef:h},s))};b4.propTypes={label(e){if(e.label&&typeof e.label=="string"&&!e.label.trim()){const t=`Invalid prop \`label\` supplied to \`${v4}\`. Expected non-empty \`string\`.`;return new Error(t)}return null}};const Nie="ToastViewport",jie=["F8"],Rb="toast.viewportPause",Db="toast.viewportResume",zie=b.forwardRef((e,t)=>{const{__scopeToast:n,hotkey:r=jie,label:i="Notifications ({hotkey})",...o}=e,s=Ky(Nie,n),a=Rie(n),l=b.useRef(null),c=b.useRef(null),u=b.useRef(null),d=b.useRef(null),h=Tt(t,d,s.onViewportChange),f=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),p=s.toastCount>0;b.useEffect(()=>{const y=x=>{var w;r.every(S=>x[S]||x.code===S)&&((w=d.current)===null||w===void 0||w.focus())};return document.addEventListener("keydown",y),()=>document.removeEventListener("keydown",y)},[r]),b.useEffect(()=>{const y=l.current,x=d.current;if(p&&y&&x){const w=()=>{if(!s.isClosePausedRef.current){const P=new CustomEvent(Rb);x.dispatchEvent(P),s.isClosePausedRef.current=!0}},_=()=>{if(s.isClosePausedRef.current){const P=new CustomEvent(Db);x.dispatchEvent(P),s.isClosePausedRef.current=!1}},S=P=>{!y.contains(P.relatedTarget)&&_()},T=()=>{y.contains(document.activeElement)||_()};return y.addEventListener("focusin",w),y.addEventListener("focusout",S),y.addEventListener("pointermove",w),y.addEventListener("pointerleave",T),window.addEventListener("blur",w),window.addEventListener("focus",_),()=>{y.removeEventListener("focusin",w),y.removeEventListener("focusout",S),y.removeEventListener("pointermove",w),y.removeEventListener("pointerleave",T),window.removeEventListener("blur",w),window.removeEventListener("focus",_)}}},[p,s.isClosePausedRef]);const g=b.useCallback(({tabbingDirection:y})=>{const w=a().map(_=>{const S=_.ref.current,T=[S,...roe(S)];return y==="forwards"?T:T.reverse()});return(y==="forwards"?w.reverse():w).flat()},[a]);return b.useEffect(()=>{const y=d.current;if(y){const x=w=>{const _=w.altKey||w.ctrlKey||w.metaKey;if(w.key==="Tab"&&!_){const $=document.activeElement,L=w.shiftKey;if(w.target===y&&L){var T;(T=c.current)===null||T===void 0||T.focus();return}const Q=g({tabbingDirection:L?"backwards":"forwards"}),j=Q.findIndex(B=>B===$);if(r1(Q.slice(j+1)))w.preventDefault();else{var P,I;L?(P=c.current)===null||P===void 0||P.focus():(I=u.current)===null||I===void 0||I.focus()}}};return y.addEventListener("keydown",x),()=>y.removeEventListener("keydown",x)}},[a,g]),b.createElement(hte,{ref:l,role:"region","aria-label":i.replace("{hotkey}",f),tabIndex:-1,style:{pointerEvents:p?void 0:"none"}},p&&b.createElement(dP,{ref:c,onFocusFromOutsideViewport:()=>{const y=g({tabbingDirection:"forwards"});r1(y)}}),b.createElement(q_.Slot,{scope:n},b.createElement(lt.ol,oe({tabIndex:-1},o,{ref:h}))),p&&b.createElement(dP,{ref:u,onFocusFromOutsideViewport:()=>{const y=g({tabbingDirection:"backwards"});r1(y)}}))}),Uie="ToastFocusProxy",dP=b.forwardRef((e,t)=>{const{__scopeToast:n,onFocusFromOutsideViewport:r,...i}=e,o=Ky(Uie,n);return b.createElement(y4,oe({"aria-hidden":!0,tabIndex:0},i,{ref:t,style:{position:"fixed"},onFocus:s=>{var a;const l=s.relatedTarget;!((a=o.viewport)!==null&&a!==void 0&&a.contains(l))&&r()}}))}),Vy="Toast",Wie="toast.swipeStart",Hie="toast.swipeMove",Kie="toast.swipeCancel",Vie="toast.swipeEnd",Yie=b.forwardRef((e,t)=>{const{forceMount:n,open:r,defaultOpen:i,onOpenChange:o,...s}=e,[a=!0,l]=ul({prop:r,defaultProp:i,onChange:o});return b.createElement(Jo,{present:n||a},b.createElement(w4,oe({open:a},s,{ref:t,onClose:()=>l(!1),onPause:Fn(e.onPause),onResume:Fn(e.onResume),onSwipeStart:we(e.onSwipeStart,c=>{c.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:we(e.onSwipeMove,c=>{const{x:u,y:d}=c.detail.delta;c.currentTarget.setAttribute("data-swipe","move"),c.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${u}px`),c.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${d}px`)}),onSwipeCancel:we(e.onSwipeCancel,c=>{c.currentTarget.setAttribute("data-swipe","cancel"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),c.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:we(e.onSwipeEnd,c=>{const{x:u,y:d}=c.detail.delta;c.currentTarget.setAttribute("data-swipe","end"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),c.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${u}px`),c.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${d}px`),l(!1)})})))}),[qie,Gie]=x4(Vy,{onClose(){}}),w4=b.forwardRef((e,t)=>{const{__scopeToast:n,type:r="foreground",duration:i,open:o,onClose:s,onEscapeKeyDown:a,onPause:l,onResume:c,onSwipeStart:u,onSwipeMove:d,onSwipeCancel:h,onSwipeEnd:f,...p}=e,g=Ky(Vy,n),[y,x]=b.useState(null),w=Tt(t,B=>x(B)),_=b.useRef(null),S=b.useRef(null),T=i||g.duration,P=b.useRef(0),I=b.useRef(T),$=b.useRef(0),{onToastAdd:L,onToastRemove:R}=g,K=Fn(()=>{var B;(y==null?void 0:y.contains(document.activeElement))&&((B=g.viewport)===null||B===void 0||B.focus()),s()}),Q=b.useCallback(B=>{!B||B===1/0||(window.clearTimeout($.current),P.current=new Date().getTime(),$.current=window.setTimeout(K,B))},[K]);b.useEffect(()=>{const B=g.viewport;if(B){const z=()=>{Q(I.current),c==null||c()},q=()=>{const U=new Date().getTime()-P.current;I.current=I.current-U,window.clearTimeout($.current),l==null||l()};return B.addEventListener(Rb,q),B.addEventListener(Db,z),()=>{B.removeEventListener(Rb,q),B.removeEventListener(Db,z)}}},[g.viewport,T,l,c,Q]),b.useEffect(()=>{o&&!g.isClosePausedRef.current&&Q(T)},[o,T,g.isClosePausedRef,Q]),b.useEffect(()=>(L(),()=>R()),[L,R]);const j=b.useMemo(()=>y?E4(y):null,[y]);return g.viewport?b.createElement(b.Fragment,null,j&&b.createElement(Xie,{__scopeToast:n,role:"status","aria-live":r==="foreground"?"assertive":"polite","aria-atomic":!0},j),b.createElement(qie,{scope:n,onClose:K},Yo.createPortal(b.createElement(q_.ItemSlot,{scope:n},b.createElement(dte,{asChild:!0,onEscapeKeyDown:we(a,()=>{g.isFocusedToastEscapeKeyDownRef.current||K(),g.isFocusedToastEscapeKeyDownRef.current=!1})},b.createElement(lt.li,oe({role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":o?"open":"closed","data-swipe-direction":g.swipeDirection},p,{ref:w,style:{userSelect:"none",touchAction:"none",...e.style},onKeyDown:we(e.onKeyDown,B=>{B.key==="Escape"&&(a==null||a(B.nativeEvent),B.nativeEvent.defaultPrevented||(g.isFocusedToastEscapeKeyDownRef.current=!0,K()))}),onPointerDown:we(e.onPointerDown,B=>{B.button===0&&(_.current={x:B.clientX,y:B.clientY})}),onPointerMove:we(e.onPointerMove,B=>{if(!_.current)return;const z=B.clientX-_.current.x,q=B.clientY-_.current.y,U=!!S.current,D=["left","right"].includes(g.swipeDirection),F=["left","up"].includes(g.swipeDirection)?Math.min:Math.max,J=D?F(0,z):0,Z=D?0:F(0,q),ne=B.pointerType==="touch"?10:2,de={x:J,y:Z},Ce={originalEvent:B,delta:de};U?(S.current=de,ap(Hie,d,Ce,{discrete:!1})):hP(de,g.swipeDirection,ne)?(S.current=de,ap(Wie,u,Ce,{discrete:!1}),B.target.setPointerCapture(B.pointerId)):(Math.abs(z)>ne||Math.abs(q)>ne)&&(_.current=null)}),onPointerUp:we(e.onPointerUp,B=>{const z=S.current,q=B.target;if(q.hasPointerCapture(B.pointerId)&&q.releasePointerCapture(B.pointerId),S.current=null,_.current=null,z){const U=B.currentTarget,D={originalEvent:B,delta:z};hP(z,g.swipeDirection,g.swipeThreshold)?ap(Vie,f,D,{discrete:!0}):ap(Kie,h,D,{discrete:!0}),U.addEventListener("click",F=>F.preventDefault(),{once:!0})}})})))),g.viewport))):null});w4.propTypes={type(e){if(e.type&&!["foreground","background"].includes(e.type)){const t=`Invalid prop \`type\` supplied to \`${Vy}\`. Expected \`foreground | background\`.`;return new Error(t)}return null}};const Xie=e=>{const{__scopeToast:t,children:n,...r}=e,i=Ky(Vy,t),[o,s]=b.useState(!1),[a,l]=b.useState(!1);return toe(()=>s(!0)),b.useEffect(()=>{const c=window.setTimeout(()=>l(!0),1e3);return()=>window.clearTimeout(c)},[]),a?null:b.createElement(I_,{asChild:!0},b.createElement(y4,r,o&&b.createElement(b.Fragment,null,i.label," ",n)))},Zie=b.forwardRef((e,t)=>{const{__scopeToast:n,...r}=e;return b.createElement(lt.div,oe({},r,{ref:t}))}),Qie=b.forwardRef((e,t)=>{const{__scopeToast:n,...r}=e;return b.createElement(lt.div,oe({},r,{ref:t}))}),Jie="ToastAction",S4=b.forwardRef((e,t)=>{const{altText:n,...r}=e;return n?b.createElement(C4,{altText:n,asChild:!0},b.createElement(_4,oe({},r,{ref:t}))):null});S4.propTypes={altText(e){return e.altText?null:new Error(`Missing prop \`altText\` expected on \`${Jie}\``)}};const eoe="ToastClose",_4=b.forwardRef((e,t)=>{const{__scopeToast:n,...r}=e,i=Gie(eoe,n);return b.createElement(C4,{asChild:!0},b.createElement(lt.button,oe({type:"button"},r,{ref:t,onClick:we(e.onClick,i.onClose)})))}),C4=b.forwardRef((e,t)=>{const{__scopeToast:n,altText:r,...i}=e;return b.createElement(lt.div,oe({"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":r||void 0},i,{ref:t}))});function E4(e){const t=[];return Array.from(e.childNodes).forEach(r=>{if(r.nodeType===r.TEXT_NODE&&r.textContent&&t.push(r.textContent),noe(r)){const i=r.ariaHidden||r.hidden||r.style.display==="none",o=r.dataset.radixToastAnnounceExclude==="";if(!i)if(o){const s=r.dataset.radixToastAnnounceAlt;s&&t.push(s)}else t.push(...E4(r))}}),t}function ap(e,t,n,{discrete:r}){const i=n.originalEvent.currentTarget,o=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:n});t&&i.addEventListener(e,t,{once:!0}),r?T_(i,o):i.dispatchEvent(o)}const hP=(e,t,n=0)=>{const r=Math.abs(e.x),i=Math.abs(e.y),o=r>i;return t==="left"||t==="right"?o&&r>n:!o&&i>n};function toe(e=()=>{}){const t=Fn(e);Za(()=>{let n=0,r=0;return n=window.requestAnimationFrame(()=>r=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(n),window.cancelAnimationFrame(r)}},[t])}function noe(e){return e.nodeType===e.ELEMENT_NODE}function roe(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const i=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||i?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function r1(e){const t=document.activeElement;return e.some(n=>n===t?!0:(n.focus(),document.activeElement!==t))}const ioe=Yie,ooe=Zie,soe=Qie,aoe=S4,fP=_4,i1="2.0.0-canary.f2e95988e03c",loe=["align-bottom-center","align-bottom-left","align-bottom-right","align-bottom","align-center-center","align-center-horizontal","align-center-left","align-center-right","align-center-vertical","align-left","align-right","align-top-center","align-top-left","align-top-right","align-top","arrow-left","arrowhead-arrow","arrowhead-bar","arrowhead-diamond","arrowhead-dot","arrowhead-none","arrowhead-square","arrowhead-triangle-inverted","arrowhead-triangle","aspect-ratio","avatar","blob","bring-forward","bring-to-front","check","checkbox-checked","checkbox-empty","chevron-down","chevron-left","chevron-right","chevron-up","chevrons-ne","chevrons-sw","clipboard-copied","clipboard-copy","code","collab","color","comment","cross-2","cross","dash-dashed","dash-dotted","dash-draw","dash-solid","discord","distribute-horizontal","distribute-vertical","dot","dots-horizontal","dots-vertical","drag-handle-dots","duplicate","edit","external-link","file","fill-none","fill-pattern","fill-semi","fill-solid","follow","following","font-draw","font-mono","font-sans","font-serif","geo-arrow-down","geo-arrow-left","geo-arrow-right","geo-arrow-up","geo-check-box","geo-diamond","geo-ellipse","geo-hexagon","geo-octagon","geo-oval","geo-pentagon","geo-rectangle","geo-rhombus-2","geo-rhombus","geo-star","geo-trapezoid","geo-triangle","geo-x-box","github","group","hidden","image","info-circle","leading","link","lock-small","lock","menu","minus","mixed","pack","page","plus","question-mark-circle","question-mark","redo","reset-zoom","rotate-ccw","rotate-cw","ruler","search","send-backward","send-to-back","settings-horizontal","settings-vertical-1","settings-vertical","share-1","share-2","size-extra-large","size-large","size-medium","size-small","spline-cubic","spline-line","stack-horizontal","stack-vertical","stretch-horizontal","stretch-vertical","text-align-center","text-align-justify","text-align-left","text-align-right","tool-arrow","tool-embed","tool-eraser","tool-frame","tool-hand","tool-highlight","tool-laser","tool-line","tool-media","tool-note","tool-pencil","tool-pointer","tool-text","trash","triangle-down","triangle-up","twitter","undo","ungroup","unlock-small","unlock","vertical-align-center","vertical-align-end","vertical-align-start","visible","warning-triangle","zoom-in","zoom-out"];let coe={...GM,icons:Object.fromEntries(loe.map(e=>[e,`https://unpkg.com/@tldraw/assets@${i1}/icons/icon/${e}.svg`])),translations:Object.fromEntries(Nd.map(e=>[e.locale,`https://unpkg.com/@tldraw/assets@${i1}/translations/${e.locale}.json`])),embedIcons:Object.fromEntries(Pc.map(e=>[e.type,`https://unpkg.com/@tldraw/assets@${i1}/embed-icons/${e.type}.png`]))};const G_=b.forwardRef(function({className:t,label:n,icon:r,iconLeft:i,autoselect:o=!1,autofocus:s=!1,defaultValue:a,placeholder:l,onComplete:c,onValueChange:u,onCancel:d,onBlur:h,shouldManuallyMaintainScrollPositionWhenFocused:f=!1,children:p,value:g},y){const x=b.useRef(null);b.useImperativeHandle(y,()=>x.current);const w=qe(),_=b.useRef(a??""),S=b.useRef(a??""),[T,P]=b.useState(!1),I=b.useCallback(K=>{P(!0);const Q=K.currentTarget;S.current=Q.value,requestAnimationFrame(()=>{o&&Q.select()})},[o]),$=b.useCallback(K=>{const Q=K.currentTarget.value;S.current=Q,u==null||u(Q)},[u]),L=b.useCallback(K=>{switch(K.key){case"Enter":{K.currentTarget.blur(),K.stopPropagation(),c==null||c(K.currentTarget.value);break}case"Escape":{K.currentTarget.value=_.current,K.currentTarget.blur(),K.stopPropagation(),d==null||d(K.currentTarget.value);break}}},[c,d]),R=b.useCallback(K=>{P(!1);const Q=K.currentTarget.value;h==null||h(Q)},[h]);return b.useEffect(()=>{const K=window.visualViewport;if(T&&f&&K){const Q=()=>{var j;(j=x.current)==null||j.scrollIntoView({block:"center"})};return K.addEventListener("resize",Q),K.addEventListener("scroll",Q),requestAnimationFrame(()=>{var j;(j=x.current)==null||j.scrollIntoView({block:"center"})}),()=>{K.removeEventListener("resize",Q),K.removeEventListener("scroll",Q)}}},[T,f]),m.jsxs("div",{draggable:!1,className:"tlui-input__wrapper",children:[p,n&&m.jsx("label",{children:w(n)}),i&&m.jsx(mr,{icon:i,className:"tlui-icon-left",small:!0}),m.jsx("input",{ref:x,className:Me("tlui-input",t),type:"text",defaultValue:a,onKeyUp:L,onChange:$,onFocus:I,onBlur:R,autoFocus:s,placeholder:l,value:g}),r&&m.jsx(mr,{icon:r,small:!!n})]})}),pP=new RegExp(/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:[/?#]\S*)?$/i);function o1(e){return pP.test(e)?!0:pP.test("https://"+e)?"needs protocol":!1}const uoe=Ke(function({onClose:t}){const r=re().onlySelectedShape;return r&&"url"in r.props&&typeof r.props.url=="string"?m.jsx(doe,{onClose:t,selectedShape:r}):null}),doe=Ke(function({onClose:t,selectedShape:n}){const r=re(),i=qe(),[o,s]=b.useState(o1(n.props.url)),a=b.useRef(n.props.url),l=b.useRef(n.props.url),[c,u]=b.useState(o?o==="needs protocol"?"https://"+n.props.url:n.props.url:"https://"),d=b.useCallback(y=>{const x=y.replace(/https?:\/\/(https?:\/\/)/,(_,S)=>S);u(x);const w=o1(x.trim());s(_=>_===w?_:w),w&&(l.current=x)},[]),h=b.useCallback(()=>{r.setProp("url","",!1),t()},[r,t]),f=b.useCallback(y=>{y=y.trim();const x=o1(y),w=r.selectedShapes[0];if(w&&"url"in w.props){const _=w.props.url,S=x?x==="needs protocol"?"https://"+y:y:r.isShapeOfType(w,Jc)?a.current:"";_!==void 0&&_!==S&&r.setProp("url",S,!1)}t()},[r,t]),p=b.useCallback(()=>{t()},[t]);if(!n)return t(),null;const g=a.current&&!o;return m.jsxs(m.Fragment,{children:[m.jsxs(Ry,{children:[m.jsx(Dy,{children:i("edit-link-dialog.title")}),m.jsx(Fy,{})]}),m.jsx(Qd,{children:m.jsxs("div",{className:"tlui-edit-link-dialog",children:[m.jsx(G_,{className:"tlui-edit-link-dialog__input",label:"edit-link-dialog.url",autofocus:!0,value:c,onValueChange:d,onComplete:f,onCancel:p}),m.jsx("div",{children:i(o?"edit-link-dialog.detail":"edit-link-dialog.invalid-url")})]})}),m.jsxs(O_,{className:"tlui-dialog__footer__actions",children:[m.jsx(be,{onClick:p,onTouchEnd:p,children:i("edit-link-dialog.cancel")}),g?m.jsx(be,{type:"danger",onTouchEnd:h,onClick:h,children:i("edit-link-dialog.clear")}):m.jsx(be,{type:"primary",disabled:!o,onTouchEnd:()=>f(l.current),onClick:()=>f(l.current),children:i("edit-link-dialog.save")})]})]})}),k4=Ke(function({onClose:t}){const n=re(),r=qe(),i=M_(),[o,s]=b.useState(null),[a,l]=b.useState(""),[c,u]=b.useState(null),[d,h]=b.useState(!1),f=b.useRef(-1);return m.jsxs(m.Fragment,{children:[m.jsxs(Ry,{children:[m.jsx(Dy,{children:o?`${r("embed-dialog.title")} — ${o.title}`:r("embed-dialog.title")}),m.jsx(Fy,{})]}),o?m.jsxs(m.Fragment,{children:[m.jsxs(Qd,{className:"tlui-embed-dialog__enter",children:[m.jsx(G_,{className:"tlui-embed-dialog__input",label:"embed-dialog.url",placeholder:"http://example.com",autofocus:!0,onValueChange:p=>{l(p);const g=$s(p);u(g&&g.definition.type===o.type?g:null),h(!1),clearTimeout(f.current),f.current=setTimeout(()=>h(!g),320)}}),a===""?m.jsxs("div",{className:"tlui-embed-dialog__instruction",children:[m.jsx("span",{children:r("embed-dialog.instruction")})," ",o.instructionLink&&m.jsxs("a",{target:"_blank",rel:"noopener noreferrer",href:o.instructionLink,className:"tlui-embed-dialog__instruction__link",children:["Learn more.",m.jsx(mr,{icon:"external-link",small:!0})]})]}):m.jsx("div",{className:"tlui-embed-dialog__warning",children:d?r("embed-dialog.invalid-url"):" "})]}),m.jsxs(O_,{className:"tlui-dialog__footer__actions",children:[m.jsx(be,{onClick:()=>{s(null),u(null),l("")},label:"embed-dialog.back"}),m.jsx("div",{className:"tlui-embed__spacer"}),m.jsx(be,{label:"embed-dialog.cancel",onClick:t}),m.jsx(be,{type:"primary",disabled:!c,label:"embed-dialog.create",onClick:()=>{c&&(y5(n,a,n.viewportPageCenter,{width:c.definition.width,height:c.definition.height,doesResize:c.definition.doesResize}),t())}})]})]}):m.jsxs(m.Fragment,{children:[m.jsx(Qd,{className:"tlui-embed-dialog__list",children:Pc.map(p=>m.jsxs("button",{className:"tlui-embed-dialog__item",onClick:()=>s(p),children:[m.jsx("div",{className:"tlui-embed-dialog__item__image",children:m.jsx("div",{className:"tlui-embed-dialog__item__image__img",style:{backgroundImage:`url(${i.embedIcons[p.type]})`}})}),m.jsx("div",{className:"tlui-embed-dialog__item__title",children:p.title})]},p.type))}),m.jsx("div",{className:"tlui-dialog__scrim"})]})]})});var X_={exports:{}};X_.exports;(function(e){var t=function(){var n=String.fromCharCode,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",o={};function s(l,c){if(!o[l]){o[l]={};for(var u=0;u<l.length;u++)o[l][l.charAt(u)]=u}return o[l][c]}var a={compressToBase64:function(l){if(l==null)return"";var c=a._compress(l,6,function(u){return r.charAt(u)});switch(c.length%4){default:case 0:return c;case 1:return c+"===";case 2:return c+"==";case 3:return c+"="}},decompressFromBase64:function(l){return l==null?"":l==""?null:a._decompress(l.length,32,function(c){return s(r,l.charAt(c))})},compressToUTF16:function(l){return l==null?"":a._compress(l,15,function(c){return n(c+32)})+" "},decompressFromUTF16:function(l){return l==null?"":l==""?null:a._decompress(l.length,16384,function(c){return l.charCodeAt(c)-32})},compressToUint8Array:function(l){for(var c=a.compress(l),u=new Uint8Array(c.length*2),d=0,h=c.length;d<h;d++){var f=c.charCodeAt(d);u[d*2]=f>>>8,u[d*2+1]=f%256}return u},decompressFromUint8Array:function(l){if(l==null)return a.decompress(l);for(var c=new Array(l.length/2),u=0,d=c.length;u<d;u++)c[u]=l[u*2]*256+l[u*2+1];var h=[];return c.forEach(function(f){h.push(n(f))}),a.decompress(h.join(""))},compressToEncodedURIComponent:function(l){return l==null?"":a._compress(l,6,function(c){return i.charAt(c)})},decompressFromEncodedURIComponent:function(l){return l==null?"":l==""?null:(l=l.replace(/ /g,"+"),a._decompress(l.length,32,function(c){return s(i,l.charAt(c))}))},compress:function(l){return a._compress(l,16,function(c){return n(c)})},_compress:function(l,c,u){if(l==null)return"";var d,h,f={},p={},g="",y="",x="",w=2,_=3,S=2,T=[],P=0,I=0,$;for($=0;$<l.length;$+=1)if(g=l.charAt($),Object.prototype.hasOwnProperty.call(f,g)||(f[g]=_++,p[g]=!0),y=x+g,Object.prototype.hasOwnProperty.call(f,y))x=y;else{if(Object.prototype.hasOwnProperty.call(p,x)){if(x.charCodeAt(0)<256){for(d=0;d<S;d++)P=P<<1,I==c-1?(I=0,T.push(u(P)),P=0):I++;for(h=x.charCodeAt(0),d=0;d<8;d++)P=P<<1|h&1,I==c-1?(I=0,T.push(u(P)),P=0):I++,h=h>>1}else{for(h=1,d=0;d<S;d++)P=P<<1|h,I==c-1?(I=0,T.push(u(P)),P=0):I++,h=0;for(h=x.charCodeAt(0),d=0;d<16;d++)P=P<<1|h&1,I==c-1?(I=0,T.push(u(P)),P=0):I++,h=h>>1}w--,w==0&&(w=Math.pow(2,S),S++),delete p[x]}else for(h=f[x],d=0;d<S;d++)P=P<<1|h&1,I==c-1?(I=0,T.push(u(P)),P=0):I++,h=h>>1;w--,w==0&&(w=Math.pow(2,S),S++),f[y]=_++,x=String(g)}if(x!==""){if(Object.prototype.hasOwnProperty.call(p,x)){if(x.charCodeAt(0)<256){for(d=0;d<S;d++)P=P<<1,I==c-1?(I=0,T.push(u(P)),P=0):I++;for(h=x.charCodeAt(0),d=0;d<8;d++)P=P<<1|h&1,I==c-1?(I=0,T.push(u(P)),P=0):I++,h=h>>1}else{for(h=1,d=0;d<S;d++)P=P<<1|h,I==c-1?(I=0,T.push(u(P)),P=0):I++,h=0;for(h=x.charCodeAt(0),d=0;d<16;d++)P=P<<1|h&1,I==c-1?(I=0,T.push(u(P)),P=0):I++,h=h>>1}w--,w==0&&(w=Math.pow(2,S),S++),delete p[x]}else for(h=f[x],d=0;d<S;d++)P=P<<1|h&1,I==c-1?(I=0,T.push(u(P)),P=0):I++,h=h>>1;w--,w==0&&(w=Math.pow(2,S),S++)}for(h=2,d=0;d<S;d++)P=P<<1|h&1,I==c-1?(I=0,T.push(u(P)),P=0):I++,h=h>>1;for(;;)if(P=P<<1,I==c-1){T.push(u(P));break}else I++;return T.join("")},decompress:function(l){return l==null?"":l==""?null:a._decompress(l.length,32768,function(c){return l.charCodeAt(c)})},_decompress:function(l,c,u){var d=[],h=4,f=4,p=3,g="",y=[],x,w,_,S,T,P,I,$={val:u(0),position:c,index:1};for(x=0;x<3;x+=1)d[x]=x;for(_=0,T=Math.pow(2,2),P=1;P!=T;)S=$.val&$.position,$.position>>=1,$.position==0&&($.position=c,$.val=u($.index++)),_|=(S>0?1:0)*P,P<<=1;switch(_){case 0:for(_=0,T=Math.pow(2,8),P=1;P!=T;)S=$.val&$.position,$.position>>=1,$.position==0&&($.position=c,$.val=u($.index++)),_|=(S>0?1:0)*P,P<<=1;I=n(_);break;case 1:for(_=0,T=Math.pow(2,16),P=1;P!=T;)S=$.val&$.position,$.position>>=1,$.position==0&&($.position=c,$.val=u($.index++)),_|=(S>0?1:0)*P,P<<=1;I=n(_);break;case 2:return""}for(d[3]=I,w=I,y.push(I);;){if($.index>l)return"";for(_=0,T=Math.pow(2,p),P=1;P!=T;)S=$.val&$.position,$.position>>=1,$.position==0&&($.position=c,$.val=u($.index++)),_|=(S>0?1:0)*P,P<<=1;switch(I=_){case 0:for(_=0,T=Math.pow(2,8),P=1;P!=T;)S=$.val&$.position,$.position>>=1,$.position==0&&($.position=c,$.val=u($.index++)),_|=(S>0?1:0)*P,P<<=1;d[f++]=n(_),I=f-1,h--;break;case 1:for(_=0,T=Math.pow(2,16),P=1;P!=T;)S=$.val&$.position,$.position>>=1,$.position==0&&($.position=c,$.val=u($.index++)),_|=(S>0?1:0)*P,P<<=1;d[f++]=n(_),I=f-1,h--;break;case 2:return y.join("")}if(h==0&&(h=Math.pow(2,p),p++),d[I])g=d[I];else if(I===f)g=w+w.charAt(0);else return null;y.push(g),d[f++]=w+g.charAt(0),h--,w=g,h==0&&(h=Math.pow(2,p),p++)}}};return a}();e!=null?e.exports=t:typeof angular<"u"&&angular!=null&&angular.module("LZString",[]).factory("LZString",function(){return t})})(X_);var T4=X_.exports;async function hoe(e,t,n){var x,w,_;const{elements:r,files:i}=t,o={shapes:[],rootShapeIds:[],assets:[],schema:e.store.schema.serialize()},s=new Map,a=new Map,{currentPageId:l}=e,c=new Map,u=[],d=new Set;r.forEach(S=>{if(c.set(S.id,gt()),S.boundElements!==null)for(const T of S.boundElements)T.type==="text"&&d.add(T.id)});let h="a1";for(const S of r){if(d.has(S.id))continue;const T=c.get(S.id),P={id:T,typeName:"shape",parentId:l,index:h,x:S.x,y:S.y,rotation:0,isLocked:S.locked,opacity:foe(S.opacity)};switch(S.angle!==0&&a.set(T,S.angle),S.groupIds&&S.groupIds.length>0?s.has(S.groupIds[0])?(x=s.get(S.groupIds[0]))==null||x.push(T):s.set(S.groupIds[0],[T]):u.push(T),S.type){case"rectangle":case"ellipse":case"diamond":{let I="",$="middle";if(S.boundElements!==null){for(const R of S.boundElements)if(R.type==="text"){const K=r.find(Q=>Q.id===R.id);K&&(I=K.text,$=gP[K.textAlign])}}const L=S.backgroundColor==="transparent"?S.strokeColor:S.backgroundColor;o.shapes.push({...P,type:"geo",props:{geo:S.type,url:S.link??"",w:S.width,h:S.height,size:lp[S.strokeWidth]??"draw",color:Ou[L]??"black",text:I,align:$,dash:cp(S),fill:boe(S)}});break}case"freedraw":{o.shapes.push({...P,type:"draw",props:{dash:cp(S),size:lp[S.strokeWidth],color:Ou[S.strokeColor]??"black",segments:[{type:"free",points:S.points.map(([I,$,L=.5])=>({x:I,y:$,z:L}))}]}});break}case"line":{const I=S.points[0],$=S.points[S.points.length-1],L=bM(S.points.length);o.shapes.push({...P,type:"line",props:{dash:cp(S),size:lp[S.strokeWidth],color:Ou[S.strokeColor]??"black",spline:S.roundness?"cubic":"line",handles:{start:{id:"start",type:"vertex",index:L[0],x:I[0],y:I[1]},end:{id:"end",type:"vertex",index:L[L.length-1],x:$[0],y:$[1]},...Object.fromEntries(S.points.slice(1,-1).map(([R,K],Q)=>{const j=At();return[j,{id:j,type:"vertex",index:L[Q+1],x:R,y:K}]}))}}});break}case"arrow":{let I="";if(S.boundElements!==null){for(const Q of S.boundElements)if(Q.type==="text"){const j=r.find(B=>B.id===Q.id);j&&(I=j.text)}}const $=S.points[0],L=S.points[S.points.length-1],R=c.get((w=S.startBinding)==null?void 0:w.elementId),K=c.get((_=S.endBinding)==null?void 0:_.elementId);o.shapes.push({...P,type:"arrow",props:{text:I,bend:xoe(S,$,L),dash:cp(S),size:lp[S.strokeWidth]??"m",color:Ou[S.strokeColor]??"black",start:R?{type:"binding",boundShapeId:R,normalizedAnchor:{x:.5,y:.5},isExact:!1}:{type:"point",x:$[0],y:$[1]},end:K?{type:"binding",boundShapeId:K,normalizedAnchor:{x:.5,y:.5},isExact:!1}:{type:"point",x:L[0],y:L[1]},arrowheadEnd:mP[S.endArrowhead]??"none",arrowheadStart:mP[S.startArrowhead]??"none"}});break}case"text":{const{size:I,scale:$}=goe(S.fontSize);o.shapes.push({...P,type:"text",props:{size:I,scale:$,font:moe[S.fontFamily]??"draw",color:Ou[S.strokeColor]??"black",text:S.text,align:gP[S.textAlign]}});break}case"image":{const I=i[S.fileId];if(!I)break;const $=Oh.createId();o.assets.push({id:$,typeName:"asset",type:"image",props:{w:S.width,h:S.height,name:S.id??"Untitled",isAnimated:!1,mimeType:I.mimeType,src:I.dataURL}}),o.shapes.push({...P,type:"image",props:{w:S.width,h:S.height,assetId:$}})}}h=Co(h)}const f=n??(e.inputs.shiftKey?e.inputs.currentPagePoint:void 0);e.mark("paste"),e.putContent(o,{point:f,select:!1,preserveIds:!0});for(const S of s.values())if(S.length>1){e.groupShapes(S);const T=e.getShapeById(S[0]);T!=null&&T.parentId&&Vr(T.parentId)&&u.push(T.parentId)}for(const[S,T]of a)e.select(S),e.rotateShapesBy([S],T);const p=Ae(u.map(S=>e.getShapeById(S))),g=me.Common(p.map(S=>e.getPageBounds(S))),y=e.viewportPageBounds.center;e.updateShapes(p.map(S=>{const T={x:(S.x??0)-(g.x+g.w/2),y:(S.y??0)-(g.y+g.h/2)};return{id:S.id,type:S.type,x:y.x+T.x,y:y.y+T.y}})),e.setSelectedIds(u)}const foe=e=>{const t=e/100;return t<.2?.1:t<.4?.25:t<.6?.5:t<.8?.75:1},lp={1:"s",2:"m",3:"l",4:"xl"},poe={16:"s",20:"m",28:"l",36:"xl"};function goe(e){const t=poe[e];return t?{size:t,scale:1}:e<16?{size:"s",scale:e/16}:e>36?{size:"xl",scale:e/36}:{size:"m",scale:1}}const moe={1:"draw",2:"sans",3:"mono"},Ou={"#ffffff":"grey","#000000":"black","#343a40":"black","#495057":"grey","#c92a2a":"red","#a61e4d":"light-red","#862e9c":"violet","#5f3dc4":"light-violet","#364fc7":"blue","#1864ab":"light-blue","#0b7285":"light-green","#087f5b":"light-green","#2b8a3e":"green","#5c940d":"light-green","#e67700":"yellow","#d9480f":"orange","#ced4da":"grey","#868e96":"grey","#fa5252":"light-red","#e64980":"red","#be4bdb":"light-violet","#7950f2":"violet","#4c6ef5":"blue","#228be6":"light-blue","#15aabf":"light-green","#12b886":"green","#40c057":"green","#82c91e":"light-green","#fab005":"yellow","#fd7e14":"orange","#212529":"grey"},yoe={solid:"draw",dashed:"dashed",dotted:"dotted"},voe={"cross-hatch":"pattern",hachure:"pattern",solid:"solid"},gP={left:"start",center:"middle",right:"end"},mP={arrow:"arrow",dot:"dot",triangle:"triangle",bar:"pipe"};function xoe(e,t,n){let r=0;if(e.points.length>2){const i=new E(t[0],t[1]),o=new E(n[0],n[1]),s=new E(e.points[1][0],e.points[1][1]),a=E.Sub(o,i),l=E.Per(a),c=E.Med(o,i),u=E.Sub(c,l),d=E.Add(c,l),h=E.NearestPointOnLineSegment(u,d,s,!1);r=E.Dist(h,c),E.Clockwise(h,o,c)&&(r*=-1)}return r}const cp=e=>{let t=yoe[e.strokeStyle]??"draw";return t==="draw"&&e.roughness===0&&(t="solid"),t},boe=e=>e.backgroundColor==="transparent"?"none":voe[e.fillStyle]??"solid";async function P4(e,t,n){const r=n??(e.inputs.shiftKey?e.inputs.currentPagePoint:e.viewportPageCenter),o=(await Promise.all(t.map(async s=>await(await fetch(s)).blob()))).map(s=>new File([s],"tldrawFile",{type:s.type}));e.mark("paste"),await a_(e,o,r,!1),t.forEach(s=>URL.revokeObjectURL(s))}const woe=/[\u0590-\u05FF\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]/;function Soe(e){return e.replace(/\t/g,nc)}function _oe(e){const t=e.split(`
`);for(;t[0].trim().length===0;)t.shift();let n=1/0;for(const r of t)if(r.trim().length>0){const i=r.length-r.trimStart().length;n=Math.min(n,i)}return t.map(r=>r.slice(n)).join(`
`)}function Coe(e){return e.replace(/[ \t]+$/gm,"").replace(/\n+$/,"")}async function Eoe(e,t,n){const r=n??(e.inputs.shiftKey?e.inputs.currentPagePoint:e.viewportPageCenter),i=e.getShapeUtil(cl).defaultProps(),o=Coe(_oe(Soe(t)));let s,a,l,c="middle";const u=o.split(`
`).length>1,d=woe.test(o);u&&(c=u?d?"end":"start":"middle");const h=e.textMeasure.measureText(o,{...yn,fontFamily:Mo[i.font],fontSize:Is[i.size],width:"fit-content"}),f=Math.min(u?e.viewportPageBounds.width*.9:920,Math.max(200,e.viewportPageBounds.width*.9));if(h.w>f){const p=e.textMeasure.measureText(o,{...yn,fontFamily:Mo[i.font],fontSize:Is[i.size],width:f+"px"});s=p.w,a=p.h,l=!1,c=d?"end":"start"}else s=h.w,a=h.h,l=!0;r.y-a/2<e.viewportPageBounds.minY+40&&(r.y=e.viewportPageBounds.minY+40+a/2),e.mark("paste"),e.createShapes([{id:gt(),type:"text",x:r.x-s/2,y:r.y-a/2,props:{text:o,align:c,autoSize:l,w:s}}])}async function koe(e,t,n){const r=n??(e.inputs.shiftKey?e.inputs.currentPagePoint:e.viewportPageCenter);return e.mark("paste"),await Oq(e,t,r)}function Toe(e,t,n){const r=n??(e.inputs.shiftKey?e.inputs.currentPagePoint:void 0);e.mark("paste"),e.putContent(t,{point:r,select:!0})}async function Fb(e,t,n){var o;const r=n??(e.inputs.shiftKey?e.inputs.currentPagePoint:e.viewportPageCenter);try{if((o=(await fetch(t)).headers.get("content-type"))!=null&&o.match(/^image\//)){e.mark("paste"),P4(e,[t]);return}}catch(s){s.message!=="Failed to fetch"&&console.error(s)}e.mark("paste");const i=$s(t);return i?await y5(e,i.url,r,i.definition):await Mq(e,t,r)}function I4(){const e=re();return ye("editor.isFocused",()=>e.isFocused,[e])}const Poe=["input","select","textarea"];function sg(e){const{activeElement:t}=document;return e.isMenuOpen||t&&(t.getAttribute("contenteditable")||Poe.indexOf(t.tagName.toLowerCase())>-1)}async function s1(e){return new Promise((t,n)=>{const r=new FileReader;r.addEventListener("loadend",()=>{const i=r.result;t(i)}),r.addEventListener("error",()=>{n(r.error)}),r.readAsText(e)})}function Ioe(e){const t=document.implementation.createHTMLDocument("");return t.documentElement.innerHTML=e.trim(),t.body.textContent||t.body.innerText||""}const $oe=e=>e.types.find(t=>t.match(/^image\//)),a1=(e,t,n)=>{const r=Bq(t);if(r)for(const i of r)Fb(e,i,n);else Lq(t)?Fb(e,t,n):Rq(t)?koe(e,t,n):Eoe(e,t,n)},Aoe=async(e,t,n)=>{if(e.editingId!==null)return;if(!t)throw Error("No clipboard data");const r=[];for(const i of Object.values(t.items))switch(i.kind){case"file":{r.push({type:"file",source:new Promise(o=>o(i.getAsFile()))});break}case"string":{i.type==="text/html"?r.push({type:"html",source:new Promise(o=>i.getAsString(o))}):i.type==="text/plain"?r.push({type:"text",source:new Promise(o=>i.getAsString(o))}):r.push({type:i.type,source:new Promise(o=>i.getAsString(o))});break}}A4(e,r,n)},$4=async(e,t,n)=>{const r=[];for(const i of t){if($oe(i))for(const o of i.types)o.match(/^image\//)&&r.push({type:"blob",source:i.getType(o)});i.types.includes("text/html")&&r.push({type:"html",source:new Promise(o=>i.getType("text/html").then(s=>s1(s).then(o)))}),i.types.includes("text/uri-list")&&r.push({type:"url",source:new Promise(o=>i.getType("text/uri-list").then(s=>s1(s).then(o)))}),i.types.includes("text/plain")&&r.push({type:"text",source:new Promise(o=>i.getType("text/plain").then(s=>s1(s).then(o)))})}return await A4(e,r,n)};async function A4(e,t,n){const r=t.filter(o=>(o.type==="file"||o.type==="blob")&&o.source!==null);if(r.length){const s=(await Promise.all(r.map(a=>a.source))).filter(Boolean).map(a=>URL.createObjectURL(a));return await P4(e,s,n)}const i=await Promise.all(t.filter(o=>o.type!=="file").map(o=>new Promise(s=>{const a=o;if(a.type==="file"){s({type:"error",data:null,reason:"unexpected file"});return}a.source.then(l=>{var u;const c=(u=l.match(/<tldraw[^>]*>(.*)<\/tldraw>/))==null?void 0:u[1];if(c)try{const d=T4.decompressFromBase64(c);if(d===null){s({type:"error",data:d,reason:"found tldraw data comment but could not parse base64"});return}else{const h=JSON.parse(d);if(h.type!=="application/tldraw"&&s({type:"error",data:h,reason:`found tldraw data comment but JSON was of a different type: ${h.type}`}),typeof h.data=="string"){s({type:"error",data:h,reason:"found tldraw json but data was a string instead of a TLClipboardModel object"});return}s({type:"tldraw",data:h.data});return}}catch{s({type:"error",data:c,reason:"found tldraw json but data was a string instead of a TLClipboardModel object"});return}else{if(a.type==="html"){s({type:"text",data:l,subtype:"html"});return}if(a.type==="url"){s({type:"text",data:l,subtype:"url"});return}try{const d=JSON.parse(l);if(d.type==="excalidraw/clipboard"){s({type:"excalidraw",data:d});return}else{s({type:"text",data:l,subtype:"json"});return}}catch{s({type:"text",data:l,subtype:"text"});return}}s({type:"error",data:l,reason:"unhandled case"})})})));for(const o of i)if(o.type==="tldraw"){Toe(e,o.data,n);return}for(const o of i)if(o.type==="excalidraw"){hoe(e,o.data,n);return}for(const o of i)if(o.type==="text"&&o.subtype==="html"){const a=new DOMParser().parseFromString(o.data,"text/html").querySelector("body");if(a&&Array.from(a.children).filter(c=>c.nodeType===1).length===1&&a.firstElementChild&&a.firstElementChild.tagName==="A"&&a.firstElementChild.hasAttribute("href")&&a.firstElementChild.getAttribute("href")!==""){const c=a.firstElementChild.getAttribute("href");a1(e,c,n);return}if(!i.some(c=>c.type==="text"&&c.subtype!=="html")&&o.data.trim()){a1(e,Ioe(o.data),n);return}}for(const o of i)if(o.type==="text"&&o.subtype==="url"){Fb(e,o.data,n);return}for(const o of i)if(o.type==="text"&&o.subtype==="text"&&o.data.trim()){a1(e,o.data,n);return}}const vm=e=>{var r;const t=e.getContent();if(!t){navigator&&navigator.clipboard&&navigator.clipboard.writeText("");return}const n=T4.compressToBase64(JSON.stringify({type:"application/tldraw",kind:"content",data:t}));if(!(typeof navigator>"u")){const i=t.shapes.map(o=>e.isShapeOfType(o,cl)||e.isShapeOfType(o,y_)||e.isShapeOfType(o,Qt)?o.props.text:e.isShapeOfType(o,Jc)||e.isShapeOfType(o,$c)?o.props.url:null).filter($H);if((r=navigator.clipboard)!=null&&r.write){const o=new Blob([`<tldraw>${n}</tldraw>`],{type:"text/html"});let s=i.join(" ");s===""&&(s=" "),navigator.clipboard.write([new ClipboardItem({"text/html":o,"text/plain":new Blob([s],{type:"text/plain"})})])}else navigator.clipboard.writeText&&navigator.clipboard.writeText(`<tldraw>${n}</tldraw>`)}};function Moe(){const e=re(),t=nu(),n=b.useCallback(function(s){e.selectedIds.length!==0&&(vm(e),t("copy",{source:s}))},[e,t]),r=b.useCallback(function(s){e.selectedIds.length!==0&&(vm(e),e.deleteShapes(),t("cut",{source:s}))},[e,t]),i=b.useCallback(async function(s,a,l){e.editingId!==null||sg(e)||(Array.isArray(s)&&s[0]instanceof ClipboardItem?($4(e,s,l),t("paste",{source:"menu"})):navigator.clipboard.read().then(c=>{i(c,a,l)}))},[e,t]);return{copy:n,cut:r,paste:i}}function Ooe(){const e=re(),t=nu(),n=I4();b.useEffect(()=>{if(!n)return;const r=()=>{e.selectedIds.length===0||e.editingId!==null||sg(e)||(vm(e),t("copy",{source:"kbd"}))};function i(){e.selectedIds.length===0||e.editingId!==null||sg(e)||(vm(e),e.deleteShapes(),t("cut",{source:"kbd"}))}let o=!1;const s=l=>{l.button===1&&(o=!0,requestAnimationFrame(()=>{o=!1}))},a=l=>{if(o){l.stopPropagation();return}e.editingId!==null||sg(e)||(l.clipboardData&&!e.inputs.shiftKey?Aoe(e,l.clipboardData):navigator.clipboard.read().then(c=>{Array.isArray(c)&&c[0]instanceof ClipboardItem&&$4(e,c,e.inputs.currentPagePoint)}),t("paste",{source:"kbd"}))};return document.addEventListener("copy",r),document.addEventListener("cut",i),document.addEventListener("paste",a),document.addEventListener("pointerup",s),()=>{document.removeEventListener("copy",r),document.removeEventListener("cut",i),document.removeEventListener("paste",a),document.removeEventListener("pointerup",s)}},[e,t,n])}const M4=b.createContext({});function Loe({children:e}){const[t,n]=b.useState([]),r=b.useCallback(s=>{const a=s.id??At();return n(l=>[...l.filter(c=>c.id!==s.id),{...s,id:a}]),a},[]),i=b.useCallback(s=>(n(a=>a.filter(l=>l.id!==s)),s),[]),o=b.useCallback(()=>{n(()=>[])},[]);return m.jsx(M4.Provider,{value:{toasts:t,addToast:r,removeToast:i,clearToasts:o},children:e})}function lo(){const e=b.useContext(M4);if(!e)throw new Error("useToasts must be used within a ToastsProvider");return e}function Boe(){const e=re(),{addToast:t}=lo(),n=qe();return b.useCallback(function(i=e.selectedIds,o="svg"){if(i.length===0&&(i=[...e.shapeIds]),i.length!==0)switch(o){case"svg":{window.navigator.clipboard&&(window.navigator.clipboard.write?window.navigator.clipboard.write([new ClipboardItem({"text/plain":Roe(e,i)})]):yP(async()=>Y6(await Z_(e,i))));break}case"jpeg":case"png":{const s=o==="jpeg"?"image/jpeg":"image/png",a=Doe(e,i,o).then(l=>{if(l){if(window.navigator.clipboard)return l;throw new Error("Copy not supported")}else throw t({id:"copy-fail",icon:"warning-triangle",title:n("toast.error.copy-fail.title"),description:n("toast.error.copy-fail.desc")}),new Error("Copy not possible")});window.navigator.clipboard.write([new ClipboardItem({[s]:a})]).catch(l=>{l.toString().match(/^TypeError: DOMString not supported/)||console.error(l),a.then(c=>{window.navigator.clipboard.write([new ClipboardItem({[s]:c})])})});break}case"json":{const s=e.getContent(i);if(window.navigator.clipboard){const a=JSON.stringify(s);window.navigator.clipboard.write?window.navigator.clipboard.write([new ClipboardItem({"text/plain":new Blob([a],{type:"text/plain"})})]):yP(async()=>a)}break}default:throw new Error(`Copy type ${o} not supported.`)}},[e,t,n])}async function Z_(e,t){const n=await e.getSvg(t,{scale:1,background:e.instanceState.exportBackground});if(!n)throw new Error("Could not construct SVG.");return n}async function Roe(e,t){return new Blob([Y6(await Z_(e,t))],{type:"text/plain"})}async function Doe(e,t,n){return await q6(await Z_(e,t),{type:n,quality:1,scale:2})}async function yP(e){navigator&&navigator.clipboard&&navigator.clipboard.writeText(await e())}const O4=b.createContext({});function Foe({children:e}){const t=re(),n=nu(),[r,i]=b.useState([]),o=b.useCallback(c=>{const u=c.id??At();return i(d=>[...d.filter(h=>h.id!==c.id),{...c,id:u}]),n("open-menu",{source:"dialog",id:u}),t.addOpenMenu(u),u},[t,n]),s=b.useCallback((c,u)=>(i(d=>d.map(h=>h.id===c?{...h,...u}:h)),n("open-menu",{source:"dialog",id:c}),t.addOpenMenu(c),c),[t,n]),a=b.useCallback(c=>(i(u=>u.filter(d=>{var h;return d.id===c?((h=d.onClose)==null||h.call(d),!1):!0})),n("close-menu",{source:"dialog",id:c}),t.deleteOpenMenu(c),c),[t,n]),l=b.useCallback(()=>{i(c=>(c.forEach(u=>{var d;(d=u.onClose)==null||d.call(u),n("close-menu",{source:"dialog",id:u.id}),t.deleteOpenMenu(u.id)}),[]))},[t,n]);return m.jsx(O4.Provider,{value:{dialogs:r,addDialog:o,removeDialog:a,clearDialogs:l,updateDialog:s},children:e})}function fl(){const e=b.useContext(O4);if(!e)throw new Error("useDialogs must be used within a DialogsProvider");return e}function Noe(){const e=re(),{addToast:t}=lo(),n=qe();return b.useCallback(async function(i=e.selectedIds,o="png"){if(i.length===0&&(i=[...e.shapeIds]),i.length===0)return;const s=await e.getSvg(i,{scale:1,background:e.instanceState.exportBackground});if(!s)throw new Error("Could not construct SVG.");let a="shapes";if(i.length===1){const l=e.getShapeById(i[0]);e.isShapeOfType(l,mc)?a=l.props.name??"frame":a=l.id.replace(/:/,"_")}switch(o){case"svg":{const l=await G6(s);Gv(l,`${a||"shapes"}.svg`);return}case"webp":case"png":{const l=await q6(s,{type:o,quality:1,scale:2});if(!l){t({id:"export-fail",title:n("toast.error.export-fail.title"),description:n("toast.error.export-fail.desc")});return}const c=URL.createObjectURL(l);Gv(c,`${a||"shapes"}.${o}`),URL.revokeObjectURL(c);return}case"json":{const l=e.getContent(i),c=URL.createObjectURL(new Blob([JSON.stringify(l,null,4)],{type:"application/json"}));Gv(c,`${a||"shapes"}.json`),URL.revokeObjectURL(c);return}default:throw new Error(`Export type ${o} not supported.`)}},[e,t,n])}function L4(){const e=re(),t=b.useRef();return b.useEffect(()=>{const n=window.document.createElement("input");n.type="file",n.accept=Cq,n.multiple=!0,t.current=n;async function r(i){const o=i.target.files;!o||o.length===0||(await a_(e,Array.from(o),e.viewportPageBounds.center,!1),n.value="")}return n.addEventListener("change",r),()=>{t.current=void 0,n.removeEventListener("change",r)}},[e]),b.useCallback(()=>{var n;(n=t.current)==null||n.click()},[t])}function joe(){const e=re(),t=b.useRef(null),n=b.useRef(null);return b.useCallback(async function(){const i=document.createElement("div"),o=document.createElement("style"),s=(x,w)=>{x&&(x.innerHTML=""),w&&document.head.contains(w)&&document.head.removeChild(w),x&&document.body.contains(x)&&document.body.removeChild(x)};s(t.current,n.current),t.current=i,n.current=o;const a=`tl-print-surface-${At()}`;i.className=a,o.innerHTML=`
			.${a} {
				display: none;
			}

			.${a} svg {
				max-width: 100%;
				height: 100%;
				display: block;
			}

			@media print {				  
				html, body {
					min-height: 100%;
					height: 100%;
					margin: 0;
				}

				body {
					position: relative;
				}

				body > * {
					display: none;
				}

				.${a} {
					display: block !important;
					background: white;
					min-height: 100%;
					height: 100%;
					max-width: 100%;
				}

				.${a}__item {
					padding: 10mm;
					display: flex;
					min-height: 100%;
					flex-direction: column;
					page-break-after: always;
					position: relative;
					overflow: hidden;
					height: 100%;
				}

				.${a}__item__main {
					flex: 1;
					display: flex;
					align-items: center;
					justify-content: center;
					max-height: 100%;
				}

				.${a}__item__header {
					display: none;
				}

				.${a}__item__footer {
					display: none;
					text-align: right;
				}

				.${a}__item__footer__hide {
					display: none;
				}

				
			}

		`;const l=()=>{document.head.appendChild(o),document.body.appendChild(i)},c=()=>{e.once("change-history",()=>{s(i,o)})};window.addEventListener("beforeprint",l),window.addEventListener("afterprint",c);function u(x,w,_){try{i.innerHTML+=`<div class="${a}__item">
        <div class="${a}__item__header">
          ${x.replace(/</g,"&lt;").replace(/>/g,"&gt;")}
        </div>
        <div class="${a}__item__main">
          ${_.outerHTML}
        </div>
        <div class="${a}__item__footer ${a}__item__footer__${w?"":"hide"}">
          ${w??""}
        </div>
      </div>`}catch(S){console.error(S)}}function d(){e.isChromeForIos?(l(),window.print()):e.isSafari?(l(),document.execCommand("print",!1)):window.print()}const{pages:h,currentPageId:f,selectedIds:p}=e,y={scale:1,background:!1,darkMode:!1,preserveAspectRatio:"xMidYMid meet"};if(e.selectedIds.length>0){const x=await e.getSvg(p,y);if(x){const w=h.find(_=>_.id===f);u(`tldraw — ${w==null?void 0:w.name}`,null,x),d()}}else{const x=e.currentPage,w=await e.getSvg(e.getSortedChildIds(x.id),y);w&&(u(`tldraw — ${x.name}`,null,w),d())}window.removeEventListener("beforeprint",l),window.removeEventListener("afterprint",c)},[e])}const B4=b.createContext({});function zoe(e){return Object.fromEntries(e.map(t=>[t.id,t]))}function Uoe({overrides:e,children:t}){const n=re(),{addDialog:r,clearDialogs:i}=fl(),{clearToasts:o}=lo(),s=L4(),a=joe(),{cut:l,copy:c,paste:u}=Moe(),d=Boe(),h=Noe(),f=nu(),p=b.useMemo(()=>{const g=zoe([{id:"edit-link",label:"action.edit-link",icon:"link",readonlyOk:!1,onSelect(y){f("edit-link",{source:y}),n.mark("edit-link"),r({component:uoe})}},{id:"insert-embed",label:"action.insert-embed",readonlyOk:!1,kbd:"$i",onSelect(y){f("insert-embed",{source:y}),r({component:k4})}},{id:"insert-media",label:"action.insert-media",kbd:"$u",readonlyOk:!1,onSelect(y){f("insert-media",{source:y}),s()}},{id:"undo",label:"action.undo",icon:"undo",kbd:"$z",readonlyOk:!1,onSelect(y){f("undo",{source:y}),n.undo()}},{id:"redo",label:"action.redo",icon:"redo",kbd:"$!z",readonlyOk:!1,onSelect(y){f("redo",{source:y}),n.redo()}},{id:"export-as-svg",label:"action.export-as-svg",menuLabel:"action.export-as-svg.short",contextMenuLabel:"action.export-as-svg.short",readonlyOk:!0,onSelect(y){f("export-as",{format:"svg",source:y}),h(n.selectedIds,"svg")}},{id:"export-as-png",label:"action.export-as-png",menuLabel:"action.export-as-png.short",contextMenuLabel:"action.export-as-png.short",readonlyOk:!0,onSelect(y){f("export-as",{format:"png",source:y}),h(n.selectedIds,"png")}},{id:"export-as-json",label:"action.export-as-json",menuLabel:"action.export-as-json.short",contextMenuLabel:"action.export-as-json.short",readonlyOk:!0,onSelect(y){f("export-as",{format:"json",source:y}),h(n.selectedIds,"json")}},{id:"copy-as-svg",label:"action.copy-as-svg",menuLabel:"action.copy-as-svg.short",contextMenuLabel:"action.copy-as-svg.short",kbd:"$!c",readonlyOk:!0,onSelect(y){f("copy-as",{format:"svg",source:y}),d(n.selectedIds,"svg")}},{id:"copy-as-png",label:"action.copy-as-png",menuLabel:"action.copy-as-png.short",contextMenuLabel:"action.copy-as-png.short",readonlyOk:!0,onSelect(y){f("copy-as",{format:"png",source:y}),d(n.selectedIds,"png")}},{id:"copy-as-json",label:"action.copy-as-json",menuLabel:"action.copy-as-json.short",contextMenuLabel:"action.copy-as-json.short",readonlyOk:!0,onSelect(y){f("copy-as",{format:"json",source:y}),d(n.selectedIds,"json")}},{id:"toggle-auto-size",label:"action.toggle-auto-size",readonlyOk:!1,onSelect(y){f("toggle-auto-size",{source:y}),n.mark(),n.updateShapes(n.selectedShapes.filter(x=>n.isShapeOfType(x,cl)&&x.props.autoSize===!1).map(x=>({id:x.id,type:x.type,props:{...x.props,w:8,autoSize:!0}})))}},{id:"open-embed-link",label:"action.open-embed-link",readonlyOk:!0,onSelect(y){f("open-embed-link",{source:y});const x=n.selectedIds,w="No embed shapes selected";if(x.length!==1){console.error(w);return}const _=n.getShapeById(x[0]);if(!_||!n.isShapeOfType(_,$c)){console.error(w);return}Gee(_.props.url,"_blank")}},{id:"convert-to-bookmark",label:"action.convert-to-bookmark",readonlyOk:!1,onSelect(y){f("convert-to-bookmark",{source:y});const w=n.selectedIds.map(T=>n.getShapeById(T)),_=[],S=[];for(const T of w){if(!T||!n.isShapeOfType(T,$c)||!T.props.url)continue;const P=new E(T.x,T.y);P.rot(-T.rotation),P.add(new E(T.props.w/2-u5/2,T.props.h/2-d5/2)),P.rot(T.rotation),_.push({id:gt(),type:"bookmark",rotation:T.rotation,x:P.x,y:P.y,props:{url:T.props.url,opacity:"1"}}),S.push(T.id)}n.mark("convert shapes to bookmark"),n.deleteShapes(S),n.createShapes(_)}},{id:"convert-to-embed",label:"action.convert-to-embed",readonlyOk:!1,onSelect(y){f("convert-to-embed",{source:y});const x=n.selectedIds,w=Ae(x.map(T=>n.getShapeById(T))),_=[],S=[];for(const T of w){if(!n.isShapeOfType(T,Jc))continue;const{url:P}=T.props,I=$s(T.props.url);if(!I||!I.definition)continue;const{width:$,height:L,doesResize:R}=I.definition,K=new E(T.x,T.y);K.rot(-T.rotation),K.add(new E(T.props.w/2-$/2,T.props.h/2-L/2)),K.rot(T.rotation),_.push({id:gt(),type:"embed",x:K.x,y:K.y,rotation:T.rotation,props:{url:P,w:$,h:L,doesResize:R}}),S.push(T.id)}n.mark("convert shapes to embed"),n.deleteShapes(S),n.createShapes(_)}},{id:"duplicate",kbd:"$d",label:"action.duplicate",icon:"duplicate",readonlyOk:!1,onSelect(y){if(n.currentToolId!=="select")return;f("duplicate-shapes",{source:y});const x=n.selectedIds,w=me.Common(Ae(x.map(S=>n.getPageBoundsById(S)))),_=n.canMoveCamera?{x:w.width+10,y:0}:{x:16/n.zoomLevel,y:16/n.zoomLevel};n.mark("duplicate shapes"),n.duplicateShapes(x,_)}},{id:"ungroup",label:"action.ungroup",kbd:"$!g",icon:"ungroup",readonlyOk:!1,onSelect(y){f("ungroup-shapes",{source:y}),n.mark("ungroup"),n.ungroupShapes(n.selectedIds)}},{id:"group",label:"action.group",kbd:"$g",icon:"group",readonlyOk:!1,onSelect(y){f("group-shapes",{source:y}),n.selectedShapes.length===1&&n.selectedShapes[0].type==="group"?(n.mark("ungroup"),n.ungroupShapes(n.selectedIds)):(n.mark("group"),n.groupShapes(n.selectedIds))}},{id:"align-left",label:"action.align-left",kbd:"?A",icon:"align-left",readonlyOk:!1,onSelect(y){f("align-shapes",{operation:"left",source:y}),n.mark("align left"),n.alignShapes("left",n.selectedIds)}},{id:"align-center-horizontal",label:"action.align-center-horizontal",contextMenuLabel:"action.align-center-horizontal.short",kbd:"?H",icon:"align-center-horizontal",readonlyOk:!1,onSelect(y){f("align-shapes",{operation:"center-horizontal",source:y}),n.mark("align center horizontal"),n.alignShapes("center-horizontal",n.selectedIds)}},{id:"align-right",label:"action.align-right",kbd:"?D",icon:"align-right",readonlyOk:!1,onSelect(y){f("align-shapes",{operation:"right",source:y}),n.mark("align right"),n.alignShapes("right",n.selectedIds)}},{id:"align-center-vertical",label:"action.align-center-vertical",contextMenuLabel:"action.align-center-vertical.short",kbd:"?V",icon:"align-center-vertical",readonlyOk:!1,onSelect(y){f("align-shapes",{operation:"center-vertical",source:y}),n.mark("align center vertical"),n.alignShapes("center-vertical",n.selectedIds)}},{id:"align-top",label:"action.align-top",icon:"align-top",kbd:"?W",readonlyOk:!1,onSelect(y){f("align-shapes",{operation:"top",source:y}),n.mark("align top"),n.alignShapes("top",n.selectedIds)}},{id:"align-bottom",label:"action.align-bottom",icon:"align-bottom",kbd:"?S",readonlyOk:!1,onSelect(y){f("align-shapes",{operation:"bottom",source:y}),n.mark("align bottom"),n.alignShapes("bottom",n.selectedIds)}},{id:"distribute-horizontal",label:"action.distribute-horizontal",contextMenuLabel:"action.distribute-horizontal.short",icon:"distribute-horizontal",kbd:"?!h",readonlyOk:!1,onSelect(y){f("distribute-shapes",{operation:"horizontal",source:y}),n.mark("distribute horizontal"),n.distributeShapes("horizontal",n.selectedIds)}},{id:"distribute-vertical",label:"action.distribute-vertical",contextMenuLabel:"action.distribute-vertical.short",icon:"distribute-vertical",kbd:"?!V",readonlyOk:!1,onSelect(y){f("distribute-shapes",{operation:"vertical",source:y}),n.mark("distribute vertical"),n.distributeShapes("vertical",n.selectedIds)}},{id:"stretch-horizontal",label:"action.stretch-horizontal",contextMenuLabel:"action.stretch-horizontal.short",icon:"stretch-horizontal",readonlyOk:!1,onSelect(y){f("stretch-shapes",{operation:"horizontal",source:y}),n.mark("stretch horizontal"),n.stretchShapes("horizontal",n.selectedIds)}},{id:"stretch-vertical",label:"action.stretch-vertical",contextMenuLabel:"action.stretch-vertical.short",icon:"stretch-vertical",readonlyOk:!1,onSelect(y){f("stretch-shapes",{operation:"vertical",source:y}),n.mark("stretch vertical"),n.stretchShapes("vertical",n.selectedIds)}},{id:"flip-horizontal",label:"action.flip-horizontal",contextMenuLabel:"action.flip-horizontal.short",kbd:"!h",readonlyOk:!1,onSelect(y){f("flip-shapes",{operation:"horizontal",source:y}),n.mark("flip horizontal"),n.flipShapes("horizontal",n.selectedIds)}},{id:"flip-vertical",label:"action.flip-vertical",contextMenuLabel:"action.flip-vertical.short",kbd:"!v",readonlyOk:!1,onSelect(y){f("flip-shapes",{operation:"vertical",source:y}),n.mark("flip vertical"),n.flipShapes("vertical",n.selectedIds)}},{id:"pack",label:"action.pack",icon:"pack",readonlyOk:!1,onSelect(y){f("pack-shapes",{source:y}),n.mark("pack"),n.packShapes(n.selectedIds)}},{id:"stack-vertical",label:"action.stack-vertical",contextMenuLabel:"action.stack-vertical.short",icon:"stack-vertical",readonlyOk:!1,onSelect(y){f("stack-shapes",{operation:"vertical",source:y}),n.mark("stack-vertical"),n.stackShapes("vertical",n.selectedIds)}},{id:"stack-horizontal",label:"action.stack-horizontal",contextMenuLabel:"action.stack-horizontal.short",icon:"stack-horizontal",readonlyOk:!1,onSelect(y){f("stack-shapes",{operation:"horizontal",source:y}),n.mark("stack-horizontal"),n.stackShapes("horizontal",n.selectedIds)}},{id:"bring-to-front",label:"action.bring-to-front",kbd:"]",icon:"bring-to-front",readonlyOk:!1,onSelect(y){f("reorder-shapes",{operation:"toFront",source:y}),n.mark("bring to front"),n.bringToFront()}},{id:"bring-forward",label:"action.bring-forward",icon:"bring-forward",kbd:"?]",readonlyOk:!1,onSelect(y){f("reorder-shapes",{operation:"forward",source:y}),n.mark("bring forward"),n.bringForward()}},{id:"send-backward",label:"action.send-backward",icon:"send-backward",kbd:"?[",readonlyOk:!1,onSelect(y){f("reorder-shapes",{operation:"backward",source:y}),n.mark("send backward"),n.sendBackward()}},{id:"send-to-back",label:"action.send-to-back",icon:"send-to-back",kbd:"[",readonlyOk:!1,onSelect(y){f("reorder-shapes",{operation:"toBack",source:y}),n.mark("send to back"),n.sendToBack()}},{id:"cut",label:"action.cut",kbd:"$x",readonlyOk:!1,onSelect(y){n.mark("cut"),l(y)}},{id:"copy",label:"action.copy",kbd:"$c",readonlyOk:!0,onSelect(y){c(y)}},{id:"paste",label:"action.paste",kbd:"$v",readonlyOk:!1,onSelect(y){var x;(x=navigator.clipboard)==null||x.read().then(w=>{u(w,y,y==="context-menu"?n.inputs.currentPagePoint:void 0)})}},{id:"select-all",label:"action.select-all",kbd:"$a",readonlyOk:!0,onSelect(y){f("select-all-shapes",{source:y}),n.currentToolId!=="select"&&(n.cancel(),n.setSelectedTool("select")),n.mark("select all kbd"),n.selectAll()}},{id:"select-none",label:"action.select-none",readonlyOk:!0,onSelect(y){f("select-none-shapes",{source:y}),n.mark("select none"),n.selectNone()}},{id:"delete",label:"action.delete",kbd:"⌫",icon:"trash",readonlyOk:!1,onSelect(y){n.currentToolId==="select"&&(f("delete-shapes",{source:y}),n.mark("delete"),n.deleteShapes())}},{id:"rotate-cw",label:"action.rotate-cw",icon:"rotate-cw",readonlyOk:!1,onSelect(y){if(n.selectedIds.length===0)return;f("rotate-cw",{source:y}),n.mark("rotate-cw");const x=n.selectionRotation%(tt/2),w=ud(x,0)||ud(x,tt/2);n.rotateShapesBy(n.selectedIds,tt/2-(w?0:x))}},{id:"rotate-ccw",label:"action.rotate-ccw",icon:"rotate-ccw",readonlyOk:!1,onSelect(y){if(n.selectedIds.length===0)return;f("rotate-ccw",{source:y}),n.mark("rotate-ccw");const x=n.selectionRotation%(tt/2),w=ud(x,0);n.rotateShapesBy(n.selectedIds,w?-(tt/2):-x)}},{id:"zoom-in",label:"action.zoom-in",kbd:"$=",readonlyOk:!0,onSelect(y){f("zoom-in",{source:y}),n.zoomIn(n.viewportScreenCenter,{duration:ko})}},{id:"zoom-out",label:"action.zoom-out",kbd:"$-",readonlyOk:!0,onSelect(y){f("zoom-out",{source:y}),n.zoomOut(n.viewportScreenCenter,{duration:ko})}},{id:"zoom-to-100",label:"action.zoom-to-100",icon:"reset-zoom",kbd:"!0",readonlyOk:!0,onSelect(y){f("reset-zoom",{source:y}),n.resetZoom(n.viewportScreenCenter,{duration:ko})}},{id:"zoom-to-fit",label:"action.zoom-to-fit",kbd:"!1",readonlyOk:!0,onSelect(y){f("zoom-to-fit",{source:y}),n.zoomToFit({duration:ko})}},{id:"zoom-to-selection",label:"action.zoom-to-selection",kbd:"!2",readonlyOk:!0,onSelect(y){f("zoom-to-selection",{source:y}),n.zoomToSelection({duration:ko})}},{id:"toggle-snap-mode",label:"action.toggle-snap-mode",menuLabel:"action.toggle-snap-mode.menu",readonlyOk:!1,onSelect(y){f("toggle-snap-mode",{source:y}),n.setSnapMode(!n.isSnapMode)},checkbox:!0},{id:"toggle-dark-mode",label:"action.toggle-dark-mode",menuLabel:"action.toggle-dark-mode.menu",kbd:"$/",readonlyOk:!0,onSelect(y){f("toggle-dark-mode",{source:y}),n.setDarkMode(!n.isDarkMode)},checkbox:!0},{id:"toggle-reduce-motion",label:"action.toggle-reduce-motion",menuLabel:"action.toggle-reduce-motion.menu",readonlyOk:!0,onSelect(y){f("toggle-reduce-motion",{source:y}),n.setAnimationSpeed(n.animationSpeed===0?1:0)},checkbox:!0},{id:"toggle-transparent",label:"action.toggle-transparent",menuLabel:"action.toggle-transparent.menu",contextMenuLabel:"action.toggle-transparent.context-menu",readonlyOk:!0,onSelect(y){f("toggle-transparent",{source:y}),n.updateInstanceState({exportBackground:!n.instanceState.exportBackground},!0)},checkbox:!0},{id:"toggle-tool-lock",label:"action.toggle-tool-lock",menuLabel:"action.toggle-tool-lock.menu",readonlyOk:!1,kbd:"q",onSelect(y){f("toggle-tool-lock",{source:y}),n.setToolLocked(!n.isToolLocked)},checkbox:!0},{id:"toggle-focus-mode",label:"action.toggle-focus-mode",menuLabel:"action.toggle-focus-mode.menu",readonlyOk:!0,kbd:"$.",checkbox:!0,onSelect(y){requestAnimationFrame(()=>{n.batch(()=>{f("toggle-focus-mode",{source:y}),i(),o(),n.setFocusMode(!n.isFocusMode)})})}},{id:"toggle-grid",label:"action.toggle-grid",menuLabel:"action.toggle-grid.menu",readonlyOk:!0,kbd:"$'",onSelect(y){f("toggle-grid-mode",{source:y}),n.setGridMode(!n.isGridMode)},checkbox:!0},{id:"toggle-debug-mode",label:"action.toggle-debug-mode",menuLabel:"action.toggle-debug-mode.menu",readonlyOk:!0,onSelect(y){f("toggle-debug-mode",{source:y}),n.updateInstanceState({isDebugMode:!n.instanceState.isDebugMode},!0)},checkbox:!0},{id:"print",label:"action.print",kbd:"$p",readonlyOk:!0,onSelect(y){f("print",{source:y}),a()}},{id:"exit-pen-mode",label:"action.exit-pen-mode",icon:"cross-2",readonlyOk:!0,onSelect(y){f("exit-pen-mode",{source:y}),n.setPenMode(!1)}},{id:"stop-following",label:"action.stop-following",icon:"cross-2",readonlyOk:!0,onSelect(y){f("stop-following",{source:y}),n.stopFollowingUser()}},{id:"back-to-content",label:"action.back-to-content",icon:"arrow-left",readonlyOk:!0,onSelect(y){f("zoom-to-content",{source:y}),n.zoomToContent()}},{id:"toggle-lock",label:"action.toggle-lock",readonlyOk:!1,kbd:"!$l",onSelect(y){f("toggle-lock",{source:y}),n.toggleLock()}}]);return e?e(n,g,void 0):g},[f,e,n,r,s,h,d,l,c,u,i,o,a]);return m.jsx(B4.Provider,{value:p,children:t})}function Nn(){const e=b.useContext(B4);if(!e)throw new Error("useTools must be used within a ToolProvider");return e}function Q_(e){return e.filter(t=>t!=null&&t!==!1)}function He(e,...t){const n=Q_(t);return n.length===0?null:{id:e,type:"group",checkbox:n.every(r=>r.type==="item"&&r.actionItem.checkbox),disabled:n.every(r=>r.disabled),readonlyOk:n.some(r=>r.readonlyOk),children:n}}function Ki(e,t,...n){const r=Q_(n);return r.length===0?null:{id:e,type:"submenu",label:t,children:r,disabled:r.every(i=>i.disabled),readonlyOk:r.some(i=>i.readonlyOk)}}function J_(e,t={}){const{readonlyOk:n=!0,disabled:r=!1}=t;return{id:e,type:"custom",disabled:r,readonlyOk:n}}function X(e,t={}){if(!e)throw Error("No action item provided to menuItem");if(!e.label)throw Error("Trying to create menu item for action item that doesn't have a label");const{checked:n=!1,disabled:r=!1}=t;return{id:e.id,type:"item",actionItem:e,disabled:r,checked:n,readonlyOk:e.readonlyOk}}function R4(e){const{selectedIds:t}=e;return t.map(r=>e.getShapeById(r)).filter(r=>!(!r||e.isShapeOfType(r,Qt)&&r.props.start.type==="binding"||e.isShapeOfType(r,Qt)&&r.props.end.type==="binding"))}const D4=()=>{const e=re();return ye("threeStackableItems",()=>R4(e).length>2,[e])},eC=()=>{const e=re();return ye("allowGroup",()=>R4(e).length>1,[e])},tC=()=>{const e=re();return ye("allowUngroup",()=>e.selectedIds.some(t=>{var n;return((n=e.getShapeById(t))==null?void 0:n.type)==="group"}),[])},F4=typeof window<"u"&&"navigator"in window&&!!navigator.clipboard&&!!navigator.clipboard.read,Woe=[0,380,420,460,580,640,840,1023],N4=ke.createContext(0);function Hoe({children:e}){const t=re(),n=ye("breakpoint",()=>{const{width:r}=t.viewportScreenBounds,i=Woe;for(let o=0;o<i.length-1;o++)if(r>i[o]&&r<=i[o+1])return o;return i.length},[t]);return m.jsx(N4.Provider,{value:n,children:e})}function fi(){let e=b.useContext(N4);const t=new URL(window.location.href).searchParams.get("layout");return t==="desktop"?e=7:t==="mobile"&&(e=1),e}function nC(){const e=re();return ye("hasLinkShapeSelected",()=>{const{selectedShapes:t}=e;return t.length===1&&"url"in t[0].props&&t[0].type!=="embed"},[e])}const j4=ke.createContext({}),Koe=Ke(function({overrides:t,children:n}){const r=re(),i=Nn(),o=r.selectedIds.length,s=o>0,a=o>1,l=o>2,c=D4(),u=eC(),d=tC(),h=nC(),f=fi(),p=r.zoomLevel===1,g=b.useMemo(()=>{const y=[X(i["align-left"],{disabled:!a}),X(i["align-center-horizontal"],{disabled:!a}),X(i["align-right"],{disabled:!a}),X(i["stretch-horizontal"],{disabled:!a}),X(i["align-top"],{disabled:!a}),X(i["align-center-vertical"],{disabled:!a}),X(i["align-bottom"],{disabled:!a}),X(i["stretch-vertical"],{disabled:!a}),X(i["distribute-horizontal"],{disabled:!l}),X(i["distribute-vertical"],{disabled:!l}),X(i["stack-horizontal"],{disabled:!c}),X(i["stack-vertical"],{disabled:!c}),X(i["send-to-back"],{disabled:!s}),X(i["send-backward"],{disabled:!s}),X(i["bring-forward"],{disabled:!s}),X(i["bring-to-front"],{disabled:!s}),f<5?X(i["zoom-to-100"],{disabled:!!p}):X(i["rotate-ccw"],{disabled:!s}),X(i["rotate-cw"],{disabled:!s}),X(i["edit-link"],{disabled:!h}),u?X(i.group,{disabled:!a}):d?X(i.ungroup):X(i.group,{disabled:!a})];return t?t(r,y,{actions:i,oneSelected:s,twoSelected:a,threeSelected:l}):y},[r,p,u,t,i,s,a,l,c,d,h,f]);return m.jsx(j4.Provider,{value:g,children:n})});function Voe(){const e=ke.useContext(j4);if(!e)throw new Error("useActionsMenuSchema must be used inside of a ActionsMenuSchemaProvider.");return e}function Yoe(){const e=re();return ye("onlyFlippableShape",()=>{const{selectedShapes:t}=e;return t.length===1&&t.every(n=>n.type==="group"||n.type==="arrow"||n.type==="line"||n.type==="draw")},[e])}function z4(){const e=re();return ye("showAutoSizeToggle",()=>{const{selectedShapes:t}=e;return t.length===1&&e.isShapeOfType(t[0],cl)&&t[0].props.autoSize===!1},[e])}const U4=ke.createContext({}),qoe=Ke(function({overrides:t,children:n}){var I;const r=re(),i=Nn(),o=z4(),s=Yoe(),a=r.selectedIds.length,l=a>0,c=ye("oneEmbedSelected",()=>r.selectedIds.length!==1?!1:r.selectedIds.some($=>{const L=r.getShapeById($);return L&&r.isShapeOfType(L,$c)&&L.props.url}),[]),u=ye("oneEmbeddableBookmarkSelected",()=>r.selectedIds.length!==1?!1:r.selectedIds.some($=>{const L=r.getShapeById($);return L&&r.isShapeOfType(L,Jc)&&$s(L.props.url)}),[]),d=a>1,h=a>2,f=D4(),p=ye("atLeastOneShapeOnPage",()=>r.shapeIds.size>0,[]),g=ye("isTransparentBg",()=>r.instanceState.exportBackground,[]),y=eC(),x=tC(),w=!!((I=window.navigator.clipboard)!=null&&I.write),_=nC(),{onlySelectedShape:S}=r,T=S&&r.isShapeOrAncestorLocked(S),P=b.useMemo(()=>{let $=Q_([He("selection",c&&X(i["open-embed-link"]),c&&!T&&X(i["convert-to-bookmark"]),u&&X(i["convert-to-embed"]),o&&X(i["toggle-auto-size"]),_&&!T&&X(i["edit-link"]),l&&!T&&X(i.duplicate),y&&!T&&X(i.group),x&&!T&&X(i.ungroup),l&&X(i["toggle-lock"])),He("modify",(d||s)&&Ki("arrange","context-menu.arrange",d&&He("align",X(i["align-left"]),X(i["align-center-horizontal"]),X(i["align-right"]),X(i["align-top"]),X(i["align-center-vertical"]),X(i["align-bottom"])),h&&He("distribute",X(i["distribute-horizontal"]),X(i["distribute-vertical"])),d&&He("stretch",X(i["stretch-horizontal"]),X(i["stretch-vertical"])),s&&!T&&He("flip",X(i["flip-horizontal"]),X(i["flip-vertical"])),d&&He("order",X(i.pack,{disabled:!d}),f&&X(i["stack-vertical"]),f&&X(i["stack-horizontal"]))),l&&!T&&Ki("reorder","context-menu.reorder",He("reorder",X(i["bring-to-front"]),X(i["bring-forward"]),X(i["send-backward"]),X(i["send-to-back"]))),l&&!T&&J_("MOVE_TO_PAGE_MENU",{readonlyOk:!1})),He("clipboard-group",l&&!T&&X(i.cut),l&&X(i.copy),F4&&X(i.paste)),p&&He("conversions",Ki("copy-as","context-menu.copy-as",He("copy-as-group",X(i["copy-as-svg"]),w&&X(i["copy-as-png"]),X(i["copy-as-json"])),He("export-bg",X(i["toggle-transparent"],{checked:!g}))),Ki("export-as","context-menu.export-as",He("export-as-group",X(i["export-as-svg"]),X(i["export-as-png"]),X(i["export-as-json"])),He("export-bg,",X(i["toggle-transparent"],{checked:!g})))),p&&He("set-selection-group",X(i["select-all"]),l&&X(i["select-none"])),l&&!T&&He("delete-group",X(i.delete))]);return t&&($=t(r,$,{actions:i,oneSelected:l,twoSelected:d,threeSelected:h,showAutoSizeToggle:o,showUngroup:x,onlyFlippableShapeSelected:s})),$},[r,t,i,l,d,h,o,s,p,f,y,x,w,_,c,u,g,T]);return m.jsx(U4.Provider,{value:P,children:n})});function W4(){const e=ke.useContext(U4);if(!e)throw new Error("useContextMenuSchema must be used inside of a TLUiContextMenuSchemaProvider.");return e}const H4=b.createContext({});function Goe({overrides:e,children:t}){const n=re(),r=nu(),{addDialog:i}=fl(),o=L4(),s=ye(l_.highlighterTool),a=b.useMemo(()=>{const l=[{id:"select",label:"tool.select",icon:"tool-pointer",kbd:"v",readonlyOk:!0,onSelect(u){n.setSelectedTool("select"),r("select-tool",{source:u,id:"select"})}},{id:"hand",label:"tool.hand",icon:"tool-hand",kbd:"h",readonlyOk:!0,onSelect(u){n.setSelectedTool("hand"),r("select-tool",{source:u,id:"hand"})}},{id:"eraser",label:"tool.eraser",icon:"tool-eraser",kbd:"e",readonlyOk:!1,onSelect(u){n.setSelectedTool("eraser"),r("select-tool",{source:u,id:"eraser"})}},{id:"draw",label:"tool.draw",readonlyOk:!1,icon:"tool-pencil",kbd:"d,b,x",onSelect(u){n.setSelectedTool("draw"),r("select-tool",{source:u,id:"draw"})}},...[...UM].map(u=>({id:u,label:`tool.${u}`,readonlyOk:!1,meta:{geo:u},kbd:u==="rectangle"?"r":u==="ellipse"?"o":void 0,icon:"geo-"+u,onSelect(d){n.batch(()=>{n.updateInstanceState({propsForNextShape:{...n.instanceState.propsForNextShape,geo:u}},!0),n.setSelectedTool("geo"),r("select-tool",{source:d,id:`geo-${u}`})})}})),{id:"arrow",label:"tool.arrow",readonlyOk:!1,icon:"tool-arrow",kbd:"a",onSelect(u){n.setSelectedTool("arrow"),r("select-tool",{source:u,id:"arrow"})}},{id:"line",label:"tool.line",readonlyOk:!1,icon:"tool-line",kbd:"l",onSelect(u){n.setSelectedTool("line"),r("select-tool",{source:u,id:"line"})}},{id:"frame",label:"tool.frame",readonlyOk:!1,icon:"tool-frame",kbd:"f",onSelect(u){n.setSelectedTool("frame"),r("select-tool",{source:u,id:"frame"})}},{id:"text",label:"tool.text",readonlyOk:!1,icon:"tool-text",kbd:"t",onSelect(u){n.setSelectedTool("text"),r("select-tool",{source:u,id:"text"})}},{id:"asset",label:"tool.asset",readonlyOk:!1,icon:"tool-media",kbd:"$u",onSelect(u){o(),r("select-tool",{source:u,id:"media"})}},{id:"note",label:"tool.note",readonlyOk:!1,icon:"tool-note",kbd:"n",onSelect(u){n.setSelectedTool("note"),r("select-tool",{source:u,id:"note"})}},{id:"laser",label:"tool.laser",readonlyOk:!0,icon:"tool-laser",kbd:"k",onSelect(u){n.setSelectedTool("laser"),r("select-tool",{source:u,id:"laser"})}},{id:"embed",label:"tool.embed",readonlyOk:!1,icon:"tool-embed",onSelect(u){i({component:k4}),r("select-tool",{source:u,id:"embed"})}}];s&&l.push({id:"highlight",label:"tool.highlight",readonlyOk:!0,icon:"tool-highlight",kbd:"!d",onSelect(u){n.setSelectedTool("highlight"),r("select-tool",{source:u,id:"highlight"})}});const c=Object.fromEntries(l.map(u=>[u.id,u]));return e?e(n,c,{insertMedia:o}):c},[s,e,n,r,o,i]);return m.jsx(H4.Provider,{value:a,children:t})}function rC(){const e=b.useContext(H4);if(!e)throw new Error("useTools must be used within a ToolProvider");return e}const K4=ke.createContext({}),Xoe=Ke(function({overrides:t,children:n}){const r=re(),i=rC(),o=Nn(),s=b.useMemo(()=>{const a=Ae([He("shortcuts-dialog.tools",X(o["toggle-tool-lock"]),X(i.select),X(i.draw),X(i.eraser),X(i.hand),X(i.rectangle),X(i.ellipse),X(i.arrow),X(i.line),X(i.text),X(i.frame),X(i.note),X(i.laser)),He("shortcuts-dialog.file",X(o["insert-media"]),X(o.print)),He("shortcuts-dialog.preferences",X(o["toggle-dark-mode"]),X(o["toggle-focus-mode"]),X(o["toggle-grid"])),He("shortcuts-dialog.edit",X(o.undo),X(o.redo),X(o.cut),X(o.copy),X(o.paste),X(o["select-all"]),X(o.delete),X(o.duplicate),X(o["export-as-svg"]),X(o["export-as-png"])),He("shortcuts-dialog.view",X(o["zoom-in"]),X(o["zoom-out"]),X(o["zoom-to-100"]),X(o["zoom-to-fit"]),X(o["zoom-to-selection"])),He("shortcuts-dialog.transform",X(o["bring-to-front"]),X(o["bring-forward"]),X(o["send-backward"]),X(o["send-to-back"]),X(o.group),X(o.ungroup),X(o["flip-horizontal"]),X(o["flip-vertical"]),X(o["align-top"]),X(o["align-center-vertical"]),X(o["align-bottom"]),X(o["align-left"]),X(o["align-center-horizontal"]),X(o["align-right"]))]);return t?t(r,a,{tools:i,actions:o}):a},[r,t,o,i]);return m.jsx(K4.Provider,{value:s,children:n})});function Zoe(){const e=ke.useContext(K4);if(!e)throw new Error("Shortcuts must be used inside of a ShortcutsProvider.");return e}function co(){const e=re();return ye("isReadOnlyMode",()=>e.isReadOnly,[e])}const Qoe=()=>{const e=qe(),t=co(),n=Zoe();function r(i){if(t&&!i.readonlyOk)return null;switch(i.type){case"group":return m.jsxs("div",{className:"tlui-shortcuts-dialog__group",children:[m.jsx("h2",{className:"tlui-shortcuts-dialog__group__title",children:e(i.id)}),m.jsx("div",{className:"tlui-shortcuts-dialog__group__content",children:i.children.filter(o=>o.type==="item"&&o.actionItem.kbd).map(r)})]},i.id);case"item":{const{id:o,label:s,shortcutsLabel:a,kbd:l}=i.actionItem;return m.jsxs("div",{className:"tlui-shortcuts-dialog__key-pair",children:[m.jsx("div",{className:"tlui-shortcuts-dialog__key-pair__key",children:e(a??s)}),m.jsx("div",{className:"tlui-shortcuts-dialog__key-pair__value",children:m.jsx(By,{children:l})})]},o)}}}return m.jsxs(m.Fragment,{children:[m.jsxs(Ry,{className:"tlui-shortcuts-dialog__header",children:[m.jsx(Dy,{children:e("shortcuts-dialog.title")}),m.jsx(Fy,{})]}),m.jsx(Qd,{className:"tlui-shortcuts-dialog__body",children:n.map(r)}),m.jsx("div",{className:"tlui-dialog__scrim"})]})};function V4(){const e=re();return{languages:Nd,currentLanguage:e.locale}}const Y4=ke.createContext({}),Joe=Ke(function({overrides:t,children:n}){const r=re(),i=Nn(),o=r.selectedIds.length,s=o>0,a=o>1,l=o>2,{languages:c,currentLanguage:u}=V4(),{addDialog:d}=fl(),h=b.useMemo(()=>{const f=Ae([He("top",J_("LANGUAGE_MENU",{readonlyOk:!0}),X({id:"keyboard-shortcuts",label:"help-menu.keyboard-shortcuts",readonlyOk:!0,onSelect(){d({component:Qoe})}}))]);return t?t(r,f,{actions:i,currentLanguage:u,languages:c,oneSelected:s,twoSelected:a,threeSelected:l}):f},[r,t,c,i,s,a,l,u,d]);return m.jsx(Y4.Provider,{value:h,children:n})});function ese(){const e=ke.useContext(Y4);if(!e)throw new Error("useHelpMenuSchema must be used inside of a helpTLUiMenuSchemaProvider.");return e}function q4(){const e=re();return ye("useCanRedo",()=>e.canRedo,[e])}function G4(){const e=re();return ye("useCanUndo",()=>e.canUndo,[e])}const X4=ke.createContext({});function tse({overrides:e,children:t}){var j;const n=re(),r=Nn(),o=fi()<5,s=ye("isDarkMode",()=>n.isDarkMode,[n]),a=ye("animationSpeed",()=>n.animationSpeed,[n]),l=ye("isGridMode",()=>n.isGridMode,[n]),c=ye("isSnapMode",()=>n.isSnapMode,[n]),u=ye("isToolLock",()=>n.instanceState.isToolLocked,[n]),d=ye("isFocusMode",()=>n.instanceState.isFocusMode,[n]),h=ye("isDebugMode",()=>n.instanceState.isDebugMode,[n]),f=ye("exportBackground",()=>n.instanceState.exportBackground,[n]),p=ye("emptyPage",()=>n.shapeIds.size===0,[n]),g=ye("selectedCount",()=>n.selectedIds.length,[n]),y=g===0,x=g>0,w=g>1,_=g>2,S=!!((j=window.navigator.clipboard)!=null&&j.write),T=nC(),P=z4(),I=eC(),$=tC(),L=G4(),R=q4(),K=ye("isZoomedTo100",()=>n.zoomLevel===1,[n]),Q=b.useMemo(()=>{const B=Ae([He("menu",Ki("file","menu.file",He("print",X(r.print,{disabled:p}))),Ki("edit","menu.edit",He("undo-actions",X(r.undo,{disabled:!L}),X(r.redo,{disabled:!R})),He("clipboard-actions",X(r.cut,{disabled:y}),X(r.copy,{disabled:y}),X(r.paste,{disabled:!F4})),He("conversions",Ki("copy-as","menu.copy-as",He("copy-as-group",X(r["copy-as-svg"],{disabled:p}),X(r["copy-as-png"],{disabled:p||!S}),X(r["copy-as-json"],{disabled:p})),He("export-bg",X(r["toggle-transparent"],{checked:!f}))),Ki("export-as","menu.export-as",He("export-as-group",X(r["export-as-svg"],{disabled:p}),X(r["export-as-png"],{disabled:p}),X(r["export-as-json"],{disabled:p})),He("export-bg",X(r["toggle-transparent"],{checked:!f})))),He("set-selection-group",X(r["select-all"],{disabled:p}),X(r["select-none"],{disabled:!x})),He("selection",P&&X(r["toggle-auto-size"]),T&&X(r["edit-link"]),X(r.duplicate,{disabled:!x}),I&&X(r.group),$&&X(r.ungroup)),He("delete-group",X(r.delete,{disabled:!x}))),Ki("view","menu.view",He("view-actions",X(r["zoom-in"]),X(r["zoom-out"]),X(r["zoom-to-100"],{disabled:K}),X(r["zoom-to-fit"],{disabled:p}),X(r["zoom-to-selection"],{disabled:p||!x})))),He("extras",X(r["insert-embed"]),X(r["insert-media"])),He("preferences",Ki("preferences","menu.preferences",He("preferences-actions",X(r["toggle-snap-mode"],{checked:c}),X(r["toggle-tool-lock"],{checked:u}),X(r["toggle-grid"],{checked:l}),X(r["toggle-dark-mode"],{checked:s}),X(r["toggle-focus-mode"],{checked:d}),X(r["toggle-reduce-motion"],{checked:a===0}),X(r["toggle-debug-mode"],{checked:h}))),o&&J_("LANGUAGE_MENU",{readonlyOk:!0}))]);return e?e(n,B,{actions:r,noneSelected:y,oneSelected:x,twoSelected:w,threeSelected:_}):B},[n,e,r,x,w,_,p,o,I,$,T,S,P,y,L,R,a,s,l,c,u,d,f,h,K]);return m.jsx(X4.Provider,{value:Q,children:t})}function nse(){const e=ke.useContext(X4);if(!e)throw new Error("useMenuSchema must be used inside of a TLUiMenuSchemaProvider.");return e}function it(e){return{id:e.id,type:"item",readonlyOk:e.readonlyOk,toolItem:e}}const Z4=ke.createContext([]);function rse({overrides:e,children:t}){const n=re(),r=rC(),i=ye(l_.highlighterTool),o=ke.useMemo(()=>{const s=Ae([it(r.select),it(r.hand),it(r.draw),it(r.eraser),it(r.arrow),it(r.text),it(r.note),it(r.asset),it(r.rectangle),it(r.ellipse),it(r.diamond),it(r.triangle),it(r.trapezoid),it(r.rhombus),it(r.pentagon),it(r.hexagon),it(r.star),it(r.oval),it(r["x-box"]),it(r["check-box"]),it(r["arrow-left"]),it(r["arrow-up"]),it(r["arrow-down"]),it(r["arrow-right"]),it(r.frame),it(r.line),i?it(r.highlight):null,it(r.laser)]);return e?e(n,s,{tools:r}):s},[n,i,e,r]);return m.jsx(Z4.Provider,{value:o,children:t})}function ise(){const e=ke.useContext(Z4);if(!e)throw new Error("useToolbarSchema must be used within a ToolbarSchemaProvider");return e}function ose(){const{addToast:e,removeToast:t,clearToasts:n}=lo(),{addDialog:r,clearDialogs:i,removeDialog:o,updateDialog:s}=fl(),l=fi()<5,c=qe();return b.useMemo(()=>({addToast:e,removeToast:t,clearToasts:n,addDialog:r,clearDialogs:i,removeDialog:o,updateDialog:s,msg:c,isMobile:l}),[r,e,i,n,c,o,t,s,l])}function sse(e,t){const n={};for(const r of e)if(r.translations)for(const[i,o]of js(r.translations)){let s=n[i];s||(s=n[i]={}),Object.assign(s,o)}return{actionsMenu:(r,i,o)=>{for(const s of e)s.actionsMenu&&(i=s.actionsMenu(r,i,{...t,...o}));return i},actions:(r,i)=>{for(const o of e)o.actions&&(i=o.actions(r,i,t));return i},contextMenu:(r,i,o)=>{for(const s of e)s.contextMenu&&(i=s.contextMenu(r,i,{...t,...o}));return i},helpMenu:(r,i,o)=>{for(const s of e)s.helpMenu&&(i=s.helpMenu(r,i,{...t,...o}));return i},menu:(r,i,o)=>{for(const s of e)s.menu&&(i=s.menu(r,i,{...t,...o}));return i},toolbar:(r,i,o)=>{for(const s of e)s.toolbar&&(i=s.toolbar(r,i,{...t,...o}));return i},keyboardShortcutsMenu:(r,i,o)=>{for(const s of e)s.keyboardShortcutsMenu&&(i=s.keyboardShortcutsMenu(r,i,{...t,...o}));return i},tools:(r,i,o)=>{for(const s of e)s.tools&&(i=s.tools(r,i,{...t,...o}));return i},translations:n}}function Q4(e){return b.useMemo(()=>e,e)}function ase(e){const t=Q4(e==null?[]:Array.isArray(e)?e:[e]);return b.useMemo(()=>{const n={};for(const r of t)if(r.translations)for(const[i,o]of js(r.translations)){let s=n[i];s||(s=n[i]={}),Object.assign(s,o)}return n},[t])}function lse(e){const t=ose(),n=Q4(e==null?[]:Array.isArray(e)?e:[e]);return b.useMemo(()=>sse(n,t),[n,t])}function cse({overrides:e,assetUrls:t,onUiEvent:n,children:r}){return m.jsx(wne,{assetUrls:t??coe,children:m.jsx(Cne,{overrides:ase(e),children:m.jsx(Lie,{onEvent:n,children:m.jsx(Loe,{children:m.jsx(Foe,{children:m.jsx(Hoe,{children:m.jsx(use,{overrides:e,children:r})})})})})})})}function use({overrides:e,children:t}){const n=lse(e);return m.jsx(Uoe,{overrides:n.actions,children:m.jsx(Goe,{overrides:n.tools,children:m.jsx(rse,{overrides:n.toolbar,children:m.jsx(Koe,{overrides:n.actionsMenu,children:m.jsx(Xoe,{overrides:n.keyboardShortcutsMenu,children:m.jsx(qoe,{overrides:n.contextMenu,children:m.jsx(Joe,{overrides:n.helpMenu,children:m.jsx(tse,{overrides:n.menu,children:t})})})})})})})})}function dse(){const e=re(),n=Nn()["back-to-content"],[r,i]=b.useState(!1);return b.useEffect(()=>{let o=!1;const s=setInterval(()=>{const{renderingShapes:a}=e,c=a.filter(u=>u.isInViewport).length===0&&e.shapesArray.length>0;o!==c&&(i(c),o=c)},1e3);return()=>{clearInterval(s)}},[e]),r?m.jsx(be,{iconLeft:n.icon,label:n.label,onClick:()=>{n.onSelect("helper-buttons"),i(!1)}}):null}let vP=0;function hse(e,t){const n=Array(t),r=Math.floor(Math.sqrt(t));for(let i=0;i<t;i++)vP++,n[i]={id:gt("box"+vP),type:"geo",x:i%r*132,y:Math.floor(i/r)*132};e.batch(()=>{e.createShapes(n).setSelectedIds(n.map(i=>i.id))})}const fse=b.memo(function({renderDebugMenuItems:t}){const n=qe();return m.jsxs("div",{className:"tlui-debug-panel",children:[m.jsx(pse,{}),m.jsx(gse,{}),m.jsxs(Qs,{id:"debug",children:[m.jsx(Wh,{children:m.jsx(be,{icon:"dots-horizontal",title:n("debug-panel.more")})}),m.jsx(Js,{side:"top",align:"end",alignOffset:0,children:m.jsx(mse,{renderDebugMenuItems:t})})]})]})}),pse=Ke(function(){const t=re();return m.jsx("div",{className:"tlui-debug-panel__current-state",children:t.root.path.value})}),gse=function(){const t=re(),n=ye("rendering shapes count",()=>t.renderingShapes.length,[t]);return m.jsxs("div",{children:[n," Shapes"]})},mse=Ke(function({renderDebugMenuItems:t}){const n=re(),{addToast:r}=lo(),{addDialog:i}=fl(),[o,s]=b.useState(!1);return m.jsxs(m.Fragment,{children:[m.jsxs(Lo,{children:[m.jsx(Pr,{onClick:()=>{r({id:At(),title:"Something happened",description:"Hey, attend to this thing over here. It might be important!"})},children:m.jsx("span",{children:"Show toast"})}),m.jsx(Pr,{onClick:()=>{i({component:({onClose:a})=>m.jsx(vse,{displayDontShowAgain:!0,onCancel:()=>{a()},onContinue:()=>{a()}}),onClose:()=>{}})},children:m.jsx("span",{children:"Show dialog"})}),m.jsx(Pr,{onClick:()=>hse(n,100),children:m.jsx("span",{children:"Create 100 shapes"})}),m.jsx(Pr,{onClick:()=>{function a({children:h}){let f=0;if(!h.length)return 0;for(const p of[...h])f++,f+=a(p);return f}const{selectedShapes:l}=n,c=l.length===0?n.renderingShapes:l,u=c.map(h=>document.getElementById(h.id).parentElement);let d=u.length;for(const h of u)d+=a(h);window.alert(`Shapes ${c.length}, DOM nodes:${d}`)},children:m.jsx("span",{children:"Count shapes and nodes"})}),(()=>{if(o)throw Error("oh no!")})(),m.jsx(Pr,{onClick:()=>{s(!0)},children:m.jsx("span",{children:"Throw error"})}),m.jsx(Pr,{onClick:()=>{ZM()},children:m.jsx("span",{children:"Hard reset"})})]}),m.jsxs(Lo,{children:[m.jsx(J4,{label:"Read-only",value:n.isReadOnly,onChange:a=>n.setReadOnly(a)}),m.jsx(up,{flag:nn.debugSvg}),m.jsx(up,{flag:nn.forceSrgb}),m.jsx(up,{flag:nn.debugCursors,onChange:a=>{if(a){const c=yse.map((u,d)=>({id:gt(),type:"geo",x:d%5*175,y:Math.floor(d/5)*175,props:{text:u,w:150,h:150,fill:"semi"}}));n.createShapes(c)}}})]}),m.jsx(Lo,{children:Object.values(l_).map(a=>m.jsx(up,{flag:a},a.name))}),t==null?void 0:t()]})});function J4({label:e,value:t,onChange:n}){return m.jsx(m4,{title:e,checked:t,onSelect:()=>n(!t),children:e})}const up=Ke(function({flag:t,onChange:n}){return m.jsx(J4,{label:t.name.replace(/([a-z0-9])([A-Z])/g,r=>`${r[0]} ${r[1].toLowerCase()}`).replace(/^[a-z]/,r=>r.toUpperCase()),value:t.value,onChange:r=>{t.set(r),n==null||n(r)}})}),yse=["none","default","pointer","cross","move","grab","grabbing","text","ew-resize","ns-resize","nesw-resize","nwse-resize","nwse-rotate","nesw-rotate","senw-rotate","swne-rotate","zoom-in","zoom-out"];function vse({title:e="title",body:t="hello hello hello",cancel:n="Cancel",confirm:r="Continue",displayDontShowAgain:i=!1,onCancel:o,onContinue:s}){const[a,l]=b.useState(!1);return m.jsxs(m.Fragment,{children:[m.jsxs(Ry,{children:[m.jsx(Dy,{children:e}),m.jsx(Fy,{})]}),m.jsx(Qd,{style:{maxWidth:350},children:t}),m.jsxs(O_,{className:"tlui-dialog__footer__actions",children:[i&&m.jsx(be,{onClick:()=>l(!a),iconLeft:a?"checkbox-checked":"checkbox-empty",style:{marginRight:"auto"},children:"Don't show again"}),m.jsx(be,{onClick:o,children:n}),m.jsx(be,{type:"primary",onClick:async()=>s(),children:r})]})]})}const xse=({id:e,component:t,onClose:n})=>{const{removeDialog:r}=fl(),i=tr(),o=b.useCallback(s=>{if(!s){if(n)try{n()}catch(a){console.warn(a)}r(e)}},[e,n,r]);return m.jsx(yne,{onOpenChange:o,defaultOpen:!0,children:m.jsx(vne,{container:i,children:m.jsx(xne,{dir:"ltr",className:"tlui-dialog__overlay",children:m.jsx(bne,{dir:"ltr",className:"tlui-dialog__content",children:m.jsx(t,{onClose:()=>o(!1)})})})})})};function bse(){const{dialogs:e}=fl();return m.jsx(m.Fragment,{children:e.map(t=>m.jsx(xse,{...t},t.id))})}const wse=ke.memo(bse);function Sse(){const e=re(),t=ye("follow",()=>e.instanceState.followingUserId,[e]);return t?m.jsx(_se,{userId:t}):null}function _se({userId:e}){const t=L5(e);return t?m.jsx("div",{className:"tlui-following",style:{borderColor:t.color}}):null}function eL(){const e=re(),{languages:t,currentLanguage:n}=V4(),r=b.useCallback(i=>e.setLocale(i),[e]);return m.jsxs(K_,{id:"help menu language",children:[m.jsx(V_,{label:"menu.language","data-direction":"left"}),m.jsx(Y_,{sideOffset:-4,children:m.jsx(Lo,{children:t.map(({locale:i,label:o})=>m.jsx(Bie,{title:i,checked:i===n,onSelect:()=>r(i),children:m.jsx("span",{children:o})},i))})})]})}const Cse=b.memo(function(){const t=tr(),n=qe(),[r,i]=hl("help menu");return m.jsx("div",{className:"tlui-help-menu",children:m.jsxs(h4,{dir:"ltr",open:r,onOpenChange:i,modal:!1,children:[m.jsx(rh,{className:"tlui-button tlui-help-menu__button",dir:"ltr",title:n("help-menu.title"),children:m.jsx(mr,{icon:"question-mark"})}),m.jsx(H_,{container:t,dir:"ltr",children:m.jsx(f4,{className:"tlui-menu",side:"top",sideOffset:8,align:"end",alignOffset:0,collisionPadding:4,children:m.jsx(Ese,{})})})]})})});function Ese(){const e=ese(),t=co();function n(r){if(t&&!r.readonlyOk)return null;switch(r.type){case"custom":{if(r.id==="LANGUAGE_MENU")return m.jsx(eL,{},"item");break}case"group":return m.jsx(Lo,{size:"small",children:r.children.map(n)},r.id);case"submenu":return m.jsxs(K_,{id:`help menu ${r.id}`,children:[m.jsx(V_,{label:r.label}),m.jsx(Y_,{children:r.children.map(n)})]},r.id);case"item":{const{id:i,kbd:o,label:s,onSelect:a,icon:l}=r.actionItem;return m.jsx(Pr,{kbd:o,label:s,onClick:()=>a("help-menu"),iconLeft:l},i)}}}return m.jsx(m.Fragment,{children:e.map(n)})}function ja(e,t,{checkForDefaultPrevented:n=!0}={}){return function(i){if(e==null||e(i),n===!1||!i.defaultPrevented)return t==null?void 0:t(i)}}function kse(e,t){typeof e=="function"?e(t):e!=null&&(e.current=t)}function tL(...e){return t=>e.forEach(n=>kse(n,t))}function pl(...e){return b.useCallback(tL(...e),e)}function nL(e,t=[]){let n=[];function r(o,s){const a=b.createContext(s),l=n.length;n=[...n,s];function c(d){const{scope:h,children:f,...p}=d,g=(h==null?void 0:h[e][l])||a,y=b.useMemo(()=>p,Object.values(p));return b.createElement(g.Provider,{value:y},f)}function u(d,h){const f=(h==null?void 0:h[e][l])||a,p=b.useContext(f);if(p)return p;if(s!==void 0)return s;throw new Error(`\`${d}\` must be used within \`${o}\``)}return c.displayName=o+"Provider",[c,u]}const i=()=>{const o=n.map(s=>b.createContext(s));return function(a){const l=(a==null?void 0:a[e])||o;return b.useMemo(()=>({[`__scope${e}`]:{...a,[e]:l}}),[a,l])}};return i.scopeName=e,[r,Tse(i,...t)]}function Tse(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(o){const s=r.reduce((a,{useScope:l,scopeName:c})=>{const d=l(o)[`__scope${c}`];return{...a,...d}},{});return b.useMemo(()=>({[`__scope${t.scopeName}`]:s}),[s])}};return n.scopeName=t.scopeName,n}const iC=b.forwardRef((e,t)=>{const{children:n,...r}=e,i=b.Children.toArray(n),o=i.find(Ise);if(o){const s=o.props.children,a=i.map(l=>l===o?b.Children.count(s)>1?b.Children.only(null):b.isValidElement(s)?s.props.children:null:l);return b.createElement(Nb,oe({},r,{ref:t}),b.isValidElement(s)?b.cloneElement(s,void 0,a):null)}return b.createElement(Nb,oe({},r,{ref:t}),n)});iC.displayName="Slot";const Nb=b.forwardRef((e,t)=>{const{children:n,...r}=e;return b.isValidElement(n)?b.cloneElement(n,{...$se(r,n.props),ref:tL(t,n.ref)}):b.Children.count(n)>1?b.Children.only(null):null});Nb.displayName="SlotClone";const Pse=({children:e})=>b.createElement(b.Fragment,null,e);function Ise(e){return b.isValidElement(e)&&e.type===Pse}function $se(e,t){const n={...t};for(const r in t){const i=e[r],o=t[r];/^on[A-Z]/.test(r)?i&&o?n[r]=(...a)=>{o(...a),i(...a)}:i&&(n[r]=i):r==="style"?n[r]={...i,...o}:r==="className"&&(n[r]=[i,o].filter(Boolean).join(" "))}return{...e,...n}}const Ase=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Ja=Ase.reduce((e,t)=>{const n=b.forwardRef((r,i)=>{const{asChild:o,...s}=r,a=o?iC:t;return b.useEffect(()=>{window[Symbol.for("radix-ui")]=!0},[]),b.createElement(a,oe({},s,{ref:i}))});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function Mse(e,t){e&&Yo.flushSync(()=>e.dispatchEvent(t))}function ea(e){const t=b.useRef(e);return b.useEffect(()=>{t.current=e}),b.useMemo(()=>(...n)=>{var r;return(r=t.current)===null||r===void 0?void 0:r.call(t,...n)},[])}function Ose(e,t=globalThis==null?void 0:globalThis.document){const n=ea(e);b.useEffect(()=>{const r=i=>{i.key==="Escape"&&n(i)};return t.addEventListener("keydown",r),()=>t.removeEventListener("keydown",r)},[n,t])}const jb="dismissableLayer.update",Lse="dismissableLayer.pointerDownOutside",Bse="dismissableLayer.focusOutside";let xP;const Rse=b.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Dse=b.forwardRef((e,t)=>{var n;const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:s,onInteractOutside:a,onDismiss:l,...c}=e,u=b.useContext(Rse),[d,h]=b.useState(null),f=(n=d==null?void 0:d.ownerDocument)!==null&&n!==void 0?n:globalThis==null?void 0:globalThis.document,[,p]=b.useState({}),g=pl(t,$=>h($)),y=Array.from(u.layers),[x]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),w=y.indexOf(x),_=d?y.indexOf(d):-1,S=u.layersWithOutsidePointerEventsDisabled.size>0,T=_>=w,P=Fse($=>{const L=$.target,R=[...u.branches].some(K=>K.contains(L));!T||R||(o==null||o($),a==null||a($),$.defaultPrevented||l==null||l())},f),I=Nse($=>{const L=$.target;[...u.branches].some(K=>K.contains(L))||(s==null||s($),a==null||a($),$.defaultPrevented||l==null||l())},f);return Ose($=>{_===u.layers.size-1&&(i==null||i($),!$.defaultPrevented&&l&&($.preventDefault(),l()))},f),b.useEffect(()=>{if(d)return r&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(xP=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(d)),u.layers.add(d),bP(),()=>{r&&u.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=xP)}},[d,f,r,u]),b.useEffect(()=>()=>{d&&(u.layers.delete(d),u.layersWithOutsidePointerEventsDisabled.delete(d),bP())},[d,u]),b.useEffect(()=>{const $=()=>p({});return document.addEventListener(jb,$),()=>document.removeEventListener(jb,$)},[]),b.createElement(Ja.div,oe({},c,{ref:g,style:{pointerEvents:S?T?"auto":"none":void 0,...e.style},onFocusCapture:ja(e.onFocusCapture,I.onFocusCapture),onBlurCapture:ja(e.onBlurCapture,I.onBlurCapture),onPointerDownCapture:ja(e.onPointerDownCapture,P.onPointerDownCapture)}))});function Fse(e,t=globalThis==null?void 0:globalThis.document){const n=ea(e),r=b.useRef(!1),i=b.useRef(()=>{});return b.useEffect(()=>{const o=a=>{if(a.target&&!r.current){let c=function(){rL(Lse,n,l,{discrete:!0})};const l={originalEvent:a};a.pointerType==="touch"?(t.removeEventListener("click",i.current),i.current=c,t.addEventListener("click",i.current,{once:!0})):c()}r.current=!1},s=window.setTimeout(()=>{t.addEventListener("pointerdown",o)},0);return()=>{window.clearTimeout(s),t.removeEventListener("pointerdown",o),t.removeEventListener("click",i.current)}},[t,n]),{onPointerDownCapture:()=>r.current=!0}}function Nse(e,t=globalThis==null?void 0:globalThis.document){const n=ea(e),r=b.useRef(!1);return b.useEffect(()=>{const i=o=>{o.target&&!r.current&&rL(Bse,n,{originalEvent:o},{discrete:!1})};return t.addEventListener("focusin",i),()=>t.removeEventListener("focusin",i)},[t,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function bP(){const e=new CustomEvent(jb);document.dispatchEvent(e)}function rL(e,t,n,{discrete:r}){const i=n.originalEvent.target,o=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&i.addEventListener(e,t,{once:!0}),r?Mse(i,o):i.dispatchEvent(o)}let l1=0;function jse(){b.useEffect(()=>{var e,t;const n=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",(e=n[0])!==null&&e!==void 0?e:wP()),document.body.insertAdjacentElement("beforeend",(t=n[1])!==null&&t!==void 0?t:wP()),l1++,()=>{l1===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(r=>r.remove()),l1--}},[])}function wP(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.cssText="outline: none; opacity: 0; position: fixed; pointer-events: none",e}const c1="focusScope.autoFocusOnMount",u1="focusScope.autoFocusOnUnmount",SP={bubbles:!1,cancelable:!0},zse=b.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:i,onUnmountAutoFocus:o,...s}=e,[a,l]=b.useState(null),c=ea(i),u=ea(o),d=b.useRef(null),h=pl(t,g=>l(g)),f=b.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;b.useEffect(()=>{if(r){let g=function(x){if(f.paused||!a)return;const w=x.target;a.contains(w)?d.current=w:Ca(d.current,{select:!0})},y=function(x){f.paused||!a||a.contains(x.relatedTarget)||Ca(d.current,{select:!0})};return document.addEventListener("focusin",g),document.addEventListener("focusout",y),()=>{document.removeEventListener("focusin",g),document.removeEventListener("focusout",y)}}},[r,a,f.paused]),b.useEffect(()=>{if(a){CP.add(f);const g=document.activeElement;if(!a.contains(g)){const x=new CustomEvent(c1,SP);a.addEventListener(c1,c),a.dispatchEvent(x),x.defaultPrevented||(Use(Yse(iL(a)),{select:!0}),document.activeElement===g&&Ca(a))}return()=>{a.removeEventListener(c1,c),setTimeout(()=>{const x=new CustomEvent(u1,SP);a.addEventListener(u1,u),a.dispatchEvent(x),x.defaultPrevented||Ca(g??document.body,{select:!0}),a.removeEventListener(u1,u),CP.remove(f)},0)}}},[a,c,u,f]);const p=b.useCallback(g=>{if(!n&&!r||f.paused)return;const y=g.key==="Tab"&&!g.altKey&&!g.ctrlKey&&!g.metaKey,x=document.activeElement;if(y&&x){const w=g.currentTarget,[_,S]=Wse(w);_&&S?!g.shiftKey&&x===S?(g.preventDefault(),n&&Ca(_,{select:!0})):g.shiftKey&&x===_&&(g.preventDefault(),n&&Ca(S,{select:!0})):x===w&&g.preventDefault()}},[n,r,f.paused]);return b.createElement(Ja.div,oe({tabIndex:-1},s,{ref:h,onKeyDown:p}))});function Use(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(Ca(r,{select:t}),document.activeElement!==n)return}function Wse(e){const t=iL(e),n=_P(t,e),r=_P(t.reverse(),e);return[n,r]}function iL(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const i=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||i?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function _P(e,t){for(const n of e)if(!Hse(n,{upTo:t}))return n}function Hse(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function Kse(e){return e instanceof HTMLInputElement&&"select"in e}function Ca(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&Kse(e)&&t&&e.select()}}const CP=Vse();function Vse(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=EP(e,t),e.unshift(t)},remove(t){var n;e=EP(e,t),(n=e[0])===null||n===void 0||n.resume()}}}function EP(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function Yse(e){return e.filter(t=>t.tagName!=="A")}const As=globalThis!=null&&globalThis.document?b.useLayoutEffect:()=>{},qse=d$["useId".toString()]||(()=>{});let Gse=0;function Xse(e){const[t,n]=b.useState(qse());return As(()=>{e||n(r=>r??String(Gse++))},[e]),e||(t?`radix-${t}`:"")}function gl(e){return e.split("-")[0]}function Hh(e){return e.split("-")[1]}function ru(e){return["top","bottom"].includes(gl(e))?"x":"y"}function oC(e){return e==="y"?"height":"width"}function kP(e,t,n){let{reference:r,floating:i}=e;const o=r.x+r.width/2-i.width/2,s=r.y+r.height/2-i.height/2,a=ru(t),l=oC(a),c=r[l]/2-i[l]/2,u=a==="x";let d;switch(gl(t)){case"top":d={x:o,y:r.y-i.height};break;case"bottom":d={x:o,y:r.y+r.height};break;case"right":d={x:r.x+r.width,y:s};break;case"left":d={x:r.x-i.width,y:s};break;default:d={x:r.x,y:r.y}}switch(Hh(t)){case"start":d[a]-=c*(n&&u?-1:1);break;case"end":d[a]+=c*(n&&u?-1:1)}return d}const Zse=async(e,t,n)=>{const{placement:r="bottom",strategy:i="absolute",middleware:o=[],platform:s}=n,a=await(s.isRTL==null?void 0:s.isRTL(t));let l=await s.getElementRects({reference:e,floating:t,strategy:i}),{x:c,y:u}=kP(l,r,a),d=r,h={},f=0;for(let p=0;p<o.length;p++){const{name:g,fn:y}=o[p],{x,y:w,data:_,reset:S}=await y({x:c,y:u,initialPlacement:r,placement:d,strategy:i,middlewareData:h,rects:l,platform:s,elements:{reference:e,floating:t}});c=x??c,u=w??u,h={...h,[g]:{...h[g],..._}},S&&f<=50&&(f++,typeof S=="object"&&(S.placement&&(d=S.placement),S.rects&&(l=S.rects===!0?await s.getElementRects({reference:e,floating:t,strategy:i}):S.rects),{x:c,y:u}=kP(l,d,a)),p=-1)}return{x:c,y:u,placement:d,strategy:i,middlewareData:h}};function oL(e){return typeof e!="number"?function(t){return{top:0,right:0,bottom:0,left:0,...t}}(e):{top:e,right:e,bottom:e,left:e}}function xm(e){return{...e,top:e.y,left:e.x,right:e.x+e.width,bottom:e.y+e.height}}async function ih(e,t){var n;t===void 0&&(t={});const{x:r,y:i,platform:o,rects:s,elements:a,strategy:l}=e,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:h=!1,padding:f=0}=t,p=oL(f),g=a[h?d==="floating"?"reference":"floating":d],y=xm(await o.getClippingRect({element:(n=await(o.isElement==null?void 0:o.isElement(g)))==null||n?g:g.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),x=xm(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({rect:d==="floating"?{...s.floating,x:r,y:i}:s.reference,offsetParent:await(o.getOffsetParent==null?void 0:o.getOffsetParent(a.floating)),strategy:l}):s[d]);return{top:y.top-x.top+p.top,bottom:x.bottom-y.bottom+p.bottom,left:y.left-x.left+p.left,right:x.right-y.right+p.right}}const Qse=Math.min,Ea=Math.max;function zb(e,t,n){return Ea(e,Qse(t,n))}const TP=e=>({name:"arrow",options:e,async fn(t){const{element:n,padding:r=0}=e??{},{x:i,y:o,placement:s,rects:a,platform:l}=t;if(n==null)return{};const c=oL(r),u={x:i,y:o},d=ru(s),h=Hh(s),f=oC(d),p=await l.getDimensions(n),g=d==="y"?"top":"left",y=d==="y"?"bottom":"right",x=a.reference[f]+a.reference[d]-u[d]-a.floating[f],w=u[d]-a.reference[d],_=await(l.getOffsetParent==null?void 0:l.getOffsetParent(n));let S=_?d==="y"?_.clientHeight||0:_.clientWidth||0:0;S===0&&(S=a.floating[f]);const T=x/2-w/2,P=c[g],I=S-p[f]-c[y],$=S/2-p[f]/2+T,L=zb(P,$,I),R=(h==="start"?c[g]:c[y])>0&&$!==L&&a.reference[f]<=a.floating[f];return{[d]:u[d]-(R?$<P?P-$:I-$:0),data:{[d]:L,centerOffset:$-L}}}}),Jse={left:"right",right:"left",bottom:"top",top:"bottom"};function bm(e){return e.replace(/left|right|bottom|top/g,t=>Jse[t])}function eae(e,t,n){n===void 0&&(n=!1);const r=Hh(e),i=ru(e),o=oC(i);let s=i==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return t.reference[o]>t.floating[o]&&(s=bm(s)),{main:s,cross:bm(s)}}const tae={start:"end",end:"start"};function PP(e){return e.replace(/start|end/g,t=>tae[t])}const sL=["top","right","bottom","left"];sL.reduce((e,t)=>e.concat(t,t+"-start",t+"-end"),[]);const nae=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n;const{placement:r,middlewareData:i,rects:o,initialPlacement:s,platform:a,elements:l}=t,{mainAxis:c=!0,crossAxis:u=!0,fallbackPlacements:d,fallbackStrategy:h="bestFit",flipAlignment:f=!0,...p}=e,g=gl(r),y=d||(g===s||!f?[bm(s)]:function($){const L=bm($);return[PP($),L,PP(L)]}(s)),x=[s,...y],w=await ih(t,p),_=[];let S=((n=i.flip)==null?void 0:n.overflows)||[];if(c&&_.push(w[g]),u){const{main:$,cross:L}=eae(r,o,await(a.isRTL==null?void 0:a.isRTL(l.floating)));_.push(w[$],w[L])}if(S=[...S,{placement:r,overflows:_}],!_.every($=>$<=0)){var T,P;const $=((T=(P=i.flip)==null?void 0:P.index)!=null?T:0)+1,L=x[$];if(L)return{data:{index:$,overflows:S},reset:{placement:L}};let R="bottom";switch(h){case"bestFit":{var I;const K=(I=S.map(Q=>[Q,Q.overflows.filter(j=>j>0).reduce((j,B)=>j+B,0)]).sort((Q,j)=>Q[1]-j[1])[0])==null?void 0:I[0].placement;K&&(R=K);break}case"initialPlacement":R=s}if(r!==R)return{reset:{placement:R}}}return{}}}};function IP(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function $P(e){return sL.some(t=>e[t]>=0)}const rae=function(e){let{strategy:t="referenceHidden",...n}=e===void 0?{}:e;return{name:"hide",async fn(r){const{rects:i}=r;switch(t){case"referenceHidden":{const o=IP(await ih(r,{...n,elementContext:"reference"}),i.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:$P(o)}}}case"escaped":{const o=IP(await ih(r,{...n,altBoundary:!0}),i.floating);return{data:{escapedOffsets:o,escaped:$P(o)}}}default:return{}}}}},iae=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){const{x:n,y:r}=t,i=await async function(o,s){const{placement:a,platform:l,elements:c}=o,u=await(l.isRTL==null?void 0:l.isRTL(c.floating)),d=gl(a),h=Hh(a),f=ru(a)==="x",p=["left","top"].includes(d)?-1:1,g=u&&f?-1:1,y=typeof s=="function"?s(o):s;let{mainAxis:x,crossAxis:w,alignmentAxis:_}=typeof y=="number"?{mainAxis:y,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...y};return h&&typeof _=="number"&&(w=h==="end"?-1*_:_),f?{x:w*g,y:x*p}:{x:x*p,y:w*g}}(t,e);return{x:n+i.x,y:r+i.y,data:i}}}};function aL(e){return e==="x"?"y":"x"}const oae=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:r,placement:i}=t,{mainAxis:o=!0,crossAxis:s=!1,limiter:a={fn:y=>{let{x,y:w}=y;return{x,y:w}}},...l}=e,c={x:n,y:r},u=await ih(t,l),d=ru(gl(i)),h=aL(d);let f=c[d],p=c[h];if(o){const y=d==="y"?"bottom":"right";f=zb(f+u[d==="y"?"top":"left"],f,f-u[y])}if(s){const y=h==="y"?"bottom":"right";p=zb(p+u[h==="y"?"top":"left"],p,p-u[y])}const g=a.fn({...t,[d]:f,[h]:p});return{...g,data:{x:g.x-n,y:g.y-r}}}}},sae=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:n,y:r,placement:i,rects:o,middlewareData:s}=t,{offset:a=0,mainAxis:l=!0,crossAxis:c=!0}=e,u={x:n,y:r},d=ru(i),h=aL(d);let f=u[d],p=u[h];const g=typeof a=="function"?a({...o,placement:i}):a,y=typeof g=="number"?{mainAxis:g,crossAxis:0}:{mainAxis:0,crossAxis:0,...g};if(l){const T=d==="y"?"height":"width",P=o.reference[d]-o.floating[T]+y.mainAxis,I=o.reference[d]+o.reference[T]-y.mainAxis;f<P?f=P:f>I&&(f=I)}if(c){var x,w,_,S;const T=d==="y"?"width":"height",P=["top","left"].includes(gl(i)),I=o.reference[h]-o.floating[T]+(P&&(x=(w=s.offset)==null?void 0:w[h])!=null?x:0)+(P?0:y.crossAxis),$=o.reference[h]+o.reference[T]+(P?0:(_=(S=s.offset)==null?void 0:S[h])!=null?_:0)-(P?y.crossAxis:0);p<I?p=I:p>$&&(p=$)}return{[d]:f,[h]:p}}}},aae=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){const{placement:n,rects:r,platform:i,elements:o}=t,{apply:s,...a}=e,l=await ih(t,a),c=gl(n),u=Hh(n);let d,h;c==="top"||c==="bottom"?(d=c,h=u===(await(i.isRTL==null?void 0:i.isRTL(o.floating))?"start":"end")?"left":"right"):(h=c,d=u==="end"?"top":"bottom");const f=Ea(l.left,0),p=Ea(l.right,0),g=Ea(l.top,0),y=Ea(l.bottom,0),x={availableHeight:r.floating.height-(["left","right"].includes(n)?2*(g!==0||y!==0?g+y:Ea(l.top,l.bottom)):l[d]),availableWidth:r.floating.width-(["top","bottom"].includes(n)?2*(f!==0||p!==0?f+p:Ea(l.left,l.right)):l[h])},w=await i.getDimensions(o.floating);s==null||s({...t,...x});const _=await i.getDimensions(o.floating);return w.width!==_.width||w.height!==_.height?{reset:{rects:!0}}:{}}}};function lL(e){return e&&e.document&&e.location&&e.alert&&e.setInterval}function ns(e){if(e==null)return window;if(!lL(e)){const t=e.ownerDocument;return t&&t.defaultView||window}return e}function Kh(e){return ns(e).getComputedStyle(e)}function Bo(e){return lL(e)?"":e?(e.nodeName||"").toLowerCase():""}function cL(){const e=navigator.userAgentData;return e!=null&&e.brands?e.brands.map(t=>t.brand+"/"+t.version).join(" "):navigator.userAgent}function io(e){return e instanceof ns(e).HTMLElement}function ta(e){return e instanceof ns(e).Element}function sC(e){return typeof ShadowRoot>"u"?!1:e instanceof ns(e).ShadowRoot||e instanceof ShadowRoot}function Yy(e){const{overflow:t,overflowX:n,overflowY:r}=Kh(e);return/auto|scroll|overlay|hidden/.test(t+r+n)}function lae(e){return["table","td","th"].includes(Bo(e))}function AP(e){const t=/firefox/i.test(cL()),n=Kh(e);return n.transform!=="none"||n.perspective!=="none"||n.contain==="paint"||["transform","perspective"].includes(n.willChange)||t&&n.willChange==="filter"||t&&!!n.filter&&n.filter!=="none"}function uL(){return!/^((?!chrome|android).)*safari/i.test(cL())}const MP=Math.min,fd=Math.max,wm=Math.round;function Ro(e,t,n){var r,i,o,s;t===void 0&&(t=!1),n===void 0&&(n=!1);const a=e.getBoundingClientRect();let l=1,c=1;t&&io(e)&&(l=e.offsetWidth>0&&wm(a.width)/e.offsetWidth||1,c=e.offsetHeight>0&&wm(a.height)/e.offsetHeight||1);const u=ta(e)?ns(e):window,d=!uL()&&n,h=(a.left+(d&&(r=(i=u.visualViewport)==null?void 0:i.offsetLeft)!=null?r:0))/l,f=(a.top+(d&&(o=(s=u.visualViewport)==null?void 0:s.offsetTop)!=null?o:0))/c,p=a.width/l,g=a.height/c;return{width:p,height:g,top:f,right:h+p,bottom:f+g,left:h,x:h,y:f}}function Hs(e){return(t=e,(t instanceof ns(t).Node?e.ownerDocument:e.document)||window.document).documentElement;var t}function qy(e){return ta(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function dL(e){return Ro(Hs(e)).left+qy(e).scrollLeft}function cae(e,t,n){const r=io(t),i=Hs(t),o=Ro(e,r&&function(l){const c=Ro(l);return wm(c.width)!==l.offsetWidth||wm(c.height)!==l.offsetHeight}(t),n==="fixed");let s={scrollLeft:0,scrollTop:0};const a={x:0,y:0};if(r||!r&&n!=="fixed")if((Bo(t)!=="body"||Yy(i))&&(s=qy(t)),io(t)){const l=Ro(t,!0);a.x=l.x+t.clientLeft,a.y=l.y+t.clientTop}else i&&(a.x=dL(i));return{x:o.left+s.scrollLeft-a.x,y:o.top+s.scrollTop-a.y,width:o.width,height:o.height}}function hL(e){return Bo(e)==="html"?e:e.assignedSlot||e.parentNode||(sC(e)?e.host:null)||Hs(e)}function OP(e){return io(e)&&getComputedStyle(e).position!=="fixed"?e.offsetParent:null}function Ub(e){const t=ns(e);let n=OP(e);for(;n&&lae(n)&&getComputedStyle(n).position==="static";)n=OP(n);return n&&(Bo(n)==="html"||Bo(n)==="body"&&getComputedStyle(n).position==="static"&&!AP(n))?t:n||function(r){let i=hL(r);for(sC(i)&&(i=i.host);io(i)&&!["html","body"].includes(Bo(i));){if(AP(i))return i;i=i.parentNode}return null}(e)||t}function LP(e){if(io(e))return{width:e.offsetWidth,height:e.offsetHeight};const t=Ro(e);return{width:t.width,height:t.height}}function fL(e){const t=hL(e);return["html","body","#document"].includes(Bo(t))?e.ownerDocument.body:io(t)&&Yy(t)?t:fL(t)}function Sm(e,t){var n;t===void 0&&(t=[]);const r=fL(e),i=r===((n=e.ownerDocument)==null?void 0:n.body),o=ns(r),s=i?[o].concat(o.visualViewport||[],Yy(r)?r:[]):r,a=t.concat(s);return i?a:a.concat(Sm(s))}function BP(e,t,n){return t==="viewport"?xm(function(r,i){const o=ns(r),s=Hs(r),a=o.visualViewport;let l=s.clientWidth,c=s.clientHeight,u=0,d=0;if(a){l=a.width,c=a.height;const h=uL();(h||!h&&i==="fixed")&&(u=a.offsetLeft,d=a.offsetTop)}return{width:l,height:c,x:u,y:d}}(e,n)):ta(t)?function(r,i){const o=Ro(r,!1,i==="fixed"),s=o.top+r.clientTop,a=o.left+r.clientLeft;return{top:s,left:a,x:a,y:s,right:a+r.clientWidth,bottom:s+r.clientHeight,width:r.clientWidth,height:r.clientHeight}}(t,n):xm(function(r){var i;const o=Hs(r),s=qy(r),a=(i=r.ownerDocument)==null?void 0:i.body,l=fd(o.scrollWidth,o.clientWidth,a?a.scrollWidth:0,a?a.clientWidth:0),c=fd(o.scrollHeight,o.clientHeight,a?a.scrollHeight:0,a?a.clientHeight:0);let u=-s.scrollLeft+dL(r);const d=-s.scrollTop;return Kh(a||o).direction==="rtl"&&(u+=fd(o.clientWidth,a?a.clientWidth:0)-l),{width:l,height:c,x:u,y:d}}(Hs(e)))}function uae(e){const t=Sm(e),n=["absolute","fixed"].includes(Kh(e).position)&&io(e)?Ub(e):e;return ta(n)?t.filter(r=>ta(r)&&function(i,o){const s=o.getRootNode==null?void 0:o.getRootNode();if(i.contains(o))return!0;if(s&&sC(s)){let a=o;do{if(a&&i===a)return!0;a=a.parentNode||a.host}while(a)}return!1}(r,n)&&Bo(r)!=="body"):[]}const dae={getClippingRect:function(e){let{element:t,boundary:n,rootBoundary:r,strategy:i}=e;const o=[...n==="clippingAncestors"?uae(t):[].concat(n),r],s=o[0],a=o.reduce((l,c)=>{const u=BP(t,c,i);return l.top=fd(u.top,l.top),l.right=MP(u.right,l.right),l.bottom=MP(u.bottom,l.bottom),l.left=fd(u.left,l.left),l},BP(t,s,i));return{width:a.right-a.left,height:a.bottom-a.top,x:a.left,y:a.top}},convertOffsetParentRelativeRectToViewportRelativeRect:function(e){let{rect:t,offsetParent:n,strategy:r}=e;const i=io(n),o=Hs(n);if(n===o)return t;let s={scrollLeft:0,scrollTop:0};const a={x:0,y:0};if((i||!i&&r!=="fixed")&&((Bo(n)!=="body"||Yy(o))&&(s=qy(n)),io(n))){const l=Ro(n,!0);a.x=l.x+n.clientLeft,a.y=l.y+n.clientTop}return{...t,x:t.x-s.scrollLeft+a.x,y:t.y-s.scrollTop+a.y}},isElement:ta,getDimensions:LP,getOffsetParent:Ub,getDocumentElement:Hs,getElementRects:e=>{let{reference:t,floating:n,strategy:r}=e;return{reference:cae(t,Ub(n),r),floating:{...LP(n),x:0,y:0}}},getClientRects:e=>Array.from(e.getClientRects()),isRTL:e=>Kh(e).direction==="rtl"};function hae(e,t,n,r){r===void 0&&(r={});const{ancestorScroll:i=!0,ancestorResize:o=!0,elementResize:s=!0,animationFrame:a=!1}=r,l=i&&!a,c=o&&!a,u=l||c?[...ta(e)?Sm(e):[],...Sm(t)]:[];u.forEach(p=>{l&&p.addEventListener("scroll",n,{passive:!0}),c&&p.addEventListener("resize",n)});let d,h=null;if(s){let p=!0;h=new ResizeObserver(()=>{p||n(),p=!1}),ta(e)&&!a&&h.observe(e),h.observe(t)}let f=a?Ro(e):null;return a&&function p(){const g=Ro(e);!f||g.x===f.x&&g.y===f.y&&g.width===f.width&&g.height===f.height||n(),f=g,d=requestAnimationFrame(p)}(),n(),()=>{var p;u.forEach(g=>{l&&g.removeEventListener("scroll",n),c&&g.removeEventListener("resize",n)}),(p=h)==null||p.disconnect(),h=null,a&&cancelAnimationFrame(d)}}const fae=(e,t,n)=>Zse(e,t,{platform:dae,...n});var Wb=typeof document<"u"?b.useLayoutEffect:b.useEffect;function Hb(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let n,r,i;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(n=e.length,n!=t.length)return!1;for(r=n;r--!==0;)if(!Hb(e[r],t[r]))return!1;return!0}if(i=Object.keys(e),n=i.length,n!==Object.keys(t).length)return!1;for(r=n;r--!==0;)if(!Object.prototype.hasOwnProperty.call(t,i[r]))return!1;for(r=n;r--!==0;){const o=i[r];if(!(o==="_owner"&&e.$$typeof)&&!Hb(e[o],t[o]))return!1}return!0}return e!==e&&t!==t}function pae(e){const t=b.useRef(e);return Wb(()=>{t.current=e}),t}function gae(e){let{middleware:t,placement:n="bottom",strategy:r="absolute",whileElementsMounted:i}=e===void 0?{}:e;const o=b.useRef(null),s=b.useRef(null),a=pae(i),l=b.useRef(null),[c,u]=b.useState({x:null,y:null,strategy:r,placement:n,middlewareData:{}}),[d,h]=b.useState(t);Hb(d==null?void 0:d.map(_=>{let{options:S}=_;return S}),t==null?void 0:t.map(_=>{let{options:S}=_;return S}))||h(t);const f=b.useCallback(()=>{!o.current||!s.current||fae(o.current,s.current,{middleware:d,placement:n,strategy:r}).then(_=>{p.current&&Yo.flushSync(()=>{u(_)})})},[d,n,r]);Wb(()=>{p.current&&f()},[f]);const p=b.useRef(!1);Wb(()=>(p.current=!0,()=>{p.current=!1}),[]);const g=b.useCallback(()=>{if(typeof l.current=="function"&&(l.current(),l.current=null),o.current&&s.current)if(a.current){const _=a.current(o.current,s.current,f);l.current=_}else f()},[f,a]),y=b.useCallback(_=>{o.current=_,g()},[g]),x=b.useCallback(_=>{s.current=_,g()},[g]),w=b.useMemo(()=>({reference:o,floating:s}),[]);return b.useMemo(()=>({...c,update:f,refs:w,reference:y,floating:x}),[c,f,w,y,x])}const mae=e=>{const{element:t,padding:n}=e;function r(i){return Object.prototype.hasOwnProperty.call(i,"current")}return{name:"arrow",options:e,fn(i){return r(t)?t.current!=null?TP({element:t.current,padding:n}).fn(i):{}:t?TP({element:t,padding:n}).fn(i):{}}}};function yae(e){const[t,n]=b.useState(void 0);return As(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});const r=new ResizeObserver(i=>{if(!Array.isArray(i)||!i.length)return;const o=i[0];let s,a;if("borderBoxSize"in o){const l=o.borderBoxSize,c=Array.isArray(l)?l[0]:l;s=c.inlineSize,a=c.blockSize}else s=e.offsetWidth,a=e.offsetHeight;n({width:s,height:a})});return r.observe(e,{box:"border-box"}),()=>r.unobserve(e)}else n(void 0)},[e]),t}const pL="Popper",[aC,gL]=nL(pL),[vae,mL]=aC(pL),xae=e=>{const{__scopePopper:t,children:n}=e,[r,i]=b.useState(null);return b.createElement(vae,{scope:t,anchor:r,onAnchorChange:i},n)},bae="PopperAnchor",wae=b.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...i}=e,o=mL(bae,n),s=b.useRef(null),a=pl(t,s);return b.useEffect(()=>{o.onAnchorChange((r==null?void 0:r.current)||s.current)}),r?null:b.createElement(Ja.div,oe({},i,{ref:a}))}),_m="PopperContent",[Sae,Rwe]=aC(_m),[_ae,Cae]=aC(_m,{hasParent:!1,positionUpdateFns:new Set}),Eae=b.forwardRef((e,t)=>{var n,r,i,o,s,a,l,c;const{__scopePopper:u,side:d="bottom",sideOffset:h=0,align:f="center",alignOffset:p=0,arrowPadding:g=0,collisionBoundary:y=[],collisionPadding:x=0,sticky:w="partial",hideWhenDetached:_=!1,avoidCollisions:S=!0,onPlaced:T,...P}=e,I=mL(_m,u),[$,L]=b.useState(null),R=pl(t,yt=>L(yt)),[K,Q]=b.useState(null),j=yae(K),B=(n=j==null?void 0:j.width)!==null&&n!==void 0?n:0,z=(r=j==null?void 0:j.height)!==null&&r!==void 0?r:0,q=d+(f!=="center"?"-"+f:""),U=typeof x=="number"?x:{top:0,right:0,bottom:0,left:0,...x},D=Array.isArray(y)?y:[y],F=D.length>0,J={padding:U,boundary:D.filter(Tae),altBoundary:F},{reference:Z,floating:ne,strategy:de,x:Ce,y:he,placement:je,middlewareData:$e,update:Ee}=gae({strategy:"fixed",placement:q,whileElementsMounted:hae,middleware:[iae({mainAxis:h+z,alignmentAxis:p}),S?oae({mainAxis:!0,crossAxis:!1,limiter:w==="partial"?sae():void 0,...J}):void 0,S?nae({...J}):void 0,aae({...J,apply:({elements:yt,rects:nr,availableWidth:is,availableHeight:zn})=>{const{width:os,height:A}=nr.reference,C=yt.floating.style;C.setProperty("--radix-popper-available-width",`${is}px`),C.setProperty("--radix-popper-available-height",`${zn}px`),C.setProperty("--radix-popper-anchor-width",`${os}px`),C.setProperty("--radix-popper-anchor-height",`${A}px`)}}),K?mae({element:K,padding:g}):void 0,Pae({arrowWidth:B,arrowHeight:z}),_?rae({strategy:"referenceHidden"}):void 0].filter(kae)});As(()=>{Z(I.anchor)},[Z,I.anchor]);const Ie=Ce!==null&&he!==null,[Fe,ct]=yL(je),mt=ea(T);As(()=>{Ie&&(mt==null||mt())},[Ie,mt]);const Wt=(i=$e.arrow)===null||i===void 0?void 0:i.x,_t=(o=$e.arrow)===null||o===void 0?void 0:o.y,jn=((s=$e.arrow)===null||s===void 0?void 0:s.centerOffset)!==0,[Sn,Zt]=b.useState();As(()=>{$&&Zt(window.getComputedStyle($).zIndex)},[$]);const{hasParent:_n,positionUpdateFns:Cn}=Cae(_m,u),Rt=!_n;b.useLayoutEffect(()=>{if(!Rt)return Cn.add(Ee),()=>{Cn.delete(Ee)}},[Rt,Cn,Ee]),As(()=>{Rt&&Ie&&Array.from(Cn).reverse().forEach(yt=>requestAnimationFrame(yt))},[Rt,Ie,Cn]);const rn={"data-side":Fe,"data-align":ct,...P,ref:R,style:{...P.style,animation:Ie?void 0:"none",opacity:(a=$e.hide)!==null&&a!==void 0&&a.referenceHidden?0:void 0}};return b.createElement("div",{ref:ne,"data-radix-popper-content-wrapper":"",style:{position:de,left:0,top:0,transform:Ie?`translate3d(${Math.round(Ce)}px, ${Math.round(he)}px, 0)`:"translate3d(0, -200%, 0)",minWidth:"max-content",zIndex:Sn,"--radix-popper-transform-origin":[(l=$e.transformOrigin)===null||l===void 0?void 0:l.x,(c=$e.transformOrigin)===null||c===void 0?void 0:c.y].join(" ")},dir:e.dir},b.createElement(Sae,{scope:u,placedSide:Fe,onArrowChange:Q,arrowX:Wt,arrowY:_t,shouldHideArrow:jn},Rt?b.createElement(_ae,{scope:u,hasParent:!0,positionUpdateFns:Cn},b.createElement(Ja.div,rn)):b.createElement(Ja.div,rn)))});function kae(e){return e!==void 0}function Tae(e){return e!==null}const Pae=e=>({name:"transformOrigin",options:e,fn(t){var n,r,i,o,s;const{placement:a,rects:l,middlewareData:c}=t,d=((n=c.arrow)===null||n===void 0?void 0:n.centerOffset)!==0,h=d?0:e.arrowWidth,f=d?0:e.arrowHeight,[p,g]=yL(a),y={start:"0%",center:"50%",end:"100%"}[g],x=((r=(i=c.arrow)===null||i===void 0?void 0:i.x)!==null&&r!==void 0?r:0)+h/2,w=((o=(s=c.arrow)===null||s===void 0?void 0:s.y)!==null&&o!==void 0?o:0)+f/2;let _="",S="";return p==="bottom"?(_=d?y:`${x}px`,S=`${-f}px`):p==="top"?(_=d?y:`${x}px`,S=`${l.floating.height+f}px`):p==="right"?(_=`${-f}px`,S=d?y:`${w}px`):p==="left"&&(_=`${l.floating.width+f}px`,S=d?y:`${w}px`),{data:{x:_,y:S}}}});function yL(e){const[t,n="center"]=e.split("-");return[t,n]}const Iae=xae,$ae=wae,Aae=Eae,Mae=b.forwardRef((e,t)=>{var n;const{container:r=globalThis==null||(n=globalThis.document)===null||n===void 0?void 0:n.body,...i}=e;return r?m3.createPortal(b.createElement(Ja.div,oe({},i,{ref:t})),r):null});function Oae(e,t){return b.useReducer((n,r)=>{const i=t[n][r];return i??n},e)}const lC=e=>{const{present:t,children:n}=e,r=Lae(t),i=typeof n=="function"?n({present:r.isPresent}):b.Children.only(n),o=pl(r.ref,i.ref);return typeof n=="function"||r.isPresent?b.cloneElement(i,{ref:o}):null};lC.displayName="Presence";function Lae(e){const[t,n]=b.useState(),r=b.useRef({}),i=b.useRef(e),o=b.useRef("none"),s=e?"mounted":"unmounted",[a,l]=Oae(s,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return b.useEffect(()=>{const c=dp(r.current);o.current=a==="mounted"?c:"none"},[a]),As(()=>{const c=r.current,u=i.current;if(u!==e){const h=o.current,f=dp(c);e?l("MOUNT"):f==="none"||(c==null?void 0:c.display)==="none"?l("UNMOUNT"):l(u&&h!==f?"ANIMATION_OUT":"UNMOUNT"),i.current=e}},[e,l]),As(()=>{if(t){const c=d=>{const f=dp(r.current).includes(d.animationName);d.target===t&&f&&Yo.flushSync(()=>l("ANIMATION_END"))},u=d=>{d.target===t&&(o.current=dp(r.current))};return t.addEventListener("animationstart",u),t.addEventListener("animationcancel",c),t.addEventListener("animationend",c),()=>{t.removeEventListener("animationstart",u),t.removeEventListener("animationcancel",c),t.removeEventListener("animationend",c)}}else l("ANIMATION_END")},[t,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:b.useCallback(c=>{c&&(r.current=getComputedStyle(c)),n(c)},[])}}function dp(e){return(e==null?void 0:e.animationName)||"none"}function Bae({prop:e,defaultProp:t,onChange:n=()=>{}}){const[r,i]=Rae({defaultProp:t,onChange:n}),o=e!==void 0,s=o?e:r,a=ea(n),l=b.useCallback(c=>{if(o){const d=typeof c=="function"?c(e):c;d!==e&&a(d)}else i(c)},[o,e,i,a]);return[s,l]}function Rae({defaultProp:e,onChange:t}){const n=b.useState(e),[r]=n,i=b.useRef(r),o=ea(t);return b.useEffect(()=>{i.current!==r&&(o(r),i.current=r)},[r,i,o]),n}const vL="Popover",[xL,Dwe]=nL(vL,[gL]),cC=gL(),[Dae,iu]=xL(vL),Fae=e=>{const{__scopePopover:t,children:n,open:r,defaultOpen:i,onOpenChange:o,modal:s=!1}=e,a=cC(t),l=b.useRef(null),[c,u]=b.useState(!1),[d=!1,h]=Bae({prop:r,defaultProp:i,onChange:o});return b.createElement(Iae,a,b.createElement(Dae,{scope:t,contentId:Xse(),triggerRef:l,open:d,onOpenChange:h,onOpenToggle:b.useCallback(()=>h(f=>!f),[h]),hasCustomAnchor:c,onCustomAnchorAdd:b.useCallback(()=>u(!0),[]),onCustomAnchorRemove:b.useCallback(()=>u(!1),[]),modal:s},n))},Nae="PopoverTrigger",jae=b.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,i=iu(Nae,n),o=cC(n),s=pl(t,i.triggerRef),a=b.createElement(Ja.button,oe({type:"button","aria-haspopup":"dialog","aria-expanded":i.open,"aria-controls":i.contentId,"data-state":SL(i.open)},r,{ref:s,onClick:ja(e.onClick,i.onOpenToggle)}));return i.hasCustomAnchor?a:b.createElement($ae,oe({asChild:!0},o),a)}),bL="PopoverPortal",[zae,Uae]=xL(bL,{forceMount:void 0}),Wae=e=>{const{__scopePopover:t,forceMount:n,children:r,container:i}=e,o=iu(bL,t);return b.createElement(zae,{scope:t,forceMount:n},b.createElement(lC,{present:n||o.open},b.createElement(Mae,{asChild:!0,container:i},r)))},oh="PopoverContent",Hae=b.forwardRef((e,t)=>{const n=Uae(oh,e.__scopePopover),{forceMount:r=n.forceMount,...i}=e,o=iu(oh,e.__scopePopover);return b.createElement(lC,{present:r||o.open},o.modal?b.createElement(Kae,oe({},i,{ref:t})):b.createElement(Vae,oe({},i,{ref:t})))}),Kae=b.forwardRef((e,t)=>{const n=iu(oh,e.__scopePopover),r=b.useRef(null),i=pl(t,r),o=b.useRef(!1);return b.useEffect(()=>{const s=r.current;if(s)return A_(s)},[]),b.createElement($_,{as:iC,allowPinchZoom:!0},b.createElement(wL,oe({},e,{ref:i,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ja(e.onCloseAutoFocus,s=>{var a;s.preventDefault(),o.current||(a=n.triggerRef.current)===null||a===void 0||a.focus()}),onPointerDownOutside:ja(e.onPointerDownOutside,s=>{const a=s.detail.originalEvent,l=a.button===0&&a.ctrlKey===!0,c=a.button===2||l;o.current=c},{checkForDefaultPrevented:!1}),onFocusOutside:ja(e.onFocusOutside,s=>s.preventDefault(),{checkForDefaultPrevented:!1})})))}),Vae=b.forwardRef((e,t)=>{const n=iu(oh,e.__scopePopover),r=b.useRef(!1),i=b.useRef(!1);return b.createElement(wL,oe({},e,{ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{var s;if((s=e.onCloseAutoFocus)===null||s===void 0||s.call(e,o),!o.defaultPrevented){var a;r.current||(a=n.triggerRef.current)===null||a===void 0||a.focus(),o.preventDefault()}r.current=!1,i.current=!1},onInteractOutside:o=>{var s,a;(s=e.onInteractOutside)===null||s===void 0||s.call(e,o),o.defaultPrevented||(r.current=!0,o.detail.originalEvent.type==="pointerdown"&&(i.current=!0));const l=o.target;((a=n.triggerRef.current)===null||a===void 0?void 0:a.contains(l))&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&i.current&&o.preventDefault()}}))}),wL=b.forwardRef((e,t)=>{const{__scopePopover:n,trapFocus:r,onOpenAutoFocus:i,onCloseAutoFocus:o,disableOutsidePointerEvents:s,onEscapeKeyDown:a,onPointerDownOutside:l,onFocusOutside:c,onInteractOutside:u,...d}=e,h=iu(oh,n),f=cC(n);return jse(),b.createElement(zse,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:i,onUnmountAutoFocus:o},b.createElement(Dse,{asChild:!0,disableOutsidePointerEvents:s,onInteractOutside:u,onEscapeKeyDown:a,onPointerDownOutside:l,onFocusOutside:c,onDismiss:()=>h.onOpenChange(!1)},b.createElement(Aae,oe({"data-state":SL(h.open),role:"dialog",id:h.contentId},f,d,{ref:t,style:{...d.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}}))))});function SL(e){return e?"open":"closed"}const Yae=Fae,qae=jae,_L=Wae,CL=Hae,uC=({id:e,children:t,onOpenChange:n})=>{const[r,i]=hl(e,n);return m.jsx(Yae,{onOpenChange:i,open:r,children:m.jsx("div",{className:"tlui-popover",children:t})})},dC=({children:e,disabled:t,"data-testid":n})=>m.jsx(qae,{"data-testid":n,disabled:t,asChild:!0,dir:"ltr",children:e}),EL=({side:e,children:t,align:n="center",sideOffset:r=8,alignOffset:i=0})=>{const o=tr();return m.jsx(_L,{dir:"ltr",container:o,children:m.jsx(CL,{className:"tlui-popover__content",side:e,sideOffset:r,align:n,alignOffset:i,dir:"ltr",children:t})})},kL=b.memo(function(){const t=qe(),n=tr(),r=Voe(),i=co();function o(s){if(i&&!s.readonlyOk)return null;switch(s.type){case"item":{const{id:a,icon:l,label:c,kbd:u,onSelect:d}=s.actionItem;return m.jsx(be,{className:"tlui-button-grid__button","data-testid":`menu-item.${s.id}`,icon:l,title:c?u?`${t(c)} ${no(u)}`:`${t(c)}`:u?`${no(u)}`:"",onClick:()=>d("actions-menu"),disabled:s.disabled},a)}}}return m.jsxs(uC,{id:"actions menu",children:[m.jsx(dC,{children:m.jsx(be,{className:"tlui-menu__trigger","data-testid":"main.action-menu",icon:"dots-vertical",title:t("actions-menu.title"),smallIcon:!0})}),m.jsx(_L,{dir:"ltr",container:n,children:m.jsx(CL,{className:"tlui-popover__content",side:"bottom",dir:"ltr",sideOffset:6,children:m.jsx("div",{className:"tlui-actions-menu tlui-button-grid__four",children:r.map(o)})})})]})}),TL=Ke(function(){const t=re(),n=Nn(),r=qe(),i=n.duplicate,o=t.selectedIds.length<=0;return m.jsx(be,{icon:i.icon,onClick:()=>i.onSelect("quick-actions"),disabled:o,title:`${r(i.label)} ${no(i.kbd)}`,smallIcon:!0})}),Gae=b.memo(function(){const t=qe();return m.jsxs(Qs,{id:"main menu",children:[m.jsx(Wh,{children:m.jsx(be,{className:"tlui-menu__trigger","data-testid":"main.menu",title:t("menu.title"),icon:"menu"})}),m.jsx(Js,{alignOffset:0,sideOffset:6,children:m.jsx(Xae,{})})]})});function Xae(){const e=re(),t=qe(),n=nse(),r=fi(),i=co();function o(s,a,l,c){switch(a.type){case"custom":return i&&!a.readonlyOk?null:a.id==="LANGUAGE_MENU"?m.jsx(eL,{},"item"):null;case"group":return i&&!a.readonlyOk?null:m.jsx(Lo,{size:c<=1?"medium":r<3||(l==null?void 0:l.type)==="submenu"&&c>2?"tiny":"medium",children:a.children.map(u=>o(s,u,a,c+1))},a.id);case"submenu":return i&&!a.readonlyOk?null:m.jsxs(K_,{id:`main menu ${l?l.id+" ":""}${a.id}`,children:[m.jsx(V_,{label:a.label,"data-testid":`menu-item.${a.id}`}),m.jsx(Y_,{sideOffset:-4,alignOffset:-1,children:a.children.map(u=>o(s,u,a,c+1))})]},a.id);case"item":{if(i&&!a.readonlyOk)return null;const{id:u,checkbox:d,menuLabel:h,label:f,onSelect:p,kbd:g}=a.actionItem,y=h??f,x=y?t(y):void 0;return d?m.jsxs(m4,{onSelect:()=>p("menu"),title:x||"",checked:a.checked,disabled:a.disabled,children:[x&&m.jsx("span",{children:x}),g&&m.jsx(By,{children:g})]},u):m.jsx(Pr,{"data-testid":`menu-item.${a.id}`,kbd:g,label:y,onClick:()=>p("menu"),disabled:a.disabled},u)}}}return m.jsx(m.Fragment,{children:n.map(s=>o(e,s,null,0))})}const Zae=function({name:t,id:n,isCurrentPage:r}){const i=re(),o=b.useRef(null),s=b.useCallback(l=>{i.renamePage(n,l||"New Page",!0)},[i,n]),a=b.useCallback(l=>{i.mark("rename page"),i.renamePage(n,l||"New Page",!1)},[i,n]);return m.jsx(G_,{className:"tlui-page-menu__item__input",ref:l=>o.current=l,defaultValue:t,onValueChange:s,onComplete:a,onCancel:a,shouldManuallyMaintainScrollPositionWhenFocused:!0,autofocus:r,autoselect:!0})},Kb=(e,t,n,r)=>{let i;const o=e.pages,s=n>r?o[r-1]:o[r],a=n>r?o[r]:o[r+1];s&&!a?i=Co(s.index):!s&&a?i=bH(o[0].index):i=ld(s.index,a.index),i!==o[n].index&&(e.mark("moving page"),e.updatePage({id:t,index:i}))},RP=Ke(function({index:t,listSize:n,item:r,onRename:i}){const o=re(),s=qe(),a=o.pages,l=b.useCallback(()=>{o.mark("creating page");const h=ei.createId();o.duplicatePage(r.id,h)},[o,r]),c=b.useCallback(()=>{Kb(o,r.id,t,t-1)},[o,r,t]),u=b.useCallback(()=>{Kb(o,r.id,t,t+1)},[o,r,t]),d=b.useCallback(()=>{o.mark("deleting page"),o.deletePage(r.id)},[o,r]);return m.jsxs(Qs,{id:`page item submenu ${t}`,children:[m.jsx(Wh,{children:m.jsx(be,{title:s("page-menu.submenu.title"),icon:"dots-vertical"})}),m.jsxs(Js,{alignOffset:0,children:[m.jsxs(Lo,{children:[i&&m.jsx(jl,{dir:"ltr",onSelect:i,asChild:!0,children:m.jsx(be,{className:"tlui-menu__button",label:"page-menu.submenu.rename"})}),m.jsx(jl,{dir:"ltr",onSelect:l,disabled:a.length>=im,asChild:!0,children:m.jsx(be,{className:"tlui-menu__button",label:"page-menu.submenu.duplicate-page"})}),t>0&&m.jsx(jl,{dir:"ltr",onSelect:c,asChild:!0,children:m.jsx(be,{className:"tlui-menu__button",label:"page-menu.submenu.move-up"})}),t<n-1&&m.jsx(jl,{dir:"ltr",onSelect:u,asChild:!0,children:m.jsx(be,{className:"tlui-menu__button",label:"page-menu.submenu.move-down"})})]}),n>1&&m.jsx(Lo,{children:m.jsx(jl,{dir:"ltr",onSelect:d,asChild:!0,children:m.jsx(be,{className:"tlui-menu__button",label:"page-menu.submenu.delete"})})})]})]})}),Qae=function(){const t=re(),n=qe(),r=fi(),i=b.useCallback(()=>g(!1),[]),[o,s]=hl("page-menu",i),a=r<5?36:40,l=b.useRef(null),c=ye("pages",()=>t.pages,[t]),u=ye("currentPage",()=>t.currentPage,[t]),d=ye("isReadonlyMode",()=>t.isReadOnly,[t]),h=ye("maxPageCountReached",()=>t.pages.length>=im,[t]),f=ye("isCoarsePointer",()=>t.isCoarsePointer,[t]),[p,g]=b.useState(!1),y=b.useCallback(()=>{d||g(L=>!L)},[d]),x=b.useRef({isPointing:!1,status:"idle",pointing:null,startY:0,startIndex:0,dragIndex:0}),[w,_]=b.useState(Object.fromEntries(c.map((L,R)=>[L.id,{y:R*a,offsetY:0,isSelected:!1}])));b.useLayoutEffect(()=>{_(Object.fromEntries(c.map((L,R)=>[L.id,{y:R*a,offsetY:0,isSelected:!1}])))},[a,c]),b.useEffect(()=>{o&&requestAnimationFrame(()=>{const L=document.querySelector(`[data-testid="page-menu-item-${u.id}"]`);if(L){const R=l.current;if(!R)return;const K=L.offsetTop,Q=R.scrollTop;K<Q&&R.scrollTo({top:K});const j=K+a,B=R.scrollTop+R.offsetHeight;j>B&&R.scrollTo({top:j-R.offsetHeight})}})},[a,u,o]);const S=b.useCallback(L=>{const{clientY:R,currentTarget:K}=L,{dataset:{id:Q,index:j}}=K;if(!Q||!j)return;const B=x.current;L.currentTarget.setPointerCapture(L.pointerId),B.status="pointing",B.pointing={id:Q,index:+j};const q=w[Q].y;B.startY=R,B.startIndex=Math.max(0,Math.min(Math.round(q/a),c.length-1))},[a,c.length,w]),T=b.useCallback(L=>{const R=x.current;if(R.status==="pointing"){const{clientY:K}=L,Q=K-R.startY;Math.abs(Q)>5&&(R.status="dragging")}if(R.status==="dragging"){const{clientY:K}=L,Q=K-R.startY,j=w[R.pointing.id],{startIndex:B,pointing:z}=R,q=j.y+Q,U=Math.max(0,Math.min(Math.round(q/a),c.length-1)),D={...w};if(D[z.id]={y:j.y,offsetY:Q,isSelected:!0},U!==R.dragIndex){R.dragIndex=U;for(let F=0;F<c.length;F++){const J=c[F];if(J.id===R.pointing.id)continue;let{y:Z}=D[J.id];U===B?Z=F*a:U<B?U<=F&&F<B?Z=(F+1)*a:Z=F*a:U>B&&(U>=F&&F>B?Z=(F-1)*a:Z=F*a),Z!==D[J.id].y&&(D[J.id]={y:Z,offsetY:0,isSelected:!0})}}_(D)}},[a,c,w]),P=b.useCallback(L=>{const R=x.current;if(R.status==="dragging"){const{id:K,index:Q}=R.pointing;Kb(t,K,Q,R.dragIndex)}L.currentTarget.releasePointerCapture(L.pointerId),R.status="idle"},[t]),I=b.useCallback(L=>{const R=x.current;L.key==="Escape"&&(R.status==="dragging"&&_(Object.fromEntries(c.map((K,Q)=>[K.id,{y:Q*a,offsetY:0,isSelected:!1}]))),R.status="idle")},[a,c]),$=b.useCallback(()=>{if(d)return;t.mark("creating page");const L=ei.createId();t.createPage(n("page-menu.new-page-initial-name"),L),g(!0)},[t,n,d]);return m.jsxs(uC,{id:"page menu",onOpenChange:s,open:o,children:[m.jsx(dC,{children:m.jsx(be,{className:"tlui-page-menu__trigger tlui-menu__trigger","data-testid":"main.page-menu",icon:"chevron-down",title:u.name,children:m.jsx("div",{className:"tlui-page-menu__name",children:u.name})})}),m.jsx(EL,{side:"bottom",align:"start",sideOffset:6,children:m.jsxs("div",{className:"tlui-page-menu__wrapper",children:[m.jsxs("div",{className:"tlui-page-menu__header",children:[m.jsx("div",{className:"tlui-page-menu__header__title",children:n("page-menu.title")}),!d&&m.jsxs(m.Fragment,{children:[m.jsx(be,{"data-testid":"page-menu.edit",title:n(p?"page-menu.edit-done":"page-menu.edit-start"),icon:p?"check":"edit",onClick:y}),m.jsx(be,{"data-testid":"page-menu.create",icon:"plus",title:n(h?"page-menu.max-page-count-reached":"page-menu.create-new-page"),disabled:h,onClick:$})]})]}),m.jsx("div",{className:"tlui-page-menu__list tlui-menu__group",style:{height:a*c.length+4},ref:l,children:c.map((L,R)=>{const K=w[L.id]??{position:R*40,offsetY:0};return p?m.jsxs("div",{"data-testid":`page-menu-item-${L.id}`,className:"tlui-page_menu__item__sortable",style:{zIndex:L.id===u.id?888:R,transform:`translate(0px, ${K.y+K.offsetY}px)`},children:[m.jsx(be,{tabIndex:-1,className:"tlui-page_menu__item__sortable__handle",icon:"drag-handle-dots",onPointerDown:S,onPointerUp:P,onPointerMove:T,onKeyDown:I,"data-id":L.id,"data-index":R}),r<5&&f?m.jsx(be,{className:"tlui-page-menu__item__button",onClick:()=>{const Q=window.prompt("Rename page",L.name);Q&&Q!==L.name&&t.renamePage(L.id,Q)},onDoubleClick:y,isChecked:L.id===u.id,children:m.jsx("span",{children:L.name})}):m.jsx("div",{id:`page-menu-item-${L.id}`,"data-testid":`page-menu-item-${L.id}`,className:"tlui-page_menu__item__sortable__title",style:{height:a},children:m.jsx(Zae,{id:L.id,name:L.name,isCurrentPage:L.id===u.id})}),!d&&m.jsx("div",{className:"tlui-page_menu__item__submenu","data-isediting":p,children:m.jsx(RP,{index:R,item:L,listSize:c.length})})]},L.id+"_editing"):m.jsxs("div",{"data-testid":`page-menu-item-${L.id}`,className:"tlui-page-menu__item",children:[m.jsxs(be,{className:"tlui-page-menu__item__button tlui-page-menu__item__button__checkbox",onClick:()=>t.setCurrentPageId(L.id),onDoubleClick:y,isChecked:L.id===u.id,title:n("page-menu.go-to-page"),children:[m.jsx("div",{className:"tlui-page-menu__item__button__check",children:L.id===u.id&&m.jsx(mr,{icon:"check"})}),m.jsx("span",{children:L.name})]}),!d&&m.jsx("div",{className:"tlui-page_menu__item__submenu",children:m.jsx(RP,{index:R,item:L,listSize:c.length,onRename:()=>{if(t.isIos){const Q=window.prompt("Rename page",L.name);Q&&Q!==L.name&&t.renamePage(L.id,Q)}else g(!0),t.setCurrentPageId(L.id)}})})]},L.id)})})]})})]})},PL=b.memo(function(){const t=qe(),n=q4(),i=Nn().redo;return m.jsx(be,{"data-testid":"main.redo",icon:i.icon,title:`${t(i.label)} ${no(i.kbd)}`,disabled:!n,onClick:()=>i.onSelect("quick-actions"),smallIcon:!0})}),IL=Ke(function(){const t=re(),n=Nn(),r=qe(),i=n.delete;if(co())return null;const s=t.selectedIds.length<=0;return m.jsx(be,{icon:i.icon,onClick:()=>i.onSelect("quick-actions"),disabled:s,title:`${r(i.label)} ${no(i.kbd)}`,smallIcon:!0})}),$L=b.memo(function(){const t=qe(),n=G4(),i=Nn().undo;return m.jsx(be,{"data-testid":"main.undo",icon:i.icon,title:`${t(i.label)} ${no(i.kbd)}`,disabled:!n,onClick:()=>i.onSelect("quick-actions"),smallIcon:!0})}),Jae=Ke(function(){const t=re(),n=fi(),i=!co()&&!t.isInAny("hand","zoom","eraser");return m.jsx("div",{className:"tlui-menu-zone",children:m.jsxs("div",{className:"tlui-menu-zone__controls",children:[m.jsx(Gae,{}),m.jsx("div",{className:"tlui-menu-zone__divider"}),m.jsx(Qae,{}),n>=6&&i&&m.jsxs(m.Fragment,{children:[m.jsx("div",{className:"tlui-menu-zone__divider"}),m.jsx($L,{}),m.jsx(PL,{}),m.jsx(IL,{}),m.jsx(TL,{}),m.jsx(kL,{})]})]})})});function ele(e,t){const[n,r]=ke.useState(t);ke.useLayoutEffect(()=>{const o=localStorage.getItem(e);if(o)try{r(JSON.parse(o))}catch{console.error(`Could not restore value ${e} from local storage.`)}},[e]);const i=ke.useCallback(o=>{r(s=>{const a=typeof o=="function"?o(s):o;return localStorage.setItem(e,JSON.stringify(a)),a})},[e]);return[n,i]}class pd{constructor(t,n){v(this,"colors",{shapeFill:"rgba(144, 144, 144, .1)",selectFill:"#2f80ed",viewportFill:"rgba(144, 144, 144, .1)"});v(this,"id",At());v(this,"cvs",null);v(this,"pageBounds",[]);v(this,"collaborators",[]);v(this,"canvasScreenBounds",new me);v(this,"canvasPageBounds",new me);v(this,"contentPageBounds",new me);v(this,"contentScreenBounds",new me);v(this,"originPagePoint",new E);v(this,"originPageCenter",new E);v(this,"isInViewport",!1);v(this,"debug",!1);v(this,"updateContentScreenBounds",()=>{const{contentScreenBounds:t,contentPageBounds:n,canvasScreenBounds:r}=this;let{x:i,y:o,w:s,h:a}=t;if(n.w>n.h){const l=r.w/(n.w/n.h);l>r.h?(i=(r.w-r.w*(r.h/l))/2,o=0,s=r.w*(r.h/l),a=r.h):(i=0,o=(r.h-l)/2,s=r.w,a=l)}else if(n.w<n.h){const l=r.h/(n.h/n.w);i=(r.w-l)/2,o=0,s=l,a=r.h}else i=r.h/2,o=0,s=r.h,a=r.h;t.set(i,o,s,a)});v(this,"updateCanvasPageBounds",()=>{const{canvasPageBounds:t,canvasScreenBounds:n,contentPageBounds:r,contentScreenBounds:i}=this;t.set(0,0,r.width/(i.width/n.width),r.height/(i.height/n.height)),t.center=r.center});v(this,"getScreenPoint",(t,n)=>{const{canvasScreenBounds:r}=this,i=(t-r.minX)*this.dpr,o=(n-r.minY)*this.dpr;return{x:i,y:o}});v(this,"getPagePoint",(t,n)=>{const{contentPageBounds:r,contentScreenBounds:i,canvasPageBounds:o}=this,{x:s,y:a}=this.getScreenPoint(t,n);return{x:o.minX+s*r.width/i.width,y:o.minY+a*r.height/i.height,z:1}});v(this,"minimapScreenPointToPagePoint",(t,n,r=!1,i=!1)=>{const{editor:o}=this,{viewportPageBounds:s}=o;let{x:a,y:l}=this.getPagePoint(t,n);if(i){const c=this.editor.allShapesCommonBounds,u=s,d=((c==null?void 0:c.minX)??0)-u.width/2,h=((c==null?void 0:c.maxX)??0)+u.width/2,f=((c==null?void 0:c.minY)??0)-u.height/2,p=((c==null?void 0:c.maxY)??0)+u.height/2,g=Math.max(0,d+u.width-a),y=Math.max(0,-(h-u.width-a)),x=Math.max(0,f+u.height-l),w=Math.max(0,-(p-u.height-l)),_=Math.max(0,g-y),S=Math.max(0,y-g),T=Math.max(0,x-w),P=Math.max(0,w-x);_&&_>S?a+=_/2:S&&(a-=S/2),T&&T>P?l+=T/2:P&&(l-=P/2),a=Ci(a,d,h),l=Ci(l,f,p)}if(r){const{originPagePoint:c}=this,u=Math.abs(a-c.x),d=Math.abs(l-c.y);u>d?l=c.y:a=c.x}return{x:a,y:l}});v(this,"render",()=>{const{cvs:t,pageBounds:n}=this;this.updateCanvasPageBounds();const{editor:r,canvasScreenBounds:i,canvasPageBounds:o,contentPageBounds:s,contentScreenBounds:a}=this,{width:l,height:c}=i,{viewportPageBounds:u,selectedIds:d}=r;if(!t||!n)return;const h=t.getContext("2d");if(!h)throw new Error("Minimap (shapes): Could not get context");h.resetTransform(),h.globalAlpha=1,h.clearRect(0,0,l,c);const f=a.width/s.width,p=a.height/s.height;h.translate((l-a.width)/2,(c-a.height)/2),h.scale(f,p),h.translate(-s.minX,-s.minY);const g=8/f,y=8/f,x=1/f,w=1/f,_=g/4,S=y/4,T=new Path2D,P=new Path2D,{shapeFill:I,selectFill:$,viewportFill:L}=this.colors;let R;for(let z=0,q=n.length;z<q;z++)R=n[z],pd.roundedRect(d.includes(R.id)?P:T,R.minX,R.minY,R.width,R.height,Ci(g,x,R.width/_),Ci(y,w,R.height/S));if(h.fillStyle=I,h.fill(T),h.fillStyle=$,h.fill(P),this.debug){const z=me.Common(n),{minX:q,minY:U,width:D,height:F}=z;h.strokeStyle="green",h.lineWidth=2/f,h.strokeRect(q+1/f,U+1/p,D-2/f,F-2/p)}{const{brush:z}=r;if(z){const{x:q,y:U,w:D,h:F}=z;h.beginPath(),pd.sharpRect(h,q,U,D,F),h.closePath(),h.fillStyle=L,h.fill()}}{const{minX:z,minY:q,width:U,height:D}=u;h.beginPath();const F=12/f,J=12/f;pd.roundedRect(h,z,q,U,D,Math.min(U/4,F),Math.min(D/4,J)),h.closePath(),h.fillStyle=L,h.fill(),this.debug&&(h.strokeStyle="orange",h.strokeRect(z+1/f,q+1/p,U-2/f,D-2/p))}const K=2.5/f,Q=2.5/p,{currentPageId:j}=r;let B;for(let z=0;z<this.collaborators.length;z++)B=this.collaborators[z],B.currentPageId===j&&(h.beginPath(),h.ellipse(Ci(B.cursor.x,o.minX+K,o.maxX-K),Ci(B.cursor.y,o.minY+Q,o.maxY-Q),5/f,5/p,0,0,kt),h.fillStyle=B.color,h.fill());if(this.debug){h.lineWidth=2/f;{const{minX:z,minY:q,width:U,height:D}=s;h.strokeStyle="red",h.strokeRect(z+1/f,q+1/p,U-2/f,D-2/p)}{const{minX:z,minY:q,width:U,height:D}=o;h.strokeStyle="blue",h.strokeRect(z+1/f,q+1/p,U-2/f,D-2/p)}}});this.editor=t,this.dpr=n}setDpr(t){this.dpr=+t.toFixed(2)}static roundedRect(t,n,r,i,o,s,a){if(s<1&&a<1){t.rect(n,r,i,o);return}t.moveTo(n+s,r),t.lineTo(n+i-s,r),t.quadraticCurveTo(n+i,r,n+i,r+a),t.lineTo(n+i,r+o-a),t.quadraticCurveTo(n+i,r+o,n+i-s,r+o),t.lineTo(n+s,r+o),t.quadraticCurveTo(n,r+o,n,r+o-a),t.lineTo(n,r+a),t.quadraticCurveTo(n,r,n+s,r)}static sharpRect(t,n,r,i,o,s,a){t.rect(n,r,i,o)}}const tle=Ke(function({shapeFill:t,selectFill:n,viewportFill:r}){const i=re(),o=b.useRef(null),s=tr(),a=b.useRef(!1),l=b.useMemo(()=>new pd(i,i.devicePixelRatio),[i]),c=i.isDarkMode;b.useEffect(()=>{const y=requestAnimationFrame(()=>{const x=getComputedStyle(s);l.colors={shapeFill:x.getPropertyValue(t).trim(),selectFill:x.getPropertyValue(n).trim(),viewportFill:x.getPropertyValue(r).trim()},l.render()});return()=>{cancelAnimationFrame(y)}},[s,n,t,r,l,c]);const u=b.useCallback(y=>{if(!i.shapeIds.size)return;const{x,y:w}=l.minimapScreenPointToPagePoint(y.clientX,y.clientY,!1,!1),_=l.minimapScreenPointToPagePoint(y.clientX,y.clientY,!1,!0);l.originPagePoint.setTo(_),l.originPageCenter.setTo(i.viewportPageBounds.center),i.centerOnPoint(x,w,{duration:ko})},[i,l]),d=b.useCallback(y=>{if(y.currentTarget.setPointerCapture(y.pointerId),!i.shapeIds.size)return;a.current=!0,l.isInViewport=!1;const{x,y:w}=l.minimapScreenPointToPagePoint(y.clientX,y.clientY,!1,!1),_=l.minimapScreenPointToPagePoint(y.clientX,y.clientY,!1,!0),S=i.viewportPageBounds;l.originPagePoint.setTo(_),l.originPageCenter.setTo(S.center),l.isInViewport=S.containsPoint(_),l.isInViewport||i.centerOnPoint(x,w,{duration:ko})},[i,l]),h=b.useCallback(y=>{if(a.current){const{x:S,y:T}=l.minimapScreenPointToPagePoint(y.clientX,y.clientY,y.shiftKey,!0);if(l.isInViewport){const P=E.Sub({x:S,y:T},l.originPagePoint),I=E.Add(l.originPageCenter,P);i.centerOnPoint(I.x,I.y);return}i.centerOnPoint(S,T)}const x=l.getPagePoint(y.clientX,y.clientY),w=i.pageToScreen(x.x,x.y),_={type:"pointer",target:"canvas",name:"pointer_move",...nle(y),point:w,isPen:i.isPenMode};i.dispatch(_)},[i,l]),f=b.useCallback(y=>{a.current=!1},[]),p=b.useCallback(y=>{const x=O5(y);i.dispatch({type:"wheel",name:"wheel",delta:x,shiftKey:y.shiftKey,altKey:y.altKey,ctrlKey:y.metaKey||y.ctrlKey})},[i]);Na("update dpr",()=>{const{devicePixelRatio:y}=i;l.setDpr(y);const x=o.current,w=x.getBoundingClientRect(),_=w.width*y,S=w.height*y;x.width=_,x.height=S,l.canvasScreenBounds.set(w.x,w.y,_,S),l.cvs=o.current},[i,l]);const g=b.useMemo(()=>i.store.query.records("instance_presence"),[i]);return Na("minimap render when pagebounds or collaborators changes",()=>{const{devicePixelRatio:y,viewportPageBounds:x,allShapesCommonBounds:w}=i;l.contentPageBounds=w?me.Expand(w,x):x,l.updateContentScreenBounds();const _=[];i.shapeIds.forEach(S=>{let T=i.getPageBoundsById(S);const P=i.getPageMaskById(S);if(P){const I=pb(P,T.corners);if(!I)return;T=me.FromPoints(I)}T&&(T.id=S,_.push(T))}),l.pageBounds=_,l.collaborators=g.value,l.render()},[i,l]),m.jsx("div",{className:"tlui-minimap",children:m.jsx("canvas",{ref:o,className:"tlui-minimap__canvas",onDoubleClick:u,onPointerMove:h,onPointerDown:d,onPointerUp:f,onWheel:p})})});function nle(e){return e.isKilled=!0,{point:{x:e.clientX,y:e.clientY,z:e.pressure},shiftKey:e.shiftKey,altKey:e.altKey,ctrlKey:e.metaKey||e.ctrlKey,pointerId:e.pointerId,button:e.button,isPen:e.pointerType==="pen"}}const d1=Ke(function(){const t=re(),n=qe(),r=fi(),i=t.zoomLevel,o=t.shapeIds.size>0,s=t.selectedIds.length>0,a=t.zoomLevel===1,l=b.useCallback(()=>{t.resetZoom(t.viewportScreenCenter,{duration:ko})},[t]);return m.jsxs(Qs,{id:"zoom",children:[m.jsx(Wh,{children:m.jsx(be,{title:`${n("navigation-zone.zoom")}`,"data-testid":"minimap.zoom-menu",className:r<5?"tlui-zoom-menu__button":"tlui-zoom-menu__button__pct",onDoubleClick:l,icon:r<4?"zoom-in":void 0,children:r<4?null:m.jsxs("span",{style:{flexGrow:0,textAlign:"center"},children:[Math.floor(i*100),"%"]})})}),m.jsx(Js,{side:"top",align:"start",alignOffset:0,children:m.jsxs(Lo,{children:[m.jsx(Lu,{action:"zoom-in","data-testid":"minimap.zoom-menu.zoom-in",noClose:!0}),m.jsx(Lu,{action:"zoom-out","data-testid":"minimap.zoom-menu.zoom-out",noClose:!0}),m.jsx(Lu,{action:"zoom-to-100","data-testid":"minimap.zoom-menu.zoom-to-100",noClose:!0,disabled:a}),m.jsx(Lu,{action:"zoom-to-fit",disabled:!o,"data-testid":"minimap.zoom-menu.zoom-to-fit",noClose:!0}),m.jsx(Lu,{action:"zoom-to-selection",disabled:!s,"data-testid":"minimap.zoom-menu.zoom-to-selection",noClose:!0})]})})]})});function Lu(e){const{action:t,disabled:n=!1,noClose:r=!1}=e,i=Nn();return m.jsx(Pr,{label:i[t].label,kbd:i[t].kbd,"data-testid":e["data-testid"],onClick:()=>i[t].onSelect("zoom-menu"),noClose:r,disabled:n})}const rle=b.memo(function(){const t=Nn(),n=qe(),r=fi(),[i,o]=ele("minimap",!0),s=b.useCallback(()=>{o(a=>!a)},[o]);return r<4?null:m.jsxs("div",{className:"tlui-navigation-zone",children:[m.jsx("div",{className:"tlui-navigation-zone__controls",children:r<6?m.jsx(d1,{}):i?m.jsxs(m.Fragment,{children:[m.jsx(d1,{}),m.jsx(be,{title:n("navigation-zone.toggle-minimap"),className:"tlui-navigation-zone__toggle","data-testid":"minimap.toggle",onClick:s,icon:i?"chevrons-ne":"chevrons-sw"})]}):m.jsxs(m.Fragment,{children:[m.jsx(be,{icon:"minus","data-testid":"minimap.zoom-out",title:`${n(t["zoom-out"].label)} ${no(t["zoom-out"].kbd)}`,onClick:()=>t["zoom-out"].onSelect("navigation-zone")}),m.jsx(d1,{}),m.jsx(be,{icon:"plus","data-testid":"minimap.zoom-in",title:`${n(t["zoom-in"].label)} ${no(t["zoom-in"].kbd)}`,onClick:()=>t["zoom-in"].onSelect("navigation-zone")}),m.jsx(be,{title:n("navigation-zone.toggle-minimap"),className:"tlui-navigation-zone__toggle",onClick:s,icon:i?"chevrons-ne":"chevrons-sw"})]})}),r>=6&&!i&&m.jsx(tle,{viewportFill:"--color-muted-1",selectFill:"--color-selected",shapeFill:"--color-text-3"})]})}),ile=Ke(function(){const n=re().isPenMode,r=Nn();if(!n)return null;const i=r["exit-pen-mode"];return m.jsx(be,{label:i.label,iconLeft:i.icon,onClick:()=>i.onSelect("helper-buttons")})}),ole=Ke(function(){const t=re(),n=Nn();if(!t.instanceState.followingUserId)return null;const r=n["stop-following"];return m.jsx(be,{label:r.label,iconLeft:r.icon,onClick:()=>r.onSelect("people-menu")})});function sle(e){const{items:t,title:n,styleType:r,value:i=null,onValueChange:o,columns:s=Ci(t.length,2,4)}=e,a=re(),l=qe(),c=b.useRef(!1),{handleButtonClick:u,handleButtonPointerDown:d,handleButtonPointerEnter:h,handleButtonPointerUp:f}=b.useMemo(()=>{const p=()=>{c.current=!1,window.removeEventListener("pointerup",p)};return{handleButtonClick:_=>{const{id:S}=_.currentTarget.dataset;i!==S&&(a.mark("point picker item"),o(t.find(T=>T.id===S),!1))},handleButtonPointerDown:_=>{const{id:S}=_.currentTarget.dataset;a.mark("point picker item"),o(t.find(T=>T.id===S),!0),c.current=!0,window.addEventListener("pointerup",p)},handleButtonPointerEnter:_=>{if(!c.current)return;const{id:S}=_.currentTarget.dataset;o(t.find(T=>T.id===S),!0)},handleButtonPointerUp:_=>{const{id:S}=_.currentTarget.dataset;o(t.find(T=>T.id===S),!1)}}},[a,i,o,t]);return m.jsx("div",{className:Me("tlui-button-grid",{"tlui-button-grid__two":s===2,"tlui-button-grid__three":s===3,"tlui-button-grid__four":s===4}),children:t.map(p=>m.jsx(be,{"data-id":p.id,"data-testid":`${e["data-testid"]}.${p.id}`,"aria-label":p.id,"data-state":i===p.id?"hinted":void 0,title:n+" — "+l(`${r}-style.${p.id}`),className:Me("tlui-button-grid__button"),style:p.type==="color"?{color:`var(--palette-${p.id})`}:void 0,onPointerEnter:h,onPointerDown:d,onPointerUp:f,onClick:u,icon:p.icon},p.id))})}const ic=b.memo(sle);function AL(e,[t,n]){return Math.min(n,Math.max(t,e))}function ale(e){const t=b.useRef({value:e,previous:e});return b.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}const ML=["PageUp","PageDown"],OL=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],LL={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},Vh="Slider",[Vb,lle,cle]=Ny(Vh),[BL,Fwe]=Qo(Vh,[cle]),[ule,Gy]=BL(Vh),dle=b.forwardRef((e,t)=>{const{name:n,min:r=0,max:i=100,step:o=1,orientation:s="horizontal",disabled:a=!1,minStepsBetweenThumbs:l=0,defaultValue:c=[r],value:u,onValueChange:d=()=>{},onValueCommit:h=()=>{},inverted:f=!1,...p}=e,[g,y]=b.useState(null),x=Tt(t,B=>y(B)),w=b.useRef(new Set),_=b.useRef(0),S=s==="horizontal",T=g?!!g.closest("form"):!0,P=S?hle:fle,[I=[],$]=ul({prop:u,defaultProp:c,onChange:B=>{var z;(z=[...w.current][_.current])===null||z===void 0||z.focus(),d(B)}}),L=b.useRef(I);function R(B){const z=Sle(I,B);j(B,z)}function K(B){j(B,_.current)}function Q(){const B=L.current[_.current];I[_.current]!==B&&h(I)}function j(B,z,{commit:q}={commit:!1}){const U=kle(o),D=Tle(Math.round((B-r)/o)*o+r,U),F=AL(D,[r,i]);$((J=[])=>{const Z=ble(J,F,z);if(Ele(Z,l*o)){_.current=Z.indexOf(F);const ne=String(Z)!==String(J);return ne&&q&&h(Z),ne?Z:J}else return J})}return b.createElement(ule,{scope:e.__scopeSlider,disabled:a,min:r,max:i,valueIndexToChangeRef:_,thumbs:w.current,values:I,orientation:s},b.createElement(Vb.Provider,{scope:e.__scopeSlider},b.createElement(Vb.Slot,{scope:e.__scopeSlider},b.createElement(P,oe({"aria-disabled":a,"data-disabled":a?"":void 0},p,{ref:x,onPointerDown:we(p.onPointerDown,()=>{a||(L.current=I)}),min:r,max:i,inverted:f,onSlideStart:a?void 0:R,onSlideMove:a?void 0:K,onSlideEnd:a?void 0:Q,onHomeKeyDown:()=>!a&&j(r,0,{commit:!0}),onEndKeyDown:()=>!a&&j(i,I.length-1,{commit:!0}),onStepKeyDown:({event:B,direction:z})=>{if(!a){const D=ML.includes(B.key)||B.shiftKey&&OL.includes(B.key)?10:1,F=_.current,J=I[F],Z=o*D*z;j(J+Z,F,{commit:!0})}}})))),T&&I.map((B,z)=>b.createElement(xle,{key:z,name:n?n+(I.length>1?"[]":""):void 0,value:B})))}),[RL,DL]=BL(Vh,{startEdge:"left",endEdge:"right",size:"width",direction:1}),hle=b.forwardRef((e,t)=>{const{min:n,max:r,dir:i,inverted:o,onSlideStart:s,onSlideMove:a,onSlideEnd:l,onStepKeyDown:c,...u}=e,[d,h]=b.useState(null),f=Tt(t,_=>h(_)),p=b.useRef(),g=L_(i),y=g==="ltr",x=y&&!o||!y&&o;function w(_){const S=p.current||d.getBoundingClientRect(),T=[0,S.width],I=hC(T,x?[n,r]:[r,n]);return p.current=S,I(_-S.left)}return b.createElement(RL,{scope:e.__scopeSlider,startEdge:x?"left":"right",endEdge:x?"right":"left",direction:x?1:-1,size:"width"},b.createElement(FL,oe({dir:g,"data-orientation":"horizontal"},u,{ref:f,style:{...u.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:_=>{const S=w(_.clientX);s==null||s(S)},onSlideMove:_=>{const S=w(_.clientX);a==null||a(S)},onSlideEnd:()=>{p.current=void 0,l==null||l()},onStepKeyDown:_=>{const T=LL[x?"from-left":"from-right"].includes(_.key);c==null||c({event:_,direction:T?-1:1})}})))}),fle=b.forwardRef((e,t)=>{const{min:n,max:r,inverted:i,onSlideStart:o,onSlideMove:s,onSlideEnd:a,onStepKeyDown:l,...c}=e,u=b.useRef(null),d=Tt(t,u),h=b.useRef(),f=!i;function p(g){const y=h.current||u.current.getBoundingClientRect(),x=[0,y.height],_=hC(x,f?[r,n]:[n,r]);return h.current=y,_(g-y.top)}return b.createElement(RL,{scope:e.__scopeSlider,startEdge:f?"bottom":"top",endEdge:f?"top":"bottom",size:"height",direction:f?1:-1},b.createElement(FL,oe({"data-orientation":"vertical"},c,{ref:d,style:{...c.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:g=>{const y=p(g.clientY);o==null||o(y)},onSlideMove:g=>{const y=p(g.clientY);s==null||s(y)},onSlideEnd:()=>{h.current=void 0,a==null||a()},onStepKeyDown:g=>{const x=LL[f?"from-bottom":"from-top"].includes(g.key);l==null||l({event:g,direction:x?-1:1})}})))}),FL=b.forwardRef((e,t)=>{const{__scopeSlider:n,onSlideStart:r,onSlideMove:i,onSlideEnd:o,onHomeKeyDown:s,onEndKeyDown:a,onStepKeyDown:l,...c}=e,u=Gy(Vh,n);return b.createElement(lt.span,oe({},c,{ref:t,onKeyDown:we(e.onKeyDown,d=>{d.key==="Home"?(s(d),d.preventDefault()):d.key==="End"?(a(d),d.preventDefault()):ML.concat(OL).includes(d.key)&&(l(d),d.preventDefault())}),onPointerDown:we(e.onPointerDown,d=>{const h=d.target;h.setPointerCapture(d.pointerId),d.preventDefault(),u.thumbs.has(h)?h.focus():r(d)}),onPointerMove:we(e.onPointerMove,d=>{d.target.hasPointerCapture(d.pointerId)&&i(d)}),onPointerUp:we(e.onPointerUp,d=>{const h=d.target;h.hasPointerCapture(d.pointerId)&&(h.releasePointerCapture(d.pointerId),o(d))})}))}),ple="SliderTrack",gle=b.forwardRef((e,t)=>{const{__scopeSlider:n,...r}=e,i=Gy(ple,n);return b.createElement(lt.span,oe({"data-disabled":i.disabled?"":void 0,"data-orientation":i.orientation},r,{ref:t}))}),DP="SliderRange",mle=b.forwardRef((e,t)=>{const{__scopeSlider:n,...r}=e,i=Gy(DP,n),o=DL(DP,n),s=b.useRef(null),a=Tt(t,s),l=i.values.length,c=i.values.map(h=>NL(h,i.min,i.max)),u=l>1?Math.min(...c):0,d=100-Math.max(...c);return b.createElement(lt.span,oe({"data-orientation":i.orientation,"data-disabled":i.disabled?"":void 0},r,{ref:a,style:{...e.style,[o.startEdge]:u+"%",[o.endEdge]:d+"%"}}))}),FP="SliderThumb",yle=b.forwardRef((e,t)=>{const n=lle(e.__scopeSlider),[r,i]=b.useState(null),o=Tt(t,a=>i(a)),s=b.useMemo(()=>r?n().findIndex(a=>a.ref.current===r):-1,[n,r]);return b.createElement(vle,oe({},e,{ref:o,index:s}))}),vle=b.forwardRef((e,t)=>{const{__scopeSlider:n,index:r,...i}=e,o=Gy(FP,n),s=DL(FP,n),[a,l]=b.useState(null),c=Tt(t,y=>l(y)),u=$O(a),d=o.values[r],h=d===void 0?0:NL(d,o.min,o.max),f=wle(r,o.values.length),p=u==null?void 0:u[s.size],g=p?_le(p,h,s.direction):0;return b.useEffect(()=>{if(a)return o.thumbs.add(a),()=>{o.thumbs.delete(a)}},[a,o.thumbs]),b.createElement("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[s.startEdge]:`calc(${h}% + ${g}px)`}},b.createElement(Vb.ItemSlot,{scope:e.__scopeSlider},b.createElement(lt.span,oe({role:"slider","aria-label":e["aria-label"]||f,"aria-valuemin":o.min,"aria-valuenow":d,"aria-valuemax":o.max,"aria-orientation":o.orientation,"data-orientation":o.orientation,"data-disabled":o.disabled?"":void 0,tabIndex:o.disabled?void 0:0},i,{ref:c,style:d===void 0?{display:"none"}:e.style,onFocus:we(e.onFocus,()=>{o.valueIndexToChangeRef.current=r})}))))}),xle=e=>{const{value:t,...n}=e,r=b.useRef(null),i=ale(t);return b.useEffect(()=>{const o=r.current,s=window.HTMLInputElement.prototype,l=Object.getOwnPropertyDescriptor(s,"value").set;if(i!==t&&l){const c=new Event("input",{bubbles:!0});l.call(o,t),o.dispatchEvent(c)}},[i,t]),b.createElement("input",oe({style:{display:"none"}},n,{ref:r,defaultValue:t}))};function ble(e=[],t,n){const r=[...e];return r[n]=t,r.sort((i,o)=>i-o)}function NL(e,t,n){const o=100/(n-t)*(e-t);return AL(o,[0,100])}function wle(e,t){return t>2?`Value ${e+1} of ${t}`:t===2?["Minimum","Maximum"][e]:void 0}function Sle(e,t){if(e.length===1)return 0;const n=e.map(i=>Math.abs(i-t)),r=Math.min(...n);return n.indexOf(r)}function _le(e,t,n){const r=e/2,o=hC([0,50],[0,r]);return(r-o(t)*n)*n}function Cle(e){return e.slice(0,-1).map((t,n)=>e[n+1]-t)}function Ele(e,t){if(t>0){const n=Cle(e);return Math.min(...n)>=t}return!0}function hC(e,t){return n=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const r=(t[1]-t[0])/(e[1]-e[0]);return t[0]+r*(n-e[0])}}function kle(e){return(String(e).split(".")[1]||"").length}function Tle(e,t){const n=Math.pow(10,t);return Math.round(e*n)/n}const Ple=dle,Ile=gle,$le=mle,Ale=yle;function Mle(e){const{title:t,steps:n,value:r,label:i,onValueChange:o}=e,s=re(),a=qe(),l=b.useCallback(d=>{o(d[0],!0)},[o]),c=b.useCallback(()=>{s.mark("click slider")},[s]),u=b.useCallback(()=>{r&&o(r,!1)},[r,o]);return m.jsx("div",{className:"tlui-slider__container",children:m.jsxs(Ple,{"data-testid":e["data-testid"],className:"tlui-slider","area-label":"Opacity",dir:"ltr",min:0,max:n,step:1,value:r?[r]:void 0,onPointerDown:c,onValueChange:l,onPointerUp:u,title:t+" — "+a(i),children:[m.jsx(Ile,{className:"tlui-slider__track",dir:"ltr",children:r!==null&&m.jsx($le,{className:"tlui-slider__range",dir:"ltr"})}),r!==null&&m.jsx(Ale,{className:"tlui-slider__thumb",dir:"ltr"})]})})}const Ole=b.memo(function({"data-testid":t,label:n,labelA:r,labelB:i,itemsA:o,itemsB:s,styleTypeA:a,styleTypeB:l,valueA:c,valueB:u,onValueChange:d}){const h=qe(),f=b.useMemo(()=>{var x;return((x=o.find(w=>w.id===c))==null?void 0:x.icon)??"mixed"},[o,c]),p=b.useMemo(()=>{var x;return((x=s.find(w=>w.id===u))==null?void 0:x.icon)??"mixed"},[s,u]);if(c===void 0&&u===void 0)return null;const g=`${t}.start`,y=`${t}.end`;return m.jsxs("div",{className:"tlui-style-panel__double-select-picker",children:[m.jsx("div",{title:h(n),className:"tlui-style-panel__double-select-picker-label",children:h(n)}),m.jsxs(Qs,{id:`style panel ${a}`,children:[m.jsx(rh,{asChild:!0,children:m.jsx(be,{"data-testid":g,title:h(r)+" — "+h(c===null?"style-panel.mixed":`${a}-style.${c}`),icon:f,invertIcon:!0,smallIcon:!0})}),m.jsx(Js,{side:"bottom",align:"end",sideOffset:0,alignOffset:-2,children:m.jsx("div",{className:Me("tlui-button-grid",{"tlui-button-grid__two":o.length<4,"tlui-button-grid__four":o.length>=4}),children:o.map(x=>m.jsx(Pr,{className:"tlui-button-grid__button",title:h(r)+" — "+h(`${a}-style.${x.id}`),"data-testid":`${g}.${x.id}`,icon:x.icon,onClick:()=>d(x,!1),invertIcon:!0},x.id))})})]}),m.jsxs(Qs,{id:`style panel ${l}`,children:[m.jsx(rh,{asChild:!0,children:m.jsx(be,{"data-testid":y,title:h(i)+" — "+h(u===null?"style-panel.mixed":`${l}-style.${u}`),icon:p,smallIcon:!0})}),m.jsx(Js,{side:"bottom",align:"end",sideOffset:0,alignOffset:-2,children:m.jsx("div",{className:Me("tlui-button-grid",{"tlui-button-grid__two":o.length<4,"tlui-button-grid__four":o.length>=4}),children:s.map(x=>m.jsx(Pr,{className:"tlui-button-grid__button",title:h(i)+" — "+h(`${l}-style.${x.id}`),"data-testid":`${y}.${x.id}`,icon:x.icon,onClick:()=>d(x,!1)},x.id))})})]})]})}),fC=b.memo(function({id:t,items:n,styleType:r,label:i,value:o,onValueChange:s,"data-testid":a}){const l=qe(),c=b.useMemo(()=>{var u;return(u=n.find(d=>d.id===o))==null?void 0:u.icon},[n,o]);return m.jsxs(Qs,{id:`style panel ${t}`,children:[m.jsx(rh,{asChild:!0,children:m.jsx(be,{"data-testid":a,title:l(o===null?"style-panel.mixed":`${r}-style.${o}`),label:i,icon:c??"mixed"})}),m.jsx(Js,{side:"left",align:"center",alignOffset:0,children:m.jsx("div",{className:Me("tlui-button-grid",{"tlui-button-grid__two":n.length<3,"tlui-button-grid__three":n.length==3,"tlui-button-grid__four":n.length>=4}),children:n.map(u=>m.jsx(Pr,{className:"tlui-button-grid__button","data-testid":`${a}.${u.id}`,title:l(`${r}-style.${u.id}`),icon:u.icon,onClick:()=>s(u,!1)},u.id))})})]})}),jL=function({isMobile:t}){const n=re(),r=ye("props",()=>n.props,[n]),i=ye("opacity",()=>n.opacity,[n]),o=ye("toolShapeType",()=>{var y;return(y=n.root.current.value)==null?void 0:y.shapeType},[n]),s=b.useCallback(()=>{t||(n.isChangingStyle=!1)},[n,t]);if(!r&&!o)return null;const{geo:a,arrowheadEnd:l,arrowheadStart:c,spline:u,font:d}=r??{},h=a===void 0,f=l===void 0&&c===void 0,p=u===void 0,g=d===void 0;return m.jsxs("div",{className:"tlui-style-panel","data-ismobile":t,onPointerLeave:s,children:[m.jsx(Lle,{props:r??{},opacity:i}),!g&&m.jsx(Ble,{props:r??{}}),!(h&&f&&p)&&m.jsxs("div",{className:"tlui-style-panel__section","aria-label":"style panel styles",children:[m.jsx(Rle,{props:r??{}}),m.jsx(Fle,{props:r??{}}),m.jsx(Dle,{props:r??{}})]})]})},{styles:Ti}=Oe;function Yh(){const e=re();return ke.useCallback((t,n)=>{e.batch(()=>{e.setProp(t.type,t.id,!1,n),e.isChangingStyle=!0})},[e])}const Bu=[.1,.25,.5,.75,1];function Lle({props:e,opacity:t}){const n=re(),r=qe(),i=Yh(),o=ke.useCallback((h,f)=>{const p=Bu[h];n.setOpacity(p,f),n.isChangingStyle=!0},[n]),{color:s,fill:a,dash:l,size:c}=e;if(s===void 0&&a===void 0&&l===void 0&&c===void 0&&t===void 0)return null;const u=a!==void 0||l!==void 0||c!==void 0,d=t===null?-1:Bu.indexOf(wM(Bu,h=>Math.abs(h-t)));return m.jsxs(m.Fragment,{children:[m.jsxs("div",{className:"tlui-style-panel__section__common","aria-label":"style panel styles",children:[s===void 0?null:m.jsx(ic,{title:r("style-panel.color"),styleType:"color","data-testid":"style.color",items:Ti.color,value:s,onValueChange:i}),t===void 0?null:m.jsx(Mle,{"data-testid":"style.opacity",value:d>=0?d:Bu.length-1,label:t?`opacity-style.${t}`:"style-panel.mixed",onValueChange:o,steps:Bu.length-1,title:r("style-panel.opacity")})]}),u&&m.jsxs("div",{className:"tlui-style-panel__section","aria-label":"style panel styles",children:[a===void 0?null:m.jsx(ic,{title:r("style-panel.fill"),styleType:"fill","data-testid":"style.fill",items:Ti.fill,value:a,onValueChange:i}),l===void 0?null:m.jsx(ic,{title:r("style-panel.dash"),styleType:"dash","data-testid":"style.dash",items:Ti.dash,value:l,onValueChange:i}),c===void 0?null:m.jsx(ic,{title:r("style-panel.size"),styleType:"size","data-testid":"style.size",items:Ti.size,value:c,onValueChange:i})]})]})}function Ble({props:e}){const t=qe(),n=Yh(),{font:r,align:i,verticalAlign:o}=e;return r===void 0&&i===void 0?null:m.jsxs("div",{className:"tlui-style-panel__section","aria-label":"style panel text",children:[r===void 0?null:m.jsx(ic,{title:t("style-panel.font"),styleType:"font","data-testid":"font",items:Ti.font,value:r,onValueChange:n}),i===void 0?null:m.jsxs("div",{className:"tlui-style-panel__row",children:[m.jsx(ic,{title:t("style-panel.align"),styleType:"align","data-testid":"align",items:Ti.align,value:i,onValueChange:n}),o===void 0?m.jsx(be,{title:t("style-panel.vertical-align"),"data-testid":"vertical-align",icon:"vertical-align-center",disabled:!0}):m.jsx(fC,{id:"geo-vertical-alignment",styleType:"verticalAlign","data-testid":"style-panel.geo-vertical-align",items:Ti.verticalAlign,value:o,onValueChange:n})]})]})}function Rle({props:e}){const t=Yh(),{geo:n}=e;return n===void 0?null:m.jsx(fC,{id:"geo",label:"style-panel.geo",styleType:"geo","data-testid":"style-panel.geo",items:Ti.geo,value:n,onValueChange:t})}function Dle({props:e}){const t=Yh(),{spline:n}=e;return n===void 0?null:m.jsx(fC,{id:"spline",label:"style-panel.spline",styleType:"spline","data-testid":"style.spline",items:Ti.spline,value:n,onValueChange:t})}function Fle({props:e}){const t=Yh(),{arrowheadEnd:n,arrowheadStart:r}=e;return n===void 0&&r===void 0?null:m.jsx(Ole,{label:"style-panel.arrowheads",styleTypeA:"arrowheadStart","data-testid":"style.arrowheads",itemsA:Ti.arrowheadStart,valueA:r,styleTypeB:"arrowheadEnd",itemsB:Ti.arrowheadEnd,valueB:n,onValueChange:t,labelA:"style-panel.arrowhead-start",labelB:"style-panel.arrowhead-end"})}function Nle({toast:e}){const{removeToast:t}=lo(),n=qe(),r=o=>{o||t(e.id)},i=e.actions&&e.actions.length>0;return m.jsxs(ioe,{onOpenChange:r,className:"tlui-toast__container",duration:e.keepOpen?1/0:5e3,children:[e.icon&&m.jsx("div",{className:"tlui-toast__icon",children:m.jsx(mr,{icon:e.icon})}),m.jsxs("div",{className:"tlui-toast__main",children:[m.jsxs("div",{className:"tlui-toast__content",children:[m.jsx(ooe,{className:"tlui-toast__title",children:e.title}),m.jsx(soe,{className:"tlui-toast__description",children:e.description})]}),e.actions&&m.jsxs("div",{className:"tlui-toast__actions",children:[e.actions.map((o,s)=>m.jsx(aoe,{altText:o.label,asChild:!0,onClick:o.onClick,children:m.jsx(be,{className:o.type==="warn"?"tlui-button__warning":"tlui-button__primary",children:o.label})},s)),i&&m.jsx(fP,{asChild:!0,children:m.jsx(be,{className:"tlui-toast__close",style:{marginLeft:"auto"},children:e.closeLabel??n("toast.close")})})]})]}),!i&&m.jsx(fP,{asChild:!0,children:m.jsx(be,{className:"tlui-toast__close",children:e.closeLabel??n("toast.close")})})]})}function jle(){const{toasts:e}=lo();return m.jsx(m.Fragment,{children:e.map(t=>m.jsx(Nle,{toast:t},t.id))})}const zle=b.memo(jle);function Ule(){const{toasts:e}=lo(),[t,n]=b.useState(!1);return b.useEffect(()=>{let r=!1;return e.length?n(!0):setTimeout(()=>{r||n(!1)},1e3),()=>{r=!0}},[e.length,n]),t?m.jsx(zie,{className:"tlui-toast__viewport"}):null}function Wle(){const e=re(),t=qe(),n=ye("current color",()=>{const{props:o}=e;return o?o.color?e.getCssColor(o.color):null:"var(--color-muted-1)"},[e]),r=ye("isHandOrEraserToolActive",()=>e.isInAny("hand","zoom","eraser"),[e]),i=b.useCallback(o=>{o||(e.isChangingStyle=!1)},[e]);return m.jsxs(uC,{id:"style menu",onOpenChange:i,children:[m.jsx(dC,{disabled:r,children:m.jsx(be,{className:"tlui-toolbar__tools__button tlui-toolbar__styles__button","data-testid":"mobile.styles",style:{color:n??"var(--color-text)"},title:t("style-panel.title"),children:m.jsx(mr,{icon:n?"blob":"mixed"})})}),m.jsx(EL,{side:"top",align:"end",children:m.jsx(jL,{isMobile:!0})})]})}const Hle=["select","hand","draw","eraser","text","zoom","laser"];function Kle({activeToolId:e}){const t=re(),n=fi(),r=qe(),i=ye("is tool locked",()=>t.instanceState.isToolLocked,[t]);return!e||Hle.includes(e)?null:m.jsx(be,{title:r("action.toggle-tool-lock"),className:Me("tlui-toolbar__lock-button",{"tlui-toolbar__lock-button__mobile":n<5}),icon:i?"lock":"unlock",onClick:()=>t.updateInstanceState({isToolLocked:!i}),smallIcon:!0})}const Vle=function(){const t=re(),n=qe(),r=fi(),i=ke.useRef(void 0),o=co(),s=ise(),a=s.find(w=>w.toolItem.id==="laser"),l=ye("current tool id",()=>t.currentToolId,[t]),c=l==="hand",u=ye("geo",()=>t.props?t.props.geo:void 0,[t]),d=!o,h=!(o||c),f=w=>w.label?`${n(w.label)} ${w.kbd?no(w.kbd):""}`:"",p=s.find(w=>Dl(w.toolItem,l,u)),{itemsInPanel:g,itemsInDropdown:y,dropdownFirstItem:x}=ke.useMemo(()=>{const w=[],_=[];let S;const T=Math.min(8,5+r);for(let P=4;P<s.length;P++){const I=s[P];P<T?w.push(I):(I===p&&(S=I),_.push(I))}return S||(i.current||(i.current=_[0]),S=i.current,_.includes(S)||(S=_[0])),i.current=S,_.length<=2&&(w.push(..._),_.length=0),{itemsInPanel:w,itemsInDropdown:_,dropdownFirstItem:S}},[s,p,r]);return m.jsx("div",{className:"tlui-toolbar",children:m.jsxs("div",{className:"tlui-toolbar__inner",children:[m.jsxs("div",{className:"tlui-toolbar__left",children:[!o&&m.jsxs("div",{className:Me("tlui-toolbar__extras",{"tlui-toolbar__extras__hidden":!h}),children:[r<6&&m.jsxs("div",{className:"tlui-toolbar__extras__controls",children:[m.jsx($L,{}),m.jsx(PL,{}),m.jsx(IL,{}),m.jsx(TL,{}),m.jsx(kL,{})]}),m.jsx(Kle,{activeToolId:l})]}),m.jsxs("div",{className:Me("tlui-toolbar__tools",{"tlui-toolbar__tools__mobile":r<5}),children:[s.slice(0,2).map(({toolItem:w})=>m.jsx(Ru,{item:w,title:f(w),isSelected:Dl(w,l,u)},w.id)),o&&a&&m.jsx(Ru,{item:a.toolItem,title:f(a.toolItem),isSelected:Dl(a.toolItem,l,u)},a.toolItem.id),d&&m.jsxs(m.Fragment,{children:[m.jsx("div",{className:"tlui-toolbar__divider"}),s.slice(2,4).map(({toolItem:w})=>m.jsx(Ru,{item:w,title:f(w),isSelected:Dl(w,l,u)},w.id)),m.jsx("div",{className:"tlui-toolbar__divider"}),g.map(({toolItem:w})=>m.jsx(Ru,{item:w,title:f(w),isSelected:Dl(w,l,u)},w.id)),y.length?m.jsxs(m.Fragment,{children:[m.jsx(Ru,{item:x.toolItem,title:f(x.toolItem),isSelected:Dl(x.toolItem,l,u)},x.toolItem.id),m.jsxs(Qs,{id:"toolbar overflow",modal:!1,children:[m.jsx(Wh,{children:m.jsx(be,{className:"tlui-toolbar__tools__button tlui-toolbar__overflow",icon:"chevron-up","data-testid":"tools.more",title:n("tool-panel.more")})}),m.jsx(Js,{side:"top",align:"center",children:m.jsx(Yle,{toolbarItems:y})})]})]}):null]})]})]}),r<5&&!o&&m.jsx("div",{className:"tlui-toolbar__tools",children:m.jsx(Wle,{})})]})})},Yle=Ke(function({toolbarItems:t}){const n=qe();return m.jsx("div",{className:"tlui-button-grid__four tlui-button-grid__reverse",children:t.map(({toolItem:{id:r,meta:i,kbd:o,label:s,onSelect:a,icon:l}})=>m.jsx(Pr,{className:"tlui-button-grid__button","data-testid":`tools.${r}`,"data-tool":r,"data-geo":(i==null?void 0:i.geo)??"","aria-label":s,onClick:()=>a("toolbar"),title:s?`${n(s)} ${o?no(o):""}`:"",icon:l},r))})});function Ru({item:e,title:t,isSelected:n}){var r;return m.jsx(be,{className:"tlui-toolbar__tools__button","data-testid":`tools.${e.id}`,"data-tool":e.id,"data-geo":((r=e.meta)==null?void 0:r.geo)??"","aria-label":e.label,title:t,icon:e.icon,"data-state":n?"selected":void 0,onClick:()=>e.onSelect("toolbar"),onTouchStart:i=>{Xe(i),e.onSelect("toolbar")}})}const Dl=(e,t,n)=>{var r,i;return(r=e.meta)!=null&&r.geo?t==="geo"&&n===((i=e.meta)==null?void 0:i.geo):t===e.id};function qle(){const e=re(),{addToast:t}=lo();b.useEffect(()=>{function n({name:r,count:i}){t({title:"Maximum Shapes Reached",description:`You've reached the maximum number of shapes allowed on ${r} (${i}). Please delete some shapes or move to a different page to continue.`})}return e.addListener("max-shapes",n),()=>{e.removeListener("max-shapes",n)}},[e,t])}var h1=typeof navigator<"u"?navigator.userAgent.toLowerCase().indexOf("firefox")>0:!1;function f1(e,t,n,r){e.addEventListener?e.addEventListener(t,n,r):e.attachEvent&&e.attachEvent("on".concat(t),function(){n(window.event)})}function zL(e,t){for(var n=t.slice(0,t.length-1),r=0;r<n.length;r++)n[r]=e[n[r].toLowerCase()];return n}function UL(e){typeof e!="string"&&(e=""),e=e.replace(/\s/g,"");for(var t=e.split(","),n=t.lastIndexOf("");n>=0;)t[n-1]+=",",t.splice(n,1),n=t.lastIndexOf("");return t}function Gle(e,t){for(var n=e.length>=t.length?e:t,r=e.length>=t.length?t:e,i=!0,o=0;o<n.length;o++)r.indexOf(n[o])===-1&&(i=!1);return i}var sh={backspace:8,"⌫":8,tab:9,clear:12,enter:13,"↩":13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,num_0:96,num_1:97,num_2:98,num_3:99,num_4:100,num_5:101,num_6:102,num_7:103,num_8:104,num_9:105,num_multiply:106,num_add:107,num_enter:108,num_subtract:109,num_decimal:110,num_divide:111,"⇪":20,",":188,".":190,"/":191,"`":192,"-":h1?173:189,"=":h1?61:187,";":h1?59:186,"'":222,"[":219,"]":221,"\\":220},oo={"⇧":16,shift:16,"⌥":18,alt:18,option:18,"⌃":17,ctrl:17,control:17,"⌘":91,cmd:91,command:91},Yb={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey",shiftKey:16,ctrlKey:17,altKey:18,metaKey:91},pn={16:!1,18:!1,17:!1,91:!1},zt={};for(var hp=1;hp<20;hp++)sh["f".concat(hp)]=111+hp;var ft=[],NP=!1,WL="all",HL=[],qh=function(t){return sh[t.toLowerCase()]||oo[t.toLowerCase()]||t.toUpperCase().charCodeAt(0)},Xle=function(t){return Object.keys(sh).find(function(n){return sh[n]===t})},Zle=function(t){return Object.keys(oo).find(function(n){return oo[n]===t})};function KL(e){WL=e||"all"}function ah(){return WL||"all"}function Qle(){return ft.slice(0)}function Jle(){return ft.map(function(e){return Xle(e)||Zle(e)||String.fromCharCode(e)})}function ece(){var e=[];return Object.keys(zt).forEach(function(t){zt[t].forEach(function(n){var r=n.key,i=n.scope,o=n.mods,s=n.shortcut;e.push({scope:i,shortcut:s,mods:o,keys:r.split("+").map(function(a){return qh(a)})})})}),e}function tce(e){var t=e.target||e.srcElement,n=t.tagName,r=!0;return(t.isContentEditable||(n==="INPUT"||n==="TEXTAREA"||n==="SELECT")&&!t.readOnly)&&(r=!1),r}function nce(e){return typeof e=="string"&&(e=qh(e)),ft.indexOf(e)!==-1}function rce(e,t){var n,r;e||(e=ah());for(var i in zt)if(Object.prototype.hasOwnProperty.call(zt,i))for(n=zt[i],r=0;r<n.length;)n[r].scope===e?n.splice(r,1):r++;ah()===e&&KL(t||"all")}function ice(e){var t=e.keyCode||e.which||e.charCode,n=ft.indexOf(t);if(n>=0&&ft.splice(n,1),e.key&&e.key.toLowerCase()==="meta"&&ft.splice(0,ft.length),(t===93||t===224)&&(t=91),t in pn){pn[t]=!1;for(var r in oo)oo[r]===t&&(Pi[r]=!1)}}function oce(e){if(typeof e>"u")Object.keys(zt).forEach(function(s){return delete zt[s]});else if(Array.isArray(e))e.forEach(function(s){s.key&&p1(s)});else if(typeof e=="object")e.key&&p1(e);else if(typeof e=="string"){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n[0],o=n[1];typeof i=="function"&&(o=i,i=""),p1({key:e,scope:i,method:o,splitKey:"+"})}}var p1=function(t){var n=t.key,r=t.scope,i=t.method,o=t.splitKey,s=o===void 0?"+":o,a=UL(n);a.forEach(function(l){var c=l.split(s),u=c.length,d=c[u-1],h=d==="*"?"*":qh(d);if(zt[h]){r||(r=ah());var f=u>1?zL(oo,c):[];zt[h]=zt[h].filter(function(p){var g=i?p.method===i:!0;return!(g&&p.scope===r&&Gle(p.mods,f))})}})};function jP(e,t,n,r){if(t.element===r){var i;if(t.scope===n||t.scope==="all"){i=t.mods.length>0;for(var o in pn)Object.prototype.hasOwnProperty.call(pn,o)&&(!pn[o]&&t.mods.indexOf(+o)>-1||pn[o]&&t.mods.indexOf(+o)===-1)&&(i=!1);(t.mods.length===0&&!pn[16]&&!pn[18]&&!pn[17]&&!pn[91]||i||t.shortcut==="*")&&(t.keys=[],t.keys=t.keys.concat(ft),t.method(e,t)===!1&&(e.preventDefault?e.preventDefault():e.returnValue=!1,e.stopPropagation&&e.stopPropagation(),e.cancelBubble&&(e.cancelBubble=!0)))}}}function zP(e,t){var n=zt["*"],r=e.keyCode||e.which||e.charCode;if(Pi.filter.call(this,e)){if((r===93||r===224)&&(r=91),ft.indexOf(r)===-1&&r!==229&&ft.push(r),["ctrlKey","altKey","shiftKey","metaKey"].forEach(function(p){var g=Yb[p];e[p]&&ft.indexOf(g)===-1?ft.push(g):!e[p]&&ft.indexOf(g)>-1?ft.splice(ft.indexOf(g),1):p==="metaKey"&&e[p]&&ft.length===3&&(e.ctrlKey||e.shiftKey||e.altKey||(ft=ft.slice(ft.indexOf(g))))}),r in pn){pn[r]=!0;for(var i in oo)oo[i]===r&&(Pi[i]=!0);if(!n)return}for(var o in pn)Object.prototype.hasOwnProperty.call(pn,o)&&(pn[o]=e[Yb[o]]);e.getModifierState&&!(e.altKey&&!e.ctrlKey)&&e.getModifierState("AltGraph")&&(ft.indexOf(17)===-1&&ft.push(17),ft.indexOf(18)===-1&&ft.push(18),pn[17]=!0,pn[18]=!0);var s=ah();if(n)for(var a=0;a<n.length;a++)n[a].scope===s&&(e.type==="keydown"&&n[a].keydown||e.type==="keyup"&&n[a].keyup)&&jP(e,n[a],s,t);if(r in zt){for(var l=0;l<zt[r].length;l++)if((e.type==="keydown"&&zt[r][l].keydown||e.type==="keyup"&&zt[r][l].keyup)&&zt[r][l].key){for(var c=zt[r][l],u=c.splitKey,d=c.key.split(u),h=[],f=0;f<d.length;f++)h.push(qh(d[f]));h.sort().join("")===ft.sort().join("")&&jP(e,c,s,t)}}}}function sce(e){return HL.indexOf(e)>-1}function Pi(e,t,n){ft=[];var r=UL(e),i=[],o="all",s=document,a=0,l=!1,c=!0,u="+",d=!1;for(n===void 0&&typeof t=="function"&&(n=t),Object.prototype.toString.call(t)==="[object Object]"&&(t.scope&&(o=t.scope),t.element&&(s=t.element),t.keyup&&(l=t.keyup),t.keydown!==void 0&&(c=t.keydown),t.capture!==void 0&&(d=t.capture),typeof t.splitKey=="string"&&(u=t.splitKey)),typeof t=="string"&&(o=t);a<r.length;a++)e=r[a].split(u),i=[],e.length>1&&(i=zL(oo,e)),e=e[e.length-1],e=e==="*"?"*":qh(e),e in zt||(zt[e]=[]),zt[e].push({keyup:l,keydown:c,scope:o,mods:i,shortcut:r[a],method:n,key:r[a],splitKey:u,element:s});typeof s<"u"&&!sce(s)&&window&&(HL.push(s),f1(s,"keydown",function(h){zP(h,s)},d),NP||(NP=!0,f1(window,"focus",function(){ft=[]},d)),f1(s,"keyup",function(h){zP(h,s),ice(h)},d))}function ace(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"all";Object.keys(zt).forEach(function(n){var r=zt[n].filter(function(i){return i.scope===t&&i.shortcut===e});r.forEach(function(i){i&&i.method&&i.method()})})}var g1={getPressedKeyString:Jle,setScope:KL,getScope:ah,deleteScope:rce,getPressedKeyCodes:Qle,getAllKeyCodes:ece,isPressed:nce,filter:tce,trigger:ace,unbind:oce,keyMap:sh,modifier:oo,modifierMap:Yb};for(var m1 in g1)Object.prototype.hasOwnProperty.call(g1,m1)&&(Pi[m1]=g1[m1]);if(typeof window<"u"){var lce=window.hotkeys;Pi.noConflict=function(e){return e&&window.hotkeys===Pi&&(window.hotkeys=lce),Pi},window.hotkeys=Pi}const UP=["copy","cut","paste","delete","asset"];function cce(){const e=re(),t=I4(),n=co(),r=Nn(),i=rC();b.useEffect(()=>{if(!t)return;const o=e.getContainer(),s=(l,c)=>{Pi(l,{element:o,scope:e.store.id},c)},a=()=>e.isMenuOpen||e.editingId!==null||e.crashingError;for(const l of Object.values(r))l.kbd&&(n&&!l.readonlyOk||UP.includes(l.id)||s(WP(l.kbd),c=>{a()||(Xe(c),l.onSelect("kbd"))}));for(const l of Object.values(i))!l.kbd||!l.readonlyOk&&e.isReadOnly||UP.includes(l.id)||s(WP(l.kbd),c=>{a()||(Xe(c),l.onSelect("kbd"))});return s("g",()=>{a()||e.isReadOnly||e.setSelectedTool("geo")}),s("del,backspace",()=>{a()||r.delete.onSelect("kbd")}),s("=",()=>{a()||r["zoom-in"].onSelect("kbd")}),s("-",()=>{a()||r["zoom-out"].onSelect("kbd")}),Pi.setScope(e.store.id),()=>{Pi.deleteScope(e.store.id)}},[r,i,n,e,t])}function WP(e){let t="";const n=e.split("");return n.length===1?t=n[0]:n[0]==="!"?t=`shift+${n[1]}`:n[0]==="?"?t=`alt+${n[1]}`:n[0]==="$"?n[1]==="!"?t=`cmd+shift+${n[2]},ctrl+shift+${n[2]}`:n[1]==="?"?t=`cmd+⌥+${n[2]},ctrl+alt+${n[2]}`:t=`cmd+${n[1]},ctrl+${n[1]}`:t=e,t}const uce=ke.memo(function({shareZone:t,topZone:n,renderDebugMenuItems:r,children:i,hideUi:o,...s}){return m.jsx(cse,{...s,children:m.jsx(dce,{hideUi:o,shareZone:t,topZone:n,renderDebugMenuItems:r,children:i})})}),dce=ke.memo(function({children:t,hideUi:n,...r}){return m.jsxs(m.Fragment,{children:[t,n?null:m.jsx(hce,{...r})]})}),hce=ke.memo(function({shareZone:t,topZone:n,renderDebugMenuItems:r}){const i=re(),o=qe(),s=fi(),a=ye("isReadOnlyMode",()=>i.isReadOnly,[i]),l=ye("focus",()=>i.instanceState.isFocusMode,[i]),c=ye("debug",()=>i.instanceState.isDebugMode,[i]);cce(),Ooe(),qle();const{"toggle-focus-mode":u}=Nn();return m.jsx(b4,{children:m.jsxs("main",{"data-tldraw-area":"active-drawing",className:Me("tlui-layout",{"tlui-layout__mobile":s<5}),children:[l?m.jsx("div",{className:"tlui-layout__top",children:m.jsx(be,{className:"tlui-focus-button",title:`${o("focus-mode.toggle-focus-mode")}`,icon:"dot",onClick:()=>u.onSelect("menu")})}):m.jsxs(m.Fragment,{children:[m.jsxs("div",{className:"tlui-layout__top",children:[m.jsxs("div",{className:"tlui-layout__top__left",children:[m.jsx(Jae,{}),m.jsxs("div",{className:"tlui-helper-buttons",children:[m.jsx(ile,{}),m.jsx(dse,{}),m.jsx(ole,{})]})]}),m.jsx("div",{className:"tlui-layout__top__center",children:n}),m.jsxs("div",{className:"tlui-layout__top__right",children:[t,s>=5&&!a&&m.jsx("div",{className:"tlui-style-panel__wrapper",children:m.jsx(jL,{})})]})]}),m.jsxs("div",{className:"tlui-layout__bottom",children:[m.jsxs("div",{className:"tlui-layout__bottom__main",children:[m.jsx(rle,{}),m.jsx(Vle,{}),s>=4&&m.jsx(Cse,{})]}),c&&m.jsx(fse,{renderDebugMenuItems:r??null})]})]}),m.jsx(zle,{}),m.jsx(wse,{}),m.jsx(Ule,{}),m.jsx(Sse,{})]})})}),VL="ContextMenu",[fce,Nwe]=Qo(VL,[Wy]),uo=Wy(),[pce,YL]=fce(VL),gce=e=>{const{__scopeContextMenu:t,children:n,onOpenChange:r,dir:i,modal:o=!0}=e,[s,a]=b.useState(!1),l=uo(t),c=Fn(r),u=b.useCallback(d=>{a(d),c(d)},[c]);return b.createElement(pce,{scope:t,open:s,onOpenChange:u,modal:o},b.createElement(e4,oe({},l,{dir:i,open:s,onOpenChange:u,modal:o}),n))},mce="ContextMenuTrigger",yce=b.forwardRef((e,t)=>{const{__scopeContextMenu:n,disabled:r=!1,...i}=e,o=YL(mce,n),s=uo(n),a=b.useRef({x:0,y:0}),l=b.useRef({getBoundingClientRect:()=>DOMRect.fromRect({width:0,height:0,...a.current})}),c=b.useRef(0),u=b.useCallback(()=>window.clearTimeout(c.current),[]),d=h=>{a.current={x:h.clientX,y:h.clientY},o.onOpenChange(!0)};return b.useEffect(()=>u,[u]),b.useEffect(()=>void(r&&u()),[r,u]),b.createElement(b.Fragment,null,b.createElement(t4,oe({},s,{virtualRef:l})),b.createElement(lt.span,oe({"data-state":o.open?"open":"closed","data-disabled":r?"":void 0},i,{ref:t,style:{WebkitTouchCallout:"none",...e.style},onContextMenu:r?e.onContextMenu:we(e.onContextMenu,h=>{u(),d(h),h.preventDefault()}),onPointerDown:r?e.onPointerDown:we(e.onPointerDown,fp(h=>{u(),c.current=window.setTimeout(()=>d(h),700)})),onPointerMove:r?e.onPointerMove:we(e.onPointerMove,fp(u)),onPointerCancel:r?e.onPointerCancel:we(e.onPointerCancel,fp(u)),onPointerUp:r?e.onPointerUp:we(e.onPointerUp,fp(u))})))}),vce=e=>{const{__scopeContextMenu:t,...n}=e,r=uo(t);return b.createElement(n4,oe({},r,n))},xce="ContextMenuContent",bce=b.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,i=YL(xce,n),o=uo(n),s=b.useRef(!1);return b.createElement(r4,oe({},o,r,{ref:t,side:"right",sideOffset:2,align:"start",onCloseAutoFocus:a=>{var l;(l=e.onCloseAutoFocus)===null||l===void 0||l.call(e,a),!a.defaultPrevented&&s.current&&a.preventDefault(),s.current=!1},onInteractOutside:a=>{var l;(l=e.onInteractOutside)===null||l===void 0||l.call(e,a),!a.defaultPrevented&&!i.modal&&(s.current=!0)},style:{...e.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}}))}),wce=b.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,i=uo(n);return b.createElement(i4,oe({},i,r,{ref:t}))}),Sce=b.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,i=uo(n);return b.createElement(o4,oe({},i,r,{ref:t}))}),_ce=b.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,i=uo(n);return b.createElement(s4,oe({},i,r,{ref:t}))}),Cce=e=>{const{__scopeContextMenu:t,children:n,onOpenChange:r,open:i,defaultOpen:o}=e,s=uo(t),[a,l]=ul({prop:i,defaultProp:o,onChange:r});return b.createElement(a4,oe({},s,{open:a,onOpenChange:l}),n)},Ece=b.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,i=uo(n);return b.createElement(l4,oe({},i,r,{ref:t}))}),kce=b.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,i=uo(n);return b.createElement(c4,oe({},i,r,{ref:t,style:{...e.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}}))});function fp(e){return t=>t.pointerType!=="mouse"?e(t):void 0}const Tce=gce,Pce=yce,qb=vce,Ice=bce,Gb=wce,Xb=Sce,$ce=_ce,qL=Cce,GL=Ece,XL=kce,Ace=Ke(function(){const t=re(),n=tr(),r=t.pages,i=t.currentPageId,o=qe(),{addToast:s}=lo();return m.jsxs(qL,{children:[m.jsx(GL,{dir:"ltr",asChild:!0,children:m.jsx(be,{className:"tlui-menu__button",label:"context-menu.move-to-page","data-testid":"menu-item.move-to-page",icon:"chevron-right"})}),m.jsx(qb,{container:n,dir:"ltr",children:m.jsxs(XL,{className:"tlui-menu",sideOffset:-4,collisionPadding:4,children:[m.jsx(Gb,{dir:"ltr",className:"tlui-menu__group","data-testid":"menu-item.pages",children:r.map(a=>m.jsx(Xb,{disabled:i===a.id,onSelect:()=>{t.mark("move_shapes_to_page"),t.moveShapesToPage(t.selectedIds,a.id);const l=t.getPageById(a.id);l&&s({title:"Changed Page",description:`Moved to ${l.name}.`,actions:[{label:"Go Back",type:"primary",onClick:()=>{t.mark("change-page"),t.setCurrentPageId(i)}}]})},asChild:!0,children:m.jsx(be,{title:a.name,className:"tlui-menu__button tlui-context-menu__move-to-page__name",children:m.jsx("span",{children:a.name})})},a.id))},"pages"),m.jsx(Gb,{dir:"ltr",className:"tlui-menu__group","data-testid":"menu-item.new-page",children:m.jsx(Xb,{onSelect:()=>{t.mark("move_shapes_to_page");const a=ei.createId(),l=t.selectedIds,c=t.currentPageId;t.batch(()=>{t.createPage("Page 1",a),t.setCurrentPageId(c),t.moveShapesToPage(l,a)})},asChild:!0,children:m.jsx(be,{title:o("context.pages.new-page"),className:"tlui-menu__button tlui-context-menu__move-to-page__name",children:o("context.pages.new-page")})},"new-page")},"new-page")]})})]})}),Mce=function({children:t}){const n=re(),r=W4(),i=b.useCallback(d=>{if(d){if(n.isCoarsePointer){const{selectedShapes:h,inputs:{currentPagePoint:f}}=n,p=n.getShapesAtPoint(f);if(!n.selectedShapes.length||!p.some(g=>h.includes(g))){const g=p.filter(y=>n.isShapeOrAncestorLocked(y));g.length&&n.select(...g.map(y=>y.id))}}}else{const{onlySelectedShape:h}=n;h&&n.isShapeOrAncestorLocked(h)&&n.setSelectedIds([])}},[n]),[o,s]=hl("context menu",i),a=co(),l=r.length===0||a&&r.every(d=>!d.readonlyOk),u=!ye("isSelectToolActive",()=>n.currentToolId==="select",[n])||l;return m.jsxs(Tce,{dir:"ltr",onOpenChange:s,children:[m.jsx(Pce,{onContextMenu:u?Xe:void 0,dir:"ltr",disabled:u,children:t}),m.jsx(Oce,{})]})};function Oce(){const e=re(),t=qe(),n=W4(),[r,i]=hl("context menu sub"),o=co(),s=fi(),a=tr(),[l,c]=b.useState(!1);function u(d,h,f,p){if(o&&!h.readonlyOk)return null;switch(h.type){case"custom":{switch(h.id){case"MOVE_TO_PAGE_MENU":return m.jsx(Ace,{},h.id)}break}case"group":return m.jsx(Gb,{dir:"ltr",className:Me("tlui-menu__group",{"tlui-menu__group__small":(f==null?void 0:f.type)==="submenu"}),"data-testid":`menu-item.${h.id}`,children:h.children.map(g=>u(d,g,h,p+1))},h.id);case"submenu":return m.jsxs(qL,{onOpenChange:i,children:[m.jsx(GL,{dir:"ltr",disabled:h.disabled,asChild:!0,children:m.jsx(be,{className:"tlui-menu__button",label:h.label,"data-testid":`menu-item.${h.id}`,icon:"chevron-right"})}),m.jsx(qb,{container:a,dir:"ltr",children:m.jsx(XL,{className:"tlui-menu",sideOffset:-4,collisionPadding:4,children:h.children.map(g=>u(d,g,h,p+1))})})]},h.id);case"item":{if(o&&!h.readonlyOk)return null;const{id:g,checkbox:y,contextMenuLabel:x,label:w,onSelect:_,kbd:S,icon:T}=h.actionItem,P=x??w,I=P?t(P):void 0;return y?m.jsxs($ce,{className:"tlui-button tlui-menu__button tlui-menu__checkbox-item",dir:"ltr",disabled:h.disabled,onSelect:$=>{_("context-menu"),Xe($)},title:I||void 0,checked:h.checked,children:[m.jsx("div",{className:"tlui-menu__checkbox-item__check",style:{transformOrigin:"75% center",transform:`scale(${h.checked?1:.5})`,opacity:h.checked?1:.5},children:m.jsx(mr,{small:!0,icon:h.checked?"check":"checkbox-empty"})}),I&&m.jsx("span",{children:I}),S&&m.jsx(By,{children:S})]},g):m.jsx(Xb,{dir:"ltr",asChild:!0,children:m.jsx(be,{className:"tlui-menu__button","data-testid":`menu-item.${g}`,kbd:S,label:P,disabled:h.disabled,iconLeft:s<3&&p>2?T:void 0,onClick:()=>{l?c(!1):_("context-menu")}})},g)}}}return m.jsx(qb,{dir:"ltr",container:a,children:m.jsx(Ice,{className:"tlui-menu scrollable",alignOffset:-4,collisionPadding:4,onContextMenu:Xe,children:n.map(d=>u(e,d,null,0))})})}function Lce(e){const{children:t,...n}=e;return m.jsx(Pee,{...n,children:m.jsxs(uce,{...n,children:[m.jsx(Mce,{children:m.jsx(B5,{})}),t]})})}function Bce(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=Array.from(typeof e=="string"?[e]:e);r[r.length-1]=r[r.length-1].replace(/\r?\n([\t ]*)$/,"");var i=r.reduce(function(a,l){var c=l.match(/\n([\t ]+|(?!\s).)/g);return c?a.concat(c.map(function(u){var d,h;return(h=(d=u.match(/[\t ]/g))===null||d===void 0?void 0:d.length)!==null&&h!==void 0?h:0})):a},[]);if(i.length){var o=new RegExp(`
[	 ]{`+Math.min.apply(Math,i)+"}","g");r=r.map(function(a){return a.replace(o,`
`)})}r[0]=r[0].replace(/^\r?\n/,"");var s=r[0];return t.forEach(function(a,l){var c=s.match(/(?:^|\n)( *)$/),u=c?c[1]:"",d=a;typeof a=="string"&&a.includes(`
`)&&(d=String(a).split(`
`).map(function(h,f){return f===0?h:""+u+h}).join(`
`)),s+=d+r[l+1]}),s}const Rce="modulepreload",Dce=function(e){return"/"+e},HP={},Xt=function(t,n,r){if(!n||n.length===0)return t();const i=document.getElementsByTagName("link");return Promise.all(n.map(o=>{if(o=Dce(o),o in HP)return;HP[o]=!0;const s=o.endsWith(".css"),a=s?'[rel="stylesheet"]':"";if(!!r)for(let u=i.length-1;u>=0;u--){const d=i[u];if(d.href===o&&(!s||d.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${o}"]${a}`))return;const c=document.createElement("link");if(c.rel=s?"stylesheet":Rce,s||(c.as="script",c.crossOrigin=""),c.href=o,document.head.appendChild(c),s)return new Promise((u,d)=>{c.addEventListener("load",u),c.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${o}`)))})})).then(()=>t()).catch(o=>{const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=o,window.dispatchEvent(s),!s.defaultPrevented)throw o})};var ZL={exports:{}};(function(e,t){(function(n,r){e.exports=r()})(Ln,function(){var n=1e3,r=6e4,i=36e5,o="millisecond",s="second",a="minute",l="hour",c="day",u="week",d="month",h="quarter",f="year",p="date",g="Invalid Date",y=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,x=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,w={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(j){var B=["th","st","nd","rd"],z=j%100;return"["+j+(B[(z-20)%10]||B[z]||B[0])+"]"}},_=function(j,B,z){var q=String(j);return!q||q.length>=B?j:""+Array(B+1-q.length).join(z)+j},S={s:_,z:function(j){var B=-j.utcOffset(),z=Math.abs(B),q=Math.floor(z/60),U=z%60;return(B<=0?"+":"-")+_(q,2,"0")+":"+_(U,2,"0")},m:function j(B,z){if(B.date()<z.date())return-j(z,B);var q=12*(z.year()-B.year())+(z.month()-B.month()),U=B.clone().add(q,d),D=z-U<0,F=B.clone().add(q+(D?-1:1),d);return+(-(q+(z-U)/(D?U-F:F-U))||0)},a:function(j){return j<0?Math.ceil(j)||0:Math.floor(j)},p:function(j){return{M:d,y:f,w:u,d:c,D:p,h:l,m:a,s,ms:o,Q:h}[j]||String(j||"").toLowerCase().replace(/s$/,"")},u:function(j){return j===void 0}},T="en",P={};P[T]=w;var I=function(j){return j instanceof K},$=function j(B,z,q){var U;if(!B)return T;if(typeof B=="string"){var D=B.toLowerCase();P[D]&&(U=D),z&&(P[D]=z,U=D);var F=B.split("-");if(!U&&F.length>1)return j(F[0])}else{var J=B.name;P[J]=B,U=J}return!q&&U&&(T=U),U||!q&&T},L=function(j,B){if(I(j))return j.clone();var z=typeof B=="object"?B:{};return z.date=j,z.args=arguments,new K(z)},R=S;R.l=$,R.i=I,R.w=function(j,B){return L(j,{locale:B.$L,utc:B.$u,x:B.$x,$offset:B.$offset})};var K=function(){function j(z){this.$L=$(z.locale,null,!0),this.parse(z)}var B=j.prototype;return B.parse=function(z){this.$d=function(q){var U=q.date,D=q.utc;if(U===null)return new Date(NaN);if(R.u(U))return new Date;if(U instanceof Date)return new Date(U);if(typeof U=="string"&&!/Z$/i.test(U)){var F=U.match(y);if(F){var J=F[2]-1||0,Z=(F[7]||"0").substring(0,3);return D?new Date(Date.UTC(F[1],J,F[3]||1,F[4]||0,F[5]||0,F[6]||0,Z)):new Date(F[1],J,F[3]||1,F[4]||0,F[5]||0,F[6]||0,Z)}}return new Date(U)}(z),this.$x=z.x||{},this.init()},B.init=function(){var z=this.$d;this.$y=z.getFullYear(),this.$M=z.getMonth(),this.$D=z.getDate(),this.$W=z.getDay(),this.$H=z.getHours(),this.$m=z.getMinutes(),this.$s=z.getSeconds(),this.$ms=z.getMilliseconds()},B.$utils=function(){return R},B.isValid=function(){return this.$d.toString()!==g},B.isSame=function(z,q){var U=L(z);return this.startOf(q)<=U&&U<=this.endOf(q)},B.isAfter=function(z,q){return L(z)<this.startOf(q)},B.isBefore=function(z,q){return this.endOf(q)<L(z)},B.$g=function(z,q,U){return R.u(z)?this[q]:this.set(U,z)},B.unix=function(){return Math.floor(this.valueOf()/1e3)},B.valueOf=function(){return this.$d.getTime()},B.startOf=function(z,q){var U=this,D=!!R.u(q)||q,F=R.p(z),J=function(Ee,Ie){var Fe=R.w(U.$u?Date.UTC(U.$y,Ie,Ee):new Date(U.$y,Ie,Ee),U);return D?Fe:Fe.endOf(c)},Z=function(Ee,Ie){return R.w(U.toDate()[Ee].apply(U.toDate("s"),(D?[0,0,0,0]:[23,59,59,999]).slice(Ie)),U)},ne=this.$W,de=this.$M,Ce=this.$D,he="set"+(this.$u?"UTC":"");switch(F){case f:return D?J(1,0):J(31,11);case d:return D?J(1,de):J(0,de+1);case u:var je=this.$locale().weekStart||0,$e=(ne<je?ne+7:ne)-je;return J(D?Ce-$e:Ce+(6-$e),de);case c:case p:return Z(he+"Hours",0);case l:return Z(he+"Minutes",1);case a:return Z(he+"Seconds",2);case s:return Z(he+"Milliseconds",3);default:return this.clone()}},B.endOf=function(z){return this.startOf(z,!1)},B.$set=function(z,q){var U,D=R.p(z),F="set"+(this.$u?"UTC":""),J=(U={},U[c]=F+"Date",U[p]=F+"Date",U[d]=F+"Month",U[f]=F+"FullYear",U[l]=F+"Hours",U[a]=F+"Minutes",U[s]=F+"Seconds",U[o]=F+"Milliseconds",U)[D],Z=D===c?this.$D+(q-this.$W):q;if(D===d||D===f){var ne=this.clone().set(p,1);ne.$d[J](Z),ne.init(),this.$d=ne.set(p,Math.min(this.$D,ne.daysInMonth())).$d}else J&&this.$d[J](Z);return this.init(),this},B.set=function(z,q){return this.clone().$set(z,q)},B.get=function(z){return this[R.p(z)]()},B.add=function(z,q){var U,D=this;z=Number(z);var F=R.p(q),J=function(de){var Ce=L(D);return R.w(Ce.date(Ce.date()+Math.round(de*z)),D)};if(F===d)return this.set(d,this.$M+z);if(F===f)return this.set(f,this.$y+z);if(F===c)return J(1);if(F===u)return J(7);var Z=(U={},U[a]=r,U[l]=i,U[s]=n,U)[F]||1,ne=this.$d.getTime()+z*Z;return R.w(ne,this)},B.subtract=function(z,q){return this.add(-1*z,q)},B.format=function(z){var q=this,U=this.$locale();if(!this.isValid())return U.invalidDate||g;var D=z||"YYYY-MM-DDTHH:mm:ssZ",F=R.z(this),J=this.$H,Z=this.$m,ne=this.$M,de=U.weekdays,Ce=U.months,he=U.meridiem,je=function(Ie,Fe,ct,mt){return Ie&&(Ie[Fe]||Ie(q,D))||ct[Fe].slice(0,mt)},$e=function(Ie){return R.s(J%12||12,Ie,"0")},Ee=he||function(Ie,Fe,ct){var mt=Ie<12?"AM":"PM";return ct?mt.toLowerCase():mt};return D.replace(x,function(Ie,Fe){return Fe||function(ct){switch(ct){case"YY":return String(q.$y).slice(-2);case"YYYY":return R.s(q.$y,4,"0");case"M":return ne+1;case"MM":return R.s(ne+1,2,"0");case"MMM":return je(U.monthsShort,ne,Ce,3);case"MMMM":return je(Ce,ne);case"D":return q.$D;case"DD":return R.s(q.$D,2,"0");case"d":return String(q.$W);case"dd":return je(U.weekdaysMin,q.$W,de,2);case"ddd":return je(U.weekdaysShort,q.$W,de,3);case"dddd":return de[q.$W];case"H":return String(J);case"HH":return R.s(J,2,"0");case"h":return $e(1);case"hh":return $e(2);case"a":return Ee(J,Z,!0);case"A":return Ee(J,Z,!1);case"m":return String(Z);case"mm":return R.s(Z,2,"0");case"s":return String(q.$s);case"ss":return R.s(q.$s,2,"0");case"SSS":return R.s(q.$ms,3,"0");case"Z":return F}return null}(Ie)||F.replace(":","")})},B.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},B.diff=function(z,q,U){var D,F=this,J=R.p(q),Z=L(z),ne=(Z.utcOffset()-this.utcOffset())*r,de=this-Z,Ce=function(){return R.m(F,Z)};switch(J){case f:D=Ce()/12;break;case d:D=Ce();break;case h:D=Ce()/3;break;case u:D=(de-ne)/6048e5;break;case c:D=(de-ne)/864e5;break;case l:D=de/i;break;case a:D=de/r;break;case s:D=de/n;break;default:D=de}return U?D:R.a(D)},B.daysInMonth=function(){return this.endOf(d).$D},B.$locale=function(){return P[this.$L]},B.locale=function(z,q){if(!z)return this.$L;var U=this.clone(),D=$(z,q,!0);return D&&(U.$L=D),U},B.clone=function(){return R.w(this.$d,this)},B.toDate=function(){return new Date(this.valueOf())},B.toJSON=function(){return this.isValid()?this.toISOString():null},B.toISOString=function(){return this.$d.toISOString()},B.toString=function(){return this.$d.toUTCString()},j}(),Q=K.prototype;return L.prototype=Q,[["$ms",o],["$s",s],["$m",a],["$H",l],["$W",c],["$M",d],["$y",f],["$D",p]].forEach(function(j){Q[j[1]]=function(B){return this.$g(B,j[0],j[1])}}),L.extend=function(j,B){return j.$i||(j(B,K,L),j.$i=!0),L},L.locale=$,L.isDayjs=I,L.unix=function(j){return L(1e3*j)},L.en=P[T],L.Ls=P,L.p={},L})})(ZL);var Fce=ZL.exports;const Nce=rl(Fce);var QL={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.sanitizeUrl=e.BLANK_URL=void 0;var t=/^([^\w]*)(javascript|data|vbscript)/im,n=/&#(\w+)(^\w|;)?/g,r=/&(newline|tab);/gi,i=/[\u0000-\u001F\u007F-\u009F\u2000-\u200D\uFEFF]/gim,o=/^.+(:|&colon;)/gim,s=[".","/"];e.BLANK_URL="about:blank";function a(u){return s.indexOf(u[0])>-1}function l(u){var d=u.replace(i,"");return d.replace(n,function(h,f){return String.fromCharCode(f)})}function c(u){if(!u)return e.BLANK_URL;var d=l(u).replace(r,"").replace(i,"").trim();if(!d)return e.BLANK_URL;if(a(d))return d;var h=d.match(o);if(!h)return d;var f=h[0];return t.test(f)?e.BLANK_URL:d}e.sanitizeUrl=c})(QL);var jce={value:()=>{}};function JL(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new ag(n)}function ag(e){this._=e}function zce(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}ag.prototype=JL.prototype={constructor:ag,on:function(e,t){var n=this._,r=zce(e+"",n),i,o=-1,s=r.length;if(arguments.length<2){for(;++o<s;)if((i=(e=r[o]).type)&&(i=Uce(n[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++o<s;)if(i=(e=r[o]).type)n[i]=KP(n[i],e.name,t);else if(t==null)for(i in n)n[i]=KP(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new ag(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,o;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=this._[e],r=0,i=o.length;r<i;++r)o[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,o=r.length;i<o;++i)r[i].value.apply(t,n)}};function Uce(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function KP(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=jce,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var Zb="http://www.w3.org/1999/xhtml";const VP={svg:"http://www.w3.org/2000/svg",xhtml:Zb,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Xy(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),VP.hasOwnProperty(t)?{space:VP[t],local:e}:e}function Wce(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Zb&&t.documentElement.namespaceURI===Zb?t.createElement(e):t.createElementNS(n,e)}}function Hce(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function eB(e){var t=Xy(e);return(t.local?Hce:Wce)(t)}function Kce(){}function pC(e){return e==null?Kce:function(){return this.querySelector(e)}}function Vce(e){typeof e!="function"&&(e=pC(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o=t[i],s=o.length,a=r[i]=new Array(s),l,c,u=0;u<s;++u)(l=o[u])&&(c=e.call(l,l.__data__,u,o))&&("__data__"in l&&(c.__data__=l.__data__),a[u]=c);return new Br(r,this._parents)}function Yce(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function qce(){return[]}function tB(e){return e==null?qce:function(){return this.querySelectorAll(e)}}function Gce(e){return function(){return Yce(e.apply(this,arguments))}}function Xce(e){typeof e=="function"?e=Gce(e):e=tB(e);for(var t=this._groups,n=t.length,r=[],i=[],o=0;o<n;++o)for(var s=t[o],a=s.length,l,c=0;c<a;++c)(l=s[c])&&(r.push(e.call(l,l.__data__,c,s)),i.push(l));return new Br(r,i)}function nB(e){return function(){return this.matches(e)}}function rB(e){return function(t){return t.matches(e)}}var Zce=Array.prototype.find;function Qce(e){return function(){return Zce.call(this.children,e)}}function Jce(){return this.firstElementChild}function eue(e){return this.select(e==null?Jce:Qce(typeof e=="function"?e:rB(e)))}var tue=Array.prototype.filter;function nue(){return Array.from(this.children)}function rue(e){return function(){return tue.call(this.children,e)}}function iue(e){return this.selectAll(e==null?nue:rue(typeof e=="function"?e:rB(e)))}function oue(e){typeof e!="function"&&(e=nB(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o=t[i],s=o.length,a=r[i]=[],l,c=0;c<s;++c)(l=o[c])&&e.call(l,l.__data__,c,o)&&a.push(l);return new Br(r,this._parents)}function iB(e){return new Array(e.length)}function sue(){return new Br(this._enter||this._groups.map(iB),this._parents)}function Cm(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Cm.prototype={constructor:Cm,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function aue(e){return function(){return e}}function lue(e,t,n,r,i,o){for(var s=0,a,l=t.length,c=o.length;s<c;++s)(a=t[s])?(a.__data__=o[s],r[s]=a):n[s]=new Cm(e,o[s]);for(;s<l;++s)(a=t[s])&&(i[s]=a)}function cue(e,t,n,r,i,o,s){var a,l,c=new Map,u=t.length,d=o.length,h=new Array(u),f;for(a=0;a<u;++a)(l=t[a])&&(h[a]=f=s.call(l,l.__data__,a,t)+"",c.has(f)?i[a]=l:c.set(f,l));for(a=0;a<d;++a)f=s.call(e,o[a],a,o)+"",(l=c.get(f))?(r[a]=l,l.__data__=o[a],c.delete(f)):n[a]=new Cm(e,o[a]);for(a=0;a<u;++a)(l=t[a])&&c.get(h[a])===l&&(i[a]=l)}function uue(e){return e.__data__}function due(e,t){if(!arguments.length)return Array.from(this,uue);var n=t?cue:lue,r=this._parents,i=this._groups;typeof e!="function"&&(e=aue(e));for(var o=i.length,s=new Array(o),a=new Array(o),l=new Array(o),c=0;c<o;++c){var u=r[c],d=i[c],h=d.length,f=hue(e.call(u,u&&u.__data__,c,r)),p=f.length,g=a[c]=new Array(p),y=s[c]=new Array(p),x=l[c]=new Array(h);n(u,d,g,y,x,f,t);for(var w=0,_=0,S,T;w<p;++w)if(S=g[w]){for(w>=_&&(_=w+1);!(T=y[_])&&++_<p;);S._next=T||null}}return s=new Br(s,r),s._enter=a,s._exit=l,s}function hue(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function fue(){return new Br(this._exit||this._groups.map(iB),this._parents)}function pue(e,t,n){var r=this.enter(),i=this,o=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(i=t(i),i&&(i=i.selection())),n==null?o.remove():n(o),r&&i?r.merge(i).order():i}function gue(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,i=n.length,o=r.length,s=Math.min(i,o),a=new Array(i),l=0;l<s;++l)for(var c=n[l],u=r[l],d=c.length,h=a[l]=new Array(d),f,p=0;p<d;++p)(f=c[p]||u[p])&&(h[p]=f);for(;l<i;++l)a[l]=n[l];return new Br(a,this._parents)}function mue(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],i=r.length-1,o=r[i],s;--i>=0;)(s=r[i])&&(o&&s.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(s,o),o=s);return this}function yue(e){e||(e=vue);function t(d,h){return d&&h?e(d.__data__,h.__data__):!d-!h}for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var s=n[o],a=s.length,l=i[o]=new Array(a),c,u=0;u<a;++u)(c=s[u])&&(l[u]=c);l.sort(t)}return new Br(i,this._parents).order()}function vue(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function xue(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function bue(){return Array.from(this)}function wue(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,o=r.length;i<o;++i){var s=r[i];if(s)return s}return null}function Sue(){let e=0;for(const t of this)++e;return e}function _ue(){return!this.node()}function Cue(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i=t[n],o=0,s=i.length,a;o<s;++o)(a=i[o])&&e.call(a,a.__data__,o,i);return this}function Eue(e){return function(){this.removeAttribute(e)}}function kue(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Tue(e,t){return function(){this.setAttribute(e,t)}}function Pue(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function Iue(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function $ue(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function Aue(e,t){var n=Xy(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?kue:Eue:typeof t=="function"?n.local?$ue:Iue:n.local?Pue:Tue)(n,t))}function oB(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Mue(e){return function(){this.style.removeProperty(e)}}function Oue(e,t,n){return function(){this.style.setProperty(e,t,n)}}function Lue(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function Bue(e,t,n){return arguments.length>1?this.each((t==null?Mue:typeof t=="function"?Lue:Oue)(e,t,n??"")):Lc(this.node(),e)}function Lc(e,t){return e.style.getPropertyValue(t)||oB(e).getComputedStyle(e,null).getPropertyValue(t)}function Rue(e){return function(){delete this[e]}}function Due(e,t){return function(){this[e]=t}}function Fue(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function Nue(e,t){return arguments.length>1?this.each((t==null?Rue:typeof t=="function"?Fue:Due)(e,t)):this.node()[e]}function sB(e){return e.trim().split(/^|\s+/)}function gC(e){return e.classList||new aB(e)}function aB(e){this._node=e,this._names=sB(e.getAttribute("class")||"")}aB.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function lB(e,t){for(var n=gC(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function cB(e,t){for(var n=gC(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function jue(e){return function(){lB(this,e)}}function zue(e){return function(){cB(this,e)}}function Uue(e,t){return function(){(t.apply(this,arguments)?lB:cB)(this,e)}}function Wue(e,t){var n=sB(e+"");if(arguments.length<2){for(var r=gC(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof t=="function"?Uue:t?jue:zue)(n,t))}function Hue(){this.textContent=""}function Kue(e){return function(){this.textContent=e}}function Vue(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function Yue(e){return arguments.length?this.each(e==null?Hue:(typeof e=="function"?Vue:Kue)(e)):this.node().textContent}function que(){this.innerHTML=""}function Gue(e){return function(){this.innerHTML=e}}function Xue(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function Zue(e){return arguments.length?this.each(e==null?que:(typeof e=="function"?Xue:Gue)(e)):this.node().innerHTML}function Que(){this.nextSibling&&this.parentNode.appendChild(this)}function Jue(){return this.each(Que)}function ede(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function tde(){return this.each(ede)}function nde(e){var t=typeof e=="function"?e:eB(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function rde(){return null}function ide(e,t){var n=typeof e=="function"?e:eB(e),r=t==null?rde:typeof t=="function"?t:pC(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function ode(){var e=this.parentNode;e&&e.removeChild(this)}function sde(){return this.each(ode)}function ade(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function lde(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function cde(e){return this.select(e?lde:ade)}function ude(e){return arguments.length?this.property("__data__",e):this.node().__data__}function dde(e){return function(t){e.call(this,t,this.__data__)}}function hde(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function fde(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,i=t.length,o;n<i;++n)o=t[n],(!e.type||o.type===e.type)&&o.name===e.name?this.removeEventListener(o.type,o.listener,o.options):t[++r]=o;++r?t.length=r:delete this.__on}}}function pde(e,t,n){return function(){var r=this.__on,i,o=dde(t);if(r){for(var s=0,a=r.length;s<a;++s)if((i=r[s]).type===e.type&&i.name===e.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=o,i.options=n),i.value=t;return}}this.addEventListener(e.type,o,n),i={type:e.type,name:e.name,value:t,listener:o,options:n},r?r.push(i):this.__on=[i]}}function gde(e,t,n){var r=hde(e+""),i,o=r.length,s;if(arguments.length<2){var a=this.node().__on;if(a){for(var l=0,c=a.length,u;l<c;++l)for(i=0,u=a[l];i<o;++i)if((s=r[i]).type===u.type&&s.name===u.name)return u.value}return}for(a=t?pde:fde,i=0;i<o;++i)this.each(a(r[i],t,n));return this}function uB(e,t,n){var r=oB(e),i=r.CustomEvent;typeof i=="function"?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function mde(e,t){return function(){return uB(this,e,t)}}function yde(e,t){return function(){return uB(this,e,t.apply(this,arguments))}}function vde(e,t){return this.each((typeof t=="function"?yde:mde)(e,t))}function*xde(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,o=r.length,s;i<o;++i)(s=r[i])&&(yield s)}var dB=[null];function Br(e,t){this._groups=e,this._parents=t}function Gh(){return new Br([[document.documentElement]],dB)}function bde(){return this}Br.prototype=Gh.prototype={constructor:Br,select:Vce,selectAll:Xce,selectChild:eue,selectChildren:iue,filter:oue,data:due,enter:sue,exit:fue,join:pue,merge:gue,selection:bde,order:mue,sort:yue,call:xue,nodes:bue,node:wue,size:Sue,empty:_ue,each:Cue,attr:Aue,style:Bue,property:Nue,classed:Wue,text:Yue,html:Zue,raise:Jue,lower:tde,append:nde,insert:ide,remove:sde,clone:cde,datum:ude,on:gde,dispatch:vde,[Symbol.iterator]:xde};function Yr(e){return typeof e=="string"?new Br([[document.querySelector(e)]],[document.documentElement]):new Br([[e]],dB)}function mC(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function hB(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Xh(){}var lh=.7,Em=1/lh,xc="\\s*([+-]?\\d+)\\s*",ch="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ji="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",wde=/^#([0-9a-f]{3,8})$/,Sde=new RegExp(`^rgb\\(${xc},${xc},${xc}\\)$`),_de=new RegExp(`^rgb\\(${Ji},${Ji},${Ji}\\)$`),Cde=new RegExp(`^rgba\\(${xc},${xc},${xc},${ch}\\)$`),Ede=new RegExp(`^rgba\\(${Ji},${Ji},${Ji},${ch}\\)$`),kde=new RegExp(`^hsl\\(${ch},${Ji},${Ji}\\)$`),Tde=new RegExp(`^hsla\\(${ch},${Ji},${Ji},${ch}\\)$`),YP={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};mC(Xh,uh,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:qP,formatHex:qP,formatHex8:Pde,formatHsl:Ide,formatRgb:GP,toString:GP});function qP(){return this.rgb().formatHex()}function Pde(){return this.rgb().formatHex8()}function Ide(){return fB(this).formatHsl()}function GP(){return this.rgb().formatRgb()}function uh(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=wde.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?XP(t):n===3?new cr(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?pp(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?pp(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Sde.exec(e))?new cr(t[1],t[2],t[3],1):(t=_de.exec(e))?new cr(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Cde.exec(e))?pp(t[1],t[2],t[3],t[4]):(t=Ede.exec(e))?pp(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=kde.exec(e))?JP(t[1],t[2]/100,t[3]/100,1):(t=Tde.exec(e))?JP(t[1],t[2]/100,t[3]/100,t[4]):YP.hasOwnProperty(e)?XP(YP[e]):e==="transparent"?new cr(NaN,NaN,NaN,0):null}function XP(e){return new cr(e>>16&255,e>>8&255,e&255,1)}function pp(e,t,n,r){return r<=0&&(e=t=n=NaN),new cr(e,t,n,r)}function $de(e){return e instanceof Xh||(e=uh(e)),e?(e=e.rgb(),new cr(e.r,e.g,e.b,e.opacity)):new cr}function Qb(e,t,n,r){return arguments.length===1?$de(e):new cr(e,t,n,r??1)}function cr(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}mC(cr,Qb,hB(Xh,{brighter(e){return e=e==null?Em:Math.pow(Em,e),new cr(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?lh:Math.pow(lh,e),new cr(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new cr(za(this.r),za(this.g),za(this.b),km(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ZP,formatHex:ZP,formatHex8:Ade,formatRgb:QP,toString:QP}));function ZP(){return`#${La(this.r)}${La(this.g)}${La(this.b)}`}function Ade(){return`#${La(this.r)}${La(this.g)}${La(this.b)}${La((isNaN(this.opacity)?1:this.opacity)*255)}`}function QP(){const e=km(this.opacity);return`${e===1?"rgb(":"rgba("}${za(this.r)}, ${za(this.g)}, ${za(this.b)}${e===1?")":`, ${e})`}`}function km(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function za(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function La(e){return e=za(e),(e<16?"0":"")+e.toString(16)}function JP(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new ki(e,t,n,r)}function fB(e){if(e instanceof ki)return new ki(e.h,e.s,e.l,e.opacity);if(e instanceof Xh||(e=uh(e)),!e)return new ki;if(e instanceof ki)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),o=Math.max(t,n,r),s=NaN,a=o-i,l=(o+i)/2;return a?(t===o?s=(n-r)/a+(n<r)*6:n===o?s=(r-t)/a+2:s=(t-n)/a+4,a/=l<.5?o+i:2-o-i,s*=60):a=l>0&&l<1?0:s,new ki(s,a,l,e.opacity)}function Mde(e,t,n,r){return arguments.length===1?fB(e):new ki(e,t,n,r??1)}function ki(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}mC(ki,Mde,hB(Xh,{brighter(e){return e=e==null?Em:Math.pow(Em,e),new ki(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?lh:Math.pow(lh,e),new ki(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new cr(y1(e>=240?e-240:e+120,i,r),y1(e,i,r),y1(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new ki(eI(this.h),gp(this.s),gp(this.l),km(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=km(this.opacity);return`${e===1?"hsl(":"hsla("}${eI(this.h)}, ${gp(this.s)*100}%, ${gp(this.l)*100}%${e===1?")":`, ${e})`}`}}));function eI(e){return e=(e||0)%360,e<0?e+360:e}function gp(e){return Math.max(0,Math.min(1,e||0))}function y1(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const yC=e=>()=>e;function pB(e,t){return function(n){return e+n*t}}function Ode(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function jwe(e,t){var n=t-e;return n?pB(e,n>180||n<-180?n-360*Math.round(n/360):n):yC(isNaN(e)?t:e)}function Lde(e){return(e=+e)==1?gB:function(t,n){return n-t?Ode(t,n,e):yC(isNaN(t)?n:t)}}function gB(e,t){var n=t-e;return n?pB(e,n):yC(isNaN(e)?t:e)}const tI=function e(t){var n=Lde(t);function r(i,o){var s=n((i=Qb(i)).r,(o=Qb(o)).r),a=n(i.g,o.g),l=n(i.b,o.b),c=gB(i.opacity,o.opacity);return function(u){return i.r=s(u),i.g=a(u),i.b=l(u),i.opacity=c(u),i+""}}return r.gamma=e,r}(1);function ws(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var Jb=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,v1=new RegExp(Jb.source,"g");function Bde(e){return function(){return e}}function Rde(e){return function(t){return e(t)+""}}function Dde(e,t){var n=Jb.lastIndex=v1.lastIndex=0,r,i,o,s=-1,a=[],l=[];for(e=e+"",t=t+"";(r=Jb.exec(e))&&(i=v1.exec(t));)(o=i.index)>n&&(o=t.slice(n,o),a[s]?a[s]+=o:a[++s]=o),(r=r[0])===(i=i[0])?a[s]?a[s]+=i:a[++s]=i:(a[++s]=null,l.push({i:s,x:ws(r,i)})),n=v1.lastIndex;return n<t.length&&(o=t.slice(n),a[s]?a[s]+=o:a[++s]=o),a.length<2?l[0]?Rde(l[0].x):Bde(t):(t=l.length,function(c){for(var u=0,d;u<t;++u)a[(d=l[u]).i]=d.x(c);return a.join("")})}var nI=180/Math.PI,ew={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function mB(e,t,n,r,i,o){var s,a,l;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,l/=a),e*r<t*n&&(e=-e,t=-t,l=-l,s=-s),{translateX:i,translateY:o,rotate:Math.atan2(t,e)*nI,skewX:Math.atan(l)*nI,scaleX:s,scaleY:a}}var mp;function Fde(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?ew:mB(t.a,t.b,t.c,t.d,t.e,t.f)}function Nde(e){return e==null||(mp||(mp=document.createElementNS("http://www.w3.org/2000/svg","g")),mp.setAttribute("transform",e),!(e=mp.transform.baseVal.consolidate()))?ew:(e=e.matrix,mB(e.a,e.b,e.c,e.d,e.e,e.f))}function yB(e,t,n,r){function i(c){return c.length?c.pop()+" ":""}function o(c,u,d,h,f,p){if(c!==d||u!==h){var g=f.push("translate(",null,t,null,n);p.push({i:g-4,x:ws(c,d)},{i:g-2,x:ws(u,h)})}else(d||h)&&f.push("translate("+d+t+h+n)}function s(c,u,d,h){c!==u?(c-u>180?u+=360:u-c>180&&(c+=360),h.push({i:d.push(i(d)+"rotate(",null,r)-2,x:ws(c,u)})):u&&d.push(i(d)+"rotate("+u+r)}function a(c,u,d,h){c!==u?h.push({i:d.push(i(d)+"skewX(",null,r)-2,x:ws(c,u)}):u&&d.push(i(d)+"skewX("+u+r)}function l(c,u,d,h,f,p){if(c!==d||u!==h){var g=f.push(i(f)+"scale(",null,",",null,")");p.push({i:g-4,x:ws(c,d)},{i:g-2,x:ws(u,h)})}else(d!==1||h!==1)&&f.push(i(f)+"scale("+d+","+h+")")}return function(c,u){var d=[],h=[];return c=e(c),u=e(u),o(c.translateX,c.translateY,u.translateX,u.translateY,d,h),s(c.rotate,u.rotate,d,h),a(c.skewX,u.skewX,d,h),l(c.scaleX,c.scaleY,u.scaleX,u.scaleY,d,h),c=u=null,function(f){for(var p=-1,g=h.length,y;++p<g;)d[(y=h[p]).i]=y.x(f);return d.join("")}}}var jde=yB(Fde,"px, ","px)","deg)"),zde=yB(Nde,", ",")",")"),Bc=0,Xu=0,Du=0,vB=1e3,Tm,Zu,Pm=0,el=0,Zy=0,dh=typeof performance=="object"&&performance.now?performance:Date,xB=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function vC(){return el||(xB(Ude),el=dh.now()+Zy)}function Ude(){el=0}function Im(){this._call=this._time=this._next=null}Im.prototype=bB.prototype={constructor:Im,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?vC():+n)+(t==null?0:+t),!this._next&&Zu!==this&&(Zu?Zu._next=this:Tm=this,Zu=this),this._call=e,this._time=n,tw()},stop:function(){this._call&&(this._call=null,this._time=1/0,tw())}};function bB(e,t,n){var r=new Im;return r.restart(e,t,n),r}function Wde(){vC(),++Bc;for(var e=Tm,t;e;)(t=el-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Bc}function rI(){el=(Pm=dh.now())+Zy,Bc=Xu=0;try{Wde()}finally{Bc=0,Kde(),el=0}}function Hde(){var e=dh.now(),t=e-Pm;t>vB&&(Zy-=t,Pm=e)}function Kde(){for(var e,t=Tm,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Tm=n);Zu=e,tw(r)}function tw(e){if(!Bc){Xu&&(Xu=clearTimeout(Xu));var t=e-el;t>24?(e<1/0&&(Xu=setTimeout(rI,e-dh.now()-Zy)),Du&&(Du=clearInterval(Du))):(Du||(Pm=dh.now(),Du=setInterval(Hde,vB)),Bc=1,xB(rI))}}function iI(e,t,n){var r=new Im;return t=t==null?0:+t,r.restart(i=>{r.stop(),e(i+t)},t,n),r}var Vde=JL("start","end","cancel","interrupt"),Yde=[],wB=0,oI=1,nw=2,lg=3,sI=4,rw=5,cg=6;function Qy(e,t,n,r,i,o){var s=e.__transition;if(!s)e.__transition={};else if(n in s)return;qde(e,n,{name:t,index:r,group:i,on:Vde,tween:Yde,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:wB})}function xC(e,t){var n=Ni(e,t);if(n.state>wB)throw new Error("too late; already scheduled");return n}function ho(e,t){var n=Ni(e,t);if(n.state>lg)throw new Error("too late; already running");return n}function Ni(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function qde(e,t,n){var r=e.__transition,i;r[t]=n,n.timer=bB(o,0,n.time);function o(c){n.state=oI,n.timer.restart(s,n.delay,n.time),n.delay<=c&&s(c-n.delay)}function s(c){var u,d,h,f;if(n.state!==oI)return l();for(u in r)if(f=r[u],f.name===n.name){if(f.state===lg)return iI(s);f.state===sI?(f.state=cg,f.timer.stop(),f.on.call("interrupt",e,e.__data__,f.index,f.group),delete r[u]):+u<t&&(f.state=cg,f.timer.stop(),f.on.call("cancel",e,e.__data__,f.index,f.group),delete r[u])}if(iI(function(){n.state===lg&&(n.state=sI,n.timer.restart(a,n.delay,n.time),a(c))}),n.state=nw,n.on.call("start",e,e.__data__,n.index,n.group),n.state===nw){for(n.state=lg,i=new Array(h=n.tween.length),u=0,d=-1;u<h;++u)(f=n.tween[u].value.call(e,e.__data__,n.index,n.group))&&(i[++d]=f);i.length=d+1}}function a(c){for(var u=c<n.duration?n.ease.call(null,c/n.duration):(n.timer.restart(l),n.state=rw,1),d=-1,h=i.length;++d<h;)i[d].call(e,u);n.state===rw&&(n.on.call("end",e,e.__data__,n.index,n.group),l())}function l(){n.state=cg,n.timer.stop(),delete r[t];for(var c in r)return;delete e.__transition}}function Gde(e,t){var n=e.__transition,r,i,o=!0,s;if(n){t=t==null?null:t+"";for(s in n){if((r=n[s]).name!==t){o=!1;continue}i=r.state>nw&&r.state<rw,r.state=cg,r.timer.stop(),r.on.call(i?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[s]}o&&delete e.__transition}}function Xde(e){return this.each(function(){Gde(this,e)})}function Zde(e,t){var n,r;return function(){var i=ho(this,e),o=i.tween;if(o!==n){r=n=o;for(var s=0,a=r.length;s<a;++s)if(r[s].name===t){r=r.slice(),r.splice(s,1);break}}i.tween=r}}function Qde(e,t,n){var r,i;if(typeof n!="function")throw new Error;return function(){var o=ho(this,e),s=o.tween;if(s!==r){i=(r=s).slice();for(var a={name:t,value:n},l=0,c=i.length;l<c;++l)if(i[l].name===t){i[l]=a;break}l===c&&i.push(a)}o.tween=i}}function Jde(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=Ni(this.node(),n).tween,i=0,o=r.length,s;i<o;++i)if((s=r[i]).name===e)return s.value;return null}return this.each((t==null?Zde:Qde)(n,e,t))}function bC(e,t,n){var r=e._id;return e.each(function(){var i=ho(this,r);(i.value||(i.value={}))[t]=n.apply(this,arguments)}),function(i){return Ni(i,r).value[t]}}function SB(e,t){var n;return(typeof t=="number"?ws:t instanceof uh?tI:(n=uh(t))?(t=n,tI):Dde)(e,t)}function ehe(e){return function(){this.removeAttribute(e)}}function the(e){return function(){this.removeAttributeNS(e.space,e.local)}}function nhe(e,t,n){var r,i=n+"",o;return function(){var s=this.getAttribute(e);return s===i?null:s===r?o:o=t(r=s,n)}}function rhe(e,t,n){var r,i=n+"",o;return function(){var s=this.getAttributeNS(e.space,e.local);return s===i?null:s===r?o:o=t(r=s,n)}}function ihe(e,t,n){var r,i,o;return function(){var s,a=n(this),l;return a==null?void this.removeAttribute(e):(s=this.getAttribute(e),l=a+"",s===l?null:s===r&&l===i?o:(i=l,o=t(r=s,a)))}}function ohe(e,t,n){var r,i,o;return function(){var s,a=n(this),l;return a==null?void this.removeAttributeNS(e.space,e.local):(s=this.getAttributeNS(e.space,e.local),l=a+"",s===l?null:s===r&&l===i?o:(i=l,o=t(r=s,a)))}}function she(e,t){var n=Xy(e),r=n==="transform"?zde:SB;return this.attrTween(e,typeof t=="function"?(n.local?ohe:ihe)(n,r,bC(this,"attr."+e,t)):t==null?(n.local?the:ehe)(n):(n.local?rhe:nhe)(n,r,t))}function ahe(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function lhe(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function che(e,t){var n,r;function i(){var o=t.apply(this,arguments);return o!==r&&(n=(r=o)&&lhe(e,o)),n}return i._value=t,i}function uhe(e,t){var n,r;function i(){var o=t.apply(this,arguments);return o!==r&&(n=(r=o)&&ahe(e,o)),n}return i._value=t,i}function dhe(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=Xy(e);return this.tween(n,(r.local?che:uhe)(r,t))}function hhe(e,t){return function(){xC(this,e).delay=+t.apply(this,arguments)}}function fhe(e,t){return t=+t,function(){xC(this,e).delay=t}}function phe(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?hhe:fhe)(t,e)):Ni(this.node(),t).delay}function ghe(e,t){return function(){ho(this,e).duration=+t.apply(this,arguments)}}function mhe(e,t){return t=+t,function(){ho(this,e).duration=t}}function yhe(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?ghe:mhe)(t,e)):Ni(this.node(),t).duration}function vhe(e,t){if(typeof t!="function")throw new Error;return function(){ho(this,e).ease=t}}function xhe(e){var t=this._id;return arguments.length?this.each(vhe(t,e)):Ni(this.node(),t).ease}function bhe(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;ho(this,e).ease=n}}function whe(e){if(typeof e!="function")throw new Error;return this.each(bhe(this._id,e))}function She(e){typeof e!="function"&&(e=nB(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o=t[i],s=o.length,a=r[i]=[],l,c=0;c<s;++c)(l=o[c])&&e.call(l,l.__data__,c,o)&&a.push(l);return new Ko(r,this._parents,this._name,this._id)}function _he(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,i=n.length,o=Math.min(r,i),s=new Array(r),a=0;a<o;++a)for(var l=t[a],c=n[a],u=l.length,d=s[a]=new Array(u),h,f=0;f<u;++f)(h=l[f]||c[f])&&(d[f]=h);for(;a<r;++a)s[a]=t[a];return new Ko(s,this._parents,this._name,this._id)}function Che(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function Ehe(e,t,n){var r,i,o=Che(t)?xC:ho;return function(){var s=o(this,e),a=s.on;a!==r&&(i=(r=a).copy()).on(t,n),s.on=i}}function khe(e,t){var n=this._id;return arguments.length<2?Ni(this.node(),n).on.on(e):this.each(Ehe(n,e,t))}function The(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function Phe(){return this.on("end.remove",The(this._id))}function Ihe(e){var t=this._name,n=this._id;typeof e!="function"&&(e=pC(e));for(var r=this._groups,i=r.length,o=new Array(i),s=0;s<i;++s)for(var a=r[s],l=a.length,c=o[s]=new Array(l),u,d,h=0;h<l;++h)(u=a[h])&&(d=e.call(u,u.__data__,h,a))&&("__data__"in u&&(d.__data__=u.__data__),c[h]=d,Qy(c[h],t,n,h,c,Ni(u,n)));return new Ko(o,this._parents,t,n)}function $he(e){var t=this._name,n=this._id;typeof e!="function"&&(e=tB(e));for(var r=this._groups,i=r.length,o=[],s=[],a=0;a<i;++a)for(var l=r[a],c=l.length,u,d=0;d<c;++d)if(u=l[d]){for(var h=e.call(u,u.__data__,d,l),f,p=Ni(u,n),g=0,y=h.length;g<y;++g)(f=h[g])&&Qy(f,t,n,g,h,p);o.push(h),s.push(u)}return new Ko(o,s,t,n)}var Ahe=Gh.prototype.constructor;function Mhe(){return new Ahe(this._groups,this._parents)}function Ohe(e,t){var n,r,i;return function(){var o=Lc(this,e),s=(this.style.removeProperty(e),Lc(this,e));return o===s?null:o===n&&s===r?i:i=t(n=o,r=s)}}function _B(e){return function(){this.style.removeProperty(e)}}function Lhe(e,t,n){var r,i=n+"",o;return function(){var s=Lc(this,e);return s===i?null:s===r?o:o=t(r=s,n)}}function Bhe(e,t,n){var r,i,o;return function(){var s=Lc(this,e),a=n(this),l=a+"";return a==null&&(l=a=(this.style.removeProperty(e),Lc(this,e))),s===l?null:s===r&&l===i?o:(i=l,o=t(r=s,a))}}function Rhe(e,t){var n,r,i,o="style."+t,s="end."+o,a;return function(){var l=ho(this,e),c=l.on,u=l.value[o]==null?a||(a=_B(t)):void 0;(c!==n||i!==u)&&(r=(n=c).copy()).on(s,i=u),l.on=r}}function Dhe(e,t,n){var r=(e+="")=="transform"?jde:SB;return t==null?this.styleTween(e,Ohe(e,r)).on("end.style."+e,_B(e)):typeof t=="function"?this.styleTween(e,Bhe(e,r,bC(this,"style."+e,t))).each(Rhe(this._id,e)):this.styleTween(e,Lhe(e,r,t),n).on("end.style."+e,null)}function Fhe(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function Nhe(e,t,n){var r,i;function o(){var s=t.apply(this,arguments);return s!==i&&(r=(i=s)&&Fhe(e,s,n)),r}return o._value=t,o}function jhe(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,Nhe(e,t,n??""))}function zhe(e){return function(){this.textContent=e}}function Uhe(e){return function(){var t=e(this);this.textContent=t??""}}function Whe(e){return this.tween("text",typeof e=="function"?Uhe(bC(this,"text",e)):zhe(e==null?"":e+""))}function Hhe(e){return function(t){this.textContent=e.call(this,t)}}function Khe(e){var t,n;function r(){var i=e.apply(this,arguments);return i!==n&&(t=(n=i)&&Hhe(i)),t}return r._value=e,r}function Vhe(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,Khe(e))}function Yhe(){for(var e=this._name,t=this._id,n=CB(),r=this._groups,i=r.length,o=0;o<i;++o)for(var s=r[o],a=s.length,l,c=0;c<a;++c)if(l=s[c]){var u=Ni(l,t);Qy(l,e,n,c,s,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new Ko(r,this._parents,e,n)}function qhe(){var e,t,n=this,r=n._id,i=n.size();return new Promise(function(o,s){var a={value:s},l={value:function(){--i===0&&o()}};n.each(function(){var c=ho(this,r),u=c.on;u!==e&&(t=(e=u).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(l)),c.on=t}),i===0&&o()})}var Ghe=0;function Ko(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function CB(){return++Ghe}var vo=Gh.prototype;Ko.prototype={constructor:Ko,select:Ihe,selectAll:$he,selectChild:vo.selectChild,selectChildren:vo.selectChildren,filter:She,merge:_he,selection:Mhe,transition:Yhe,call:vo.call,nodes:vo.nodes,node:vo.node,size:vo.size,empty:vo.empty,each:vo.each,on:khe,attr:she,attrTween:dhe,style:Dhe,styleTween:jhe,text:Whe,textTween:Vhe,remove:Phe,tween:Jde,delay:phe,duration:yhe,ease:xhe,easeVarying:whe,end:qhe,[Symbol.iterator]:vo[Symbol.iterator]};function Xhe(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var Zhe={time:null,delay:0,duration:250,ease:Xhe};function Qhe(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function Jhe(e){var t,n;e instanceof Ko?(t=e._id,e=e._name):(t=CB(),(n=Zhe).time=vC(),e=e==null?null:e+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var s=r[o],a=s.length,l,c=0;c<a;++c)(l=s[c])&&Qy(l,e,t,c,s,n||Qhe(l,t));return new Ko(r,this._parents,e,t)}Gh.prototype.interrupt=Xde;Gh.prototype.transition=Jhe;const zwe=Math.abs,Uwe=Math.atan2,Wwe=Math.cos,Hwe=Math.max,Kwe=Math.min,Vwe=Math.sin,Ywe=Math.sqrt,aI=1e-12,wC=Math.PI,lI=wC/2,qwe=2*wC;function Gwe(e){return e>1?0:e<-1?wC:Math.acos(e)}function Xwe(e){return e>=1?lI:e<=-1?-lI:Math.asin(e)}function EB(e){this._context=e}EB.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function efe(e){return new EB(e)}class kB{constructor(t,n){this._context=t,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,n){switch(t=+t,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,n,t,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,t,this._y0,t,n);break}}this._x0=t,this._y0=n}}function tfe(e){return new kB(e,!0)}function nfe(e){return new kB(e,!1)}function na(){}function $m(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function Jy(e){this._context=e}Jy.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:$m(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:$m(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function rfe(e){return new Jy(e)}function TB(e){this._context=e}TB.prototype={areaStart:na,areaEnd:na,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:$m(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function ife(e){return new TB(e)}function PB(e){this._context=e}PB.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:$m(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function ofe(e){return new PB(e)}function IB(e,t){this._basis=new Jy(e),this._beta=t}IB.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r=e[0],i=t[0],o=e[n]-r,s=t[n]-i,a=-1,l;++a<=n;)l=a/n,this._basis.point(this._beta*e[a]+(1-this._beta)*(r+l*o),this._beta*t[a]+(1-this._beta)*(i+l*s));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};const sfe=function e(t){function n(r){return t===1?new Jy(r):new IB(r,t)}return n.beta=function(r){return e(+r)},n}(.85);function Am(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function SC(e,t){this._context=e,this._k=(1-t)/6}SC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Am(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:Am(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const afe=function e(t){function n(r){return new SC(r,t)}return n.tension=function(r){return e(+r)},n}(0);function _C(e,t){this._context=e,this._k=(1-t)/6}_C.prototype={areaStart:na,areaEnd:na,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:Am(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const lfe=function e(t){function n(r){return new _C(r,t)}return n.tension=function(r){return e(+r)},n}(0);function CC(e,t){this._context=e,this._k=(1-t)/6}CC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Am(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const cfe=function e(t){function n(r){return new CC(r,t)}return n.tension=function(r){return e(+r)},n}(0);function EC(e,t,n){var r=e._x1,i=e._y1,o=e._x2,s=e._y2;if(e._l01_a>aI){var a=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,l=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*a-e._x0*e._l12_2a+e._x2*e._l01_2a)/l,i=(i*a-e._y0*e._l12_2a+e._y2*e._l01_2a)/l}if(e._l23_a>aI){var c=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,u=3*e._l23_a*(e._l23_a+e._l12_a);o=(o*c+e._x1*e._l23_2a-t*e._l12_2a)/u,s=(s*c+e._y1*e._l23_2a-n*e._l12_2a)/u}e._context.bezierCurveTo(r,i,o,s,e._x2,e._y2)}function $B(e,t){this._context=e,this._alpha=t}$B.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:EC(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const ufe=function e(t){function n(r){return t?new $B(r,t):new SC(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function AB(e,t){this._context=e,this._alpha=t}AB.prototype={areaStart:na,areaEnd:na,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:EC(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const dfe=function e(t){function n(r){return t?new AB(r,t):new _C(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function MB(e,t){this._context=e,this._alpha=t}MB.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:EC(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const hfe=function e(t){function n(r){return t?new MB(r,t):new CC(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function OB(e){this._context=e}OB.prototype={areaStart:na,areaEnd:na,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function ffe(e){return new OB(e)}function cI(e){return e<0?-1:1}function uI(e,t,n){var r=e._x1-e._x0,i=t-e._x1,o=(e._y1-e._y0)/(r||i<0&&-0),s=(n-e._y1)/(i||r<0&&-0),a=(o*i+s*r)/(r+i);return(cI(o)+cI(s))*Math.min(Math.abs(o),Math.abs(s),.5*Math.abs(a))||0}function dI(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function x1(e,t,n){var r=e._x0,i=e._y0,o=e._x1,s=e._y1,a=(o-r)/3;e._context.bezierCurveTo(r+a,i+a*t,o-a,s-a*n,o,s)}function Mm(e){this._context=e}Mm.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:x1(this,this._t0,dI(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,x1(this,dI(this,n=uI(this,e,t)),n);break;default:x1(this,this._t0,n=uI(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function LB(e){this._context=new BB(e)}(LB.prototype=Object.create(Mm.prototype)).point=function(e,t){Mm.prototype.point.call(this,t,e)};function BB(e){this._context=e}BB.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,o){this._context.bezierCurveTo(t,e,r,n,o,i)}};function pfe(e){return new Mm(e)}function gfe(e){return new LB(e)}function RB(e){this._context=e}RB.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var r=hI(e),i=hI(t),o=0,s=1;s<n;++o,++s)this._context.bezierCurveTo(r[0][o],i[0][o],r[1][o],i[1][o],e[s],t[s]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function hI(e){var t,n=e.length-1,r,i=new Array(n),o=new Array(n),s=new Array(n);for(i[0]=0,o[0]=2,s[0]=e[0]+2*e[1],t=1;t<n-1;++t)i[t]=1,o[t]=4,s[t]=4*e[t]+2*e[t+1];for(i[n-1]=2,o[n-1]=7,s[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=i[t]/o[t-1],o[t]-=r,s[t]-=r*s[t-1];for(i[n-1]=s[n-1]/o[n-1],t=n-2;t>=0;--t)i[t]=(s[t]-i[t+1])/o[t];for(o[n-1]=(e[n]+i[n-1])/2,t=0;t<n-1;++t)o[t]=2*e[t+1]-i[t+1];return[i,o]}function mfe(e){return new RB(e)}function e0(e,t){this._context=e,this._t=t}e0.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function yfe(e){return new e0(e,.5)}function vfe(e){return new e0(e,0)}function xfe(e){return new e0(e,1)}function Qu(e,t,n){this.k=e,this.x=t,this.y=n}Qu.prototype={constructor:Qu,scale:function(e){return e===1?this:new Qu(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Qu(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};Qu.prototype;/*! @license DOMPurify 3.0.5 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.0.5/LICENSE */const{entries:DB,setPrototypeOf:fI,isFrozen:bfe,getPrototypeOf:wfe,getOwnPropertyDescriptor:Sfe}=Object;let{freeze:Xn,seal:Bi,create:_fe}=Object,{apply:iw,construct:ow}=typeof Reflect<"u"&&Reflect;iw||(iw=function(t,n,r){return t.apply(n,r)});Xn||(Xn=function(t){return t});Bi||(Bi=function(t){return t});ow||(ow=function(t,n){return new t(...n)});const Cfe=ci(Array.prototype.forEach),pI=ci(Array.prototype.pop),Fu=ci(Array.prototype.push),ug=ci(String.prototype.toLowerCase),b1=ci(String.prototype.toString),Efe=ci(String.prototype.match),yi=ci(String.prototype.replace),kfe=ci(String.prototype.indexOf),Tfe=ci(String.prototype.trim),Sr=ci(RegExp.prototype.test),Nu=Pfe(TypeError);function ci(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return iw(e,t,r)}}function Pfe(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return ow(e,n)}}function Ue(e,t,n){var r;n=(r=n)!==null&&r!==void 0?r:ug,fI&&fI(e,null);let i=t.length;for(;i--;){let o=t[i];if(typeof o=="string"){const s=n(o);s!==o&&(bfe(t)||(t[i]=s),o=s)}e[o]=!0}return e}function Fl(e){const t=_fe(null);for(const[n,r]of DB(e))t[n]=r;return t}function yp(e,t){for(;e!==null;){const r=Sfe(e,t);if(r){if(r.get)return ci(r.get);if(typeof r.value=="function")return ci(r.value)}e=wfe(e)}function n(r){return console.warn("fallback value for",r),null}return n}const gI=Xn(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),w1=Xn(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),S1=Xn(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Ife=Xn(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),_1=Xn(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),$fe=Xn(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),mI=Xn(["#text"]),yI=Xn(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),C1=Xn(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),vI=Xn(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),vp=Xn(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Afe=Bi(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Mfe=Bi(/<%[\w\W]*|[\w\W]*%>/gm),Ofe=Bi(/\${[\w\W]*}/gm),Lfe=Bi(/^data-[\-\w.\u00B7-\uFFFF]/),Bfe=Bi(/^aria-[\-\w]+$/),FB=Bi(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Rfe=Bi(/^(?:\w+script|data):/i),Dfe=Bi(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),NB=Bi(/^html$/i);var xI=Object.freeze({__proto__:null,MUSTACHE_EXPR:Afe,ERB_EXPR:Mfe,TMPLIT_EXPR:Ofe,DATA_ATTR:Lfe,ARIA_ATTR:Bfe,IS_ALLOWED_URI:FB,IS_SCRIPT_OR_DATA:Rfe,ATTR_WHITESPACE:Dfe,DOCTYPE_NAME:NB});const Ffe=()=>typeof window>"u"?null:window,Nfe=function(t,n){if(typeof t!="object"||typeof t.createPolicy!="function")return null;let r=null;const i="data-tt-policy-suffix";n&&n.hasAttribute(i)&&(r=n.getAttribute(i));const o="dompurify"+(r?"#"+r:"");try{return t.createPolicy(o,{createHTML(s){return s},createScriptURL(s){return s}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}};function jB(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ffe();const t=fe=>jB(fe);if(t.version="3.0.5",t.removed=[],!e||!e.document||e.document.nodeType!==9)return t.isSupported=!1,t;const n=e.document,r=n.currentScript;let{document:i}=e;const{DocumentFragment:o,HTMLTemplateElement:s,Node:a,Element:l,NodeFilter:c,NamedNodeMap:u=e.NamedNodeMap||e.MozNamedAttrMap,HTMLFormElement:d,DOMParser:h,trustedTypes:f}=e,p=l.prototype,g=yp(p,"cloneNode"),y=yp(p,"nextSibling"),x=yp(p,"childNodes"),w=yp(p,"parentNode");if(typeof s=="function"){const fe=i.createElement("template");fe.content&&fe.content.ownerDocument&&(i=fe.content.ownerDocument)}let _,S="";const{implementation:T,createNodeIterator:P,createDocumentFragment:I,getElementsByTagName:$}=i,{importNode:L}=n;let R={};t.isSupported=typeof DB=="function"&&typeof w=="function"&&T&&T.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:K,ERB_EXPR:Q,TMPLIT_EXPR:j,DATA_ATTR:B,ARIA_ATTR:z,IS_SCRIPT_OR_DATA:q,ATTR_WHITESPACE:U}=xI;let{IS_ALLOWED_URI:D}=xI,F=null;const J=Ue({},[...gI,...w1,...S1,..._1,...mI]);let Z=null;const ne=Ue({},[...yI,...C1,...vI,...vp]);let de=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Ce=null,he=null,je=!0,$e=!0,Ee=!1,Ie=!0,Fe=!1,ct=!1,mt=!1,Wt=!1,_t=!1,jn=!1,Sn=!1,Zt=!0,_n=!1;const Cn="user-content-";let Rt=!0,rn=!1,yt={},nr=null;const is=Ue({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let zn=null;const os=Ue({},["audio","video","img","source","image","track"]);let A=null;const C=Ue({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),k="http://www.w3.org/1998/Math/MathML",M="http://www.w3.org/2000/svg",N="http://www.w3.org/1999/xhtml";let G=N,ee=!1,De=null;const et=Ue({},[k,M,N],b1);let Ye;const st=["application/xhtml+xml","text/html"],Ze="text/html";let ut,po=null;const m0=i.createElement("form"),ef=function(W){return W instanceof RegExp||W instanceof Function},fa=function(W){if(!(po&&po===W)){if((!W||typeof W!="object")&&(W={}),W=Fl(W),Ye=st.indexOf(W.PARSER_MEDIA_TYPE)===-1?Ye=Ze:Ye=W.PARSER_MEDIA_TYPE,ut=Ye==="application/xhtml+xml"?b1:ug,F="ALLOWED_TAGS"in W?Ue({},W.ALLOWED_TAGS,ut):J,Z="ALLOWED_ATTR"in W?Ue({},W.ALLOWED_ATTR,ut):ne,De="ALLOWED_NAMESPACES"in W?Ue({},W.ALLOWED_NAMESPACES,b1):et,A="ADD_URI_SAFE_ATTR"in W?Ue(Fl(C),W.ADD_URI_SAFE_ATTR,ut):C,zn="ADD_DATA_URI_TAGS"in W?Ue(Fl(os),W.ADD_DATA_URI_TAGS,ut):os,nr="FORBID_CONTENTS"in W?Ue({},W.FORBID_CONTENTS,ut):is,Ce="FORBID_TAGS"in W?Ue({},W.FORBID_TAGS,ut):{},he="FORBID_ATTR"in W?Ue({},W.FORBID_ATTR,ut):{},yt="USE_PROFILES"in W?W.USE_PROFILES:!1,je=W.ALLOW_ARIA_ATTR!==!1,$e=W.ALLOW_DATA_ATTR!==!1,Ee=W.ALLOW_UNKNOWN_PROTOCOLS||!1,Ie=W.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Fe=W.SAFE_FOR_TEMPLATES||!1,ct=W.WHOLE_DOCUMENT||!1,_t=W.RETURN_DOM||!1,jn=W.RETURN_DOM_FRAGMENT||!1,Sn=W.RETURN_TRUSTED_TYPE||!1,Wt=W.FORCE_BODY||!1,Zt=W.SANITIZE_DOM!==!1,_n=W.SANITIZE_NAMED_PROPS||!1,Rt=W.KEEP_CONTENT!==!1,rn=W.IN_PLACE||!1,D=W.ALLOWED_URI_REGEXP||FB,G=W.NAMESPACE||N,de=W.CUSTOM_ELEMENT_HANDLING||{},W.CUSTOM_ELEMENT_HANDLING&&ef(W.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(de.tagNameCheck=W.CUSTOM_ELEMENT_HANDLING.tagNameCheck),W.CUSTOM_ELEMENT_HANDLING&&ef(W.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(de.attributeNameCheck=W.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),W.CUSTOM_ELEMENT_HANDLING&&typeof W.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(de.allowCustomizedBuiltInElements=W.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Fe&&($e=!1),jn&&(_t=!0),yt&&(F=Ue({},[...mI]),Z=[],yt.html===!0&&(Ue(F,gI),Ue(Z,yI)),yt.svg===!0&&(Ue(F,w1),Ue(Z,C1),Ue(Z,vp)),yt.svgFilters===!0&&(Ue(F,S1),Ue(Z,C1),Ue(Z,vp)),yt.mathMl===!0&&(Ue(F,_1),Ue(Z,vI),Ue(Z,vp))),W.ADD_TAGS&&(F===J&&(F=Fl(F)),Ue(F,W.ADD_TAGS,ut)),W.ADD_ATTR&&(Z===ne&&(Z=Fl(Z)),Ue(Z,W.ADD_ATTR,ut)),W.ADD_URI_SAFE_ATTR&&Ue(A,W.ADD_URI_SAFE_ATTR,ut),W.FORBID_CONTENTS&&(nr===is&&(nr=Fl(nr)),Ue(nr,W.FORBID_CONTENTS,ut)),Rt&&(F["#text"]=!0),ct&&Ue(F,["html","head","body"]),F.table&&(Ue(F,["tbody"]),delete Ce.tbody),W.TRUSTED_TYPES_POLICY){if(typeof W.TRUSTED_TYPES_POLICY.createHTML!="function")throw Nu('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof W.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Nu('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');_=W.TRUSTED_TYPES_POLICY,S=_.createHTML("")}else _===void 0&&(_=Nfe(f,r)),_!==null&&typeof S=="string"&&(S=_.createHTML(""));Xn&&Xn(W),po=W}},ss=Ue({},["mi","mo","mn","ms","mtext"]),xl=Ue({},["foreignobject","desc","title","annotation-xml"]),lu=Ue({},["title","style","font","a","script"]),as=Ue({},w1);Ue(as,S1),Ue(as,Ife);const go=Ue({},_1);Ue(go,$fe);const y0=function(W){let se=w(W);(!se||!se.tagName)&&(se={namespaceURI:G,tagName:"template"});const ue=ug(W.tagName),Je=ug(se.tagName);return De[W.namespaceURI]?W.namespaceURI===M?se.namespaceURI===N?ue==="svg":se.namespaceURI===k?ue==="svg"&&(Je==="annotation-xml"||ss[Je]):!!as[ue]:W.namespaceURI===k?se.namespaceURI===N?ue==="math":se.namespaceURI===M?ue==="math"&&xl[Je]:!!go[ue]:W.namespaceURI===N?se.namespaceURI===M&&!xl[Je]||se.namespaceURI===k&&!ss[Je]?!1:!go[ue]&&(lu[ue]||!as[ue]):!!(Ye==="application/xhtml+xml"&&De[W.namespaceURI]):!1},mo=function(W){Fu(t.removed,{element:W});try{W.parentNode.removeChild(W)}catch{W.remove()}},cu=function(W,se){try{Fu(t.removed,{attribute:se.getAttributeNode(W),from:se})}catch{Fu(t.removed,{attribute:null,from:se})}if(se.removeAttribute(W),W==="is"&&!Z[W])if(_t||jn)try{mo(se)}catch{}else try{se.setAttribute(W,"")}catch{}},tf=function(W){let se,ue;if(Wt)W="<remove></remove>"+W;else{const Kt=Efe(W,/^[\r\n\t ]+/);ue=Kt&&Kt[0]}Ye==="application/xhtml+xml"&&G===N&&(W='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+W+"</body></html>");const Je=_?_.createHTML(W):W;if(G===N)try{se=new h().parseFromString(Je,Ye)}catch{}if(!se||!se.documentElement){se=T.createDocument(G,"template",null);try{se.documentElement.innerHTML=ee?S:Je}catch{}}const Ht=se.body||se.documentElement;return W&&ue&&Ht.insertBefore(i.createTextNode(ue),Ht.childNodes[0]||null),G===N?$.call(se,ct?"html":"body")[0]:ct?se.documentElement:Ht},nf=function(W){return P.call(W.ownerDocument||W,W,c.SHOW_ELEMENT|c.SHOW_COMMENT|c.SHOW_TEXT,null,!1)},rf=function(W){return W instanceof d&&(typeof W.nodeName!="string"||typeof W.textContent!="string"||typeof W.removeChild!="function"||!(W.attributes instanceof u)||typeof W.removeAttribute!="function"||typeof W.setAttribute!="function"||typeof W.namespaceURI!="string"||typeof W.insertBefore!="function"||typeof W.hasChildNodes!="function")},ls=function(W){return typeof a=="object"?W instanceof a:W&&typeof W=="object"&&typeof W.nodeType=="number"&&typeof W.nodeName=="string"},un=function(W,se,ue){R[W]&&Cfe(R[W],Je=>{Je.call(t,se,ue,po)})},of=function(W){let se;if(un("beforeSanitizeElements",W,null),rf(W))return mo(W),!0;const ue=ut(W.nodeName);if(un("uponSanitizeElement",W,{tagName:ue,allowedTags:F}),W.hasChildNodes()&&!ls(W.firstElementChild)&&(!ls(W.content)||!ls(W.content.firstElementChild))&&Sr(/<[/\w]/g,W.innerHTML)&&Sr(/<[/\w]/g,W.textContent))return mo(W),!0;if(!F[ue]||Ce[ue]){if(!Ce[ue]&&af(ue)&&(de.tagNameCheck instanceof RegExp&&Sr(de.tagNameCheck,ue)||de.tagNameCheck instanceof Function&&de.tagNameCheck(ue)))return!1;if(Rt&&!nr[ue]){const Je=w(W)||W.parentNode,Ht=x(W)||W.childNodes;if(Ht&&Je){const Kt=Ht.length;for(let vt=Kt-1;vt>=0;--vt)Je.insertBefore(g(Ht[vt],!0),y(W))}}return mo(W),!0}return W instanceof l&&!y0(W)||(ue==="noscript"||ue==="noembed"||ue==="noframes")&&Sr(/<\/no(script|embed|frames)/i,W.innerHTML)?(mo(W),!0):(Fe&&W.nodeType===3&&(se=W.textContent,se=yi(se,K," "),se=yi(se,Q," "),se=yi(se,j," "),W.textContent!==se&&(Fu(t.removed,{element:W.cloneNode()}),W.textContent=se)),un("afterSanitizeElements",W,null),!1)},sf=function(W,se,ue){if(Zt&&(se==="id"||se==="name")&&(ue in i||ue in m0))return!1;if(!($e&&!he[se]&&Sr(B,se))){if(!(je&&Sr(z,se))){if(!Z[se]||he[se]){if(!(af(W)&&(de.tagNameCheck instanceof RegExp&&Sr(de.tagNameCheck,W)||de.tagNameCheck instanceof Function&&de.tagNameCheck(W))&&(de.attributeNameCheck instanceof RegExp&&Sr(de.attributeNameCheck,se)||de.attributeNameCheck instanceof Function&&de.attributeNameCheck(se))||se==="is"&&de.allowCustomizedBuiltInElements&&(de.tagNameCheck instanceof RegExp&&Sr(de.tagNameCheck,ue)||de.tagNameCheck instanceof Function&&de.tagNameCheck(ue))))return!1}else if(!A[se]){if(!Sr(D,yi(ue,U,""))){if(!((se==="src"||se==="xlink:href"||se==="href")&&W!=="script"&&kfe(ue,"data:")===0&&zn[W])){if(!(Ee&&!Sr(q,yi(ue,U,"")))){if(ue)return!1}}}}}}return!0},af=function(W){return W.indexOf("-")>0},lf=function(W){let se,ue,Je,Ht;un("beforeSanitizeAttributes",W,null);const{attributes:Kt}=W;if(!Kt)return;const vt={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Z};for(Ht=Kt.length;Ht--;){se=Kt[Ht];const{name:Fr,namespaceURI:uu}=se;if(ue=Fr==="value"?se.value:Tfe(se.value),Je=ut(Fr),vt.attrName=Je,vt.attrValue=ue,vt.keepAttr=!0,vt.forceKeepAttr=void 0,un("uponSanitizeAttribute",W,vt),ue=vt.attrValue,vt.forceKeepAttr||(cu(Fr,W),!vt.keepAttr))continue;if(!Ie&&Sr(/\/>/i,ue)){cu(Fr,W);continue}Fe&&(ue=yi(ue,K," "),ue=yi(ue,Q," "),ue=yi(ue,j," "));const cf=ut(W.nodeName);if(sf(cf,Je,ue)){if(_n&&(Je==="id"||Je==="name")&&(cu(Fr,W),ue=Cn+ue),_&&typeof f=="object"&&typeof f.getAttributeType=="function"&&!uu)switch(f.getAttributeType(cf,Je)){case"TrustedHTML":{ue=_.createHTML(ue);break}case"TrustedScriptURL":{ue=_.createScriptURL(ue);break}}try{uu?W.setAttributeNS(uu,Fr,ue):W.setAttribute(Fr,ue),pI(t.removed)}catch{}}}un("afterSanitizeAttributes",W,null)},v0=function fe(W){let se;const ue=nf(W);for(un("beforeSanitizeShadowDOM",W,null);se=ue.nextNode();)un("uponSanitizeShadowNode",se,null),!of(se)&&(se.content instanceof o&&fe(se.content),lf(se));un("afterSanitizeShadowDOM",W,null)};return t.sanitize=function(fe){let W=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},se,ue,Je,Ht;if(ee=!fe,ee&&(fe="<!-->"),typeof fe!="string"&&!ls(fe))if(typeof fe.toString=="function"){if(fe=fe.toString(),typeof fe!="string")throw Nu("dirty is not a string, aborting")}else throw Nu("toString is not a function");if(!t.isSupported)return fe;if(mt||fa(W),t.removed=[],typeof fe=="string"&&(rn=!1),rn){if(fe.nodeName){const Fr=ut(fe.nodeName);if(!F[Fr]||Ce[Fr])throw Nu("root node is forbidden and cannot be sanitized in-place")}}else if(fe instanceof a)se=tf("<!---->"),ue=se.ownerDocument.importNode(fe,!0),ue.nodeType===1&&ue.nodeName==="BODY"||ue.nodeName==="HTML"?se=ue:se.appendChild(ue);else{if(!_t&&!Fe&&!ct&&fe.indexOf("<")===-1)return _&&Sn?_.createHTML(fe):fe;if(se=tf(fe),!se)return _t?null:Sn?S:""}se&&Wt&&mo(se.firstChild);const Kt=nf(rn?fe:se);for(;Je=Kt.nextNode();)of(Je)||(Je.content instanceof o&&v0(Je.content),lf(Je));if(rn)return fe;if(_t){if(jn)for(Ht=I.call(se.ownerDocument);se.firstChild;)Ht.appendChild(se.firstChild);else Ht=se;return(Z.shadowroot||Z.shadowrootmode)&&(Ht=L.call(n,Ht,!0)),Ht}let vt=ct?se.outerHTML:se.innerHTML;return ct&&F["!doctype"]&&se.ownerDocument&&se.ownerDocument.doctype&&se.ownerDocument.doctype.name&&Sr(NB,se.ownerDocument.doctype.name)&&(vt="<!DOCTYPE "+se.ownerDocument.doctype.name+`>
`+vt),Fe&&(vt=yi(vt,K," "),vt=yi(vt,Q," "),vt=yi(vt,j," ")),_&&Sn?_.createHTML(vt):vt},t.setConfig=function(fe){fa(fe),mt=!0},t.clearConfig=function(){po=null,mt=!1},t.isValidAttribute=function(fe,W,se){po||fa({});const ue=ut(fe),Je=ut(W);return sf(ue,Je,se)},t.addHook=function(fe,W){typeof W=="function"&&(R[fe]=R[fe]||[],Fu(R[fe],W))},t.removeHook=function(fe){if(R[fe])return pI(R[fe])},t.removeHooks=function(fe){R[fe]&&(R[fe]=[])},t.removeAllHooks=function(){R={}},t}var Om=jB();const dg={min:{r:0,g:0,b:0,s:0,l:0,a:0},max:{r:255,g:255,b:255,h:360,s:100,l:100,a:1},clamp:{r:e=>e>=255?255:e<0?0:e,g:e=>e>=255?255:e<0?0:e,b:e=>e>=255?255:e<0?0:e,h:e=>e%360,s:e=>e>=100?100:e<0?0:e,l:e=>e>=100?100:e<0?0:e,a:e=>e>=1?1:e<0?0:e},toLinear:e=>{const t=e/255;return e>.03928?Math.pow((t+.055)/1.055,2.4):t/12.92},hue2rgb:(e,t,n)=>(n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<1/2?t:n<2/3?e+(t-e)*(2/3-n)*6:e),hsl2rgb:({h:e,s:t,l:n},r)=>{if(!t)return n*2.55;e/=360,t/=100,n/=100;const i=n<.5?n*(1+t):n+t-n*t,o=2*n-i;switch(r){case"r":return dg.hue2rgb(o,i,e+1/3)*255;case"g":return dg.hue2rgb(o,i,e)*255;case"b":return dg.hue2rgb(o,i,e-1/3)*255}},rgb2hsl:({r:e,g:t,b:n},r)=>{e/=255,t/=255,n/=255;const i=Math.max(e,t,n),o=Math.min(e,t,n),s=(i+o)/2;if(r==="l")return s*100;if(i===o)return 0;const a=i-o,l=s>.5?a/(2-i-o):a/(i+o);if(r==="s")return l*100;switch(i){case e:return((t-n)/a+(t<n?6:0))*60;case t:return((n-e)/a+2)*60;case n:return((e-t)/a+4)*60;default:return-1}}},jfe=dg,zfe={clamp:(e,t,n)=>t>n?Math.min(t,Math.max(n,e)):Math.min(n,Math.max(t,e)),round:e=>Math.round(e*1e10)/1e10},Ufe=zfe,Wfe={dec2hex:e=>{const t=Math.round(e).toString(16);return t.length>1?t:`0${t}`}},Hfe=Wfe,Kfe={channel:jfe,lang:Ufe,unit:Hfe},Le=Kfe,ys={};for(let e=0;e<=255;e++)ys[e]=Le.unit.dec2hex(e);const Pn={ALL:0,RGB:1,HSL:2};class Vfe{constructor(){this.type=Pn.ALL}get(){return this.type}set(t){if(this.type&&this.type!==t)throw new Error("Cannot change both RGB and HSL channels at the same time");this.type=t}reset(){this.type=Pn.ALL}is(t){return this.type===t}}const Yfe=Vfe;class qfe{constructor(t,n){this.color=n,this.changed=!1,this.data=t,this.type=new Yfe}set(t,n){return this.color=n,this.changed=!1,this.data=t,this.type.type=Pn.ALL,this}_ensureHSL(){const t=this.data,{h:n,s:r,l:i}=t;n===void 0&&(t.h=Le.channel.rgb2hsl(t,"h")),r===void 0&&(t.s=Le.channel.rgb2hsl(t,"s")),i===void 0&&(t.l=Le.channel.rgb2hsl(t,"l"))}_ensureRGB(){const t=this.data,{r:n,g:r,b:i}=t;n===void 0&&(t.r=Le.channel.hsl2rgb(t,"r")),r===void 0&&(t.g=Le.channel.hsl2rgb(t,"g")),i===void 0&&(t.b=Le.channel.hsl2rgb(t,"b"))}get r(){const t=this.data,n=t.r;return!this.type.is(Pn.HSL)&&n!==void 0?n:(this._ensureHSL(),Le.channel.hsl2rgb(t,"r"))}get g(){const t=this.data,n=t.g;return!this.type.is(Pn.HSL)&&n!==void 0?n:(this._ensureHSL(),Le.channel.hsl2rgb(t,"g"))}get b(){const t=this.data,n=t.b;return!this.type.is(Pn.HSL)&&n!==void 0?n:(this._ensureHSL(),Le.channel.hsl2rgb(t,"b"))}get h(){const t=this.data,n=t.h;return!this.type.is(Pn.RGB)&&n!==void 0?n:(this._ensureRGB(),Le.channel.rgb2hsl(t,"h"))}get s(){const t=this.data,n=t.s;return!this.type.is(Pn.RGB)&&n!==void 0?n:(this._ensureRGB(),Le.channel.rgb2hsl(t,"s"))}get l(){const t=this.data,n=t.l;return!this.type.is(Pn.RGB)&&n!==void 0?n:(this._ensureRGB(),Le.channel.rgb2hsl(t,"l"))}get a(){return this.data.a}set r(t){this.type.set(Pn.RGB),this.changed=!0,this.data.r=t}set g(t){this.type.set(Pn.RGB),this.changed=!0,this.data.g=t}set b(t){this.type.set(Pn.RGB),this.changed=!0,this.data.b=t}set h(t){this.type.set(Pn.HSL),this.changed=!0,this.data.h=t}set s(t){this.type.set(Pn.HSL),this.changed=!0,this.data.s=t}set l(t){this.type.set(Pn.HSL),this.changed=!0,this.data.l=t}set a(t){this.changed=!0,this.data.a=t}}const Gfe=qfe,Xfe=new Gfe({r:0,g:0,b:0,a:0},"transparent"),t0=Xfe,zB={re:/^#((?:[a-f0-9]{2}){2,4}|[a-f0-9]{3})$/i,parse:e=>{if(e.charCodeAt(0)!==35)return;const t=e.match(zB.re);if(!t)return;const n=t[1],r=parseInt(n,16),i=n.length,o=i%4===0,s=i>4,a=s?1:17,l=s?8:4,c=o?0:-1,u=s?255:15;return t0.set({r:(r>>l*(c+3)&u)*a,g:(r>>l*(c+2)&u)*a,b:(r>>l*(c+1)&u)*a,a:o?(r&u)*a/255:1},e)},stringify:e=>{const{r:t,g:n,b:r,a:i}=e;return i<1?`#${ys[Math.round(t)]}${ys[Math.round(n)]}${ys[Math.round(r)]}${ys[Math.round(i*255)]}`:`#${ys[Math.round(t)]}${ys[Math.round(n)]}${ys[Math.round(r)]}`}},gd=zB,hg={re:/^hsla?\(\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?(?:deg|grad|rad|turn)?)\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?%)\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?%)(?:\s*?(?:,|\/)\s*?\+?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?(%)?))?\s*?\)$/i,hueRe:/^(.+?)(deg|grad|rad|turn)$/i,_hue2deg:e=>{const t=e.match(hg.hueRe);if(t){const[,n,r]=t;switch(r){case"grad":return Le.channel.clamp.h(parseFloat(n)*.9);case"rad":return Le.channel.clamp.h(parseFloat(n)*180/Math.PI);case"turn":return Le.channel.clamp.h(parseFloat(n)*360)}}return Le.channel.clamp.h(parseFloat(e))},parse:e=>{const t=e.charCodeAt(0);if(t!==104&&t!==72)return;const n=e.match(hg.re);if(!n)return;const[,r,i,o,s,a]=n;return t0.set({h:hg._hue2deg(r),s:Le.channel.clamp.s(parseFloat(i)),l:Le.channel.clamp.l(parseFloat(o)),a:s?Le.channel.clamp.a(a?parseFloat(s)/100:parseFloat(s)):1},e)},stringify:e=>{const{h:t,s:n,l:r,a:i}=e;return i<1?`hsla(${Le.lang.round(t)}, ${Le.lang.round(n)}%, ${Le.lang.round(r)}%, ${i})`:`hsl(${Le.lang.round(t)}, ${Le.lang.round(n)}%, ${Le.lang.round(r)}%)`}},xp=hg,fg={colors:{aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyanaqua:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",transparent:"#00000000",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},parse:e=>{e=e.toLowerCase();const t=fg.colors[e];if(t)return gd.parse(t)},stringify:e=>{const t=gd.stringify(e);for(const n in fg.colors)if(fg.colors[n]===t)return n}},bI=fg,UB={re:/^rgba?\(\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?))\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?))\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?))(?:\s*?(?:,|\/)\s*?\+?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?)))?\s*?\)$/i,parse:e=>{const t=e.charCodeAt(0);if(t!==114&&t!==82)return;const n=e.match(UB.re);if(!n)return;const[,r,i,o,s,a,l,c,u]=n;return t0.set({r:Le.channel.clamp.r(i?parseFloat(r)*2.55:parseFloat(r)),g:Le.channel.clamp.g(s?parseFloat(o)*2.55:parseFloat(o)),b:Le.channel.clamp.b(l?parseFloat(a)*2.55:parseFloat(a)),a:c?Le.channel.clamp.a(u?parseFloat(c)/100:parseFloat(c)):1},e)},stringify:e=>{const{r:t,g:n,b:r,a:i}=e;return i<1?`rgba(${Le.lang.round(t)}, ${Le.lang.round(n)}, ${Le.lang.round(r)}, ${Le.lang.round(i)})`:`rgb(${Le.lang.round(t)}, ${Le.lang.round(n)}, ${Le.lang.round(r)})`}},bp=UB,Zfe={format:{keyword:bI,hex:gd,rgb:bp,rgba:bp,hsl:xp,hsla:xp},parse:e=>{if(typeof e!="string")return e;const t=gd.parse(e)||bp.parse(e)||xp.parse(e)||bI.parse(e);if(t)return t;throw new Error(`Unsupported color format: "${e}"`)},stringify:e=>!e.changed&&e.color?e.color:e.type.is(Pn.HSL)||e.data.r===void 0?xp.stringify(e):e.a<1||!Number.isInteger(e.r)||!Number.isInteger(e.g)||!Number.isInteger(e.b)?bp.stringify(e):gd.stringify(e)},so=Zfe,Qfe=(e,t)=>{const n=so.parse(e);for(const r in t)n[r]=Le.channel.clamp[r](t[r]);return so.stringify(n)},WB=Qfe,Jfe=(e,t,n=0,r=1)=>{if(typeof e!="number")return WB(e,{a:t});const i=t0.set({r:Le.channel.clamp.r(e),g:Le.channel.clamp.g(t),b:Le.channel.clamp.b(n),a:Le.channel.clamp.a(r)});return so.stringify(i)},md=Jfe,epe=e=>{const{r:t,g:n,b:r}=so.parse(e),i=.2126*Le.channel.toLinear(t)+.7152*Le.channel.toLinear(n)+.0722*Le.channel.toLinear(r);return Le.lang.round(i)},tpe=epe,npe=e=>tpe(e)>=.5,rpe=npe,ipe=e=>!rpe(e),Zh=ipe,ope=(e,t,n)=>{const r=so.parse(e),i=r[t],o=Le.channel.clamp[t](i+n);return i!==o&&(r[t]=o),so.stringify(r)},HB=ope,spe=(e,t)=>HB(e,"l",t),Se=spe,ape=(e,t)=>HB(e,"l",-t),Pe=ape,lpe=(e,t)=>{const n=so.parse(e),r={};for(const i in t)t[i]&&(r[i]=n[i]+t[i]);return WB(e,r)},V=lpe,cpe=(e,t,n=50)=>{const{r,g:i,b:o,a:s}=so.parse(e),{r:a,g:l,b:c,a:u}=so.parse(t),d=n/100,h=d*2-1,f=s-u,g=((h*f===-1?h:(h+f)/(1+h*f))+1)/2,y=1-g,x=r*g+a*y,w=i*g+l*y,_=o*g+c*y,S=s*d+u*(1-d);return md(x,w,_,S)},upe=cpe,dpe=(e,t=100)=>{const n=so.parse(e);return n.r=255-n.r,n.g=255-n.g,n.b=255-n.b,upe(n,e,t)},le=dpe;var hpe=typeof global=="object"&&global&&global.Object===Object&&global;const KB=hpe;var fpe=typeof self=="object"&&self&&self.Object===Object&&self,ppe=KB||fpe||Function("return this")();const fo=ppe;var gpe=fo.Symbol;const Lm=gpe;var VB=Object.prototype,mpe=VB.hasOwnProperty,ype=VB.toString,ju=Lm?Lm.toStringTag:void 0;function vpe(e){var t=mpe.call(e,ju),n=e[ju];try{e[ju]=void 0;var r=!0}catch{}var i=ype.call(e);return r&&(t?e[ju]=n:delete e[ju]),i}var xpe=Object.prototype,bpe=xpe.toString;function wpe(e){return bpe.call(e)}var Spe="[object Null]",_pe="[object Undefined]",wI=Lm?Lm.toStringTag:void 0;function ou(e){return e==null?e===void 0?_pe:Spe:wI&&wI in Object(e)?vpe(e):wpe(e)}function ml(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Cpe="[object AsyncFunction]",Epe="[object Function]",kpe="[object GeneratorFunction]",Tpe="[object Proxy]";function kC(e){if(!ml(e))return!1;var t=ou(e);return t==Epe||t==kpe||t==Cpe||t==Tpe}var Ppe=fo["__core-js_shared__"];const E1=Ppe;var SI=function(){var e=/[^.]+$/.exec(E1&&E1.keys&&E1.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function Ipe(e){return!!SI&&SI in e}var $pe=Function.prototype,Ape=$pe.toString;function yl(e){if(e!=null){try{return Ape.call(e)}catch{}try{return e+""}catch{}}return""}var Mpe=/[\\^$.*+?()[\]{}|]/g,Ope=/^\[object .+?Constructor\]$/,Lpe=Function.prototype,Bpe=Object.prototype,Rpe=Lpe.toString,Dpe=Bpe.hasOwnProperty,Fpe=RegExp("^"+Rpe.call(Dpe).replace(Mpe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Npe(e){if(!ml(e)||Ipe(e))return!1;var t=kC(e)?Fpe:Ope;return t.test(yl(e))}function jpe(e,t){return e==null?void 0:e[t]}function vl(e,t){var n=jpe(e,t);return Npe(n)?n:void 0}var zpe=vl(Object,"create");const hh=zpe;function Upe(){this.__data__=hh?hh(null):{},this.size=0}function Wpe(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var Hpe="__lodash_hash_undefined__",Kpe=Object.prototype,Vpe=Kpe.hasOwnProperty;function Ype(e){var t=this.__data__;if(hh){var n=t[e];return n===Hpe?void 0:n}return Vpe.call(t,e)?t[e]:void 0}var qpe=Object.prototype,Gpe=qpe.hasOwnProperty;function Xpe(e){var t=this.__data__;return hh?t[e]!==void 0:Gpe.call(t,e)}var Zpe="__lodash_hash_undefined__";function Qpe(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=hh&&t===void 0?Zpe:t,this}function tl(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}tl.prototype.clear=Upe;tl.prototype.delete=Wpe;tl.prototype.get=Ype;tl.prototype.has=Xpe;tl.prototype.set=Qpe;function Jpe(){this.__data__=[],this.size=0}function n0(e,t){return e===t||e!==e&&t!==t}function r0(e,t){for(var n=e.length;n--;)if(n0(e[n][0],t))return n;return-1}var ege=Array.prototype,tge=ege.splice;function nge(e){var t=this.__data__,n=r0(t,e);if(n<0)return!1;var r=t.length-1;return n==r?t.pop():tge.call(t,n,1),--this.size,!0}function rge(e){var t=this.__data__,n=r0(t,e);return n<0?void 0:t[n][1]}function ige(e){return r0(this.__data__,e)>-1}function oge(e,t){var n=this.__data__,r=r0(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this}function rs(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}rs.prototype.clear=Jpe;rs.prototype.delete=nge;rs.prototype.get=rge;rs.prototype.has=ige;rs.prototype.set=oge;var sge=vl(fo,"Map");const fh=sge;function age(){this.size=0,this.__data__={hash:new tl,map:new(fh||rs),string:new tl}}function lge(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function i0(e,t){var n=e.__data__;return lge(t)?n[typeof t=="string"?"string":"hash"]:n.map}function cge(e){var t=i0(this,e).delete(e);return this.size-=t?1:0,t}function uge(e){return i0(this,e).get(e)}function dge(e){return i0(this,e).has(e)}function hge(e,t){var n=i0(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this}function ha(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}ha.prototype.clear=age;ha.prototype.delete=cge;ha.prototype.get=uge;ha.prototype.has=dge;ha.prototype.set=hge;var fge="Expected a function";function Qh(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(fge);var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var s=e.apply(this,r);return n.cache=o.set(i,s)||o,s};return n.cache=new(Qh.Cache||ha),n}Qh.Cache=ha;function pge(){this.__data__=new rs,this.size=0}function gge(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}function mge(e){return this.__data__.get(e)}function yge(e){return this.__data__.has(e)}var vge=200;function xge(e,t){var n=this.__data__;if(n instanceof rs){var r=n.__data__;if(!fh||r.length<vge-1)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new ha(r)}return n.set(e,t),this.size=n.size,this}function su(e){var t=this.__data__=new rs(e);this.size=t.size}su.prototype.clear=pge;su.prototype.delete=gge;su.prototype.get=mge;su.prototype.has=yge;su.prototype.set=xge;var bge=function(){try{var e=vl(Object,"defineProperty");return e({},"",{}),e}catch{}}();const Bm=bge;function TC(e,t,n){t=="__proto__"&&Bm?Bm(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function sw(e,t,n){(n!==void 0&&!n0(e[t],n)||n===void 0&&!(t in e))&&TC(e,t,n)}function wge(e){return function(t,n,r){for(var i=-1,o=Object(t),s=r(t),a=s.length;a--;){var l=s[e?a:++i];if(n(o[l],l,o)===!1)break}return t}}var Sge=wge();const _ge=Sge;var YB=typeof exports=="object"&&exports&&!exports.nodeType&&exports,_I=YB&&typeof module=="object"&&module&&!module.nodeType&&module,Cge=_I&&_I.exports===YB,CI=Cge?fo.Buffer:void 0,EI=CI?CI.allocUnsafe:void 0;function Ege(e,t){if(t)return e.slice();var n=e.length,r=EI?EI(n):new e.constructor(n);return e.copy(r),r}var kge=fo.Uint8Array;const kI=kge;function Tge(e){var t=new e.constructor(e.byteLength);return new kI(t).set(new kI(e)),t}function Pge(e,t){var n=t?Tge(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function Ige(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}var TI=Object.create,$ge=function(){function e(){}return function(t){if(!ml(t))return{};if(TI)return TI(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();const Age=$ge;function qB(e,t){return function(n){return e(t(n))}}var Mge=qB(Object.getPrototypeOf,Object);const GB=Mge;var Oge=Object.prototype;function o0(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||Oge;return e===n}function Lge(e){return typeof e.constructor=="function"&&!o0(e)?Age(GB(e)):{}}function Jh(e){return e!=null&&typeof e=="object"}var Bge="[object Arguments]";function PI(e){return Jh(e)&&ou(e)==Bge}var XB=Object.prototype,Rge=XB.hasOwnProperty,Dge=XB.propertyIsEnumerable,Fge=PI(function(){return arguments}())?PI:function(e){return Jh(e)&&Rge.call(e,"callee")&&!Dge.call(e,"callee")};const Rm=Fge;var Nge=Array.isArray;const Dm=Nge;var jge=9007199254740991;function ZB(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=jge}function s0(e){return e!=null&&ZB(e.length)&&!kC(e)}function zge(e){return Jh(e)&&s0(e)}function Uge(){return!1}var QB=typeof exports=="object"&&exports&&!exports.nodeType&&exports,II=QB&&typeof module=="object"&&module&&!module.nodeType&&module,Wge=II&&II.exports===QB,$I=Wge?fo.Buffer:void 0,Hge=$I?$I.isBuffer:void 0,Kge=Hge||Uge;const PC=Kge;var Vge="[object Object]",Yge=Function.prototype,qge=Object.prototype,JB=Yge.toString,Gge=qge.hasOwnProperty,Xge=JB.call(Object);function Zge(e){if(!Jh(e)||ou(e)!=Vge)return!1;var t=GB(e);if(t===null)return!0;var n=Gge.call(t,"constructor")&&t.constructor;return typeof n=="function"&&n instanceof n&&JB.call(n)==Xge}var Qge="[object Arguments]",Jge="[object Array]",eme="[object Boolean]",tme="[object Date]",nme="[object Error]",rme="[object Function]",ime="[object Map]",ome="[object Number]",sme="[object Object]",ame="[object RegExp]",lme="[object Set]",cme="[object String]",ume="[object WeakMap]",dme="[object ArrayBuffer]",hme="[object DataView]",fme="[object Float32Array]",pme="[object Float64Array]",gme="[object Int8Array]",mme="[object Int16Array]",yme="[object Int32Array]",vme="[object Uint8Array]",xme="[object Uint8ClampedArray]",bme="[object Uint16Array]",wme="[object Uint32Array]",wt={};wt[fme]=wt[pme]=wt[gme]=wt[mme]=wt[yme]=wt[vme]=wt[xme]=wt[bme]=wt[wme]=!0;wt[Qge]=wt[Jge]=wt[dme]=wt[eme]=wt[hme]=wt[tme]=wt[nme]=wt[rme]=wt[ime]=wt[ome]=wt[sme]=wt[ame]=wt[lme]=wt[cme]=wt[ume]=!1;function Sme(e){return Jh(e)&&ZB(e.length)&&!!wt[ou(e)]}function _me(e){return function(t){return e(t)}}var eR=typeof exports=="object"&&exports&&!exports.nodeType&&exports,yd=eR&&typeof module=="object"&&module&&!module.nodeType&&module,Cme=yd&&yd.exports===eR,k1=Cme&&KB.process,Eme=function(){try{var e=yd&&yd.require&&yd.require("util").types;return e||k1&&k1.binding&&k1.binding("util")}catch{}}();const AI=Eme;var MI=AI&&AI.isTypedArray,kme=MI?_me(MI):Sme;const IC=kme;function aw(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}var Tme=Object.prototype,Pme=Tme.hasOwnProperty;function Ime(e,t,n){var r=e[t];(!(Pme.call(e,t)&&n0(r,n))||n===void 0&&!(t in e))&&TC(e,t,n)}function $me(e,t,n,r){var i=!n;n||(n={});for(var o=-1,s=t.length;++o<s;){var a=t[o],l=r?r(n[a],e[a],a,n,e):void 0;l===void 0&&(l=e[a]),i?TC(n,a,l):Ime(n,a,l)}return n}function Ame(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}var Mme=9007199254740991,Ome=/^(?:0|[1-9]\d*)$/;function tR(e,t){var n=typeof e;return t=t??Mme,!!t&&(n=="number"||n!="symbol"&&Ome.test(e))&&e>-1&&e%1==0&&e<t}var Lme=Object.prototype,Bme=Lme.hasOwnProperty;function Rme(e,t){var n=Dm(e),r=!n&&Rm(e),i=!n&&!r&&PC(e),o=!n&&!r&&!i&&IC(e),s=n||r||i||o,a=s?Ame(e.length,String):[],l=a.length;for(var c in e)(t||Bme.call(e,c))&&!(s&&(c=="length"||i&&(c=="offset"||c=="parent")||o&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||tR(c,l)))&&a.push(c);return a}function Dme(e){var t=[];if(e!=null)for(var n in Object(e))t.push(n);return t}var Fme=Object.prototype,Nme=Fme.hasOwnProperty;function jme(e){if(!ml(e))return Dme(e);var t=o0(e),n=[];for(var r in e)r=="constructor"&&(t||!Nme.call(e,r))||n.push(r);return n}function nR(e){return s0(e)?Rme(e,!0):jme(e)}function zme(e){return $me(e,nR(e))}function Ume(e,t,n,r,i,o,s){var a=aw(e,n),l=aw(t,n),c=s.get(l);if(c){sw(e,n,c);return}var u=o?o(a,l,n+"",e,t,s):void 0,d=u===void 0;if(d){var h=Dm(l),f=!h&&PC(l),p=!h&&!f&&IC(l);u=l,h||f||p?Dm(a)?u=a:zge(a)?u=Ige(a):f?(d=!1,u=Ege(l,!0)):p?(d=!1,u=Pge(l,!0)):u=[]:Zge(l)||Rm(l)?(u=a,Rm(a)?u=zme(a):(!ml(a)||kC(a))&&(u=Lge(l))):d=!1}d&&(s.set(l,u),i(u,l,r,o,s),s.delete(l)),sw(e,n,u)}function rR(e,t,n,r,i){e!==t&&_ge(t,function(o,s){if(i||(i=new su),ml(o))Ume(e,t,s,n,rR,r,i);else{var a=r?r(aw(e,s),o,s+"",e,t,i):void 0;a===void 0&&(a=o),sw(e,s,a)}},nR)}function iR(e){return e}function Wme(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}var OI=Math.max;function Hme(e,t,n){return t=OI(t===void 0?e.length-1:t,0),function(){for(var r=arguments,i=-1,o=OI(r.length-t,0),s=Array(o);++i<o;)s[i]=r[t+i];i=-1;for(var a=Array(t+1);++i<t;)a[i]=r[i];return a[t]=n(s),Wme(e,this,a)}}function Kme(e){return function(){return e}}var Vme=Bm?function(e,t){return Bm(e,"toString",{configurable:!0,enumerable:!1,value:Kme(t),writable:!0})}:iR;const Yme=Vme;var qme=800,Gme=16,Xme=Date.now;function Zme(e){var t=0,n=0;return function(){var r=Xme(),i=Gme-(r-n);if(n=r,i>0){if(++t>=qme)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var Qme=Zme(Yme);const Jme=Qme;function eye(e,t){return Jme(Hme(e,t,iR),e+"")}function tye(e,t,n){if(!ml(n))return!1;var r=typeof t;return(r=="number"?s0(n)&&tR(t,n.length):r=="string"&&t in n)?n0(n[t],e):!1}function nye(e){return eye(function(t,n){var r=-1,i=n.length,o=i>1?n[i-1]:void 0,s=i>2?n[2]:void 0;for(o=e.length>3&&typeof o=="function"?(i--,o):void 0,s&&tye(n[0],n[1],s)&&(o=i<3?void 0:o,i=1),t=Object(t);++r<i;){var a=n[r];a&&e(t,a,r,o)}return t})}var rye=nye(function(e,t,n){rR(e,t,n)});const iye=rye;var oR="comm",sR="rule",aR="decl",oye="@import",sye="@keyframes",aye="@layer",lye=Math.abs,$C=String.fromCharCode;function lR(e){return e.trim()}function pg(e,t,n){return e.replace(t,n)}function cye(e,t){return e.indexOf(t)}function ph(e,t){return e.charCodeAt(t)|0}function gh(e,t,n){return e.slice(t,n)}function Eo(e){return e.length}function uye(e){return e.length}function wp(e,t){return t.push(e),e}var a0=1,Rc=1,cR=0,ui=0,Yt=0,au="";function AC(e,t,n,r,i,o,s,a){return{value:e,root:t,parent:n,type:r,props:i,children:o,line:a0,column:Rc,length:s,return:"",siblings:a}}function dye(){return Yt}function hye(){return Yt=ui>0?ph(au,--ui):0,Rc--,Yt===10&&(Rc=1,a0--),Yt}function Oi(){return Yt=ui<cR?ph(au,ui++):0,Rc++,Yt===10&&(Rc=1,a0++),Yt}function Ua(){return ph(au,ui)}function gg(){return ui}function l0(e,t){return gh(au,e,t)}function lw(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function fye(e){return a0=Rc=1,cR=Eo(au=e),ui=0,[]}function pye(e){return au="",e}function T1(e){return lR(l0(ui-1,cw(e===91?e+2:e===40?e+1:e)))}function gye(e){for(;(Yt=Ua())&&Yt<33;)Oi();return lw(e)>2||lw(Yt)>3?"":" "}function mye(e,t){for(;--t&&Oi()&&!(Yt<48||Yt>102||Yt>57&&Yt<65||Yt>70&&Yt<97););return l0(e,gg()+(t<6&&Ua()==32&&Oi()==32))}function cw(e){for(;Oi();)switch(Yt){case e:return ui;case 34:case 39:e!==34&&e!==39&&cw(Yt);break;case 40:e===41&&cw(e);break;case 92:Oi();break}return ui}function yye(e,t){for(;Oi()&&e+Yt!==47+10;)if(e+Yt===42+42&&Ua()===47)break;return"/*"+l0(t,ui-1)+"*"+$C(e===47?e:Oi())}function vye(e){for(;!lw(Ua());)Oi();return l0(e,ui)}function xye(e){return pye(mg("",null,null,null,[""],e=fye(e),0,[0],e))}function mg(e,t,n,r,i,o,s,a,l){for(var c=0,u=0,d=s,h=0,f=0,p=0,g=1,y=1,x=1,w=0,_="",S=i,T=o,P=r,I=_;y;)switch(p=w,w=Oi()){case 40:if(p!=108&&ph(I,d-1)==58){cye(I+=pg(T1(w),"&","&\f"),"&\f")!=-1&&(x=-1);break}case 34:case 39:case 91:I+=T1(w);break;case 9:case 10:case 13:case 32:I+=gye(p);break;case 92:I+=mye(gg()-1,7);continue;case 47:switch(Ua()){case 42:case 47:wp(bye(yye(Oi(),gg()),t,n,l),l);break;default:I+="/"}break;case 123*g:a[c++]=Eo(I)*x;case 125*g:case 59:case 0:switch(w){case 0:case 125:y=0;case 59+u:x==-1&&(I=pg(I,/\f/g,"")),f>0&&Eo(I)-d&&wp(f>32?BI(I+";",r,n,d-1,l):BI(pg(I," ","")+";",r,n,d-2,l),l);break;case 59:I+=";";default:if(wp(P=LI(I,t,n,c,u,i,a,_,S=[],T=[],d,o),o),w===123)if(u===0)mg(I,t,P,P,S,o,d,a,T);else switch(h===99&&ph(I,3)===110?100:h){case 100:case 108:case 109:case 115:mg(e,P,P,r&&wp(LI(e,P,P,0,0,i,a,_,i,S=[],d,T),T),i,T,d,a,r?S:T);break;default:mg(I,P,P,P,[""],T,0,a,T)}}c=u=f=0,g=x=1,_=I="",d=s;break;case 58:d=1+Eo(I),f=p;default:if(g<1){if(w==123)--g;else if(w==125&&g++==0&&hye()==125)continue}switch(I+=$C(w),w*g){case 38:x=u>0?1:(I+="\f",-1);break;case 44:a[c++]=(Eo(I)-1)*x,x=1;break;case 64:Ua()===45&&(I+=T1(Oi())),h=Ua(),u=d=Eo(_=I+=vye(gg())),w++;break;case 45:p===45&&Eo(I)==2&&(g=0)}}return o}function LI(e,t,n,r,i,o,s,a,l,c,u,d){for(var h=i-1,f=i===0?o:[""],p=uye(f),g=0,y=0,x=0;g<r;++g)for(var w=0,_=gh(e,h+1,h=lye(y=s[g])),S=e;w<p;++w)(S=lR(y>0?f[w]+" "+_:pg(_,/&\f/g,f[w])))&&(l[x++]=S);return AC(e,t,n,i===0?sR:a,l,c,u,d)}function bye(e,t,n,r){return AC(e,t,n,oR,$C(dye()),gh(e,2,-2),0,r)}function BI(e,t,n,r,i){return AC(e,t,n,aR,gh(e,0,r),gh(e,r+1,-1),r,i)}function uw(e,t){for(var n="",r=0;r<e.length;r++)n+=t(e[r],r,e,t)||"";return n}function wye(e,t,n,r){switch(e.type){case aye:if(e.children.length)break;case oye:case aR:return e.return=e.return||e.value;case oR:return"";case sye:return e.return=e.value+"{"+uw(e.children,r)+"}";case sR:if(!Eo(e.value=e.props.join(",")))return""}return Eo(n=uw(e.children,r))?e.return=e.value+"{"+n+"}":""}var Sye=qB(Object.keys,Object);const _ye=Sye;var Cye=Object.prototype,Eye=Cye.hasOwnProperty;function kye(e){if(!o0(e))return _ye(e);var t=[];for(var n in Object(e))Eye.call(e,n)&&n!="constructor"&&t.push(n);return t}var Tye=vl(fo,"DataView");const dw=Tye;var Pye=vl(fo,"Promise");const hw=Pye;var Iye=vl(fo,"Set");const fw=Iye;var $ye=vl(fo,"WeakMap");const pw=$ye;var RI="[object Map]",Aye="[object Object]",DI="[object Promise]",FI="[object Set]",NI="[object WeakMap]",jI="[object DataView]",Mye=yl(dw),Oye=yl(fh),Lye=yl(hw),Bye=yl(fw),Rye=yl(pw),ka=ou;(dw&&ka(new dw(new ArrayBuffer(1)))!=jI||fh&&ka(new fh)!=RI||hw&&ka(hw.resolve())!=DI||fw&&ka(new fw)!=FI||pw&&ka(new pw)!=NI)&&(ka=function(e){var t=ou(e),n=t==Aye?e.constructor:void 0,r=n?yl(n):"";if(r)switch(r){case Mye:return jI;case Oye:return RI;case Lye:return DI;case Bye:return FI;case Rye:return NI}return t});const Dye=ka;var Fye="[object Map]",Nye="[object Set]",jye=Object.prototype,zye=jye.hasOwnProperty;function P1(e){if(e==null)return!0;if(s0(e)&&(Dm(e)||typeof e=="string"||typeof e.splice=="function"||PC(e)||IC(e)||Rm(e)))return!e.length;var t=Dye(e);if(t==Fye||t==Nye)return!e.size;if(o0(e))return!kye(e).length;for(var n in e)if(zye.call(e,n))return!1;return!0}const xo={trace:0,debug:1,info:2,warn:3,error:4,fatal:5},xe={trace:(...e)=>{},debug:(...e)=>{},info:(...e)=>{},warn:(...e)=>{},error:(...e)=>{},fatal:(...e)=>{}},MC=function(e="fatal"){let t=xo.fatal;typeof e=="string"?(e=e.toLowerCase(),e in xo&&(t=xo[e])):typeof e=="number"&&(t=e),xe.trace=()=>{},xe.debug=()=>{},xe.info=()=>{},xe.warn=()=>{},xe.error=()=>{},xe.fatal=()=>{},t<=xo.fatal&&(xe.fatal=console.error?console.error.bind(console,Hr("FATAL"),"color: orange"):console.log.bind(console,"\x1B[35m",Hr("FATAL"))),t<=xo.error&&(xe.error=console.error?console.error.bind(console,Hr("ERROR"),"color: orange"):console.log.bind(console,"\x1B[31m",Hr("ERROR"))),t<=xo.warn&&(xe.warn=console.warn?console.warn.bind(console,Hr("WARN"),"color: orange"):console.log.bind(console,"\x1B[33m",Hr("WARN"))),t<=xo.info&&(xe.info=console.info?console.info.bind(console,Hr("INFO"),"color: lightblue"):console.log.bind(console,"\x1B[34m",Hr("INFO"))),t<=xo.debug&&(xe.debug=console.debug?console.debug.bind(console,Hr("DEBUG"),"color: lightgreen"):console.log.bind(console,"\x1B[32m",Hr("DEBUG"))),t<=xo.trace&&(xe.trace=console.debug?console.debug.bind(console,Hr("TRACE"),"color: lightgreen"):console.log.bind(console,"\x1B[32m",Hr("TRACE")))},Hr=e=>`%c${Nce().format("ss.SSS")} : ${e} : `,c0=/<br\s*\/?>/gi,Uye=e=>e?dR(e).replace(/\\n/g,"#br#").split("#br#"):[""],uR=e=>Om.sanitize(e),zI=(e,t)=>{var n;if(((n=t.flowchart)==null?void 0:n.htmlLabels)!==!1){const r=t.securityLevel;r==="antiscript"||r==="strict"?e=uR(e):r!=="loose"&&(e=dR(e),e=e.replace(/</g,"&lt;").replace(/>/g,"&gt;"),e=e.replace(/=/g,"&equals;"),e=Vye(e))}return e},mh=(e,t)=>e&&(t.dompurifyConfig?e=Om.sanitize(zI(e,t),t.dompurifyConfig).toString():e=Om.sanitize(zI(e,t),{FORBID_TAGS:["style"]}).toString(),e),Wye=(e,t)=>typeof e=="string"?mh(e,t):e.flat().map(n=>mh(n,t)),Hye=e=>c0.test(e),Kye=e=>e.split(c0),Vye=e=>e.replace(/#br#/g,"<br/>"),dR=e=>e.replace(c0,"#br#"),Yye=e=>{let t="";return e&&(t=window.location.protocol+"//"+window.location.host+window.location.pathname+window.location.search,t=t.replaceAll(/\(/g,"\\("),t=t.replaceAll(/\)/g,"\\)")),t},hR=e=>!(e===!1||["false","null","0"].includes(String(e).trim().toLowerCase())),qye=function(...e){const t=e.filter(n=>!isNaN(n));return Math.max(...t)},Gye=function(...e){const t=e.filter(n=>!isNaN(n));return Math.min(...t)},Xye=function(e){let t=e;if(e.split("~").length-1>=2){let n=t;do t=n,n=t.replace(/~([^\s,:;]+)~/,"<$1>");while(n!=t);return Xye(n)}else return t},OC={getRows:Uye,sanitizeText:mh,sanitizeTextOrArray:Wye,hasBreaks:Hye,splitBreaks:Kye,lineBreakRegex:c0,removeScript:uR,getUrl:Yye,evaluate:hR,getMax:qye,getMin:Gye},Yn=(e,t)=>t?V(e,{s:-40,l:10}):V(e,{s:-40,l:-10}),u0="#ffffff",d0="#f2f2f2";let Zye=class{constructor(){this.background="#f4f4f4",this.primaryColor="#fff4dd",this.noteBkgColor="#fff5ad",this.noteTextColor="#333",this.THEME_COLOR_LIMIT=12,this.fontFamily='"trebuchet ms", verdana, arial, sans-serif',this.fontSize="16px"}updateColors(){if(this.primaryTextColor=this.primaryTextColor||(this.darkMode?"#eee":"#333"),this.secondaryColor=this.secondaryColor||V(this.primaryColor,{h:-120}),this.tertiaryColor=this.tertiaryColor||V(this.primaryColor,{h:180,l:5}),this.primaryBorderColor=this.primaryBorderColor||Yn(this.primaryColor,this.darkMode),this.secondaryBorderColor=this.secondaryBorderColor||Yn(this.secondaryColor,this.darkMode),this.tertiaryBorderColor=this.tertiaryBorderColor||Yn(this.tertiaryColor,this.darkMode),this.noteBorderColor=this.noteBorderColor||Yn(this.noteBkgColor,this.darkMode),this.noteBkgColor=this.noteBkgColor||"#fff5ad",this.noteTextColor=this.noteTextColor||"#333",this.secondaryTextColor=this.secondaryTextColor||le(this.secondaryColor),this.tertiaryTextColor=this.tertiaryTextColor||le(this.tertiaryColor),this.lineColor=this.lineColor||le(this.background),this.arrowheadColor=this.arrowheadColor||le(this.background),this.textColor=this.textColor||this.primaryTextColor,this.border2=this.border2||this.tertiaryBorderColor,this.nodeBkg=this.nodeBkg||this.primaryColor,this.mainBkg=this.mainBkg||this.primaryColor,this.nodeBorder=this.nodeBorder||this.primaryBorderColor,this.clusterBkg=this.clusterBkg||this.tertiaryColor,this.clusterBorder=this.clusterBorder||this.tertiaryBorderColor,this.defaultLinkColor=this.defaultLinkColor||this.lineColor,this.titleColor=this.titleColor||this.tertiaryTextColor,this.edgeLabelBackground=this.edgeLabelBackground||(this.darkMode?Pe(this.secondaryColor,30):this.secondaryColor),this.nodeTextColor=this.nodeTextColor||this.primaryTextColor,this.actorBorder=this.actorBorder||this.primaryBorderColor,this.actorBkg=this.actorBkg||this.mainBkg,this.actorTextColor=this.actorTextColor||this.primaryTextColor,this.actorLineColor=this.actorLineColor||"grey",this.labelBoxBkgColor=this.labelBoxBkgColor||this.actorBkg,this.signalColor=this.signalColor||this.textColor,this.signalTextColor=this.signalTextColor||this.textColor,this.labelBoxBorderColor=this.labelBoxBorderColor||this.actorBorder,this.labelTextColor=this.labelTextColor||this.actorTextColor,this.loopTextColor=this.loopTextColor||this.actorTextColor,this.activationBorderColor=this.activationBorderColor||Pe(this.secondaryColor,10),this.activationBkgColor=this.activationBkgColor||this.secondaryColor,this.sequenceNumberColor=this.sequenceNumberColor||le(this.lineColor),this.sectionBkgColor=this.sectionBkgColor||this.tertiaryColor,this.altSectionBkgColor=this.altSectionBkgColor||"white",this.sectionBkgColor=this.sectionBkgColor||this.secondaryColor,this.sectionBkgColor2=this.sectionBkgColor2||this.primaryColor,this.excludeBkgColor=this.excludeBkgColor||"#eeeeee",this.taskBorderColor=this.taskBorderColor||this.primaryBorderColor,this.taskBkgColor=this.taskBkgColor||this.primaryColor,this.activeTaskBorderColor=this.activeTaskBorderColor||this.primaryColor,this.activeTaskBkgColor=this.activeTaskBkgColor||Se(this.primaryColor,23),this.gridColor=this.gridColor||"lightgrey",this.doneTaskBkgColor=this.doneTaskBkgColor||"lightgrey",this.doneTaskBorderColor=this.doneTaskBorderColor||"grey",this.critBorderColor=this.critBorderColor||"#ff8888",this.critBkgColor=this.critBkgColor||"red",this.todayLineColor=this.todayLineColor||"red",this.taskTextColor=this.taskTextColor||this.textColor,this.taskTextOutsideColor=this.taskTextOutsideColor||this.textColor,this.taskTextLightColor=this.taskTextLightColor||this.textColor,this.taskTextColor=this.taskTextColor||this.primaryTextColor,this.taskTextDarkColor=this.taskTextDarkColor||this.textColor,this.taskTextClickableColor=this.taskTextClickableColor||"#003163",this.personBorder=this.personBorder||this.primaryBorderColor,this.personBkg=this.personBkg||this.mainBkg,this.transitionColor=this.transitionColor||this.lineColor,this.transitionLabelColor=this.transitionLabelColor||this.textColor,this.stateLabelColor=this.stateLabelColor||this.stateBkg||this.primaryTextColor,this.stateBkg=this.stateBkg||this.mainBkg,this.labelBackgroundColor=this.labelBackgroundColor||this.stateBkg,this.compositeBackground=this.compositeBackground||this.background||this.tertiaryColor,this.altBackground=this.altBackground||this.tertiaryColor,this.compositeTitleBackground=this.compositeTitleBackground||this.mainBkg,this.compositeBorder=this.compositeBorder||this.nodeBorder,this.innerEndBackground=this.nodeBorder,this.errorBkgColor=this.errorBkgColor||this.tertiaryColor,this.errorTextColor=this.errorTextColor||this.tertiaryTextColor,this.transitionColor=this.transitionColor||this.lineColor,this.specialStateColor=this.lineColor,this.cScale0=this.cScale0||this.primaryColor,this.cScale1=this.cScale1||this.secondaryColor,this.cScale2=this.cScale2||this.tertiaryColor,this.cScale3=this.cScale3||V(this.primaryColor,{h:30}),this.cScale4=this.cScale4||V(this.primaryColor,{h:60}),this.cScale5=this.cScale5||V(this.primaryColor,{h:90}),this.cScale6=this.cScale6||V(this.primaryColor,{h:120}),this.cScale7=this.cScale7||V(this.primaryColor,{h:150}),this.cScale8=this.cScale8||V(this.primaryColor,{h:210,l:150}),this.cScale9=this.cScale9||V(this.primaryColor,{h:270}),this.cScale10=this.cScale10||V(this.primaryColor,{h:300}),this.cScale11=this.cScale11||V(this.primaryColor,{h:330}),this.darkMode)for(let n=0;n<this.THEME_COLOR_LIMIT;n++)this["cScale"+n]=Pe(this["cScale"+n],75);else for(let n=0;n<this.THEME_COLOR_LIMIT;n++)this["cScale"+n]=Pe(this["cScale"+n],25);for(let n=0;n<this.THEME_COLOR_LIMIT;n++)this["cScaleInv"+n]=this["cScaleInv"+n]||le(this["cScale"+n]);for(let n=0;n<this.THEME_COLOR_LIMIT;n++)this.darkMode?this["cScalePeer"+n]=this["cScalePeer"+n]||Se(this["cScale"+n],10):this["cScalePeer"+n]=this["cScalePeer"+n]||Pe(this["cScale"+n],10);this.scaleLabelColor=this.scaleLabelColor||this.labelTextColor;for(let n=0;n<this.THEME_COLOR_LIMIT;n++)this["cScaleLabel"+n]=this["cScaleLabel"+n]||this.scaleLabelColor;const t=this.darkMode?-4:-1;for(let n=0;n<5;n++)this["surface"+n]=this["surface"+n]||V(this.mainBkg,{h:180,s:-15,l:t*(5+n*3)}),this["surfacePeer"+n]=this["surfacePeer"+n]||V(this.mainBkg,{h:180,s:-15,l:t*(8+n*3)});this.classText=this.classText||this.textColor,this.fillType0=this.fillType0||this.primaryColor,this.fillType1=this.fillType1||this.secondaryColor,this.fillType2=this.fillType2||V(this.primaryColor,{h:64}),this.fillType3=this.fillType3||V(this.secondaryColor,{h:64}),this.fillType4=this.fillType4||V(this.primaryColor,{h:-64}),this.fillType5=this.fillType5||V(this.secondaryColor,{h:-64}),this.fillType6=this.fillType6||V(this.primaryColor,{h:128}),this.fillType7=this.fillType7||V(this.secondaryColor,{h:128}),this.pie1=this.pie1||this.primaryColor,this.pie2=this.pie2||this.secondaryColor,this.pie3=this.pie3||this.tertiaryColor,this.pie4=this.pie4||V(this.primaryColor,{l:-10}),this.pie5=this.pie5||V(this.secondaryColor,{l:-10}),this.pie6=this.pie6||V(this.tertiaryColor,{l:-10}),this.pie7=this.pie7||V(this.primaryColor,{h:60,l:-10}),this.pie8=this.pie8||V(this.primaryColor,{h:-60,l:-10}),this.pie9=this.pie9||V(this.primaryColor,{h:120,l:0}),this.pie10=this.pie10||V(this.primaryColor,{h:60,l:-20}),this.pie11=this.pie11||V(this.primaryColor,{h:-60,l:-20}),this.pie12=this.pie12||V(this.primaryColor,{h:120,l:-10}),this.pieTitleTextSize=this.pieTitleTextSize||"25px",this.pieTitleTextColor=this.pieTitleTextColor||this.taskTextDarkColor,this.pieSectionTextSize=this.pieSectionTextSize||"17px",this.pieSectionTextColor=this.pieSectionTextColor||this.textColor,this.pieLegendTextSize=this.pieLegendTextSize||"17px",this.pieLegendTextColor=this.pieLegendTextColor||this.taskTextDarkColor,this.pieStrokeColor=this.pieStrokeColor||"black",this.pieStrokeWidth=this.pieStrokeWidth||"2px",this.pieOuterStrokeWidth=this.pieOuterStrokeWidth||"2px",this.pieOuterStrokeColor=this.pieOuterStrokeColor||"black",this.pieOpacity=this.pieOpacity||"0.7",this.quadrant1Fill=this.quadrant1Fill||this.primaryColor,this.quadrant2Fill=this.quadrant2Fill||V(this.primaryColor,{r:5,g:5,b:5}),this.quadrant3Fill=this.quadrant3Fill||V(this.primaryColor,{r:10,g:10,b:10}),this.quadrant4Fill=this.quadrant4Fill||V(this.primaryColor,{r:15,g:15,b:15}),this.quadrant1TextFill=this.quadrant1TextFill||this.primaryTextColor,this.quadrant2TextFill=this.quadrant2TextFill||V(this.primaryTextColor,{r:-5,g:-5,b:-5}),this.quadrant3TextFill=this.quadrant3TextFill||V(this.primaryTextColor,{r:-10,g:-10,b:-10}),this.quadrant4TextFill=this.quadrant4TextFill||V(this.primaryTextColor,{r:-15,g:-15,b:-15}),this.quadrantPointFill=this.quadrantPointFill||Zh(this.quadrant1Fill)?Se(this.quadrant1Fill):Pe(this.quadrant1Fill),this.quadrantPointTextFill=this.quadrantPointTextFill||this.primaryTextColor,this.quadrantXAxisTextFill=this.quadrantXAxisTextFill||this.primaryTextColor,this.quadrantYAxisTextFill=this.quadrantYAxisTextFill||this.primaryTextColor,this.quadrantInternalBorderStrokeFill=this.quadrantInternalBorderStrokeFill||this.primaryBorderColor,this.quadrantExternalBorderStrokeFill=this.quadrantExternalBorderStrokeFill||this.primaryBorderColor,this.quadrantTitleFill=this.quadrantTitleFill||this.primaryTextColor,this.requirementBackground=this.requirementBackground||this.primaryColor,this.requirementBorderColor=this.requirementBorderColor||this.primaryBorderColor,this.requirementBorderSize=this.requirementBorderSize||"1",this.requirementTextColor=this.requirementTextColor||this.primaryTextColor,this.relationColor=this.relationColor||this.lineColor,this.relationLabelBackground=this.relationLabelBackground||(this.darkMode?Pe(this.secondaryColor,30):this.secondaryColor),this.relationLabelColor=this.relationLabelColor||this.actorTextColor,this.git0=this.git0||this.primaryColor,this.git1=this.git1||this.secondaryColor,this.git2=this.git2||this.tertiaryColor,this.git3=this.git3||V(this.primaryColor,{h:-30}),this.git4=this.git4||V(this.primaryColor,{h:-60}),this.git5=this.git5||V(this.primaryColor,{h:-90}),this.git6=this.git6||V(this.primaryColor,{h:60}),this.git7=this.git7||V(this.primaryColor,{h:120}),this.darkMode?(this.git0=Se(this.git0,25),this.git1=Se(this.git1,25),this.git2=Se(this.git2,25),this.git3=Se(this.git3,25),this.git4=Se(this.git4,25),this.git5=Se(this.git5,25),this.git6=Se(this.git6,25),this.git7=Se(this.git7,25)):(this.git0=Pe(this.git0,25),this.git1=Pe(this.git1,25),this.git2=Pe(this.git2,25),this.git3=Pe(this.git3,25),this.git4=Pe(this.git4,25),this.git5=Pe(this.git5,25),this.git6=Pe(this.git6,25),this.git7=Pe(this.git7,25)),this.gitInv0=this.gitInv0||le(this.git0),this.gitInv1=this.gitInv1||le(this.git1),this.gitInv2=this.gitInv2||le(this.git2),this.gitInv3=this.gitInv3||le(this.git3),this.gitInv4=this.gitInv4||le(this.git4),this.gitInv5=this.gitInv5||le(this.git5),this.gitInv6=this.gitInv6||le(this.git6),this.gitInv7=this.gitInv7||le(this.git7),this.branchLabelColor=this.branchLabelColor||(this.darkMode?"black":this.labelTextColor),this.gitBranchLabel0=this.gitBranchLabel0||this.branchLabelColor,this.gitBranchLabel1=this.gitBranchLabel1||this.branchLabelColor,this.gitBranchLabel2=this.gitBranchLabel2||this.branchLabelColor,this.gitBranchLabel3=this.gitBranchLabel3||this.branchLabelColor,this.gitBranchLabel4=this.gitBranchLabel4||this.branchLabelColor,this.gitBranchLabel5=this.gitBranchLabel5||this.branchLabelColor,this.gitBranchLabel6=this.gitBranchLabel6||this.branchLabelColor,this.gitBranchLabel7=this.gitBranchLabel7||this.branchLabelColor,this.tagLabelColor=this.tagLabelColor||this.primaryTextColor,this.tagLabelBackground=this.tagLabelBackground||this.primaryColor,this.tagLabelBorder=this.tagBorder||this.primaryBorderColor,this.tagLabelFontSize=this.tagLabelFontSize||"10px",this.commitLabelColor=this.commitLabelColor||this.secondaryTextColor,this.commitLabelBackground=this.commitLabelBackground||this.secondaryColor,this.commitLabelFontSize=this.commitLabelFontSize||"10px",this.attributeBackgroundColorOdd=this.attributeBackgroundColorOdd||u0,this.attributeBackgroundColorEven=this.attributeBackgroundColorEven||d0}calculate(t){if(typeof t!="object"){this.updateColors();return}const n=Object.keys(t);n.forEach(r=>{this[r]=t[r]}),this.updateColors(),n.forEach(r=>{this[r]=t[r]})}};const Qye=e=>{const t=new Zye;return t.calculate(e),t};let Jye=class{constructor(){this.background="#333",this.primaryColor="#1f2020",this.secondaryColor=Se(this.primaryColor,16),this.tertiaryColor=V(this.primaryColor,{h:-160}),this.primaryBorderColor=le(this.background),this.secondaryBorderColor=Yn(this.secondaryColor,this.darkMode),this.tertiaryBorderColor=Yn(this.tertiaryColor,this.darkMode),this.primaryTextColor=le(this.primaryColor),this.secondaryTextColor=le(this.secondaryColor),this.tertiaryTextColor=le(this.tertiaryColor),this.lineColor=le(this.background),this.textColor=le(this.background),this.mainBkg="#1f2020",this.secondBkg="calculated",this.mainContrastColor="lightgrey",this.darkTextColor=Se(le("#323D47"),10),this.lineColor="calculated",this.border1="#81B1DB",this.border2=md(255,255,255,.25),this.arrowheadColor="calculated",this.fontFamily='"trebuchet ms", verdana, arial, sans-serif',this.fontSize="16px",this.labelBackground="#181818",this.textColor="#ccc",this.THEME_COLOR_LIMIT=12,this.nodeBkg="calculated",this.nodeBorder="calculated",this.clusterBkg="calculated",this.clusterBorder="calculated",this.defaultLinkColor="calculated",this.titleColor="#F9FFFE",this.edgeLabelBackground="calculated",this.actorBorder="calculated",this.actorBkg="calculated",this.actorTextColor="calculated",this.actorLineColor="calculated",this.signalColor="calculated",this.signalTextColor="calculated",this.labelBoxBkgColor="calculated",this.labelBoxBorderColor="calculated",this.labelTextColor="calculated",this.loopTextColor="calculated",this.noteBorderColor="calculated",this.noteBkgColor="#fff5ad",this.noteTextColor="calculated",this.activationBorderColor="calculated",this.activationBkgColor="calculated",this.sequenceNumberColor="black",this.sectionBkgColor=Pe("#EAE8D9",30),this.altSectionBkgColor="calculated",this.sectionBkgColor2="#EAE8D9",this.excludeBkgColor=Pe(this.sectionBkgColor,10),this.taskBorderColor=md(255,255,255,70),this.taskBkgColor="calculated",this.taskTextColor="calculated",this.taskTextLightColor="calculated",this.taskTextOutsideColor="calculated",this.taskTextClickableColor="#003163",this.activeTaskBorderColor=md(255,255,255,50),this.activeTaskBkgColor="#81B1DB",this.gridColor="calculated",this.doneTaskBkgColor="calculated",this.doneTaskBorderColor="grey",this.critBorderColor="#E83737",this.critBkgColor="#E83737",this.taskTextDarkColor="calculated",this.todayLineColor="#DB5757",this.personBorder=this.primaryBorderColor,this.personBkg=this.mainBkg,this.labelColor="calculated",this.errorBkgColor="#a44141",this.errorTextColor="#ddd"}updateColors(){this.secondBkg=Se(this.mainBkg,16),this.lineColor=this.mainContrastColor,this.arrowheadColor=this.mainContrastColor,this.nodeBkg=this.mainBkg,this.nodeBorder=this.border1,this.clusterBkg=this.secondBkg,this.clusterBorder=this.border2,this.defaultLinkColor=this.lineColor,this.edgeLabelBackground=Se(this.labelBackground,25),this.actorBorder=this.border1,this.actorBkg=this.mainBkg,this.actorTextColor=this.mainContrastColor,this.actorLineColor=this.mainContrastColor,this.signalColor=this.mainContrastColor,this.signalTextColor=this.mainContrastColor,this.labelBoxBkgColor=this.actorBkg,this.labelBoxBorderColor=this.actorBorder,this.labelTextColor=this.mainContrastColor,this.loopTextColor=this.mainContrastColor,this.noteBorderColor=this.secondaryBorderColor,this.noteBkgColor=this.secondBkg,this.noteTextColor=this.secondaryTextColor,this.activationBorderColor=this.border1,this.activationBkgColor=this.secondBkg,this.altSectionBkgColor=this.background,this.taskBkgColor=Se(this.mainBkg,23),this.taskTextColor=this.darkTextColor,this.taskTextLightColor=this.mainContrastColor,this.taskTextOutsideColor=this.taskTextLightColor,this.gridColor=this.mainContrastColor,this.doneTaskBkgColor=this.mainContrastColor,this.taskTextDarkColor=this.darkTextColor,this.transitionColor=this.transitionColor||this.lineColor,this.transitionLabelColor=this.transitionLabelColor||this.textColor,this.stateLabelColor=this.stateLabelColor||this.stateBkg||this.primaryTextColor,this.stateBkg=this.stateBkg||this.mainBkg,this.labelBackgroundColor=this.labelBackgroundColor||this.stateBkg,this.compositeBackground=this.compositeBackground||this.background||this.tertiaryColor,this.altBackground=this.altBackground||"#555",this.compositeTitleBackground=this.compositeTitleBackground||this.mainBkg,this.compositeBorder=this.compositeBorder||this.nodeBorder,this.innerEndBackground=this.primaryBorderColor,this.specialStateColor="#f4f4f4",this.errorBkgColor=this.errorBkgColor||this.tertiaryColor,this.errorTextColor=this.errorTextColor||this.tertiaryTextColor,this.fillType0=this.primaryColor,this.fillType1=this.secondaryColor,this.fillType2=V(this.primaryColor,{h:64}),this.fillType3=V(this.secondaryColor,{h:64}),this.fillType4=V(this.primaryColor,{h:-64}),this.fillType5=V(this.secondaryColor,{h:-64}),this.fillType6=V(this.primaryColor,{h:128}),this.fillType7=V(this.secondaryColor,{h:128}),this.cScale1=this.cScale1||"#0b0000",this.cScale2=this.cScale2||"#4d1037",this.cScale3=this.cScale3||"#3f5258",this.cScale4=this.cScale4||"#4f2f1b",this.cScale5=this.cScale5||"#6e0a0a",this.cScale6=this.cScale6||"#3b0048",this.cScale7=this.cScale7||"#995a01",this.cScale8=this.cScale8||"#154706",this.cScale9=this.cScale9||"#161722",this.cScale10=this.cScale10||"#00296f",this.cScale11=this.cScale11||"#01629c",this.cScale12=this.cScale12||"#010029",this.cScale0=this.cScale0||this.primaryColor,this.cScale1=this.cScale1||this.secondaryColor,this.cScale2=this.cScale2||this.tertiaryColor,this.cScale3=this.cScale3||V(this.primaryColor,{h:30}),this.cScale4=this.cScale4||V(this.primaryColor,{h:60}),this.cScale5=this.cScale5||V(this.primaryColor,{h:90}),this.cScale6=this.cScale6||V(this.primaryColor,{h:120}),this.cScale7=this.cScale7||V(this.primaryColor,{h:150}),this.cScale8=this.cScale8||V(this.primaryColor,{h:210}),this.cScale9=this.cScale9||V(this.primaryColor,{h:270}),this.cScale10=this.cScale10||V(this.primaryColor,{h:300}),this.cScale11=this.cScale11||V(this.primaryColor,{h:330});for(let t=0;t<this.THEME_COLOR_LIMIT;t++)this["cScaleInv"+t]=this["cScaleInv"+t]||le(this["cScale"+t]);for(let t=0;t<this.THEME_COLOR_LIMIT;t++)this["cScalePeer"+t]=this["cScalePeer"+t]||Se(this["cScale"+t],10);for(let t=0;t<5;t++)this["surface"+t]=this["surface"+t]||V(this.mainBkg,{h:30,s:-30,l:-(-10+t*4)}),this["surfacePeer"+t]=this["surfacePeer"+t]||V(this.mainBkg,{h:30,s:-30,l:-(-7+t*4)});this.scaleLabelColor=this.scaleLabelColor||(this.darkMode?"black":this.labelTextColor);for(let t=0;t<this.THEME_COLOR_LIMIT;t++)this["cScaleLabel"+t]=this["cScaleLabel"+t]||this.scaleLabelColor;for(let t=0;t<this.THEME_COLOR_LIMIT;t++)this["pie"+t]=this["cScale"+t];this.pieTitleTextSize=this.pieTitleTextSize||"25px",this.pieTitleTextColor=this.pieTitleTextColor||this.taskTextDarkColor,this.pieSectionTextSize=this.pieSectionTextSize||"17px",this.pieSectionTextColor=this.pieSectionTextColor||this.textColor,this.pieLegendTextSize=this.pieLegendTextSize||"17px",this.pieLegendTextColor=this.pieLegendTextColor||this.taskTextDarkColor,this.pieStrokeColor=this.pieStrokeColor||"black",this.pieStrokeWidth=this.pieStrokeWidth||"2px",this.pieOuterStrokeWidth=this.pieOuterStrokeWidth||"2px",this.pieOuterStrokeColor=this.pieOuterStrokeColor||"black",this.pieOpacity=this.pieOpacity||"0.7",this.quadrant1Fill=this.quadrant1Fill||this.primaryColor,this.quadrant2Fill=this.quadrant2Fill||V(this.primaryColor,{r:5,g:5,b:5}),this.quadrant3Fill=this.quadrant3Fill||V(this.primaryColor,{r:10,g:10,b:10}),this.quadrant4Fill=this.quadrant4Fill||V(this.primaryColor,{r:15,g:15,b:15}),this.quadrant1TextFill=this.quadrant1TextFill||this.primaryTextColor,this.quadrant2TextFill=this.quadrant2TextFill||V(this.primaryTextColor,{r:-5,g:-5,b:-5}),this.quadrant3TextFill=this.quadrant3TextFill||V(this.primaryTextColor,{r:-10,g:-10,b:-10}),this.quadrant4TextFill=this.quadrant4TextFill||V(this.primaryTextColor,{r:-15,g:-15,b:-15}),this.quadrantPointFill=this.quadrantPointFill||Zh(this.quadrant1Fill)?Se(this.quadrant1Fill):Pe(this.quadrant1Fill),this.quadrantPointTextFill=this.quadrantPointTextFill||this.primaryTextColor,this.quadrantXAxisTextFill=this.quadrantXAxisTextFill||this.primaryTextColor,this.quadrantYAxisTextFill=this.quadrantYAxisTextFill||this.primaryTextColor,this.quadrantInternalBorderStrokeFill=this.quadrantInternalBorderStrokeFill||this.primaryBorderColor,this.quadrantExternalBorderStrokeFill=this.quadrantExternalBorderStrokeFill||this.primaryBorderColor,this.quadrantTitleFill=this.quadrantTitleFill||this.primaryTextColor,this.classText=this.primaryTextColor,this.requirementBackground=this.requirementBackground||this.primaryColor,this.requirementBorderColor=this.requirementBorderColor||this.primaryBorderColor,this.requirementBorderSize=this.requirementBorderSize||"1",this.requirementTextColor=this.requirementTextColor||this.primaryTextColor,this.relationColor=this.relationColor||this.lineColor,this.relationLabelBackground=this.relationLabelBackground||(this.darkMode?Pe(this.secondaryColor,30):this.secondaryColor),this.relationLabelColor=this.relationLabelColor||this.actorTextColor,this.git0=Se(this.secondaryColor,20),this.git1=Se(this.pie2||this.secondaryColor,20),this.git2=Se(this.pie3||this.tertiaryColor,20),this.git3=Se(this.pie4||V(this.primaryColor,{h:-30}),20),this.git4=Se(this.pie5||V(this.primaryColor,{h:-60}),20),this.git5=Se(this.pie6||V(this.primaryColor,{h:-90}),10),this.git6=Se(this.pie7||V(this.primaryColor,{h:60}),10),this.git7=Se(this.pie8||V(this.primaryColor,{h:120}),20),this.gitInv0=this.gitInv0||le(this.git0),this.gitInv1=this.gitInv1||le(this.git1),this.gitInv2=this.gitInv2||le(this.git2),this.gitInv3=this.gitInv3||le(this.git3),this.gitInv4=this.gitInv4||le(this.git4),this.gitInv5=this.gitInv5||le(this.git5),this.gitInv6=this.gitInv6||le(this.git6),this.gitInv7=this.gitInv7||le(this.git7),this.gitBranchLabel0=this.gitBranchLabel0||le(this.labelTextColor),this.gitBranchLabel1=this.gitBranchLabel1||this.labelTextColor,this.gitBranchLabel2=this.gitBranchLabel2||this.labelTextColor,this.gitBranchLabel3=this.gitBranchLabel3||le(this.labelTextColor),this.gitBranchLabel4=this.gitBranchLabel4||this.labelTextColor,this.gitBranchLabel5=this.gitBranchLabel5||this.labelTextColor,this.gitBranchLabel6=this.gitBranchLabel6||this.labelTextColor,this.gitBranchLabel7=this.gitBranchLabel7||this.labelTextColor,this.tagLabelColor=this.tagLabelColor||this.primaryTextColor,this.tagLabelBackground=this.tagLabelBackground||this.primaryColor,this.tagLabelBorder=this.tagBorder||this.primaryBorderColor,this.tagLabelFontSize=this.tagLabelFontSize||"10px",this.commitLabelColor=this.commitLabelColor||this.secondaryTextColor,this.commitLabelBackground=this.commitLabelBackground||this.secondaryColor,this.commitLabelFontSize=this.commitLabelFontSize||"10px",this.attributeBackgroundColorOdd=this.attributeBackgroundColorOdd||Se(this.background,12),this.attributeBackgroundColorEven=this.attributeBackgroundColorEven||Se(this.background,2)}calculate(t){if(typeof t!="object"){this.updateColors();return}const n=Object.keys(t);n.forEach(r=>{this[r]=t[r]}),this.updateColors(),n.forEach(r=>{this[r]=t[r]})}};const e0e=e=>{const t=new Jye;return t.calculate(e),t};let t0e=class{constructor(){this.background="#f4f4f4",this.primaryColor="#ECECFF",this.secondaryColor=V(this.primaryColor,{h:120}),this.secondaryColor="#ffffde",this.tertiaryColor=V(this.primaryColor,{h:-160}),this.primaryBorderColor=Yn(this.primaryColor,this.darkMode),this.secondaryBorderColor=Yn(this.secondaryColor,this.darkMode),this.tertiaryBorderColor=Yn(this.tertiaryColor,this.darkMode),this.primaryTextColor=le(this.primaryColor),this.secondaryTextColor=le(this.secondaryColor),this.tertiaryTextColor=le(this.tertiaryColor),this.lineColor=le(this.background),this.textColor=le(this.background),this.background="white",this.mainBkg="#ECECFF",this.secondBkg="#ffffde",this.lineColor="#333333",this.border1="#9370DB",this.border2="#aaaa33",this.arrowheadColor="#333333",this.fontFamily='"trebuchet ms", verdana, arial, sans-serif',this.fontSize="16px",this.labelBackground="#e8e8e8",this.textColor="#333",this.THEME_COLOR_LIMIT=12,this.nodeBkg="calculated",this.nodeBorder="calculated",this.clusterBkg="calculated",this.clusterBorder="calculated",this.defaultLinkColor="calculated",this.titleColor="calculated",this.edgeLabelBackground="calculated",this.actorBorder="calculated",this.actorBkg="calculated",this.actorTextColor="black",this.actorLineColor="grey",this.signalColor="calculated",this.signalTextColor="calculated",this.labelBoxBkgColor="calculated",this.labelBoxBorderColor="calculated",this.labelTextColor="calculated",this.loopTextColor="calculated",this.noteBorderColor="calculated",this.noteBkgColor="#fff5ad",this.noteTextColor="calculated",this.activationBorderColor="#666",this.activationBkgColor="#f4f4f4",this.sequenceNumberColor="white",this.sectionBkgColor="calculated",this.altSectionBkgColor="calculated",this.sectionBkgColor2="calculated",this.excludeBkgColor="#eeeeee",this.taskBorderColor="calculated",this.taskBkgColor="calculated",this.taskTextLightColor="calculated",this.taskTextColor=this.taskTextLightColor,this.taskTextDarkColor="calculated",this.taskTextOutsideColor=this.taskTextDarkColor,this.taskTextClickableColor="calculated",this.activeTaskBorderColor="calculated",this.activeTaskBkgColor="calculated",this.gridColor="calculated",this.doneTaskBkgColor="calculated",this.doneTaskBorderColor="calculated",this.critBorderColor="calculated",this.critBkgColor="calculated",this.todayLineColor="calculated",this.sectionBkgColor=md(102,102,255,.49),this.altSectionBkgColor="white",this.sectionBkgColor2="#fff400",this.taskBorderColor="#534fbc",this.taskBkgColor="#8a90dd",this.taskTextLightColor="white",this.taskTextColor="calculated",this.taskTextDarkColor="black",this.taskTextOutsideColor="calculated",this.taskTextClickableColor="#003163",this.activeTaskBorderColor="#534fbc",this.activeTaskBkgColor="#bfc7ff",this.gridColor="lightgrey",this.doneTaskBkgColor="lightgrey",this.doneTaskBorderColor="grey",this.critBorderColor="#ff8888",this.critBkgColor="red",this.todayLineColor="red",this.personBorder=this.primaryBorderColor,this.personBkg=this.mainBkg,this.labelColor="black",this.errorBkgColor="#552222",this.errorTextColor="#552222",this.updateColors()}updateColors(){this.cScale0=this.cScale0||this.primaryColor,this.cScale1=this.cScale1||this.secondaryColor,this.cScale2=this.cScale2||this.tertiaryColor,this.cScale3=this.cScale3||V(this.primaryColor,{h:30}),this.cScale4=this.cScale4||V(this.primaryColor,{h:60}),this.cScale5=this.cScale5||V(this.primaryColor,{h:90}),this.cScale6=this.cScale6||V(this.primaryColor,{h:120}),this.cScale7=this.cScale7||V(this.primaryColor,{h:150}),this.cScale8=this.cScale8||V(this.primaryColor,{h:210}),this.cScale9=this.cScale9||V(this.primaryColor,{h:270}),this.cScale10=this.cScale10||V(this.primaryColor,{h:300}),this.cScale11=this.cScale11||V(this.primaryColor,{h:330}),this.cScalePeer1=this.cScalePeer1||Pe(this.secondaryColor,45),this.cScalePeer2=this.cScalePeer2||Pe(this.tertiaryColor,40);for(let t=0;t<this.THEME_COLOR_LIMIT;t++)this["cScale"+t]=Pe(this["cScale"+t],10),this["cScalePeer"+t]=this["cScalePeer"+t]||Pe(this["cScale"+t],25);for(let t=0;t<this.THEME_COLOR_LIMIT;t++)this["cScaleInv"+t]=this["cScaleInv"+t]||V(this["cScale"+t],{h:180});for(let t=0;t<5;t++)this["surface"+t]=this["surface"+t]||V(this.mainBkg,{h:30,l:-(5+t*5)}),this["surfacePeer"+t]=this["surfacePeer"+t]||V(this.mainBkg,{h:30,l:-(7+t*5)});if(this.scaleLabelColor=this.scaleLabelColor!=="calculated"&&this.scaleLabelColor?this.scaleLabelColor:this.labelTextColor,this.labelTextColor!=="calculated"){this.cScaleLabel0=this.cScaleLabel0||le(this.labelTextColor),this.cScaleLabel3=this.cScaleLabel3||le(this.labelTextColor);for(let t=0;t<this.THEME_COLOR_LIMIT;t++)this["cScaleLabel"+t]=this["cScaleLabel"+t]||this.labelTextColor}this.nodeBkg=this.mainBkg,this.nodeBorder=this.border1,this.clusterBkg=this.secondBkg,this.clusterBorder=this.border2,this.defaultLinkColor=this.lineColor,this.titleColor=this.textColor,this.edgeLabelBackground=this.labelBackground,this.actorBorder=Se(this.border1,23),this.actorBkg=this.mainBkg,this.labelBoxBkgColor=this.actorBkg,this.signalColor=this.textColor,this.signalTextColor=this.textColor,this.labelBoxBorderColor=this.actorBorder,this.labelTextColor=this.actorTextColor,this.loopTextColor=this.actorTextColor,this.noteBorderColor=this.border2,this.noteTextColor=this.actorTextColor,this.taskTextColor=this.taskTextLightColor,this.taskTextOutsideColor=this.taskTextDarkColor,this.transitionColor=this.transitionColor||this.lineColor,this.transitionLabelColor=this.transitionLabelColor||this.textColor,this.stateLabelColor=this.stateLabelColor||this.stateBkg||this.primaryTextColor,this.stateBkg=this.stateBkg||this.mainBkg,this.labelBackgroundColor=this.labelBackgroundColor||this.stateBkg,this.compositeBackground=this.compositeBackground||this.background||this.tertiaryColor,this.altBackground=this.altBackground||"#f0f0f0",this.compositeTitleBackground=this.compositeTitleBackground||this.mainBkg,this.compositeBorder=this.compositeBorder||this.nodeBorder,this.innerEndBackground=this.nodeBorder,this.specialStateColor=this.lineColor,this.errorBkgColor=this.errorBkgColor||this.tertiaryColor,this.errorTextColor=this.errorTextColor||this.tertiaryTextColor,this.transitionColor=this.transitionColor||this.lineColor,this.classText=this.primaryTextColor,this.fillType0=this.primaryColor,this.fillType1=this.secondaryColor,this.fillType2=V(this.primaryColor,{h:64}),this.fillType3=V(this.secondaryColor,{h:64}),this.fillType4=V(this.primaryColor,{h:-64}),this.fillType5=V(this.secondaryColor,{h:-64}),this.fillType6=V(this.primaryColor,{h:128}),this.fillType7=V(this.secondaryColor,{h:128}),this.pie1=this.pie1||this.primaryColor,this.pie2=this.pie2||this.secondaryColor,this.pie3=this.pie3||V(this.tertiaryColor,{l:-40}),this.pie4=this.pie4||V(this.primaryColor,{l:-10}),this.pie5=this.pie5||V(this.secondaryColor,{l:-30}),this.pie6=this.pie6||V(this.tertiaryColor,{l:-20}),this.pie7=this.pie7||V(this.primaryColor,{h:60,l:-20}),this.pie8=this.pie8||V(this.primaryColor,{h:-60,l:-40}),this.pie9=this.pie9||V(this.primaryColor,{h:120,l:-40}),this.pie10=this.pie10||V(this.primaryColor,{h:60,l:-40}),this.pie11=this.pie11||V(this.primaryColor,{h:-90,l:-40}),this.pie12=this.pie12||V(this.primaryColor,{h:120,l:-30}),this.pieTitleTextSize=this.pieTitleTextSize||"25px",this.pieTitleTextColor=this.pieTitleTextColor||this.taskTextDarkColor,this.pieSectionTextSize=this.pieSectionTextSize||"17px",this.pieSectionTextColor=this.pieSectionTextColor||this.textColor,this.pieLegendTextSize=this.pieLegendTextSize||"17px",this.pieLegendTextColor=this.pieLegendTextColor||this.taskTextDarkColor,this.pieStrokeColor=this.pieStrokeColor||"black",this.pieStrokeWidth=this.pieStrokeWidth||"2px",this.pieOuterStrokeWidth=this.pieOuterStrokeWidth||"2px",this.pieOuterStrokeColor=this.pieOuterStrokeColor||"black",this.pieOpacity=this.pieOpacity||"0.7",this.quadrant1Fill=this.quadrant1Fill||this.primaryColor,this.quadrant2Fill=this.quadrant2Fill||V(this.primaryColor,{r:5,g:5,b:5}),this.quadrant3Fill=this.quadrant3Fill||V(this.primaryColor,{r:10,g:10,b:10}),this.quadrant4Fill=this.quadrant4Fill||V(this.primaryColor,{r:15,g:15,b:15}),this.quadrant1TextFill=this.quadrant1TextFill||this.primaryTextColor,this.quadrant2TextFill=this.quadrant2TextFill||V(this.primaryTextColor,{r:-5,g:-5,b:-5}),this.quadrant3TextFill=this.quadrant3TextFill||V(this.primaryTextColor,{r:-10,g:-10,b:-10}),this.quadrant4TextFill=this.quadrant4TextFill||V(this.primaryTextColor,{r:-15,g:-15,b:-15}),this.quadrantPointFill=this.quadrantPointFill||Zh(this.quadrant1Fill)?Se(this.quadrant1Fill):Pe(this.quadrant1Fill),this.quadrantPointTextFill=this.quadrantPointTextFill||this.primaryTextColor,this.quadrantXAxisTextFill=this.quadrantXAxisTextFill||this.primaryTextColor,this.quadrantYAxisTextFill=this.quadrantYAxisTextFill||this.primaryTextColor,this.quadrantInternalBorderStrokeFill=this.quadrantInternalBorderStrokeFill||this.primaryBorderColor,this.quadrantExternalBorderStrokeFill=this.quadrantExternalBorderStrokeFill||this.primaryBorderColor,this.quadrantTitleFill=this.quadrantTitleFill||this.primaryTextColor,this.requirementBackground=this.requirementBackground||this.primaryColor,this.requirementBorderColor=this.requirementBorderColor||this.primaryBorderColor,this.requirementBorderSize=this.requirementBorderSize||"1",this.requirementTextColor=this.requirementTextColor||this.primaryTextColor,this.relationColor=this.relationColor||this.lineColor,this.relationLabelBackground=this.relationLabelBackground||this.labelBackground,this.relationLabelColor=this.relationLabelColor||this.actorTextColor,this.git0=this.git0||this.primaryColor,this.git1=this.git1||this.secondaryColor,this.git2=this.git2||this.tertiaryColor,this.git3=this.git3||V(this.primaryColor,{h:-30}),this.git4=this.git4||V(this.primaryColor,{h:-60}),this.git5=this.git5||V(this.primaryColor,{h:-90}),this.git6=this.git6||V(this.primaryColor,{h:60}),this.git7=this.git7||V(this.primaryColor,{h:120}),this.darkMode?(this.git0=Se(this.git0,25),this.git1=Se(this.git1,25),this.git2=Se(this.git2,25),this.git3=Se(this.git3,25),this.git4=Se(this.git4,25),this.git5=Se(this.git5,25),this.git6=Se(this.git6,25),this.git7=Se(this.git7,25)):(this.git0=Pe(this.git0,25),this.git1=Pe(this.git1,25),this.git2=Pe(this.git2,25),this.git3=Pe(this.git3,25),this.git4=Pe(this.git4,25),this.git5=Pe(this.git5,25),this.git6=Pe(this.git6,25),this.git7=Pe(this.git7,25)),this.gitInv0=this.gitInv0||Pe(le(this.git0),25),this.gitInv1=this.gitInv1||le(this.git1),this.gitInv2=this.gitInv2||le(this.git2),this.gitInv3=this.gitInv3||le(this.git3),this.gitInv4=this.gitInv4||le(this.git4),this.gitInv5=this.gitInv5||le(this.git5),this.gitInv6=this.gitInv6||le(this.git6),this.gitInv7=this.gitInv7||le(this.git7),this.gitBranchLabel0=this.gitBranchLabel0||le(this.labelTextColor),this.gitBranchLabel1=this.gitBranchLabel1||this.labelTextColor,this.gitBranchLabel2=this.gitBranchLabel2||this.labelTextColor,this.gitBranchLabel3=this.gitBranchLabel3||le(this.labelTextColor),this.gitBranchLabel4=this.gitBranchLabel4||this.labelTextColor,this.gitBranchLabel5=this.gitBranchLabel5||this.labelTextColor,this.gitBranchLabel6=this.gitBranchLabel6||this.labelTextColor,this.gitBranchLabel7=this.gitBranchLabel7||this.labelTextColor,this.tagLabelColor=this.tagLabelColor||this.primaryTextColor,this.tagLabelBackground=this.tagLabelBackground||this.primaryColor,this.tagLabelBorder=this.tagBorder||this.primaryBorderColor,this.tagLabelFontSize=this.tagLabelFontSize||"10px",this.commitLabelColor=this.commitLabelColor||this.secondaryTextColor,this.commitLabelBackground=this.commitLabelBackground||this.secondaryColor,this.commitLabelFontSize=this.commitLabelFontSize||"10px",this.attributeBackgroundColorOdd=this.attributeBackgroundColorOdd||u0,this.attributeBackgroundColorEven=this.attributeBackgroundColorEven||d0}calculate(t){if(typeof t!="object"){this.updateColors();return}const n=Object.keys(t);n.forEach(r=>{this[r]=t[r]}),this.updateColors(),n.forEach(r=>{this[r]=t[r]})}};const n0e=e=>{const t=new t0e;return t.calculate(e),t};let r0e=class{constructor(){this.background="#f4f4f4",this.primaryColor="#cde498",this.secondaryColor="#cdffb2",this.background="white",this.mainBkg="#cde498",this.secondBkg="#cdffb2",this.lineColor="green",this.border1="#13540c",this.border2="#6eaa49",this.arrowheadColor="green",this.fontFamily='"trebuchet ms", verdana, arial, sans-serif',this.fontSize="16px",this.tertiaryColor=Se("#cde498",10),this.primaryBorderColor=Yn(this.primaryColor,this.darkMode),this.secondaryBorderColor=Yn(this.secondaryColor,this.darkMode),this.tertiaryBorderColor=Yn(this.tertiaryColor,this.darkMode),this.primaryTextColor=le(this.primaryColor),this.secondaryTextColor=le(this.secondaryColor),this.tertiaryTextColor=le(this.primaryColor),this.lineColor=le(this.background),this.textColor=le(this.background),this.THEME_COLOR_LIMIT=12,this.nodeBkg="calculated",this.nodeBorder="calculated",this.clusterBkg="calculated",this.clusterBorder="calculated",this.defaultLinkColor="calculated",this.titleColor="#333",this.edgeLabelBackground="#e8e8e8",this.actorBorder="calculated",this.actorBkg="calculated",this.actorTextColor="black",this.actorLineColor="grey",this.signalColor="#333",this.signalTextColor="#333",this.labelBoxBkgColor="calculated",this.labelBoxBorderColor="#326932",this.labelTextColor="calculated",this.loopTextColor="calculated",this.noteBorderColor="calculated",this.noteBkgColor="#fff5ad",this.noteTextColor="calculated",this.activationBorderColor="#666",this.activationBkgColor="#f4f4f4",this.sequenceNumberColor="white",this.sectionBkgColor="#6eaa49",this.altSectionBkgColor="white",this.sectionBkgColor2="#6eaa49",this.excludeBkgColor="#eeeeee",this.taskBorderColor="calculated",this.taskBkgColor="#487e3a",this.taskTextLightColor="white",this.taskTextColor="calculated",this.taskTextDarkColor="black",this.taskTextOutsideColor="calculated",this.taskTextClickableColor="#003163",this.activeTaskBorderColor="calculated",this.activeTaskBkgColor="calculated",this.gridColor="lightgrey",this.doneTaskBkgColor="lightgrey",this.doneTaskBorderColor="grey",this.critBorderColor="#ff8888",this.critBkgColor="red",this.todayLineColor="red",this.personBorder=this.primaryBorderColor,this.personBkg=this.mainBkg,this.labelColor="black",this.errorBkgColor="#552222",this.errorTextColor="#552222"}updateColors(){this.actorBorder=Pe(this.mainBkg,20),this.actorBkg=this.mainBkg,this.labelBoxBkgColor=this.actorBkg,this.labelTextColor=this.actorTextColor,this.loopTextColor=this.actorTextColor,this.noteBorderColor=this.border2,this.noteTextColor=this.actorTextColor,this.cScale0=this.cScale0||this.primaryColor,this.cScale1=this.cScale1||this.secondaryColor,this.cScale2=this.cScale2||this.tertiaryColor,this.cScale3=this.cScale3||V(this.primaryColor,{h:30}),this.cScale4=this.cScale4||V(this.primaryColor,{h:60}),this.cScale5=this.cScale5||V(this.primaryColor,{h:90}),this.cScale6=this.cScale6||V(this.primaryColor,{h:120}),this.cScale7=this.cScale7||V(this.primaryColor,{h:150}),this.cScale8=this.cScale8||V(this.primaryColor,{h:210}),this.cScale9=this.cScale9||V(this.primaryColor,{h:270}),this.cScale10=this.cScale10||V(this.primaryColor,{h:300}),this.cScale11=this.cScale11||V(this.primaryColor,{h:330}),this.cScalePeer1=this.cScalePeer1||Pe(this.secondaryColor,45),this.cScalePeer2=this.cScalePeer2||Pe(this.tertiaryColor,40);for(let t=0;t<this.THEME_COLOR_LIMIT;t++)this["cScale"+t]=Pe(this["cScale"+t],10),this["cScalePeer"+t]=this["cScalePeer"+t]||Pe(this["cScale"+t],25);for(let t=0;t<this.THEME_COLOR_LIMIT;t++)this["cScaleInv"+t]=this["cScaleInv"+t]||V(this["cScale"+t],{h:180});this.scaleLabelColor=this.scaleLabelColor!=="calculated"&&this.scaleLabelColor?this.scaleLabelColor:this.labelTextColor;for(let t=0;t<this.THEME_COLOR_LIMIT;t++)this["cScaleLabel"+t]=this["cScaleLabel"+t]||this.scaleLabelColor;for(let t=0;t<5;t++)this["surface"+t]=this["surface"+t]||V(this.mainBkg,{h:30,s:-30,l:-(5+t*5)}),this["surfacePeer"+t]=this["surfacePeer"+t]||V(this.mainBkg,{h:30,s:-30,l:-(8+t*5)});this.nodeBkg=this.mainBkg,this.nodeBorder=this.border1,this.clusterBkg=this.secondBkg,this.clusterBorder=this.border2,this.defaultLinkColor=this.lineColor,this.taskBorderColor=this.border1,this.taskTextColor=this.taskTextLightColor,this.taskTextOutsideColor=this.taskTextDarkColor,this.activeTaskBorderColor=this.taskBorderColor,this.activeTaskBkgColor=this.mainBkg,this.transitionColor=this.transitionColor||this.lineColor,this.transitionLabelColor=this.transitionLabelColor||this.textColor,this.stateLabelColor=this.stateLabelColor||this.stateBkg||this.primaryTextColor,this.stateBkg=this.stateBkg||this.mainBkg,this.labelBackgroundColor=this.labelBackgroundColor||this.stateBkg,this.compositeBackground=this.compositeBackground||this.background||this.tertiaryColor,this.altBackground=this.altBackground||"#f0f0f0",this.compositeTitleBackground=this.compositeTitleBackground||this.mainBkg,this.compositeBorder=this.compositeBorder||this.nodeBorder,this.innerEndBackground=this.primaryBorderColor,this.specialStateColor=this.lineColor,this.errorBkgColor=this.errorBkgColor||this.tertiaryColor,this.errorTextColor=this.errorTextColor||this.tertiaryTextColor,this.transitionColor=this.transitionColor||this.lineColor,this.classText=this.primaryTextColor,this.fillType0=this.primaryColor,this.fillType1=this.secondaryColor,this.fillType2=V(this.primaryColor,{h:64}),this.fillType3=V(this.secondaryColor,{h:64}),this.fillType4=V(this.primaryColor,{h:-64}),this.fillType5=V(this.secondaryColor,{h:-64}),this.fillType6=V(this.primaryColor,{h:128}),this.fillType7=V(this.secondaryColor,{h:128}),this.pie1=this.pie1||this.primaryColor,this.pie2=this.pie2||this.secondaryColor,this.pie3=this.pie3||this.tertiaryColor,this.pie4=this.pie4||V(this.primaryColor,{l:-30}),this.pie5=this.pie5||V(this.secondaryColor,{l:-30}),this.pie6=this.pie6||V(this.tertiaryColor,{h:40,l:-40}),this.pie7=this.pie7||V(this.primaryColor,{h:60,l:-10}),this.pie8=this.pie8||V(this.primaryColor,{h:-60,l:-10}),this.pie9=this.pie9||V(this.primaryColor,{h:120,l:0}),this.pie10=this.pie10||V(this.primaryColor,{h:60,l:-50}),this.pie11=this.pie11||V(this.primaryColor,{h:-60,l:-50}),this.pie12=this.pie12||V(this.primaryColor,{h:120,l:-50}),this.pieTitleTextSize=this.pieTitleTextSize||"25px",this.pieTitleTextColor=this.pieTitleTextColor||this.taskTextDarkColor,this.pieSectionTextSize=this.pieSectionTextSize||"17px",this.pieSectionTextColor=this.pieSectionTextColor||this.textColor,this.pieLegendTextSize=this.pieLegendTextSize||"17px",this.pieLegendTextColor=this.pieLegendTextColor||this.taskTextDarkColor,this.pieStrokeColor=this.pieStrokeColor||"black",this.pieStrokeWidth=this.pieStrokeWidth||"2px",this.pieOuterStrokeWidth=this.pieOuterStrokeWidth||"2px",this.pieOuterStrokeColor=this.pieOuterStrokeColor||"black",this.pieOpacity=this.pieOpacity||"0.7",this.quadrant1Fill=this.quadrant1Fill||this.primaryColor,this.quadrant2Fill=this.quadrant2Fill||V(this.primaryColor,{r:5,g:5,b:5}),this.quadrant3Fill=this.quadrant3Fill||V(this.primaryColor,{r:10,g:10,b:10}),this.quadrant4Fill=this.quadrant4Fill||V(this.primaryColor,{r:15,g:15,b:15}),this.quadrant1TextFill=this.quadrant1TextFill||this.primaryTextColor,this.quadrant2TextFill=this.quadrant2TextFill||V(this.primaryTextColor,{r:-5,g:-5,b:-5}),this.quadrant3TextFill=this.quadrant3TextFill||V(this.primaryTextColor,{r:-10,g:-10,b:-10}),this.quadrant4TextFill=this.quadrant4TextFill||V(this.primaryTextColor,{r:-15,g:-15,b:-15}),this.quadrantPointFill=this.quadrantPointFill||Zh(this.quadrant1Fill)?Se(this.quadrant1Fill):Pe(this.quadrant1Fill),this.quadrantPointTextFill=this.quadrantPointTextFill||this.primaryTextColor,this.quadrantXAxisTextFill=this.quadrantXAxisTextFill||this.primaryTextColor,this.quadrantYAxisTextFill=this.quadrantYAxisTextFill||this.primaryTextColor,this.quadrantInternalBorderStrokeFill=this.quadrantInternalBorderStrokeFill||this.primaryBorderColor,this.quadrantExternalBorderStrokeFill=this.quadrantExternalBorderStrokeFill||this.primaryBorderColor,this.quadrantTitleFill=this.quadrantTitleFill||this.primaryTextColor,this.requirementBackground=this.requirementBackground||this.primaryColor,this.requirementBorderColor=this.requirementBorderColor||this.primaryBorderColor,this.requirementBorderSize=this.requirementBorderSize||"1",this.requirementTextColor=this.requirementTextColor||this.primaryTextColor,this.relationColor=this.relationColor||this.lineColor,this.relationLabelBackground=this.relationLabelBackground||this.edgeLabelBackground,this.relationLabelColor=this.relationLabelColor||this.actorTextColor,this.git0=this.git0||this.primaryColor,this.git1=this.git1||this.secondaryColor,this.git2=this.git2||this.tertiaryColor,this.git3=this.git3||V(this.primaryColor,{h:-30}),this.git4=this.git4||V(this.primaryColor,{h:-60}),this.git5=this.git5||V(this.primaryColor,{h:-90}),this.git6=this.git6||V(this.primaryColor,{h:60}),this.git7=this.git7||V(this.primaryColor,{h:120}),this.darkMode?(this.git0=Se(this.git0,25),this.git1=Se(this.git1,25),this.git2=Se(this.git2,25),this.git3=Se(this.git3,25),this.git4=Se(this.git4,25),this.git5=Se(this.git5,25),this.git6=Se(this.git6,25),this.git7=Se(this.git7,25)):(this.git0=Pe(this.git0,25),this.git1=Pe(this.git1,25),this.git2=Pe(this.git2,25),this.git3=Pe(this.git3,25),this.git4=Pe(this.git4,25),this.git5=Pe(this.git5,25),this.git6=Pe(this.git6,25),this.git7=Pe(this.git7,25)),this.gitInv0=this.gitInv0||le(this.git0),this.gitInv1=this.gitInv1||le(this.git1),this.gitInv2=this.gitInv2||le(this.git2),this.gitInv3=this.gitInv3||le(this.git3),this.gitInv4=this.gitInv4||le(this.git4),this.gitInv5=this.gitInv5||le(this.git5),this.gitInv6=this.gitInv6||le(this.git6),this.gitInv7=this.gitInv7||le(this.git7),this.gitBranchLabel0=this.gitBranchLabel0||le(this.labelTextColor),this.gitBranchLabel1=this.gitBranchLabel1||this.labelTextColor,this.gitBranchLabel2=this.gitBranchLabel2||this.labelTextColor,this.gitBranchLabel3=this.gitBranchLabel3||le(this.labelTextColor),this.gitBranchLabel4=this.gitBranchLabel4||this.labelTextColor,this.gitBranchLabel5=this.gitBranchLabel5||this.labelTextColor,this.gitBranchLabel6=this.gitBranchLabel6||this.labelTextColor,this.gitBranchLabel7=this.gitBranchLabel7||this.labelTextColor,this.tagLabelColor=this.tagLabelColor||this.primaryTextColor,this.tagLabelBackground=this.tagLabelBackground||this.primaryColor,this.tagLabelBorder=this.tagBorder||this.primaryBorderColor,this.tagLabelFontSize=this.tagLabelFontSize||"10px",this.commitLabelColor=this.commitLabelColor||this.secondaryTextColor,this.commitLabelBackground=this.commitLabelBackground||this.secondaryColor,this.commitLabelFontSize=this.commitLabelFontSize||"10px",this.attributeBackgroundColorOdd=this.attributeBackgroundColorOdd||u0,this.attributeBackgroundColorEven=this.attributeBackgroundColorEven||d0}calculate(t){if(typeof t!="object"){this.updateColors();return}const n=Object.keys(t);n.forEach(r=>{this[r]=t[r]}),this.updateColors(),n.forEach(r=>{this[r]=t[r]})}};const i0e=e=>{const t=new r0e;return t.calculate(e),t};class o0e{constructor(){this.primaryColor="#eee",this.contrast="#707070",this.secondaryColor=Se(this.contrast,55),this.background="#ffffff",this.tertiaryColor=V(this.primaryColor,{h:-160}),this.primaryBorderColor=Yn(this.primaryColor,this.darkMode),this.secondaryBorderColor=Yn(this.secondaryColor,this.darkMode),this.tertiaryBorderColor=Yn(this.tertiaryColor,this.darkMode),this.primaryTextColor=le(this.primaryColor),this.secondaryTextColor=le(this.secondaryColor),this.tertiaryTextColor=le(this.tertiaryColor),this.lineColor=le(this.background),this.textColor=le(this.background),this.mainBkg="#eee",this.secondBkg="calculated",this.lineColor="#666",this.border1="#999",this.border2="calculated",this.note="#ffa",this.text="#333",this.critical="#d42",this.done="#bbb",this.arrowheadColor="#333333",this.fontFamily='"trebuchet ms", verdana, arial, sans-serif',this.fontSize="16px",this.THEME_COLOR_LIMIT=12,this.nodeBkg="calculated",this.nodeBorder="calculated",this.clusterBkg="calculated",this.clusterBorder="calculated",this.defaultLinkColor="calculated",this.titleColor="calculated",this.edgeLabelBackground="white",this.actorBorder="calculated",this.actorBkg="calculated",this.actorTextColor="calculated",this.actorLineColor="calculated",this.signalColor="calculated",this.signalTextColor="calculated",this.labelBoxBkgColor="calculated",this.labelBoxBorderColor="calculated",this.labelTextColor="calculated",this.loopTextColor="calculated",this.noteBorderColor="calculated",this.noteBkgColor="calculated",this.noteTextColor="calculated",this.activationBorderColor="#666",this.activationBkgColor="#f4f4f4",this.sequenceNumberColor="white",this.sectionBkgColor="calculated",this.altSectionBkgColor="white",this.sectionBkgColor2="calculated",this.excludeBkgColor="#eeeeee",this.taskBorderColor="calculated",this.taskBkgColor="calculated",this.taskTextLightColor="white",this.taskTextColor="calculated",this.taskTextDarkColor="calculated",this.taskTextOutsideColor="calculated",this.taskTextClickableColor="#003163",this.activeTaskBorderColor="calculated",this.activeTaskBkgColor="calculated",this.gridColor="calculated",this.doneTaskBkgColor="calculated",this.doneTaskBorderColor="calculated",this.critBkgColor="calculated",this.critBorderColor="calculated",this.todayLineColor="calculated",this.personBorder=this.primaryBorderColor,this.personBkg=this.mainBkg,this.labelColor="black",this.errorBkgColor="#552222",this.errorTextColor="#552222"}updateColors(){this.secondBkg=Se(this.contrast,55),this.border2=this.contrast,this.actorBorder=Se(this.border1,23),this.actorBkg=this.mainBkg,this.actorTextColor=this.text,this.actorLineColor=this.lineColor,this.signalColor=this.text,this.signalTextColor=this.text,this.labelBoxBkgColor=this.actorBkg,this.labelBoxBorderColor=this.actorBorder,this.labelTextColor=this.text,this.loopTextColor=this.text,this.noteBorderColor="#999",this.noteBkgColor="#666",this.noteTextColor="#fff",this.cScale0=this.cScale0||"#555",this.cScale1=this.cScale1||"#F4F4F4",this.cScale2=this.cScale2||"#555",this.cScale3=this.cScale3||"#BBB",this.cScale4=this.cScale4||"#777",this.cScale5=this.cScale5||"#999",this.cScale6=this.cScale6||"#DDD",this.cScale7=this.cScale7||"#FFF",this.cScale8=this.cScale8||"#DDD",this.cScale9=this.cScale9||"#BBB",this.cScale10=this.cScale10||"#999",this.cScale11=this.cScale11||"#777";for(let t=0;t<this.THEME_COLOR_LIMIT;t++)this["cScaleInv"+t]=this["cScaleInv"+t]||le(this["cScale"+t]);for(let t=0;t<this.THEME_COLOR_LIMIT;t++)this.darkMode?this["cScalePeer"+t]=this["cScalePeer"+t]||Se(this["cScale"+t],10):this["cScalePeer"+t]=this["cScalePeer"+t]||Pe(this["cScale"+t],10);this.scaleLabelColor=this.scaleLabelColor||(this.darkMode?"black":this.labelTextColor),this.cScaleLabel0=this.cScaleLabel0||this.cScale1,this.cScaleLabel2=this.cScaleLabel2||this.cScale1;for(let t=0;t<this.THEME_COLOR_LIMIT;t++)this["cScaleLabel"+t]=this["cScaleLabel"+t]||this.scaleLabelColor;for(let t=0;t<5;t++)this["surface"+t]=this["surface"+t]||V(this.mainBkg,{l:-(5+t*5)}),this["surfacePeer"+t]=this["surfacePeer"+t]||V(this.mainBkg,{l:-(8+t*5)});this.nodeBkg=this.mainBkg,this.nodeBorder=this.border1,this.clusterBkg=this.secondBkg,this.clusterBorder=this.border2,this.defaultLinkColor=this.lineColor,this.titleColor=this.text,this.sectionBkgColor=Se(this.contrast,30),this.sectionBkgColor2=Se(this.contrast,30),this.taskBorderColor=Pe(this.contrast,10),this.taskBkgColor=this.contrast,this.taskTextColor=this.taskTextLightColor,this.taskTextDarkColor=this.text,this.taskTextOutsideColor=this.taskTextDarkColor,this.activeTaskBorderColor=this.taskBorderColor,this.activeTaskBkgColor=this.mainBkg,this.gridColor=Se(this.border1,30),this.doneTaskBkgColor=this.done,this.doneTaskBorderColor=this.lineColor,this.critBkgColor=this.critical,this.critBorderColor=Pe(this.critBkgColor,10),this.todayLineColor=this.critBkgColor,this.transitionColor=this.transitionColor||"#000",this.transitionLabelColor=this.transitionLabelColor||this.textColor,this.stateLabelColor=this.stateLabelColor||this.stateBkg||this.primaryTextColor,this.stateBkg=this.stateBkg||this.mainBkg,this.labelBackgroundColor=this.labelBackgroundColor||this.stateBkg,this.compositeBackground=this.compositeBackground||this.background||this.tertiaryColor,this.altBackground=this.altBackground||"#f4f4f4",this.compositeTitleBackground=this.compositeTitleBackground||this.mainBkg,this.stateBorder=this.stateBorder||"#000",this.innerEndBackground=this.primaryBorderColor,this.specialStateColor="#222",this.errorBkgColor=this.errorBkgColor||this.tertiaryColor,this.errorTextColor=this.errorTextColor||this.tertiaryTextColor,this.classText=this.primaryTextColor,this.fillType0=this.primaryColor,this.fillType1=this.secondaryColor,this.fillType2=V(this.primaryColor,{h:64}),this.fillType3=V(this.secondaryColor,{h:64}),this.fillType4=V(this.primaryColor,{h:-64}),this.fillType5=V(this.secondaryColor,{h:-64}),this.fillType6=V(this.primaryColor,{h:128}),this.fillType7=V(this.secondaryColor,{h:128});for(let t=0;t<this.THEME_COLOR_LIMIT;t++)this["pie"+t]=this["cScale"+t];this.pie12=this.pie0,this.pieTitleTextSize=this.pieTitleTextSize||"25px",this.pieTitleTextColor=this.pieTitleTextColor||this.taskTextDarkColor,this.pieSectionTextSize=this.pieSectionTextSize||"17px",this.pieSectionTextColor=this.pieSectionTextColor||this.textColor,this.pieLegendTextSize=this.pieLegendTextSize||"17px",this.pieLegendTextColor=this.pieLegendTextColor||this.taskTextDarkColor,this.pieStrokeColor=this.pieStrokeColor||"black",this.pieStrokeWidth=this.pieStrokeWidth||"2px",this.pieOuterStrokeWidth=this.pieOuterStrokeWidth||"2px",this.pieOuterStrokeColor=this.pieOuterStrokeColor||"black",this.pieOpacity=this.pieOpacity||"0.7",this.quadrant1Fill=this.quadrant1Fill||this.primaryColor,this.quadrant2Fill=this.quadrant2Fill||V(this.primaryColor,{r:5,g:5,b:5}),this.quadrant3Fill=this.quadrant3Fill||V(this.primaryColor,{r:10,g:10,b:10}),this.quadrant4Fill=this.quadrant4Fill||V(this.primaryColor,{r:15,g:15,b:15}),this.quadrant1TextFill=this.quadrant1TextFill||this.primaryTextColor,this.quadrant2TextFill=this.quadrant2TextFill||V(this.primaryTextColor,{r:-5,g:-5,b:-5}),this.quadrant3TextFill=this.quadrant3TextFill||V(this.primaryTextColor,{r:-10,g:-10,b:-10}),this.quadrant4TextFill=this.quadrant4TextFill||V(this.primaryTextColor,{r:-15,g:-15,b:-15}),this.quadrantPointFill=this.quadrantPointFill||Zh(this.quadrant1Fill)?Se(this.quadrant1Fill):Pe(this.quadrant1Fill),this.quadrantPointTextFill=this.quadrantPointTextFill||this.primaryTextColor,this.quadrantXAxisTextFill=this.quadrantXAxisTextFill||this.primaryTextColor,this.quadrantYAxisTextFill=this.quadrantYAxisTextFill||this.primaryTextColor,this.quadrantInternalBorderStrokeFill=this.quadrantInternalBorderStrokeFill||this.primaryBorderColor,this.quadrantExternalBorderStrokeFill=this.quadrantExternalBorderStrokeFill||this.primaryBorderColor,this.quadrantTitleFill=this.quadrantTitleFill||this.primaryTextColor,this.requirementBackground=this.requirementBackground||this.primaryColor,this.requirementBorderColor=this.requirementBorderColor||this.primaryBorderColor,this.requirementBorderSize=this.requirementBorderSize||"1",this.requirementTextColor=this.requirementTextColor||this.primaryTextColor,this.relationColor=this.relationColor||this.lineColor,this.relationLabelBackground=this.relationLabelBackground||this.edgeLabelBackground,this.relationLabelColor=this.relationLabelColor||this.actorTextColor,this.git0=Pe(this.pie1,25)||this.primaryColor,this.git1=this.pie2||this.secondaryColor,this.git2=this.pie3||this.tertiaryColor,this.git3=this.pie4||V(this.primaryColor,{h:-30}),this.git4=this.pie5||V(this.primaryColor,{h:-60}),this.git5=this.pie6||V(this.primaryColor,{h:-90}),this.git6=this.pie7||V(this.primaryColor,{h:60}),this.git7=this.pie8||V(this.primaryColor,{h:120}),this.gitInv0=this.gitInv0||le(this.git0),this.gitInv1=this.gitInv1||le(this.git1),this.gitInv2=this.gitInv2||le(this.git2),this.gitInv3=this.gitInv3||le(this.git3),this.gitInv4=this.gitInv4||le(this.git4),this.gitInv5=this.gitInv5||le(this.git5),this.gitInv6=this.gitInv6||le(this.git6),this.gitInv7=this.gitInv7||le(this.git7),this.branchLabelColor=this.branchLabelColor||this.labelTextColor,this.gitBranchLabel0=this.branchLabelColor,this.gitBranchLabel1="white",this.gitBranchLabel2=this.branchLabelColor,this.gitBranchLabel3="white",this.gitBranchLabel4=this.branchLabelColor,this.gitBranchLabel5=this.branchLabelColor,this.gitBranchLabel6=this.branchLabelColor,this.gitBranchLabel7=this.branchLabelColor,this.tagLabelColor=this.tagLabelColor||this.primaryTextColor,this.tagLabelBackground=this.tagLabelBackground||this.primaryColor,this.tagLabelBorder=this.tagBorder||this.primaryBorderColor,this.tagLabelFontSize=this.tagLabelFontSize||"10px",this.commitLabelColor=this.commitLabelColor||this.secondaryTextColor,this.commitLabelBackground=this.commitLabelBackground||this.secondaryColor,this.commitLabelFontSize=this.commitLabelFontSize||"10px",this.attributeBackgroundColorOdd=this.attributeBackgroundColorOdd||u0,this.attributeBackgroundColorEven=this.attributeBackgroundColorEven||d0}calculate(t){if(typeof t!="object"){this.updateColors();return}const n=Object.keys(t);n.forEach(r=>{this[r]=t[r]}),this.updateColors(),n.forEach(r=>{this[r]=t[r]})}}const s0e=e=>{const t=new o0e;return t.calculate(e),t},Do={base:{getThemeVariables:Qye},dark:{getThemeVariables:e0e},default:{getThemeVariables:n0e},forest:{getThemeVariables:i0e},neutral:{getThemeVariables:s0e}},gs={flowchart:{useMaxWidth:!0,titleTopMargin:25,diagramPadding:8,htmlLabels:!0,nodeSpacing:50,rankSpacing:50,curve:"basis",padding:15,defaultRenderer:"dagre-wrapper",wrappingWidth:200},sequence:{useMaxWidth:!0,hideUnusedParticipants:!1,activationWidth:10,diagramMarginX:50,diagramMarginY:10,actorMargin:50,width:150,height:65,boxMargin:10,boxTextMargin:5,noteMargin:10,messageMargin:35,messageAlign:"center",mirrorActors:!0,forceMenus:!1,bottomMarginAdj:1,rightAngles:!1,showSequenceNumbers:!1,actorFontSize:14,actorFontFamily:'"Open Sans", sans-serif',actorFontWeight:400,noteFontSize:14,noteFontFamily:'"trebuchet ms", verdana, arial, sans-serif',noteFontWeight:400,noteAlign:"center",messageFontSize:16,messageFontFamily:'"trebuchet ms", verdana, arial, sans-serif',messageFontWeight:400,wrap:!1,wrapPadding:10,labelBoxWidth:50,labelBoxHeight:20},gantt:{useMaxWidth:!0,titleTopMargin:25,barHeight:20,barGap:4,topPadding:50,rightPadding:75,leftPadding:75,gridLineStartPadding:35,fontSize:11,sectionFontSize:11,numberSectionStyles:4,axisFormat:"%Y-%m-%d",topAxis:!1,displayMode:"",weekday:"sunday"},journey:{useMaxWidth:!0,diagramMarginX:50,diagramMarginY:10,leftMargin:150,width:150,height:50,boxMargin:10,boxTextMargin:5,noteMargin:10,messageMargin:35,messageAlign:"center",bottomMarginAdj:1,rightAngles:!1,taskFontSize:14,taskFontFamily:'"Open Sans", sans-serif',taskMargin:50,activationWidth:10,textPlacement:"fo",actorColours:["#8FBC8F","#7CFC00","#00FFFF","#20B2AA","#B0E0E6","#FFFFE0"],sectionFills:["#191970","#8B008B","#4B0082","#2F4F4F","#800000","#8B4513","#00008B"],sectionColours:["#fff"]},class:{useMaxWidth:!0,titleTopMargin:25,arrowMarkerAbsolute:!1,dividerMargin:10,padding:5,textHeight:10,defaultRenderer:"dagre-wrapper",htmlLabels:!1},state:{useMaxWidth:!0,titleTopMargin:25,dividerMargin:10,sizeUnit:5,padding:8,textHeight:10,titleShift:-15,noteMargin:10,forkWidth:70,forkHeight:7,miniPadding:2,fontSizeFactor:5.02,fontSize:24,labelHeight:16,edgeLengthFactor:"20",compositTitleSize:35,radius:5,defaultRenderer:"dagre-wrapper"},er:{useMaxWidth:!0,titleTopMargin:25,diagramPadding:20,layoutDirection:"TB",minEntityWidth:100,minEntityHeight:75,entityPadding:15,stroke:"gray",fill:"honeydew",fontSize:12},pie:{useMaxWidth:!0,textPosition:.75},quadrantChart:{useMaxWidth:!0,chartWidth:500,chartHeight:500,titleFontSize:20,titlePadding:10,quadrantPadding:5,xAxisLabelPadding:5,yAxisLabelPadding:5,xAxisLabelFontSize:16,yAxisLabelFontSize:16,quadrantLabelFontSize:16,quadrantTextTopPadding:5,pointTextPadding:5,pointLabelFontSize:12,pointRadius:5,xAxisPosition:"top",yAxisPosition:"left",quadrantInternalBorderStrokeWidth:1,quadrantExternalBorderStrokeWidth:2},requirement:{useMaxWidth:!0,rect_fill:"#f9f9f9",text_color:"#333",rect_border_size:"0.5px",rect_border_color:"#bbb",rect_min_width:200,rect_min_height:200,fontSize:14,rect_padding:10,line_height:20},mindmap:{useMaxWidth:!0,padding:10,maxNodeWidth:200},timeline:{useMaxWidth:!0,diagramMarginX:50,diagramMarginY:10,leftMargin:150,width:150,height:50,boxMargin:10,boxTextMargin:5,noteMargin:10,messageMargin:35,messageAlign:"center",bottomMarginAdj:1,rightAngles:!1,taskFontSize:14,taskFontFamily:'"Open Sans", sans-serif',taskMargin:50,activationWidth:10,textPlacement:"fo",actorColours:["#8FBC8F","#7CFC00","#00FFFF","#20B2AA","#B0E0E6","#FFFFE0"],sectionFills:["#191970","#8B008B","#4B0082","#2F4F4F","#800000","#8B4513","#00008B"],sectionColours:["#fff"],disableMulticolor:!1},gitGraph:{useMaxWidth:!0,titleTopMargin:25,diagramPadding:8,nodeLabel:{width:75,height:100,x:-25,y:0},mainBranchName:"main",mainBranchOrder:0,showCommitLabel:!0,showBranches:!0,rotateCommitLabel:!0,arrowMarkerAbsolute:!1},c4:{useMaxWidth:!0,diagramMarginX:50,diagramMarginY:10,c4ShapeMargin:50,c4ShapePadding:20,width:216,height:60,boxMargin:10,c4ShapeInRow:4,nextLinePaddingX:0,c4BoundaryInRow:2,personFontSize:14,personFontFamily:'"Open Sans", sans-serif',personFontWeight:"normal",external_personFontSize:14,external_personFontFamily:'"Open Sans", sans-serif',external_personFontWeight:"normal",systemFontSize:14,systemFontFamily:'"Open Sans", sans-serif',systemFontWeight:"normal",external_systemFontSize:14,external_systemFontFamily:'"Open Sans", sans-serif',external_systemFontWeight:"normal",system_dbFontSize:14,system_dbFontFamily:'"Open Sans", sans-serif',system_dbFontWeight:"normal",external_system_dbFontSize:14,external_system_dbFontFamily:'"Open Sans", sans-serif',external_system_dbFontWeight:"normal",system_queueFontSize:14,system_queueFontFamily:'"Open Sans", sans-serif',system_queueFontWeight:"normal",external_system_queueFontSize:14,external_system_queueFontFamily:'"Open Sans", sans-serif',external_system_queueFontWeight:"normal",boundaryFontSize:14,boundaryFontFamily:'"Open Sans", sans-serif',boundaryFontWeight:"normal",messageFontSize:12,messageFontFamily:'"Open Sans", sans-serif',messageFontWeight:"normal",containerFontSize:14,containerFontFamily:'"Open Sans", sans-serif',containerFontWeight:"normal",external_containerFontSize:14,external_containerFontFamily:'"Open Sans", sans-serif',external_containerFontWeight:"normal",container_dbFontSize:14,container_dbFontFamily:'"Open Sans", sans-serif',container_dbFontWeight:"normal",external_container_dbFontSize:14,external_container_dbFontFamily:'"Open Sans", sans-serif',external_container_dbFontWeight:"normal",container_queueFontSize:14,container_queueFontFamily:'"Open Sans", sans-serif',container_queueFontWeight:"normal",external_container_queueFontSize:14,external_container_queueFontFamily:'"Open Sans", sans-serif',external_container_queueFontWeight:"normal",componentFontSize:14,componentFontFamily:'"Open Sans", sans-serif',componentFontWeight:"normal",external_componentFontSize:14,external_componentFontFamily:'"Open Sans", sans-serif',external_componentFontWeight:"normal",component_dbFontSize:14,component_dbFontFamily:'"Open Sans", sans-serif',component_dbFontWeight:"normal",external_component_dbFontSize:14,external_component_dbFontFamily:'"Open Sans", sans-serif',external_component_dbFontWeight:"normal",component_queueFontSize:14,component_queueFontFamily:'"Open Sans", sans-serif',component_queueFontWeight:"normal",external_component_queueFontSize:14,external_component_queueFontFamily:'"Open Sans", sans-serif',external_component_queueFontWeight:"normal",wrap:!0,wrapPadding:10,person_bg_color:"#08427B",person_border_color:"#073B6F",external_person_bg_color:"#686868",external_person_border_color:"#8A8A8A",system_bg_color:"#1168BD",system_border_color:"#3C7FC0",system_db_bg_color:"#1168BD",system_db_border_color:"#3C7FC0",system_queue_bg_color:"#1168BD",system_queue_border_color:"#3C7FC0",external_system_bg_color:"#999999",external_system_border_color:"#8A8A8A",external_system_db_bg_color:"#999999",external_system_db_border_color:"#8A8A8A",external_system_queue_bg_color:"#999999",external_system_queue_border_color:"#8A8A8A",container_bg_color:"#438DD5",container_border_color:"#3C7FC0",container_db_bg_color:"#438DD5",container_db_border_color:"#3C7FC0",container_queue_bg_color:"#438DD5",container_queue_border_color:"#3C7FC0",external_container_bg_color:"#B3B3B3",external_container_border_color:"#A6A6A6",external_container_db_bg_color:"#B3B3B3",external_container_db_border_color:"#A6A6A6",external_container_queue_bg_color:"#B3B3B3",external_container_queue_border_color:"#A6A6A6",component_bg_color:"#85BBF0",component_border_color:"#78A8D8",component_db_bg_color:"#85BBF0",component_db_border_color:"#78A8D8",component_queue_bg_color:"#85BBF0",component_queue_border_color:"#78A8D8",external_component_bg_color:"#CCCCCC",external_component_border_color:"#BFBFBF",external_component_db_bg_color:"#CCCCCC",external_component_db_border_color:"#BFBFBF",external_component_queue_bg_color:"#CCCCCC",external_component_queue_border_color:"#BFBFBF"},sankey:{useMaxWidth:!0,width:600,height:400,linkColor:"gradient",nodeAlignment:"justify",showValues:!0,prefix:"",suffix:""},theme:"default",maxTextSize:5e4,darkMode:!1,fontFamily:'"trebuchet ms", verdana, arial, sans-serif;',logLevel:5,securityLevel:"strict",startOnLoad:!0,arrowMarkerAbsolute:!1,secure:["secure","securityLevel","startOnLoad","maxTextSize"],deterministicIds:!1,fontSize:16},fR={...gs,deterministicIDSeed:void 0,themeCSS:void 0,themeVariables:Do.default.getThemeVariables(),sequence:{...gs.sequence,messageFont:function(){return{fontFamily:this.messageFontFamily,fontSize:this.messageFontSize,fontWeight:this.messageFontWeight}},noteFont:function(){return{fontFamily:this.noteFontFamily,fontSize:this.noteFontSize,fontWeight:this.noteFontWeight}},actorFont:function(){return{fontFamily:this.actorFontFamily,fontSize:this.actorFontSize,fontWeight:this.actorFontWeight}}},gantt:{...gs.gantt,tickInterval:void 0,useWidth:void 0},c4:{...gs.c4,useWidth:void 0,personFont:function(){return{fontFamily:this.personFontFamily,fontSize:this.personFontSize,fontWeight:this.personFontWeight}},external_personFont:function(){return{fontFamily:this.external_personFontFamily,fontSize:this.external_personFontSize,fontWeight:this.external_personFontWeight}},systemFont:function(){return{fontFamily:this.systemFontFamily,fontSize:this.systemFontSize,fontWeight:this.systemFontWeight}},external_systemFont:function(){return{fontFamily:this.external_systemFontFamily,fontSize:this.external_systemFontSize,fontWeight:this.external_systemFontWeight}},system_dbFont:function(){return{fontFamily:this.system_dbFontFamily,fontSize:this.system_dbFontSize,fontWeight:this.system_dbFontWeight}},external_system_dbFont:function(){return{fontFamily:this.external_system_dbFontFamily,fontSize:this.external_system_dbFontSize,fontWeight:this.external_system_dbFontWeight}},system_queueFont:function(){return{fontFamily:this.system_queueFontFamily,fontSize:this.system_queueFontSize,fontWeight:this.system_queueFontWeight}},external_system_queueFont:function(){return{fontFamily:this.external_system_queueFontFamily,fontSize:this.external_system_queueFontSize,fontWeight:this.external_system_queueFontWeight}},containerFont:function(){return{fontFamily:this.containerFontFamily,fontSize:this.containerFontSize,fontWeight:this.containerFontWeight}},external_containerFont:function(){return{fontFamily:this.external_containerFontFamily,fontSize:this.external_containerFontSize,fontWeight:this.external_containerFontWeight}},container_dbFont:function(){return{fontFamily:this.container_dbFontFamily,fontSize:this.container_dbFontSize,fontWeight:this.container_dbFontWeight}},external_container_dbFont:function(){return{fontFamily:this.external_container_dbFontFamily,fontSize:this.external_container_dbFontSize,fontWeight:this.external_container_dbFontWeight}},container_queueFont:function(){return{fontFamily:this.container_queueFontFamily,fontSize:this.container_queueFontSize,fontWeight:this.container_queueFontWeight}},external_container_queueFont:function(){return{fontFamily:this.external_container_queueFontFamily,fontSize:this.external_container_queueFontSize,fontWeight:this.external_container_queueFontWeight}},componentFont:function(){return{fontFamily:this.componentFontFamily,fontSize:this.componentFontSize,fontWeight:this.componentFontWeight}},external_componentFont:function(){return{fontFamily:this.external_componentFontFamily,fontSize:this.external_componentFontSize,fontWeight:this.external_componentFontWeight}},component_dbFont:function(){return{fontFamily:this.component_dbFontFamily,fontSize:this.component_dbFontSize,fontWeight:this.component_dbFontWeight}},external_component_dbFont:function(){return{fontFamily:this.external_component_dbFontFamily,fontSize:this.external_component_dbFontSize,fontWeight:this.external_component_dbFontWeight}},component_queueFont:function(){return{fontFamily:this.component_queueFontFamily,fontSize:this.component_queueFontSize,fontWeight:this.component_queueFontWeight}},external_component_queueFont:function(){return{fontFamily:this.external_component_queueFontFamily,fontSize:this.external_component_queueFontSize,fontWeight:this.external_component_queueFontWeight}},boundaryFont:function(){return{fontFamily:this.boundaryFontFamily,fontSize:this.boundaryFontSize,fontWeight:this.boundaryFontWeight}},messageFont:function(){return{fontFamily:this.messageFontFamily,fontSize:this.messageFontSize,fontWeight:this.messageFontWeight}}},pie:{...gs.pie,useWidth:984},requirement:{...gs.requirement,useWidth:void 0},gitGraph:{...gs.gitGraph,useMaxWidth:!1},sankey:{...gs.sankey,useMaxWidth:!1}},pR=(e,t="")=>Object.keys(e).reduce((n,r)=>Array.isArray(e[r])?n:typeof e[r]=="object"&&e[r]!==null?[...n,t+r,...pR(e[r],"")]:[...n,t+r],[]),a0e=new Set(pR(fR,"")),l0e=fR,gR=/^-{3}\s*[\n\r](.*?)[\n\r]-{3}\s*[\n\r]+/s,yg=/%{2}{\s*(?:(\w+)\s*:|(\w+))\s*(?:(\w+)|((?:(?!}%{2}).|\r?\n)*))?\s*(?:}%{2})?/gi,c0e=/\s*%%.*\n/gm;class mR extends Error{constructor(t){super(t),this.name="UnknownDiagramError"}}const Dc={},h0=function(e,t){e=e.replace(gR,"").replace(yg,"").replace(c0e,`
`);for(const[n,{detector:r}]of Object.entries(Dc))if(r(e,t))return n;throw new mR(`No diagram type detected matching given configuration for text: ${e}`)},yR=(...e)=>{for(const{id:t,detector:n,loader:r}of e)vR(t,n,r)},vR=(e,t,n)=>{Dc[e]?xe.error(`Detector with key ${e} already exists`):Dc[e]={detector:t,loader:n},xe.debug(`Detector with key ${e} added${n?" with loader":""}`)},u0e=e=>Dc[e].loader,gw=(e,t,{depth:n=2,clobber:r=!1}={})=>{const i={depth:n,clobber:r};return Array.isArray(t)&&!Array.isArray(e)?(t.forEach(o=>gw(e,o,i)),e):Array.isArray(t)&&Array.isArray(e)?(t.forEach(o=>{e.includes(o)||e.push(o)}),e):e===void 0||n<=0?e!=null&&typeof e=="object"&&typeof t=="object"?Object.assign(e,t):t:(t!==void 0&&typeof e=="object"&&typeof t=="object"&&Object.keys(t).forEach(o=>{typeof t[o]=="object"&&(e[o]===void 0||typeof e[o]=="object")?(e[o]===void 0&&(e[o]=Array.isArray(t[o])?[]:{}),e[o]=gw(e[o],t[o],{depth:n-1,clobber:r})):(r||typeof e[o]!="object"&&typeof t[o]!="object")&&(e[o]=t[o])}),e)},On=gw,d0e="​",h0e={curveBasis:rfe,curveBasisClosed:ife,curveBasisOpen:ofe,curveBumpX:tfe,curveBumpY:nfe,curveBundle:sfe,curveCardinalClosed:lfe,curveCardinalOpen:cfe,curveCardinal:afe,curveCatmullRomClosed:dfe,curveCatmullRomOpen:hfe,curveCatmullRom:ufe,curveLinear:efe,curveLinearClosed:ffe,curveMonotoneX:pfe,curveMonotoneY:gfe,curveNatural:mfe,curveStep:yfe,curveStepAfter:xfe,curveStepBefore:vfe},f0e=/\s*(?:(\w+)(?=:):|(\w+))\s*(?:(\w+)|((?:(?!}%{2}).|\r?\n)*))?\s*(?:}%{2})?/gi,p0e=function(e,t){const n=xR(e,/(?:init\b)|(?:initialize\b)/);let r={};if(Array.isArray(n)){const o=n.map(s=>s.args);yh(o),r=On(r,[...o])}else r=n.args;if(!r)return;let i=h0(e,t);return["config"].forEach(o=>{r[o]!==void 0&&(i==="flowchart-v2"&&(i="flowchart"),r[i]=r[o],delete r[o])}),r},xR=function(e,t=null){try{const n=new RegExp(`[%]{2}(?![{]${f0e.source})(?=[}][%]{2}).*
`,"ig");e=e.trim().replace(n,"").replace(/'/gm,'"'),xe.debug(`Detecting diagram directive${t!==null?" type:"+t:""} based on the text:${e}`);let r;const i=[];for(;(r=yg.exec(e))!==null;)if(r.index===yg.lastIndex&&yg.lastIndex++,r&&!t||t&&r[1]&&r[1].match(t)||t&&r[2]&&r[2].match(t)){const o=r[1]?r[1]:r[2],s=r[3]?r[3].trim():r[4]?JSON.parse(r[4].trim()):null;i.push({type:o,args:s})}return i.length===0&&i.push({type:e,args:null}),i.length===1?i[0]:i}catch(n){return xe.error(`ERROR: ${n.message} - Unable to parse directive
      ${t!==null?" type:"+t:""} based on the text:${e}`),{type:null,args:null}}},g0e=function(e,t){for(const[n,r]of t.entries())if(r.match(e))return n;return-1};function m0e(e,t){if(!e)return t;const n=`curve${e.charAt(0).toUpperCase()+e.slice(1)}`;return h0e[n]||t}function y0e(e,t){const n=e.trim();if(n)return t.securityLevel!=="loose"?QL.sanitizeUrl(n):n}const v0e=(e,...t)=>{const n=e.split("."),r=n.length-1,i=n[r];let o=window;for(let s=0;s<r;s++)if(o=o[n[s]],!o)return;o[i](...t)};function Fm(e,t){return e&&t?Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)):0}function x0e(e){let t,n=0;e.forEach(o=>{n+=Fm(o,t),t=o});let r=n/2,i;return t=void 0,e.forEach(o=>{if(t&&!i){const s=Fm(o,t);if(s<r)r-=s;else{const a=r/s;a<=0&&(i=t),a>=1&&(i={x:o.x,y:o.y}),a>0&&a<1&&(i={x:(1-a)*t.x+a*o.x,y:(1-a)*t.y+a*o.y})}}t=o}),i}function b0e(e){return e.length===1?e[0]:x0e(e)}const w0e=(e,t,n)=>{let r;xe.info(`our points ${JSON.stringify(t)}`),t[0]!==n&&(t=t.reverse());let o=25,s;r=void 0,t.forEach(u=>{if(r&&!s){const d=Fm(u,r);if(d<o)o-=d;else{const h=o/d;h<=0&&(s=r),h>=1&&(s={x:u.x,y:u.y}),h>0&&h<1&&(s={x:(1-h)*r.x+h*u.x,y:(1-h)*r.y+h*u.y})}}r=u});const a=e?10:5,l=Math.atan2(t[0].y-s.y,t[0].x-s.x),c={x:0,y:0};return c.x=Math.sin(l)*a+(t[0].x+s.x)/2,c.y=-Math.cos(l)*a+(t[0].y+s.y)/2,c};function S0e(e,t,n){let r=JSON.parse(JSON.stringify(n)),i;xe.info("our points",r),t!=="start_left"&&t!=="start_right"&&(r=r.reverse()),r.forEach(d=>{i=d});let s=25+e,a;i=void 0,r.forEach(d=>{if(i&&!a){const h=Fm(d,i);if(h<s)s-=h;else{const f=s/h;f<=0&&(a=i),f>=1&&(a={x:d.x,y:d.y}),f>0&&f<1&&(a={x:(1-f)*i.x+f*d.x,y:(1-f)*i.y+f*d.y})}}i=d});const l=10+e*.5,c=Math.atan2(r[0].y-a.y,r[0].x-a.x),u={x:0,y:0};return u.x=Math.sin(c)*l+(r[0].x+a.x)/2,u.y=-Math.cos(c)*l+(r[0].y+a.y)/2,t==="start_left"&&(u.x=Math.sin(c+Math.PI)*l+(r[0].x+a.x)/2,u.y=-Math.cos(c+Math.PI)*l+(r[0].y+a.y)/2),t==="end_right"&&(u.x=Math.sin(c-Math.PI)*l+(r[0].x+a.x)/2-5,u.y=-Math.cos(c-Math.PI)*l+(r[0].y+a.y)/2-5),t==="end_left"&&(u.x=Math.sin(c)*l+(r[0].x+a.x)/2-5,u.y=-Math.cos(c)*l+(r[0].y+a.y)/2-5),u}function _0e(e){let t="",n="";for(const r of e)r!==void 0&&(r.startsWith("color:")||r.startsWith("text-align:")?n=n+r+";":t=t+r+";");return{style:t,labelStyle:n}}let UI=0;const C0e=()=>(UI++,"id-"+Math.random().toString(36).substr(2,12)+"-"+UI);function E0e(e){let t="";const n="0123456789abcdef",r=n.length;for(let i=0;i<e;i++)t+=n.charAt(Math.floor(Math.random()*r));return t}const k0e=e=>E0e(e.length),T0e=function(){return{x:0,y:0,fill:void 0,anchor:"start",style:"#666",width:100,height:100,textMargin:0,rx:0,ry:0,valign:void 0}},P0e=function(e,t){const n=t.text.replace(OC.lineBreakRegex," "),[,r]=BC(t.fontSize),i=e.append("text");i.attr("x",t.x),i.attr("y",t.y),i.style("text-anchor",t.anchor),i.style("font-family",t.fontFamily),i.style("font-size",r),i.style("font-weight",t.fontWeight),i.attr("fill",t.fill),t.class!==void 0&&i.attr("class",t.class);const o=i.append("tspan");return o.attr("x",t.x+t.textMargin*2),o.attr("fill",t.fill),o.text(n),i},I0e=Qh((e,t,n)=>{if(!e||(n=Object.assign({fontSize:12,fontWeight:400,fontFamily:"Arial",joinWith:"<br/>"},n),OC.lineBreakRegex.test(e)))return e;const r=e.split(" "),i=[];let o="";return r.forEach((s,a)=>{const l=Nm(`${s} `,n),c=Nm(o,n);if(l>t){const{hyphenatedStrings:h,remainingWord:f}=$0e(s,t,"-",n);i.push(o,...h),o=f}else c+l>=t?(i.push(o),o=s):o=[o,s].filter(Boolean).join(" ");a+1===r.length&&i.push(o)}),i.filter(s=>s!=="").join(n.joinWith)},(e,t,n)=>`${e}${t}${n.fontSize}${n.fontWeight}${n.fontFamily}${n.joinWith}`),$0e=Qh((e,t,n="-",r)=>{r=Object.assign({fontSize:12,fontWeight:400,fontFamily:"Arial",margin:0},r);const i=[...e],o=[];let s="";return i.forEach((a,l)=>{const c=`${s}${a}`;if(Nm(c,r)>=t){const d=l+1,h=i.length===d,f=`${c}${n}`;o.push(h?c:f),s=""}else s=c}),{hyphenatedStrings:o,remainingWord:s}},(e,t,n="-",r)=>`${e}${t}${n}${r.fontSize}${r.fontWeight}${r.fontFamily}`);function A0e(e,t){return t=Object.assign({fontSize:12,fontWeight:400,fontFamily:"Arial",margin:15},t),LC(e,t).height}function Nm(e,t){return t=Object.assign({fontSize:12,fontWeight:400,fontFamily:"Arial"},t),LC(e,t).width}const LC=Qh((e,t)=>{t=Object.assign({fontSize:12,fontWeight:400,fontFamily:"Arial"},t);const{fontSize:n,fontFamily:r,fontWeight:i}=t;if(!e)return{width:0,height:0};const[,o]=BC(n),s=["sans-serif",r],a=e.split(OC.lineBreakRegex),l=[],c=Yr("body");if(!c.remove)return{width:0,height:0,lineHeight:0};const u=c.append("svg");for(const h of s){let f=0;const p={width:0,height:0,lineHeight:0};for(const g of a){const y=T0e();y.text=g||d0e;const x=P0e(u,y).style("font-size",o).style("font-weight",i).style("font-family",h),w=(x._groups||x)[0][0].getBBox();if(w.width===0&&w.height===0)throw new Error("svg element not in render tree");p.width=Math.round(Math.max(p.width,w.width)),f=Math.round(w.height),p.height+=f,p.lineHeight=Math.round(Math.max(p.lineHeight,f))}l.push(p)}u.remove();const d=isNaN(l[1].height)||isNaN(l[1].width)||isNaN(l[1].lineHeight)||l[0].height>l[1].height&&l[0].width>l[1].width&&l[0].lineHeight>l[1].lineHeight?0:1;return l[d]},(e,t)=>`${e}${t.fontSize}${t.fontWeight}${t.fontFamily}`),M0e=class{constructor(t,n){this.deterministic=t,this.seed=n,this.count=n?n.length:0}next(){return this.deterministic?this.count++:Date.now()}};let Sp;const O0e=function(e){return Sp=Sp||document.createElement("div"),e=escape(e).replace(/%26/g,"&").replace(/%23/g,"#").replace(/%3B/g,";"),Sp.innerHTML=e,unescape(Sp.textContent)},yh=e=>{if(xe.debug("sanitizeDirective called with",e),!(typeof e!="object"||e==null)){if(Array.isArray(e)){e.forEach(t=>yh(t));return}for(const t of Object.keys(e)){if(xe.debug("Checking key",t),t.startsWith("__")||t.includes("proto")||t.includes("constr")||!a0e.has(t)||e[t]==null){xe.debug("sanitize deleting key: ",t),delete e[t];continue}if(typeof e[t]=="object"){xe.debug("sanitizing object",t),yh(e[t]);continue}const n=["themeCSS","fontFamily","altFontFamily"];for(const r of n)t.includes(r)&&(xe.debug("sanitizing css option",t),e[t]=bR(e[t]))}if(e.themeVariables)for(const t of Object.keys(e.themeVariables)){const n=e.themeVariables[t];n!=null&&n.match&&!n.match(/^[\d "#%(),.;A-Za-z]+$/)&&(e.themeVariables[t]="")}xe.debug("After sanitization",e)}},bR=e=>{let t=0,n=0;for(const r of e){if(t<n)return"{ /* ERROR: Unbalanced CSS */ }";r==="{"?t++:r==="}"&&n++}return t!==n?"{ /* ERROR: Unbalanced CSS */ }":e};function wR(e){return"str"in e}const L0e=(e,t,n,r)=>{if(!r)return;const i=e.node().getBBox();e.append("text").text(r).attr("x",i.x+i.width/2).attr("y",-n).attr("class",t)},BC=e=>{if(typeof e=="number")return[e,e+"px"];const t=parseInt(e,10);return Number.isNaN(t)?[void 0,void 0]:e===String(t)?[t,e+"px"]:[t,e]};function B0e(e,t){return iye({},e,t)}const vg={assignWithDepth:On,wrapLabel:I0e,calculateTextHeight:A0e,calculateTextWidth:Nm,calculateTextDimensions:LC,cleanAndMerge:B0e,detectInit:p0e,detectDirective:xR,isSubstringInArray:g0e,interpolateToCurve:m0e,calcLabelPosition:b0e,calcCardinalityPosition:w0e,calcTerminalLabelPosition:S0e,formatUrl:y0e,getStylesFromArray:_0e,generateId:C0e,random:k0e,runFunc:v0e,entityDecode:O0e,initIdGenerator:M0e,sanitizeDirective:yh,sanitizeCss:bR,insertTitle:L0e,parseFontSize:BC},WI="10.4.0",vh=Object.freeze(l0e);let sr=On({},vh),SR,Fc=[],vd=On({},vh);const f0=(e,t)=>{let n=On({},e),r={};for(const i of t)CR(i),r=On(r,i);if(n=On(n,r),r.theme&&r.theme in Do){const i=On({},SR),o=On(i.themeVariables||{},r.themeVariables);n.theme&&n.theme in Do&&(n.themeVariables=Do[n.theme].getThemeVariables(o))}return vd=n,ER(vd),vd},R0e=e=>(sr=On({},vh),sr=On(sr,e),e.theme&&Do[e.theme]&&(sr.themeVariables=Do[e.theme].getThemeVariables(e.themeVariables)),f0(sr,Fc),sr),D0e=e=>{SR=On({},e)},F0e=e=>(sr=On(sr,e),f0(sr,Fc),sr),_R=()=>On({},sr),N0e=e=>(ER(e),On(vd,e),Ri()),Ri=()=>On({},vd),CR=e=>{e&&(["secure",...sr.secure??[]].forEach(t=>{Object.hasOwn(e,t)&&(xe.debug(`Denied attempt to modify a secure key ${t}`,e[t]),delete e[t])}),Object.keys(e).forEach(t=>{t.startsWith("__")&&delete e[t]}),Object.keys(e).forEach(t=>{typeof e[t]=="string"&&(e[t].includes("<")||e[t].includes(">")||e[t].includes("url(data:"))&&delete e[t],typeof e[t]=="object"&&CR(e[t])}))},jm=e=>{yh(e),e.fontFamily&&(!e.themeVariables||!e.themeVariables.fontFamily)&&(e.themeVariables={fontFamily:e.fontFamily}),Fc.push(e),f0(sr,Fc)},zm=(e=sr)=>{Fc=[],f0(e,Fc)},j0e={LAZY_LOAD_DEPRECATED:"The configuration options lazyLoadedDiagrams and loadExternalDiagramsAtStartup are deprecated. Please use registerExternalDiagrams instead."},HI={},z0e=e=>{HI[e]||(xe.warn(j0e[e]),HI[e]=!0)},ER=e=>{e&&(e.lazyLoadedDiagrams||e.loadExternalDiagramsAtStartup)&&z0e("LAZY_LOAD_DEPRECATED")},kR="c4",U0e=e=>/^\s*C4Context|C4Container|C4Component|C4Dynamic|C4Deployment/.test(e),W0e=async()=>{const{diagram:e}=await Xt(()=>import("./c4Diagram-c0b17d02-ad19ec45.js"),["assets/c4Diagram-c0b17d02-ad19ec45.js","assets/svgDrawCommon-42e92da3-09597076.js"]);return{id:kR,diagram:e}},H0e={id:kR,detector:U0e,loader:W0e},K0e=H0e,TR="flowchart",V0e=(e,t)=>{var n,r;return((n=t==null?void 0:t.flowchart)==null?void 0:n.defaultRenderer)==="dagre-wrapper"||((r=t==null?void 0:t.flowchart)==null?void 0:r.defaultRenderer)==="elk"?!1:/^\s*graph/.test(e)},Y0e=async()=>{const{diagram:e}=await Xt(()=>import("./flowDiagram-d6f8fe3a-c3e12344.js"),["assets/flowDiagram-d6f8fe3a-c3e12344.js","assets/flowDb-ff651a22-8374c343.js","assets/layout-4710d466.js","assets/styles-1b0c237a-27924554.js","assets/index-f58d48f9-1632631f.js","assets/edges-0005682e-e95aebc2.js","assets/createText-3b1f58a4-251c238c.js","assets/svgDraw-70101091-1c39a1fb.js","assets/line-cc74517a.js","assets/array-9f3ba611.js","assets/path-53f90ab3.js"]);return{id:TR,diagram:e}},q0e={id:TR,detector:V0e,loader:Y0e},G0e=q0e,PR="flowchart-v2",X0e=(e,t)=>{var n,r,i;return((n=t==null?void 0:t.flowchart)==null?void 0:n.defaultRenderer)==="dagre-d3"||((r=t==null?void 0:t.flowchart)==null?void 0:r.defaultRenderer)==="elk"?!1:/^\s*graph/.test(e)&&((i=t==null?void 0:t.flowchart)==null?void 0:i.defaultRenderer)==="dagre-wrapper"?!0:/^\s*flowchart/.test(e)},Z0e=async()=>{const{diagram:e}=await Xt(()=>import("./flowDiagram-v2-58f49b84-d55b3563.js"),["assets/flowDiagram-v2-58f49b84-d55b3563.js","assets/flowDb-ff651a22-8374c343.js","assets/styles-1b0c237a-27924554.js","assets/layout-4710d466.js","assets/index-f58d48f9-1632631f.js","assets/edges-0005682e-e95aebc2.js","assets/createText-3b1f58a4-251c238c.js","assets/svgDraw-70101091-1c39a1fb.js","assets/line-cc74517a.js","assets/array-9f3ba611.js","assets/path-53f90ab3.js"]);return{id:PR,diagram:e}},Q0e={id:PR,detector:X0e,loader:Z0e},J0e=Q0e,IR="er",eve=e=>/^\s*erDiagram/.test(e),tve=async()=>{const{diagram:e}=await Xt(()=>import("./erDiagram-dedf2781-73337f8d.js"),["assets/erDiagram-dedf2781-73337f8d.js","assets/layout-4710d466.js","assets/line-cc74517a.js","assets/array-9f3ba611.js","assets/path-53f90ab3.js"]);return{id:IR,diagram:e}},nve={id:IR,detector:eve,loader:tve},rve=nve,$R="gitGraph",ive=e=>/^\s*gitGraph/.test(e),ove=async()=>{const{diagram:e}=await Xt(()=>import("./gitGraphDiagram-e0ffc2d1-790bf4c9.js"),[]);return{id:$R,diagram:e}},sve={id:$R,detector:ive,loader:ove},ave=sve,AR="gantt",lve=e=>/^\s*gantt/.test(e),cve=async()=>{const{diagram:e}=await Xt(()=>import("./ganttDiagram-088dbd90-24e4bf03.js"),["assets/ganttDiagram-088dbd90-24e4bf03.js","assets/linear-8c5763af.js","assets/init-77b53fdd.js"]);return{id:AR,diagram:e}},uve={id:AR,detector:lve,loader:cve},dve=uve,MR="info",hve=e=>/^\s*info/.test(e),fve=async()=>{const{diagram:e}=await Xt(()=>import("./infoDiagram-64895a6e-29283e39.js"),[]);return{id:MR,diagram:e}},pve={id:MR,detector:hve,loader:fve},OR="pie",gve=e=>/^\s*pie/.test(e),mve=async()=>{const{diagram:e}=await Xt(()=>import("./pieDiagram-3fca7ce7-034cd839.js"),["assets/pieDiagram-3fca7ce7-034cd839.js","assets/arc-414a26bb.js","assets/path-53f90ab3.js","assets/ordinal-ba9b4969.js","assets/init-77b53fdd.js","assets/array-9f3ba611.js"]);return{id:OR,diagram:e}},yve={id:OR,detector:gve,loader:mve},LR="quadrantChart",vve=e=>/^\s*quadrantChart/.test(e),xve=async()=>{const{diagram:e}=await Xt(()=>import("./quadrantDiagram-0ca4be02-dc6cbab1.js"),["assets/quadrantDiagram-0ca4be02-dc6cbab1.js","assets/linear-8c5763af.js","assets/init-77b53fdd.js"]);return{id:LR,diagram:e}},bve={id:LR,detector:vve,loader:xve},wve=bve,BR="requirement",Sve=e=>/^\s*requirement(Diagram)?/.test(e),_ve=async()=>{const{diagram:e}=await Xt(()=>import("./requirementDiagram-e13af0f0-b49cd75f.js"),["assets/requirementDiagram-e13af0f0-b49cd75f.js","assets/layout-4710d466.js","assets/line-cc74517a.js","assets/array-9f3ba611.js","assets/path-53f90ab3.js"]);return{id:BR,diagram:e}},Cve={id:BR,detector:Sve,loader:_ve},Eve=Cve,RR="sequence",kve=e=>/^\s*sequenceDiagram/.test(e),Tve=async()=>{const{diagram:e}=await Xt(()=>import("./sequenceDiagram-84aa38e3-cc11d0f0.js"),["assets/sequenceDiagram-84aa38e3-cc11d0f0.js","assets/svgDrawCommon-42e92da3-09597076.js"]);return{id:RR,diagram:e}},Pve={id:RR,detector:kve,loader:Tve},Ive=Pve,DR="class",$ve=(e,t)=>{var n;return((n=t==null?void 0:t.class)==null?void 0:n.defaultRenderer)==="dagre-wrapper"?!1:/^\s*classDiagram/.test(e)},Ave=async()=>{const{diagram:e}=await Xt(()=>import("./classDiagram-a8cc8886-9aa1d21a.js"),["assets/classDiagram-a8cc8886-9aa1d21a.js","assets/styles-622362e4-9c162843.js","assets/layout-4710d466.js","assets/svgDraw-70101091-1c39a1fb.js","assets/line-cc74517a.js","assets/array-9f3ba611.js","assets/path-53f90ab3.js"]);return{id:DR,diagram:e}},Mve={id:DR,detector:$ve,loader:Ave},Ove=Mve,FR="classDiagram",Lve=(e,t)=>{var n;return/^\s*classDiagram/.test(e)&&((n=t==null?void 0:t.class)==null?void 0:n.defaultRenderer)==="dagre-wrapper"?!0:/^\s*classDiagram-v2/.test(e)},Bve=async()=>{const{diagram:e}=await Xt(()=>import("./classDiagram-v2-802a48d3-36941ae8.js"),["assets/classDiagram-v2-802a48d3-36941ae8.js","assets/styles-622362e4-9c162843.js","assets/layout-4710d466.js","assets/index-f58d48f9-1632631f.js","assets/edges-0005682e-e95aebc2.js","assets/createText-3b1f58a4-251c238c.js","assets/svgDraw-70101091-1c39a1fb.js","assets/line-cc74517a.js","assets/array-9f3ba611.js","assets/path-53f90ab3.js"]);return{id:FR,diagram:e}},Rve={id:FR,detector:Lve,loader:Bve},Dve=Rve,NR="state",Fve=(e,t)=>{var n;return((n=t==null?void 0:t.state)==null?void 0:n.defaultRenderer)==="dagre-wrapper"?!1:/^\s*stateDiagram/.test(e)},Nve=async()=>{const{diagram:e}=await Xt(()=>import("./stateDiagram-9a586ac6-c4f6234d.js"),["assets/stateDiagram-9a586ac6-c4f6234d.js","assets/styles-a1a6e33f-06ca2da8.js","assets/layout-4710d466.js","assets/line-cc74517a.js","assets/array-9f3ba611.js","assets/path-53f90ab3.js"]);return{id:NR,diagram:e}},jve={id:NR,detector:Fve,loader:Nve},zve=jve,jR="stateDiagram",Uve=(e,t)=>{var n;return!!(/^\s*stateDiagram-v2/.test(e)||/^\s*stateDiagram/.test(e)&&((n=t==null?void 0:t.state)==null?void 0:n.defaultRenderer)==="dagre-wrapper")},Wve=async()=>{const{diagram:e}=await Xt(()=>import("./stateDiagram-v2-96f2b9df-0d290c6a.js"),["assets/stateDiagram-v2-96f2b9df-0d290c6a.js","assets/styles-a1a6e33f-06ca2da8.js","assets/layout-4710d466.js","assets/index-f58d48f9-1632631f.js","assets/edges-0005682e-e95aebc2.js","assets/createText-3b1f58a4-251c238c.js","assets/svgDraw-70101091-1c39a1fb.js","assets/line-cc74517a.js","assets/array-9f3ba611.js","assets/path-53f90ab3.js"]);return{id:jR,diagram:e}},Hve={id:jR,detector:Uve,loader:Wve},Kve=Hve,zR="journey",Vve=e=>/^\s*journey/.test(e),Yve=async()=>{const{diagram:e}=await Xt(()=>import("./journeyDiagram-adaa34f8-41c0cf03.js"),["assets/journeyDiagram-adaa34f8-41c0cf03.js","assets/svgDrawCommon-42e92da3-09597076.js","assets/arc-414a26bb.js","assets/path-53f90ab3.js"]);return{id:zR,diagram:e}},qve={id:zR,detector:Vve,loader:Yve},Gve=qve,Xve=e=>{var t;const{securityLevel:n}=Ri();let r=Yr("body");if(n==="sandbox"){const s=((t=Yr(`#i${e}`).node())==null?void 0:t.contentDocument)??document;r=Yr(s.body)}return r.select(`#${e}`)},Zve=function(e,t){for(let n of t)e.attr(n[0],n[1])},Qve=function(e,t,n){let r=new Map;return n?(r.set("width","100%"),r.set("style",`max-width: ${t}px;`)):(r.set("height",e),r.set("width",t)),r},UR=function(e,t,n,r){const i=Qve(t,n,r);Zve(e,i)},Jve=function(e,t,n,r){const i=t.node().getBBox(),o=i.width,s=i.height;xe.info(`SVG bounds: ${o}x${s}`,i);let a=0,l=0;xe.info(`Graph bounds: ${a}x${l}`,e),a=o+n*2,l=s+n*2,xe.info(`Calculated bounds: ${a}x${l}`),UR(t,l,a,r);const c=`${i.x-n} ${i.y-n} ${i.width+2*n} ${i.height+2*n}`;t.attr("viewBox",c)},e1e=(e,t,n)=>{xe.debug(`renering svg for syntax error
`);const r=Xve(t);r.attr("viewBox","0 0 2412 512"),UR(r,100,512,!0);const i=r.append("g");i.append("path").attr("class","error-icon").attr("d","m411.313,123.313c6.25-6.25 6.25-16.375 0-22.625s-16.375-6.25-22.625,0l-32,32-9.375,9.375-20.688-20.688c-12.484-12.5-32.766-12.5-45.25,0l-16,16c-1.261,1.261-2.304,2.648-3.31,4.051-21.739-8.561-45.324-13.426-70.065-13.426-105.867,0-192,86.133-192,192s86.133,192 192,192 192-86.133 192-192c0-24.741-4.864-48.327-13.426-70.065 1.402-1.007 2.79-2.049 4.051-3.31l16-16c12.5-12.492 12.5-32.758 0-45.25l-20.688-20.688 9.375-9.375 32.001-31.999zm-219.313,100.687c-52.938,0-96,43.063-96,96 0,8.836-7.164,16-16,16s-16-7.164-16-16c0-70.578 57.422-128 128-128 8.836,0 16,7.164 16,16s-7.164,16-16,16z"),i.append("path").attr("class","error-icon").attr("d","m459.02,148.98c-6.25-6.25-16.375-6.25-22.625,0s-6.25,16.375 0,22.625l16,16c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688 6.25-6.25 6.25-16.375 0-22.625l-16.001-16z"),i.append("path").attr("class","error-icon").attr("d","m340.395,75.605c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688 6.25-6.25 6.25-16.375 0-22.625l-16-16c-6.25-6.25-16.375-6.25-22.625,0s-6.25,16.375 0,22.625l15.999,16z"),i.append("path").attr("class","error-icon").attr("d","m400,64c8.844,0 16-7.164 16-16v-32c0-8.836-7.156-16-16-16-8.844,0-16,7.164-16,16v32c0,8.836 7.156,16 16,16z"),i.append("path").attr("class","error-icon").attr("d","m496,96.586h-32c-8.844,0-16,7.164-16,16 0,8.836 7.156,16 16,16h32c8.844,0 16-7.164 16-16 0-8.836-7.156-16-16-16z"),i.append("path").attr("class","error-icon").attr("d","m436.98,75.605c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688l32-32c6.25-6.25 6.25-16.375 0-22.625s-16.375-6.25-22.625,0l-32,32c-6.251,6.25-6.251,16.375-0.001,22.625z"),i.append("text").attr("class","error-text").attr("x",1440).attr("y",250).attr("font-size","150px").style("text-anchor","middle").text("Syntax error in text"),i.append("text").attr("class","error-text").attr("x",1250).attr("y",400).attr("font-size","100px").style("text-anchor","middle").text(`mermaid version ${n}`)},WR={draw:e1e},t1e=WR,n1e={db:{},renderer:WR,parser:{parser:{yy:{}},parse:()=>{}}},r1e=n1e,HR="flowchart-elk",i1e=(e,t)=>{var n;return!!(/^\s*flowchart-elk/.test(e)||/^\s*flowchart|graph/.test(e)&&((n=t==null?void 0:t.flowchart)==null?void 0:n.defaultRenderer)==="elk")},o1e=async()=>{const{diagram:e}=await Xt(()=>import("./flowchart-elk-definition-56584a6c-553b62fc.js"),["assets/flowchart-elk-definition-56584a6c-553b62fc.js","assets/flowDb-ff651a22-8374c343.js","assets/edges-0005682e-e95aebc2.js","assets/createText-3b1f58a4-251c238c.js","assets/svgDraw-70101091-1c39a1fb.js","assets/line-cc74517a.js","assets/array-9f3ba611.js","assets/path-53f90ab3.js"]);return{id:HR,diagram:e}},s1e={id:HR,detector:i1e,loader:o1e},a1e=s1e,KR="timeline",l1e=e=>/^\s*timeline/.test(e),c1e=async()=>{const{diagram:e}=await Xt(()=>import("./timeline-definition-1a90b03d-9779a397.js"),["assets/timeline-definition-1a90b03d-9779a397.js","assets/arc-414a26bb.js","assets/path-53f90ab3.js"]);return{id:KR,diagram:e}},u1e={id:KR,detector:l1e,loader:c1e},d1e=u1e,VR="mindmap",h1e=e=>/^\s*mindmap/.test(e),f1e=async()=>{const{diagram:e}=await Xt(()=>import("./mindmap-definition-57868176-fb0c7a9b.js"),["assets/mindmap-definition-57868176-fb0c7a9b.js","assets/createText-3b1f58a4-251c238c.js"]);return{id:VR,diagram:e}},p1e={id:VR,detector:h1e,loader:f1e},g1e=p1e,YR="sankey",m1e=e=>/^\s*sankey-beta/.test(e),y1e=async()=>{const{diagram:e}=await Xt(()=>import("./sankeyDiagram-a7f8e230-b5739dbd.js"),["assets/sankeyDiagram-a7f8e230-b5739dbd.js","assets/ordinal-ba9b4969.js","assets/init-77b53fdd.js"]);return{id:YR,diagram:e}},v1e={id:YR,detector:m1e,loader:y1e},x1e=v1e,xg={},b1e=(e,t,n)=>{let r="";return e in xg&&xg[e]?r=xg[e](n):xe.warn(`No theme found for ${e}`),` & {
    font-family: ${n.fontFamily};
    font-size: ${n.fontSize};
    fill: ${n.textColor}
  }

  /* Classes common for multiple diagrams */

  & .error-icon {
    fill: ${n.errorBkgColor};
  }
  & .error-text {
    fill: ${n.errorTextColor};
    stroke: ${n.errorTextColor};
  }

  & .edge-thickness-normal {
    stroke-width: 2px;
  }
  & .edge-thickness-thick {
    stroke-width: 3.5px
  }
  & .edge-pattern-solid {
    stroke-dasharray: 0;
  }

  & .edge-pattern-dashed{
    stroke-dasharray: 3;
  }
  .edge-pattern-dotted {
    stroke-dasharray: 2;
  }

  & .marker {
    fill: ${n.lineColor};
    stroke: ${n.lineColor};
  }
  & .marker.cross {
    stroke: ${n.lineColor};
  }

  & svg {
    font-family: ${n.fontFamily};
    font-size: ${n.fontSize};
  }

  ${r}

  ${t}
`},w1e=(e,t)=>{t!==void 0&&(xg[e]=t)},S1e=b1e;let RC="",p0="",DC="";const FC=e=>mh(e,Ri()),qR=function(){RC="",DC="",p0=""},GR=function(e){RC=FC(e).replace(/^\s+/g,"")},XR=function(){return RC||p0},ZR=function(e){DC=FC(e).replace(/\n\s+/g,`
`)},QR=function(){return DC},JR=function(e){p0=FC(e)},e8=function(){return p0},_1e={getAccTitle:XR,setAccTitle:GR,getDiagramTitle:e8,setDiagramTitle:JR,getAccDescription:QR,setAccDescription:ZR,clear:qR},C1e=Object.freeze(Object.defineProperty({__proto__:null,clear:qR,default:_1e,getAccDescription:QR,getAccTitle:XR,getDiagramTitle:e8,setAccDescription:ZR,setAccTitle:GR,setDiagramTitle:JR},Symbol.toStringTag,{value:"Module"}));let xa={};const t8=function(e,t,n,r){xe.debug("parseDirective is being called",t,n,r);try{if(t!==void 0)switch(t=t.trim(),n){case"open_directive":xa={};break;case"type_directive":if(!xa)throw new Error("currentDirective is undefined");xa.type=t.toLowerCase();break;case"arg_directive":if(!xa)throw new Error("currentDirective is undefined");xa.args=JSON.parse(t);break;case"close_directive":E1e(e,xa,r),xa=void 0;break}}catch(i){xe.error(`Error while rendering sequenceDiagram directive: ${t} jison context: ${n}`),xe.error(i.message)}},E1e=function(e,t,n){switch(xe.info(`Directive type=${t.type} with args:`,t.args),t.type){case"init":case"initialize":{["config"].forEach(r=>{t.args[r]!==void 0&&(n==="flowchart-v2"&&(n="flowchart"),t.args[n]=t.args[r],delete t.args[r])}),jm(t.args);break}case"wrap":case"nowrap":e&&e.setWrap&&e.setWrap(t.type==="wrap");break;case"themeCss":xe.warn("themeCss encountered");break;default:xe.warn(`Unhandled directive: source: '%%{${t.type}: ${JSON.stringify(t.args?t.args:{})}}%%`,t);break}},k1e=xe,T1e=MC,n8=Ri,P1e=e=>mh(e,n8()),I1e=Jve,$1e=()=>C1e,A1e=(e,t,n,r)=>t8(e,t,n,r),Um={},Wm=(e,t,n)=>{if(Um[e])throw new Error(`Diagram ${e} already registered.`);Um[e]=t,n&&vR(e,n),w1e(e,t.styles),t.injectUtils&&t.injectUtils(k1e,T1e,n8,P1e,I1e,$1e(),A1e)},NC=e=>{if(e in Um)return Um[e];throw new M1e(e)};class M1e extends Error{constructor(t){super(`Diagram ${t} not found.`)}}let KI=!1;const jC=()=>{KI||(KI=!0,Wm("error",r1e,e=>e.toLowerCase().trim()==="error"),Wm("---",{db:{clear:()=>{}},styles:{},renderer:{},parser:{parser:{yy:{}},parse:()=>{throw new Error("Diagrams beginning with --- are not valid. If you were trying to use a YAML front-matter, please ensure that you've correctly opened and closed the YAML front-matter with un-indented `---` blocks")}},init:()=>null},e=>e.toLowerCase().trimStart().startsWith("---")),yR(K0e,Dve,Ove,rve,dve,pve,yve,Eve,Ive,a1e,J0e,G0e,g1e,d1e,ave,Kve,zve,Gve,wve,x1e))};/*! js-yaml 4.1.0 https://github.com/nodeca/js-yaml @license MIT */function r8(e){return typeof e>"u"||e===null}function O1e(e){return typeof e=="object"&&e!==null}function L1e(e){return Array.isArray(e)?e:r8(e)?[]:[e]}function B1e(e,t){var n,r,i,o;if(t)for(o=Object.keys(t),n=0,r=o.length;n<r;n+=1)i=o[n],e[i]=t[i];return e}function R1e(e,t){var n="",r;for(r=0;r<t;r+=1)n+=e;return n}function D1e(e){return e===0&&Number.NEGATIVE_INFINITY===1/e}var F1e=r8,N1e=O1e,j1e=L1e,z1e=R1e,U1e=D1e,W1e=B1e,Vn={isNothing:F1e,isObject:N1e,toArray:j1e,repeat:z1e,isNegativeZero:U1e,extend:W1e};function i8(e,t){var n="",r=e.reason||"(unknown reason)";return e.mark?(e.mark.name&&(n+='in "'+e.mark.name+'" '),n+="("+(e.mark.line+1)+":"+(e.mark.column+1)+")",!t&&e.mark.snippet&&(n+=`

`+e.mark.snippet),r+" "+n):r}function xh(e,t){Error.call(this),this.name="YAMLException",this.reason=e,this.mark=t,this.message=i8(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||""}xh.prototype=Object.create(Error.prototype);xh.prototype.constructor=xh;xh.prototype.toString=function(t){return this.name+": "+i8(this,t)};var To=xh;function I1(e,t,n,r,i){var o="",s="",a=Math.floor(i/2)-1;return r-t>a&&(o=" ... ",t=r-a+o.length),n-r>a&&(s=" ...",n=r+a-s.length),{str:o+e.slice(t,n).replace(/\t/g,"→")+s,pos:r-t+o.length}}function $1(e,t){return Vn.repeat(" ",t-e.length)+e}function H1e(e,t){if(t=Object.create(t||null),!e.buffer)return null;t.maxLength||(t.maxLength=79),typeof t.indent!="number"&&(t.indent=1),typeof t.linesBefore!="number"&&(t.linesBefore=3),typeof t.linesAfter!="number"&&(t.linesAfter=2);for(var n=/\r?\n|\r|\0/g,r=[0],i=[],o,s=-1;o=n.exec(e.buffer);)i.push(o.index),r.push(o.index+o[0].length),e.position<=o.index&&s<0&&(s=r.length-2);s<0&&(s=r.length-1);var a="",l,c,u=Math.min(e.line+t.linesAfter,i.length).toString().length,d=t.maxLength-(t.indent+u+3);for(l=1;l<=t.linesBefore&&!(s-l<0);l++)c=I1(e.buffer,r[s-l],i[s-l],e.position-(r[s]-r[s-l]),d),a=Vn.repeat(" ",t.indent)+$1((e.line-l+1).toString(),u)+" | "+c.str+`
`+a;for(c=I1(e.buffer,r[s],i[s],e.position,d),a+=Vn.repeat(" ",t.indent)+$1((e.line+1).toString(),u)+" | "+c.str+`
`,a+=Vn.repeat("-",t.indent+u+3+c.pos)+`^
`,l=1;l<=t.linesAfter&&!(s+l>=i.length);l++)c=I1(e.buffer,r[s+l],i[s+l],e.position-(r[s]-r[s+l]),d),a+=Vn.repeat(" ",t.indent)+$1((e.line+l+1).toString(),u)+" | "+c.str+`
`;return a.replace(/\n$/,"")}var K1e=H1e,V1e=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],Y1e=["scalar","sequence","mapping"];function q1e(e){var t={};return e!==null&&Object.keys(e).forEach(function(n){e[n].forEach(function(r){t[String(r)]=n})}),t}function G1e(e,t){if(t=t||{},Object.keys(t).forEach(function(n){if(V1e.indexOf(n)===-1)throw new To('Unknown option "'+n+'" is met in definition of "'+e+'" YAML type.')}),this.options=t,this.tag=e,this.kind=t.kind||null,this.resolve=t.resolve||function(){return!0},this.construct=t.construct||function(n){return n},this.instanceOf=t.instanceOf||null,this.predicate=t.predicate||null,this.represent=t.represent||null,this.representName=t.representName||null,this.defaultStyle=t.defaultStyle||null,this.multi=t.multi||!1,this.styleAliases=q1e(t.styleAliases||null),Y1e.indexOf(this.kind)===-1)throw new To('Unknown kind "'+this.kind+'" is specified for "'+e+'" YAML type.')}var Rn=G1e;function VI(e,t){var n=[];return e[t].forEach(function(r){var i=n.length;n.forEach(function(o,s){o.tag===r.tag&&o.kind===r.kind&&o.multi===r.multi&&(i=s)}),n[i]=r}),n}function X1e(){var e={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}},t,n;function r(i){i.multi?(e.multi[i.kind].push(i),e.multi.fallback.push(i)):e[i.kind][i.tag]=e.fallback[i.tag]=i}for(t=0,n=arguments.length;t<n;t+=1)arguments[t].forEach(r);return e}function mw(e){return this.extend(e)}mw.prototype.extend=function(t){var n=[],r=[];if(t instanceof Rn)r.push(t);else if(Array.isArray(t))r=r.concat(t);else if(t&&(Array.isArray(t.implicit)||Array.isArray(t.explicit)))t.implicit&&(n=n.concat(t.implicit)),t.explicit&&(r=r.concat(t.explicit));else throw new To("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");n.forEach(function(o){if(!(o instanceof Rn))throw new To("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(o.loadKind&&o.loadKind!=="scalar")throw new To("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(o.multi)throw new To("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),r.forEach(function(o){if(!(o instanceof Rn))throw new To("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var i=Object.create(mw.prototype);return i.implicit=(this.implicit||[]).concat(n),i.explicit=(this.explicit||[]).concat(r),i.compiledImplicit=VI(i,"implicit"),i.compiledExplicit=VI(i,"explicit"),i.compiledTypeMap=X1e(i.compiledImplicit,i.compiledExplicit),i};var Z1e=mw,Q1e=new Rn("tag:yaml.org,2002:str",{kind:"scalar",construct:function(e){return e!==null?e:""}}),J1e=new Rn("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(e){return e!==null?e:[]}}),exe=new Rn("tag:yaml.org,2002:map",{kind:"mapping",construct:function(e){return e!==null?e:{}}}),txe=new Z1e({explicit:[Q1e,J1e,exe]});function nxe(e){if(e===null)return!0;var t=e.length;return t===1&&e==="~"||t===4&&(e==="null"||e==="Null"||e==="NULL")}function rxe(){return null}function ixe(e){return e===null}var oxe=new Rn("tag:yaml.org,2002:null",{kind:"scalar",resolve:nxe,construct:rxe,predicate:ixe,represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"});function sxe(e){if(e===null)return!1;var t=e.length;return t===4&&(e==="true"||e==="True"||e==="TRUE")||t===5&&(e==="false"||e==="False"||e==="FALSE")}function axe(e){return e==="true"||e==="True"||e==="TRUE"}function lxe(e){return Object.prototype.toString.call(e)==="[object Boolean]"}var cxe=new Rn("tag:yaml.org,2002:bool",{kind:"scalar",resolve:sxe,construct:axe,predicate:lxe,represent:{lowercase:function(e){return e?"true":"false"},uppercase:function(e){return e?"TRUE":"FALSE"},camelcase:function(e){return e?"True":"False"}},defaultStyle:"lowercase"});function uxe(e){return 48<=e&&e<=57||65<=e&&e<=70||97<=e&&e<=102}function dxe(e){return 48<=e&&e<=55}function hxe(e){return 48<=e&&e<=57}function fxe(e){if(e===null)return!1;var t=e.length,n=0,r=!1,i;if(!t)return!1;if(i=e[n],(i==="-"||i==="+")&&(i=e[++n]),i==="0"){if(n+1===t)return!0;if(i=e[++n],i==="b"){for(n++;n<t;n++)if(i=e[n],i!=="_"){if(i!=="0"&&i!=="1")return!1;r=!0}return r&&i!=="_"}if(i==="x"){for(n++;n<t;n++)if(i=e[n],i!=="_"){if(!uxe(e.charCodeAt(n)))return!1;r=!0}return r&&i!=="_"}if(i==="o"){for(n++;n<t;n++)if(i=e[n],i!=="_"){if(!dxe(e.charCodeAt(n)))return!1;r=!0}return r&&i!=="_"}}if(i==="_")return!1;for(;n<t;n++)if(i=e[n],i!=="_"){if(!hxe(e.charCodeAt(n)))return!1;r=!0}return!(!r||i==="_")}function pxe(e){var t=e,n=1,r;if(t.indexOf("_")!==-1&&(t=t.replace(/_/g,"")),r=t[0],(r==="-"||r==="+")&&(r==="-"&&(n=-1),t=t.slice(1),r=t[0]),t==="0")return 0;if(r==="0"){if(t[1]==="b")return n*parseInt(t.slice(2),2);if(t[1]==="x")return n*parseInt(t.slice(2),16);if(t[1]==="o")return n*parseInt(t.slice(2),8)}return n*parseInt(t,10)}function gxe(e){return Object.prototype.toString.call(e)==="[object Number]"&&e%1===0&&!Vn.isNegativeZero(e)}var mxe=new Rn("tag:yaml.org,2002:int",{kind:"scalar",resolve:fxe,construct:pxe,predicate:gxe,represent:{binary:function(e){return e>=0?"0b"+e.toString(2):"-0b"+e.toString(2).slice(1)},octal:function(e){return e>=0?"0o"+e.toString(8):"-0o"+e.toString(8).slice(1)},decimal:function(e){return e.toString(10)},hexadecimal:function(e){return e>=0?"0x"+e.toString(16).toUpperCase():"-0x"+e.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),yxe=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function vxe(e){return!(e===null||!yxe.test(e)||e[e.length-1]==="_")}function xxe(e){var t,n;return t=e.replace(/_/g,"").toLowerCase(),n=t[0]==="-"?-1:1,"+-".indexOf(t[0])>=0&&(t=t.slice(1)),t===".inf"?n===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:t===".nan"?NaN:n*parseFloat(t,10)}var bxe=/^[-+]?[0-9]+e/;function wxe(e,t){var n;if(isNaN(e))switch(t){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(t){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(t){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(Vn.isNegativeZero(e))return"-0.0";return n=e.toString(10),bxe.test(n)?n.replace("e",".e"):n}function Sxe(e){return Object.prototype.toString.call(e)==="[object Number]"&&(e%1!==0||Vn.isNegativeZero(e))}var _xe=new Rn("tag:yaml.org,2002:float",{kind:"scalar",resolve:vxe,construct:xxe,predicate:Sxe,represent:wxe,defaultStyle:"lowercase"}),o8=txe.extend({implicit:[oxe,cxe,mxe,_xe]}),Cxe=o8,s8=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),a8=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function Exe(e){return e===null?!1:s8.exec(e)!==null||a8.exec(e)!==null}function kxe(e){var t,n,r,i,o,s,a,l=0,c=null,u,d,h;if(t=s8.exec(e),t===null&&(t=a8.exec(e)),t===null)throw new Error("Date resolve error");if(n=+t[1],r=+t[2]-1,i=+t[3],!t[4])return new Date(Date.UTC(n,r,i));if(o=+t[4],s=+t[5],a=+t[6],t[7]){for(l=t[7].slice(0,3);l.length<3;)l+="0";l=+l}return t[9]&&(u=+t[10],d=+(t[11]||0),c=(u*60+d)*6e4,t[9]==="-"&&(c=-c)),h=new Date(Date.UTC(n,r,i,o,s,a,l)),c&&h.setTime(h.getTime()-c),h}function Txe(e){return e.toISOString()}var Pxe=new Rn("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:Exe,construct:kxe,instanceOf:Date,represent:Txe});function Ixe(e){return e==="<<"||e===null}var $xe=new Rn("tag:yaml.org,2002:merge",{kind:"scalar",resolve:Ixe}),zC=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;function Axe(e){if(e===null)return!1;var t,n,r=0,i=e.length,o=zC;for(n=0;n<i;n++)if(t=o.indexOf(e.charAt(n)),!(t>64)){if(t<0)return!1;r+=6}return r%8===0}function Mxe(e){var t,n,r=e.replace(/[\r\n=]/g,""),i=r.length,o=zC,s=0,a=[];for(t=0;t<i;t++)t%4===0&&t&&(a.push(s>>16&255),a.push(s>>8&255),a.push(s&255)),s=s<<6|o.indexOf(r.charAt(t));return n=i%4*6,n===0?(a.push(s>>16&255),a.push(s>>8&255),a.push(s&255)):n===18?(a.push(s>>10&255),a.push(s>>2&255)):n===12&&a.push(s>>4&255),new Uint8Array(a)}function Oxe(e){var t="",n=0,r,i,o=e.length,s=zC;for(r=0;r<o;r++)r%3===0&&r&&(t+=s[n>>18&63],t+=s[n>>12&63],t+=s[n>>6&63],t+=s[n&63]),n=(n<<8)+e[r];return i=o%3,i===0?(t+=s[n>>18&63],t+=s[n>>12&63],t+=s[n>>6&63],t+=s[n&63]):i===2?(t+=s[n>>10&63],t+=s[n>>4&63],t+=s[n<<2&63],t+=s[64]):i===1&&(t+=s[n>>2&63],t+=s[n<<4&63],t+=s[64],t+=s[64]),t}function Lxe(e){return Object.prototype.toString.call(e)==="[object Uint8Array]"}var Bxe=new Rn("tag:yaml.org,2002:binary",{kind:"scalar",resolve:Axe,construct:Mxe,predicate:Lxe,represent:Oxe}),Rxe=Object.prototype.hasOwnProperty,Dxe=Object.prototype.toString;function Fxe(e){if(e===null)return!0;var t=[],n,r,i,o,s,a=e;for(n=0,r=a.length;n<r;n+=1){if(i=a[n],s=!1,Dxe.call(i)!=="[object Object]")return!1;for(o in i)if(Rxe.call(i,o))if(!s)s=!0;else return!1;if(!s)return!1;if(t.indexOf(o)===-1)t.push(o);else return!1}return!0}function Nxe(e){return e!==null?e:[]}var jxe=new Rn("tag:yaml.org,2002:omap",{kind:"sequence",resolve:Fxe,construct:Nxe}),zxe=Object.prototype.toString;function Uxe(e){if(e===null)return!0;var t,n,r,i,o,s=e;for(o=new Array(s.length),t=0,n=s.length;t<n;t+=1){if(r=s[t],zxe.call(r)!=="[object Object]"||(i=Object.keys(r),i.length!==1))return!1;o[t]=[i[0],r[i[0]]]}return!0}function Wxe(e){if(e===null)return[];var t,n,r,i,o,s=e;for(o=new Array(s.length),t=0,n=s.length;t<n;t+=1)r=s[t],i=Object.keys(r),o[t]=[i[0],r[i[0]]];return o}var Hxe=new Rn("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:Uxe,construct:Wxe}),Kxe=Object.prototype.hasOwnProperty;function Vxe(e){if(e===null)return!0;var t,n=e;for(t in n)if(Kxe.call(n,t)&&n[t]!==null)return!1;return!0}function Yxe(e){return e!==null?e:{}}var qxe=new Rn("tag:yaml.org,2002:set",{kind:"mapping",resolve:Vxe,construct:Yxe}),Gxe=Cxe.extend({implicit:[Pxe,$xe],explicit:[Bxe,jxe,Hxe,qxe]}),ra=Object.prototype.hasOwnProperty,Hm=1,l8=2,c8=3,Km=4,A1=1,Xxe=2,YI=3,Zxe=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,Qxe=/[\x85\u2028\u2029]/,Jxe=/[,\[\]\{\}]/,u8=/^(?:!|!!|![a-z\-]+!)$/i,d8=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function qI(e){return Object.prototype.toString.call(e)}function eo(e){return e===10||e===13}function Wa(e){return e===9||e===32}function ur(e){return e===9||e===32||e===10||e===13}function oc(e){return e===44||e===91||e===93||e===123||e===125}function ebe(e){var t;return 48<=e&&e<=57?e-48:(t=e|32,97<=t&&t<=102?t-97+10:-1)}function tbe(e){return e===120?2:e===117?4:e===85?8:0}function nbe(e){return 48<=e&&e<=57?e-48:-1}function GI(e){return e===48?"\0":e===97?"\x07":e===98?"\b":e===116||e===9?"	":e===110?`
`:e===118?"\v":e===102?"\f":e===114?"\r":e===101?"\x1B":e===32?" ":e===34?'"':e===47?"/":e===92?"\\":e===78?"":e===95?" ":e===76?"\u2028":e===80?"\u2029":""}function rbe(e){return e<=65535?String.fromCharCode(e):String.fromCharCode((e-65536>>10)+55296,(e-65536&1023)+56320)}var h8=new Array(256),f8=new Array(256);for(var Nl=0;Nl<256;Nl++)h8[Nl]=GI(Nl)?1:0,f8[Nl]=GI(Nl);function ibe(e,t){this.input=e,this.filename=t.filename||null,this.schema=t.schema||Gxe,this.onWarning=t.onWarning||null,this.legacy=t.legacy||!1,this.json=t.json||!1,this.listener=t.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=e.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function p8(e,t){var n={name:e.filename,buffer:e.input.slice(0,-1),position:e.position,line:e.line,column:e.position-e.lineStart};return n.snippet=K1e(n),new To(t,n)}function _e(e,t){throw p8(e,t)}function Vm(e,t){e.onWarning&&e.onWarning.call(null,p8(e,t))}var XI={YAML:function(t,n,r){var i,o,s;t.version!==null&&_e(t,"duplication of %YAML directive"),r.length!==1&&_e(t,"YAML directive accepts exactly one argument"),i=/^([0-9]+)\.([0-9]+)$/.exec(r[0]),i===null&&_e(t,"ill-formed argument of the YAML directive"),o=parseInt(i[1],10),s=parseInt(i[2],10),o!==1&&_e(t,"unacceptable YAML version of the document"),t.version=r[0],t.checkLineBreaks=s<2,s!==1&&s!==2&&Vm(t,"unsupported YAML version of the document")},TAG:function(t,n,r){var i,o;r.length!==2&&_e(t,"TAG directive accepts exactly two arguments"),i=r[0],o=r[1],u8.test(i)||_e(t,"ill-formed tag handle (first argument) of the TAG directive"),ra.call(t.tagMap,i)&&_e(t,'there is a previously declared suffix for "'+i+'" tag handle'),d8.test(o)||_e(t,"ill-formed tag prefix (second argument) of the TAG directive");try{o=decodeURIComponent(o)}catch{_e(t,"tag prefix is malformed: "+o)}t.tagMap[i]=o}};function Ks(e,t,n,r){var i,o,s,a;if(t<n){if(a=e.input.slice(t,n),r)for(i=0,o=a.length;i<o;i+=1)s=a.charCodeAt(i),s===9||32<=s&&s<=1114111||_e(e,"expected valid JSON character");else Zxe.test(a)&&_e(e,"the stream contains non-printable characters");e.result+=a}}function ZI(e,t,n,r){var i,o,s,a;for(Vn.isObject(n)||_e(e,"cannot merge mappings; the provided source object is unacceptable"),i=Object.keys(n),s=0,a=i.length;s<a;s+=1)o=i[s],ra.call(t,o)||(t[o]=n[o],r[o]=!0)}function sc(e,t,n,r,i,o,s,a,l){var c,u;if(Array.isArray(i))for(i=Array.prototype.slice.call(i),c=0,u=i.length;c<u;c+=1)Array.isArray(i[c])&&_e(e,"nested arrays are not supported inside keys"),typeof i=="object"&&qI(i[c])==="[object Object]"&&(i[c]="[object Object]");if(typeof i=="object"&&qI(i)==="[object Object]"&&(i="[object Object]"),i=String(i),t===null&&(t={}),r==="tag:yaml.org,2002:merge")if(Array.isArray(o))for(c=0,u=o.length;c<u;c+=1)ZI(e,t,o[c],n);else ZI(e,t,o,n);else!e.json&&!ra.call(n,i)&&ra.call(t,i)&&(e.line=s||e.line,e.lineStart=a||e.lineStart,e.position=l||e.position,_e(e,"duplicated mapping key")),i==="__proto__"?Object.defineProperty(t,i,{configurable:!0,enumerable:!0,writable:!0,value:o}):t[i]=o,delete n[i];return t}function UC(e){var t;t=e.input.charCodeAt(e.position),t===10?e.position++:t===13?(e.position++,e.input.charCodeAt(e.position)===10&&e.position++):_e(e,"a line break is expected"),e.line+=1,e.lineStart=e.position,e.firstTabInLine=-1}function Gt(e,t,n){for(var r=0,i=e.input.charCodeAt(e.position);i!==0;){for(;Wa(i);)i===9&&e.firstTabInLine===-1&&(e.firstTabInLine=e.position),i=e.input.charCodeAt(++e.position);if(t&&i===35)do i=e.input.charCodeAt(++e.position);while(i!==10&&i!==13&&i!==0);if(eo(i))for(UC(e),i=e.input.charCodeAt(e.position),r++,e.lineIndent=0;i===32;)e.lineIndent++,i=e.input.charCodeAt(++e.position);else break}return n!==-1&&r!==0&&e.lineIndent<n&&Vm(e,"deficient indentation"),r}function g0(e){var t=e.position,n;return n=e.input.charCodeAt(t),!!((n===45||n===46)&&n===e.input.charCodeAt(t+1)&&n===e.input.charCodeAt(t+2)&&(t+=3,n=e.input.charCodeAt(t),n===0||ur(n)))}function WC(e,t){t===1?e.result+=" ":t>1&&(e.result+=Vn.repeat(`
`,t-1))}function obe(e,t,n){var r,i,o,s,a,l,c,u,d=e.kind,h=e.result,f;if(f=e.input.charCodeAt(e.position),ur(f)||oc(f)||f===35||f===38||f===42||f===33||f===124||f===62||f===39||f===34||f===37||f===64||f===96||(f===63||f===45)&&(i=e.input.charCodeAt(e.position+1),ur(i)||n&&oc(i)))return!1;for(e.kind="scalar",e.result="",o=s=e.position,a=!1;f!==0;){if(f===58){if(i=e.input.charCodeAt(e.position+1),ur(i)||n&&oc(i))break}else if(f===35){if(r=e.input.charCodeAt(e.position-1),ur(r))break}else{if(e.position===e.lineStart&&g0(e)||n&&oc(f))break;if(eo(f))if(l=e.line,c=e.lineStart,u=e.lineIndent,Gt(e,!1,-1),e.lineIndent>=t){a=!0,f=e.input.charCodeAt(e.position);continue}else{e.position=s,e.line=l,e.lineStart=c,e.lineIndent=u;break}}a&&(Ks(e,o,s,!1),WC(e,e.line-l),o=s=e.position,a=!1),Wa(f)||(s=e.position+1),f=e.input.charCodeAt(++e.position)}return Ks(e,o,s,!1),e.result?!0:(e.kind=d,e.result=h,!1)}function sbe(e,t){var n,r,i;if(n=e.input.charCodeAt(e.position),n!==39)return!1;for(e.kind="scalar",e.result="",e.position++,r=i=e.position;(n=e.input.charCodeAt(e.position))!==0;)if(n===39)if(Ks(e,r,e.position,!0),n=e.input.charCodeAt(++e.position),n===39)r=e.position,e.position++,i=e.position;else return!0;else eo(n)?(Ks(e,r,i,!0),WC(e,Gt(e,!1,t)),r=i=e.position):e.position===e.lineStart&&g0(e)?_e(e,"unexpected end of the document within a single quoted scalar"):(e.position++,i=e.position);_e(e,"unexpected end of the stream within a single quoted scalar")}function abe(e,t){var n,r,i,o,s,a;if(a=e.input.charCodeAt(e.position),a!==34)return!1;for(e.kind="scalar",e.result="",e.position++,n=r=e.position;(a=e.input.charCodeAt(e.position))!==0;){if(a===34)return Ks(e,n,e.position,!0),e.position++,!0;if(a===92){if(Ks(e,n,e.position,!0),a=e.input.charCodeAt(++e.position),eo(a))Gt(e,!1,t);else if(a<256&&h8[a])e.result+=f8[a],e.position++;else if((s=tbe(a))>0){for(i=s,o=0;i>0;i--)a=e.input.charCodeAt(++e.position),(s=ebe(a))>=0?o=(o<<4)+s:_e(e,"expected hexadecimal character");e.result+=rbe(o),e.position++}else _e(e,"unknown escape sequence");n=r=e.position}else eo(a)?(Ks(e,n,r,!0),WC(e,Gt(e,!1,t)),n=r=e.position):e.position===e.lineStart&&g0(e)?_e(e,"unexpected end of the document within a double quoted scalar"):(e.position++,r=e.position)}_e(e,"unexpected end of the stream within a double quoted scalar")}function lbe(e,t){var n=!0,r,i,o,s=e.tag,a,l=e.anchor,c,u,d,h,f,p=Object.create(null),g,y,x,w;if(w=e.input.charCodeAt(e.position),w===91)u=93,f=!1,a=[];else if(w===123)u=125,f=!0,a={};else return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=a),w=e.input.charCodeAt(++e.position);w!==0;){if(Gt(e,!0,t),w=e.input.charCodeAt(e.position),w===u)return e.position++,e.tag=s,e.anchor=l,e.kind=f?"mapping":"sequence",e.result=a,!0;n?w===44&&_e(e,"expected the node content, but found ','"):_e(e,"missed comma between flow collection entries"),y=g=x=null,d=h=!1,w===63&&(c=e.input.charCodeAt(e.position+1),ur(c)&&(d=h=!0,e.position++,Gt(e,!0,t))),r=e.line,i=e.lineStart,o=e.position,Nc(e,t,Hm,!1,!0),y=e.tag,g=e.result,Gt(e,!0,t),w=e.input.charCodeAt(e.position),(h||e.line===r)&&w===58&&(d=!0,w=e.input.charCodeAt(++e.position),Gt(e,!0,t),Nc(e,t,Hm,!1,!0),x=e.result),f?sc(e,a,p,y,g,x,r,i,o):d?a.push(sc(e,null,p,y,g,x,r,i,o)):a.push(g),Gt(e,!0,t),w=e.input.charCodeAt(e.position),w===44?(n=!0,w=e.input.charCodeAt(++e.position)):n=!1}_e(e,"unexpected end of the stream within a flow collection")}function cbe(e,t){var n,r,i=A1,o=!1,s=!1,a=t,l=0,c=!1,u,d;if(d=e.input.charCodeAt(e.position),d===124)r=!1;else if(d===62)r=!0;else return!1;for(e.kind="scalar",e.result="";d!==0;)if(d=e.input.charCodeAt(++e.position),d===43||d===45)A1===i?i=d===43?YI:Xxe:_e(e,"repeat of a chomping mode identifier");else if((u=nbe(d))>=0)u===0?_e(e,"bad explicit indentation width of a block scalar; it cannot be less than one"):s?_e(e,"repeat of an indentation width identifier"):(a=t+u-1,s=!0);else break;if(Wa(d)){do d=e.input.charCodeAt(++e.position);while(Wa(d));if(d===35)do d=e.input.charCodeAt(++e.position);while(!eo(d)&&d!==0)}for(;d!==0;){for(UC(e),e.lineIndent=0,d=e.input.charCodeAt(e.position);(!s||e.lineIndent<a)&&d===32;)e.lineIndent++,d=e.input.charCodeAt(++e.position);if(!s&&e.lineIndent>a&&(a=e.lineIndent),eo(d)){l++;continue}if(e.lineIndent<a){i===YI?e.result+=Vn.repeat(`
`,o?1+l:l):i===A1&&o&&(e.result+=`
`);break}for(r?Wa(d)?(c=!0,e.result+=Vn.repeat(`
`,o?1+l:l)):c?(c=!1,e.result+=Vn.repeat(`
`,l+1)):l===0?o&&(e.result+=" "):e.result+=Vn.repeat(`
`,l):e.result+=Vn.repeat(`
`,o?1+l:l),o=!0,s=!0,l=0,n=e.position;!eo(d)&&d!==0;)d=e.input.charCodeAt(++e.position);Ks(e,n,e.position,!1)}return!0}function QI(e,t){var n,r=e.tag,i=e.anchor,o=[],s,a=!1,l;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=o),l=e.input.charCodeAt(e.position);l!==0&&(e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,_e(e,"tab characters must not be used in indentation")),!(l!==45||(s=e.input.charCodeAt(e.position+1),!ur(s))));){if(a=!0,e.position++,Gt(e,!0,-1)&&e.lineIndent<=t){o.push(null),l=e.input.charCodeAt(e.position);continue}if(n=e.line,Nc(e,t,c8,!1,!0),o.push(e.result),Gt(e,!0,-1),l=e.input.charCodeAt(e.position),(e.line===n||e.lineIndent>t)&&l!==0)_e(e,"bad indentation of a sequence entry");else if(e.lineIndent<t)break}return a?(e.tag=r,e.anchor=i,e.kind="sequence",e.result=o,!0):!1}function ube(e,t,n){var r,i,o,s,a,l,c=e.tag,u=e.anchor,d={},h=Object.create(null),f=null,p=null,g=null,y=!1,x=!1,w;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=d),w=e.input.charCodeAt(e.position);w!==0;){if(!y&&e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,_e(e,"tab characters must not be used in indentation")),r=e.input.charCodeAt(e.position+1),o=e.line,(w===63||w===58)&&ur(r))w===63?(y&&(sc(e,d,h,f,p,null,s,a,l),f=p=g=null),x=!0,y=!0,i=!0):y?(y=!1,i=!0):_e(e,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),e.position+=1,w=r;else{if(s=e.line,a=e.lineStart,l=e.position,!Nc(e,n,l8,!1,!0))break;if(e.line===o){for(w=e.input.charCodeAt(e.position);Wa(w);)w=e.input.charCodeAt(++e.position);if(w===58)w=e.input.charCodeAt(++e.position),ur(w)||_e(e,"a whitespace character is expected after the key-value separator within a block mapping"),y&&(sc(e,d,h,f,p,null,s,a,l),f=p=g=null),x=!0,y=!1,i=!1,f=e.tag,p=e.result;else if(x)_e(e,"can not read an implicit mapping pair; a colon is missed");else return e.tag=c,e.anchor=u,!0}else if(x)_e(e,"can not read a block mapping entry; a multiline key may not be an implicit key");else return e.tag=c,e.anchor=u,!0}if((e.line===o||e.lineIndent>t)&&(y&&(s=e.line,a=e.lineStart,l=e.position),Nc(e,t,Km,!0,i)&&(y?p=e.result:g=e.result),y||(sc(e,d,h,f,p,g,s,a,l),f=p=g=null),Gt(e,!0,-1),w=e.input.charCodeAt(e.position)),(e.line===o||e.lineIndent>t)&&w!==0)_e(e,"bad indentation of a mapping entry");else if(e.lineIndent<t)break}return y&&sc(e,d,h,f,p,null,s,a,l),x&&(e.tag=c,e.anchor=u,e.kind="mapping",e.result=d),x}function dbe(e){var t,n=!1,r=!1,i,o,s;if(s=e.input.charCodeAt(e.position),s!==33)return!1;if(e.tag!==null&&_e(e,"duplication of a tag property"),s=e.input.charCodeAt(++e.position),s===60?(n=!0,s=e.input.charCodeAt(++e.position)):s===33?(r=!0,i="!!",s=e.input.charCodeAt(++e.position)):i="!",t=e.position,n){do s=e.input.charCodeAt(++e.position);while(s!==0&&s!==62);e.position<e.length?(o=e.input.slice(t,e.position),s=e.input.charCodeAt(++e.position)):_e(e,"unexpected end of the stream within a verbatim tag")}else{for(;s!==0&&!ur(s);)s===33&&(r?_e(e,"tag suffix cannot contain exclamation marks"):(i=e.input.slice(t-1,e.position+1),u8.test(i)||_e(e,"named tag handle cannot contain such characters"),r=!0,t=e.position+1)),s=e.input.charCodeAt(++e.position);o=e.input.slice(t,e.position),Jxe.test(o)&&_e(e,"tag suffix cannot contain flow indicator characters")}o&&!d8.test(o)&&_e(e,"tag name cannot contain such characters: "+o);try{o=decodeURIComponent(o)}catch{_e(e,"tag name is malformed: "+o)}return n?e.tag=o:ra.call(e.tagMap,i)?e.tag=e.tagMap[i]+o:i==="!"?e.tag="!"+o:i==="!!"?e.tag="tag:yaml.org,2002:"+o:_e(e,'undeclared tag handle "'+i+'"'),!0}function hbe(e){var t,n;if(n=e.input.charCodeAt(e.position),n!==38)return!1;for(e.anchor!==null&&_e(e,"duplication of an anchor property"),n=e.input.charCodeAt(++e.position),t=e.position;n!==0&&!ur(n)&&!oc(n);)n=e.input.charCodeAt(++e.position);return e.position===t&&_e(e,"name of an anchor node must contain at least one character"),e.anchor=e.input.slice(t,e.position),!0}function fbe(e){var t,n,r;if(r=e.input.charCodeAt(e.position),r!==42)return!1;for(r=e.input.charCodeAt(++e.position),t=e.position;r!==0&&!ur(r)&&!oc(r);)r=e.input.charCodeAt(++e.position);return e.position===t&&_e(e,"name of an alias node must contain at least one character"),n=e.input.slice(t,e.position),ra.call(e.anchorMap,n)||_e(e,'unidentified alias "'+n+'"'),e.result=e.anchorMap[n],Gt(e,!0,-1),!0}function Nc(e,t,n,r,i){var o,s,a,l=1,c=!1,u=!1,d,h,f,p,g,y;if(e.listener!==null&&e.listener("open",e),e.tag=null,e.anchor=null,e.kind=null,e.result=null,o=s=a=Km===n||c8===n,r&&Gt(e,!0,-1)&&(c=!0,e.lineIndent>t?l=1:e.lineIndent===t?l=0:e.lineIndent<t&&(l=-1)),l===1)for(;dbe(e)||hbe(e);)Gt(e,!0,-1)?(c=!0,a=o,e.lineIndent>t?l=1:e.lineIndent===t?l=0:e.lineIndent<t&&(l=-1)):a=!1;if(a&&(a=c||i),(l===1||Km===n)&&(Hm===n||l8===n?g=t:g=t+1,y=e.position-e.lineStart,l===1?a&&(QI(e,y)||ube(e,y,g))||lbe(e,g)?u=!0:(s&&cbe(e,g)||sbe(e,g)||abe(e,g)?u=!0:fbe(e)?(u=!0,(e.tag!==null||e.anchor!==null)&&_e(e,"alias node should not have any properties")):obe(e,g,Hm===n)&&(u=!0,e.tag===null&&(e.tag="?")),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):l===0&&(u=a&&QI(e,y))),e.tag===null)e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);else if(e.tag==="?"){for(e.result!==null&&e.kind!=="scalar"&&_e(e,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+e.kind+'"'),d=0,h=e.implicitTypes.length;d<h;d+=1)if(p=e.implicitTypes[d],p.resolve(e.result)){e.result=p.construct(e.result),e.tag=p.tag,e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);break}}else if(e.tag!=="!"){if(ra.call(e.typeMap[e.kind||"fallback"],e.tag))p=e.typeMap[e.kind||"fallback"][e.tag];else for(p=null,f=e.typeMap.multi[e.kind||"fallback"],d=0,h=f.length;d<h;d+=1)if(e.tag.slice(0,f[d].tag.length)===f[d].tag){p=f[d];break}p||_e(e,"unknown tag !<"+e.tag+">"),e.result!==null&&p.kind!==e.kind&&_e(e,"unacceptable node kind for !<"+e.tag+'> tag; it should be "'+p.kind+'", not "'+e.kind+'"'),p.resolve(e.result,e.tag)?(e.result=p.construct(e.result,e.tag),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):_e(e,"cannot resolve a node with !<"+e.tag+"> explicit tag")}return e.listener!==null&&e.listener("close",e),e.tag!==null||e.anchor!==null||u}function pbe(e){var t=e.position,n,r,i,o=!1,s;for(e.version=null,e.checkLineBreaks=e.legacy,e.tagMap=Object.create(null),e.anchorMap=Object.create(null);(s=e.input.charCodeAt(e.position))!==0&&(Gt(e,!0,-1),s=e.input.charCodeAt(e.position),!(e.lineIndent>0||s!==37));){for(o=!0,s=e.input.charCodeAt(++e.position),n=e.position;s!==0&&!ur(s);)s=e.input.charCodeAt(++e.position);for(r=e.input.slice(n,e.position),i=[],r.length<1&&_e(e,"directive name must not be less than one character in length");s!==0;){for(;Wa(s);)s=e.input.charCodeAt(++e.position);if(s===35){do s=e.input.charCodeAt(++e.position);while(s!==0&&!eo(s));break}if(eo(s))break;for(n=e.position;s!==0&&!ur(s);)s=e.input.charCodeAt(++e.position);i.push(e.input.slice(n,e.position))}s!==0&&UC(e),ra.call(XI,r)?XI[r](e,r,i):Vm(e,'unknown document directive "'+r+'"')}if(Gt(e,!0,-1),e.lineIndent===0&&e.input.charCodeAt(e.position)===45&&e.input.charCodeAt(e.position+1)===45&&e.input.charCodeAt(e.position+2)===45?(e.position+=3,Gt(e,!0,-1)):o&&_e(e,"directives end mark is expected"),Nc(e,e.lineIndent-1,Km,!1,!0),Gt(e,!0,-1),e.checkLineBreaks&&Qxe.test(e.input.slice(t,e.position))&&Vm(e,"non-ASCII line breaks are interpreted as content"),e.documents.push(e.result),e.position===e.lineStart&&g0(e)){e.input.charCodeAt(e.position)===46&&(e.position+=3,Gt(e,!0,-1));return}if(e.position<e.length-1)_e(e,"end of the stream or a document separator is expected");else return}function g8(e,t){e=String(e),t=t||{},e.length!==0&&(e.charCodeAt(e.length-1)!==10&&e.charCodeAt(e.length-1)!==13&&(e+=`
`),e.charCodeAt(0)===65279&&(e=e.slice(1)));var n=new ibe(e,t),r=e.indexOf("\0");for(r!==-1&&(n.position=r,_e(n,"null byte is not allowed in input")),n.input+="\0";n.input.charCodeAt(n.position)===32;)n.lineIndent+=1,n.position+=1;for(;n.position<n.length-1;)pbe(n);return n.documents}function gbe(e,t,n){t!==null&&typeof t=="object"&&typeof n>"u"&&(n=t,t=null);var r=g8(e,n);if(typeof t!="function")return r;for(var i=0,o=r.length;i<o;i+=1)t(r[i])}function mbe(e,t){var n=g8(e,t);if(n.length!==0){if(n.length===1)return n[0];throw new To("expected a single document in the stream, but found more")}}var ybe=gbe,vbe=mbe,xbe={loadAll:ybe,load:vbe},bbe=o8,wbe=xbe.load;function m8(e,t,n){var r,i;const o=e.match(gR);if(!o)return e;const s=wbe(o[1],{schema:bbe});return s!=null&&s.title&&((r=t.setDiagramTitle)==null||r.call(t,s.title.toString())),s!=null&&s.displayMode&&((i=t.setDisplayMode)==null||i.call(t,s.displayMode.toString())),s!=null&&s.config&&(n==null||n(s.config)),e.slice(o[0].length)}const Sbe=e=>e.trimStart().replace(/^\s*%%(?!{)[^\n]+\n?/gm,"");class y8{constructor(t){this.text=t,this.type="graph",this.text+=`
`;const n=Ri();try{this.type=h0(t,n)}catch(o){this.type="error",this.detectError=o}const r=NC(this.type);xe.debug("Type "+this.type),this.db=r.db,this.renderer=r.renderer,this.parser=r.parser;const i=this.parser.parse.bind(this.parser);this.parser.parse=o=>i(Sbe(m8(o,this.db,jm))),this.parser.parser.yy=this.db,this.init=r.init,this.parse()}parse(){var t,n,r;if(this.detectError)throw this.detectError;(n=(t=this.db).clear)==null||n.call(t),(r=this.init)==null||r.call(this,Ri()),this.parser.parse(this.text)}async render(t,n){await this.renderer.draw(this.text,t,n,this)}getParser(){return this.parser}getType(){return this.type}}const HC=async e=>{const t=h0(e,Ri());try{NC(t)}catch{const r=u0e(t);if(!r)throw new mR(`Diagram ${t} not found.`);const{id:i,diagram:o}=await r();Wm(i,o)}return new y8(e)};let yw=[];const nSe=e=>{yw.push(e)},_be=()=>{yw.forEach(e=>{e()}),yw=[]},Cbe="graphics-document document";function Ebe(e,t){e.attr("role",Cbe),t!==""&&e.attr("aria-roledescription",t)}function kbe(e,t,n,r){if(e.insert!==void 0){if(n){const i=`chart-desc-${r}`;e.attr("aria-describedby",i),e.insert("desc",":first-child").attr("id",i).text(n)}if(t){const i=`chart-title-${r}`;e.attr("aria-labelledby",i),e.insert("title",":first-child").attr("id",i).text(t)}}}const v8=["graph","flowchart","flowchart-v2","flowchart-elk","stateDiagram","stateDiagram-v2"],Tbe=5e4,Pbe="graph TB;a[Maximum text size in diagram exceeded];style a fill:#faa",Ibe="sandbox",$be="loose",Abe="http://www.w3.org/2000/svg",Mbe="http://www.w3.org/1999/xlink",Obe="http://www.w3.org/1999/xhtml",Lbe="100%",Bbe="100%",Rbe="border:0;margin:0;",Dbe="margin:0",Fbe="allow-top-navigation-by-user-activation allow-popups",Nbe='The "iframe" tag is not supported by your browser.',jbe=["foreignobject"],zbe=["dominant-baseline"];async function Ube(e,t){jC();try{await HC(e)}catch(n){if(t!=null&&t.suppressErrors)return!1;throw n}return!0}const Wbe=function(e){let t=e;return t=t.replace(/style.*:\S*#.*;/g,function(n){return n.substring(0,n.length-1)}),t=t.replace(/classDef.*:\S*#.*;/g,function(n){return n.substring(0,n.length-1)}),t=t.replace(/#\w+;/g,function(n){const r=n.substring(1,n.length-1);return/^\+?\d+$/.test(r)?"ﬂ°°"+r+"¶ß":"ﬂ°"+r+"¶ß"}),t},Hbe=function(e){return e.replace(/ﬂ°°/g,"&#").replace(/ﬂ°/g,"&").replace(/¶ß/g,";")},JI=(e,t,n=[])=>`
.${e} ${t} { ${n.join(" !important; ")} !important; }`,Kbe=(e,t,n={})=>{var r;let i="";if(e.themeCSS!==void 0&&(i+=`
${e.themeCSS}`),e.fontFamily!==void 0&&(i+=`
:root { --mermaid-font-family: ${e.fontFamily}}`),e.altFontFamily!==void 0&&(i+=`
:root { --mermaid-alt-font-family: ${e.altFontFamily}}`),!P1(n)&&v8.includes(t)){const l=e.htmlLabels||((r=e.flowchart)==null?void 0:r.htmlLabels)?["> *","span"]:["rect","polygon","ellipse","circle","path"];for(const c in n){const u=n[c];P1(u.styles)||l.forEach(d=>{i+=JI(u.id,d,u.styles)}),P1(u.textStyles)||(i+=JI(u.id,"tspan",u.textStyles))}}return i},Vbe=(e,t,n,r)=>{const i=Kbe(e,t,n),o=S1e(t,i,e.themeVariables);return uw(xye(`${r}{${o}}`),wye)},Ybe=(e="",t,n)=>{let r=e;return!n&&!t&&(r=r.replace(/marker-end="url\([\d+./:=?A-Za-z-]*?#/g,'marker-end="url(#')),r=Hbe(r),r=r.replace(/<br>/g,"<br/>"),r},qbe=(e="",t)=>{var n,r;const i=(r=(n=t==null?void 0:t.viewBox)==null?void 0:n.baseVal)!=null&&r.height?t.viewBox.baseVal.height+"px":Bbe,o=btoa('<body style="'+Dbe+'">'+e+"</body>");return`<iframe style="width:${Lbe};height:${i};${Rbe}" src="data:text/html;base64,${o}" sandbox="${Fbe}">
  ${Nbe}
</iframe>`},e$=(e,t,n,r,i)=>{const o=e.append("div");o.attr("id",n),r&&o.attr("style",r);const s=o.append("svg").attr("id",t).attr("width","100%").attr("xmlns",Abe);return i&&s.attr("xmlns:xlink",i),s.append("g"),e};function t$(e,t){return e.append("iframe").attr("id",t).attr("style","width: 100%; height: 100%;").attr("sandbox","")}const Gbe=(e,t,n,r)=>{var i,o,s;(i=e.getElementById(t))==null||i.remove(),(o=e.getElementById(n))==null||o.remove(),(s=e.getElementById(r))==null||s.remove()},Xbe=async function(e,t,n){var r,i,o,s;jC(),zm(),m8(t,{},jm);const a=vg.detectInit(t);a&&jm(a);const l=Ri();xe.debug(l),t.length>((l==null?void 0:l.maxTextSize)??Tbe)&&(t=Pbe),t=t.replace(/\r\n?/g,`
`),t=t.replace(/<(\w+)([^>]*)>/g,(U,D,F)=>"<"+D+F.replace(/="([^"]*)"/g,"='$1'")+">");const c="#"+e,u="i"+e,d="#"+u,h="d"+e,f="#"+h;let p=Yr("body");const g=l.securityLevel===Ibe,y=l.securityLevel===$be,x=l.fontFamily;if(n!==void 0){if(n&&(n.innerHTML=""),g){const U=t$(Yr(n),u);p=Yr(U.nodes()[0].contentDocument.body),p.node().style.margin=0}else p=Yr(n);e$(p,e,h,`font-family: ${x}`,Mbe)}else{if(Gbe(document,e,h,u),g){const U=t$(Yr("body"),u);p=Yr(U.nodes()[0].contentDocument.body),p.node().style.margin=0}else p=Yr("body");e$(p,e,h)}t=Wbe(t);let w,_;try{w=await HC(t)}catch(U){w=new y8("error"),_=U}const S=p.select(f).node(),T=w.type,P=S.firstChild,I=P.firstChild,$=v8.includes(T)?w.renderer.getClasses(t,w):{},L=Vbe(l,T,$,c),R=document.createElement("style");R.innerHTML=L,P.insertBefore(R,I);try{await w.renderer.draw(t,e,WI,w)}catch(U){throw t1e.draw(t,e,WI),U}const K=p.select(`${f} svg`),Q=(i=(r=w.db).getAccTitle)==null?void 0:i.call(r),j=(s=(o=w.db).getAccDescription)==null?void 0:s.call(o);Qbe(T,K,Q,j),p.select(`[id="${e}"]`).selectAll("foreignobject > *").attr("xmlns",Obe);let B=p.select(f).node().innerHTML;if(xe.debug("config.arrowMarkerAbsolute",l.arrowMarkerAbsolute),B=Ybe(B,g,hR(l.arrowMarkerAbsolute)),g){const U=p.select(f+" svg").node();B=qbe(B,U)}else y||(B=Om.sanitize(B,{ADD_TAGS:jbe,ADD_ATTR:zbe}));if(_be(),_)throw _;const q=Yr(g?d:f).node();return q&&"remove"in q&&q.remove(),{svg:B,bindFunctions:w.db.bindFunctions}};function Zbe(e={}){var t;e!=null&&e.fontFamily&&!((t=e.themeVariables)!=null&&t.fontFamily)&&(e.themeVariables||(e.themeVariables={}),e.themeVariables.fontFamily=e.fontFamily),D0e(e),e!=null&&e.theme&&e.theme in Do?e.themeVariables=Do[e.theme].getThemeVariables(e.themeVariables):e&&(e.themeVariables=Do.default.getThemeVariables(e.themeVariables));const n=typeof e=="object"?R0e(e):_R();MC(n.logLevel),jC()}function Qbe(e,t,n,r){Ebe(t,e),kbe(t,n,r,t.attr("id"))}const nl=Object.freeze({render:Xbe,parse:Ube,parseDirective:t8,getDiagramFromText:HC,initialize:Zbe,getConfig:Ri,setConfig:N0e,getSiteConfig:_R,updateSiteConfig:F0e,reset:()=>{zm()},globalReset:()=>{zm(vh)},defaultConfig:vh});MC(Ri().logLevel);zm(Ri());const Jbe=async()=>{xe.debug("Loading registered diagrams");const t=(await Promise.allSettled(Object.entries(Dc).map(async([n,{detector:r,loader:i}])=>{if(i)try{NC(n)}catch{try{const{diagram:s,id:a}=await i();Wm(a,s,r)}catch(s){throw xe.error(`Failed to load external diagram with key ${n}. Removing from detectors.`),delete Dc[n],s}}}))).filter(n=>n.status==="rejected");if(t.length>0){xe.error(`Failed to load ${t.length} external diagrams`);for(const n of t)xe.error(n);throw new Error(`Failed to load ${t.length} external diagrams`)}},ewe=(e,t,n)=>{xe.warn(e),wR(e)?(n&&n(e.str,e.hash),t.push({...e,message:e.str,error:e})):(n&&n(e),e instanceof Error&&t.push({str:e.message,message:e.message,hash:e.name,error:e}))},x8=async function(e={querySelector:".mermaid"}){try{await twe(e)}catch(t){if(wR(t)&&xe.error(t.str),Di.parseError&&Di.parseError(t),!e.suppressErrors)throw xe.error("Use the suppressErrors option to suppress these errors"),t}},twe=async function({postRenderCallback:e,querySelector:t,nodes:n}={querySelector:".mermaid"}){const r=nl.getConfig();xe.debug(`${e?"":"No "}Callback function found`);let i;if(n)i=n;else if(t)i=document.querySelectorAll(t);else throw new Error("Nodes and querySelector are both undefined");xe.debug(`Found ${i.length} diagrams`),(r==null?void 0:r.startOnLoad)!==void 0&&(xe.debug("Start On Load: "+(r==null?void 0:r.startOnLoad)),nl.updateSiteConfig({startOnLoad:r==null?void 0:r.startOnLoad}));const o=new vg.initIdGenerator(r.deterministicIds,r.deterministicIDSeed);let s;const a=[];for(const l of Array.from(i)){xe.info("Rendering diagram: "+l.id);/*! Check if previously processed */if(l.getAttribute("data-processed"))continue;l.setAttribute("data-processed","true");const c=`mermaid-${o.next()}`;s=l.innerHTML,s=Bce(vg.entityDecode(s)).trim().replace(/<br\s*\/?>/gi,"<br/>");const u=vg.detectInit(s);u&&xe.debug("Detected early reinit: ",u);try{const{svg:d,bindFunctions:h}=await _8(c,s,l);l.innerHTML=d,e&&await e(c),h&&h(l)}catch(d){ewe(d,a,Di.parseError)}}if(a.length>0)throw a[0]},b8=function(e){nl.initialize(e)},nwe=async function(e,t,n){xe.warn("mermaid.init is deprecated. Please use run instead."),e&&b8(e);const r={postRenderCallback:n,querySelector:".mermaid"};typeof t=="string"?r.querySelector=t:t&&(t instanceof HTMLElement?r.nodes=[t]:r.nodes=t),await x8(r)},rwe=async(e,{lazyLoad:t=!0}={})=>{yR(...e),t===!1&&await Jbe()},w8=function(){if(Di.startOnLoad){const{startOnLoad:e}=nl.getConfig();e&&Di.run().catch(t=>xe.error("Mermaid failed to initialize",t))}};if(typeof document<"u"){/*!
 * Wait for document loaded before starting the execution
 */window.addEventListener("load",w8,!1)}const iwe=function(e){Di.parseError=e},Ym=[];let M1=!1;const S8=async()=>{if(!M1){for(M1=!0;Ym.length>0;){const e=Ym.shift();if(e)try{await e()}catch(t){xe.error("Error executing queue",t)}}M1=!1}},owe=async(e,t)=>new Promise((n,r)=>{const i=()=>new Promise((o,s)=>{nl.parse(e,t).then(a=>{o(a),n(a)},a=>{var l;xe.error("Error parsing",a),(l=Di.parseError)==null||l.call(Di,a),s(a),r(a)})});Ym.push(i),S8().catch(r)}),_8=(e,t,n)=>new Promise((r,i)=>{const o=()=>new Promise((s,a)=>{nl.render(e,t,n).then(l=>{s(l),r(l)},l=>{var c;xe.error("Error parsing",l),(c=Di.parseError)==null||c.call(Di,l),a(l),i(l)})});Ym.push(o),S8().catch(i)}),Di={startOnLoad:!0,mermaidAPI:nl,parse:owe,render:_8,init:nwe,run:x8,registerExternalDiagrams:rwe,initialize:b8,parseError:void 0,contentLoaded:w8,setParseErrorHandler:iwe,detectType:h0},swe=e=>{const t=b.useRef(null);return b.useEffect(()=>{async function n(){if(t.current){t.current.innerHTML="";const r=await Di.mermaidAPI.render("graphDiv",e,t.current);t.current.innerHTML=r.svg}}n()},[e]),t};function awe(e){var s,a,l,c,u,d;const t=[],n=[];for(const h in e){const f=e[h];if(f.type==="arrow"){const p=(s=f.props.start)==null?void 0:s.boundShapeId,g=(a=f.props.end)==null?void 0:a.boundShapeId;if(console.log(p,g),!p||!g){console.log("skipped arrow");continue}else console.log("didn't skip");const y={type:"arrow",startShapeId:p,endShapeId:g,style:"---"};n.push(y)}else if(((l=f.props)==null?void 0:l.geo)==="rectangle"){const p={type:"rectangle",text:((c=f.props)==null?void 0:c.text)||" ",id:f.id};t.push(p)}else if(((u=f.props)==null?void 0:u.geo)==="ellipse"){const p={type:"ellipse",text:((d=f.props)==null?void 0:d.text)||" ",id:f.id};t.push(p)}}let r="";t.forEach(h=>{r+=`
   ${h.id}["${h.text}"]`}),t.length&&n.length&&(r+=`
`);let i="";return n.forEach(h=>{console.log(h),i+=`
   ${h.startShapeId} ${h.style} ${h.endShapeId}`}),`flowchart TD${r}${i}`}function lwe(){const[e,t]=b.useState(""),[n]=b.useState(()=>Cb({}));function r(o){return o===""?"":`\`\`\`mermaid
${o}
\`\`\``}b.useLayoutEffect(()=>{const o=n.listen(SH(()=>{const s=n.getSnapshot(),a=awe(s.store);t(a)},100));return()=>{o()}},[n]);const i=swe(e);return m.jsxs("div",{style:{width:"100vw",height:"100vh"},className:"tldraw__editor",children:[m.jsx("div",{style:{width:"100vw",height:"50vh"},children:m.jsx(Lce,{autoFocus:!0,store:n})}),m.jsx("div",{style:{width:"50vw",height:"50vh",display:"flex",alignItems:"center",justifyContent:"center",float:"left"},children:m.jsx("div",{ref:i})}),m.jsxs("div",{style:{width:"50vw",height:"50vh",float:"left"},children:[m.jsx("p",{children:"Markdown"}),m.jsx("textarea",{style:{width:"100%",height:"100%",whiteSpace:"pre",overflowWrap:"normal",overflowX:"scroll"},readOnly:!0,value:r(e)})]})]})}ex.createRoot(document.getElementById("root")).render(m.jsx(ke.StrictMode,{children:m.jsx(lwe,{})}));export{B0e as $,vg as A,md as B,so as C,JR as D,e8 as E,qR as F,rfe as G,Xye as H,n8 as I,I1e as J,k0e as K,mC as L,hB as M,Xh as N,$de as O,gB as P,jwe as Q,cr as R,Br as S,Ln as T,rl as U,Nce as V,Xve as W,qwe as X,l0e as Y,t8 as Z,Le as _,QR as a,lI as a$,BC as a0,n0e as a1,yC as a2,ws as a3,uh as a4,tI as a5,Dde as a6,nSe as a7,d0e as a8,C0e as a9,ha as aA,n0 as aB,kI as aC,IC as aD,ZB as aE,tR as aF,iR as aG,_ge as aH,fo as aI,eye as aJ,tye as aK,TC as aL,fw as aM,zge as aN,Kme as aO,P1 as aP,iye as aQ,c0 as aR,vh as aS,Hbe as aT,C1e as aU,Zh as aV,Se as aW,Pe as aX,wC as aY,Wwe as aZ,Vwe as a_,Jh as aa,ou as ab,Lm as ac,Dm as ad,ml as ae,s0 as af,Rme as ag,kye as ah,Qh as ai,Rm as aj,Jme as ak,Hme as al,$me as am,nR as an,GB as ao,Tge as ap,Pge as aq,Dye as ar,AI as as,_me as at,Ige as au,PC as av,Ege as aw,Lge as ax,su as ay,Ime as az,ZR as b,aI as b0,Ywe as b1,Kwe as b2,zwe as b3,Uwe as b4,Xwe as b5,Gwe as b6,Hwe as b7,Bce as b8,Ri as c,mh as d,On as e,Nm as f,XR as g,Yr as h,UR as i,OC as j,A0e as k,xe as l,nl as m,QL as n,efe as o,_0e as p,hR as q,m0e as r,GR as s,Jve as t,N0e as u,dB as v,I0e as w,Yce as x,Zge as y,kC as z};
